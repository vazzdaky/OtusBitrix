jn.define("intranet/invite-opener-new",((e,t,n)=>{const{Notify:i}=e("notify");const{Invite:o,IntranetInviteAnalytics:r,AnalyticsEvent:a}=e("intranet/invite-new");const{Alert:s}=e("alert");const{Loc:l}=e("loc");const{InviteStatusBox:I}=e("intranet/invite-status-box");const{Tourist:c}=e("tourist");const{ButtonDesign:E}=e("ui-system/form/buttons/button");const d={POSSIBILITIES_RESTRICTED:"Invite possibilities restricted",PERMISSIONS_RESTRICTED:"Invite permissions restricted"};const v=e=>{if(env.isCollaber||env.extranet){return}i.showIndicatorLoading();_().then((t=>T(t,e)),(t=>u(t,e))).catch((e=>console.error(e))).finally((()=>i.hideCurrentIndicator()))};const u=(e,t)=>{const n=e.errors&&e.errors.length>0;if(n){p(e.errors,t.onInviteError)}};const T=(e,t)=>{m();const n=e.errors&&e.errors.length>0;if(n){p(e.errors,t.onInviteError);return}const{canCurrentUserInvite:i,isBitrix24Included:o}=e.data;if(!o&&!env.isAdmin){f(t.onInviteError,t.parentLayout,t.analytics);return}if(!i){g(t.onInviteError,t.parentLayout);return}S({...y(e.data),...t})};const m=()=>{c.ready().then((()=>{if(c.firstTime("visit_invitations")){return c.remember("visit_invitations").then((()=>{BX.postComponentEvent("onSetUserCounters",[{[String(env.siteId)]:{menu_invite:0}}])})).catch(console.error)}return Promise.resolve()})).catch(console.error)};const f=(e,t=PageManager,n={})=>{const i=new r({analytics:n});i.sendProhibitInviteEvent();I.open({backdropTitle:l.getMessage("INTRANET_INVITE_OPENER_TITLE_MSGVER_1"),testId:"status-box-no-permission",imageName:"user-locked.svg",parentWidget:t,description:l.getMessage("INTRANET_INVITE_ADMIN_ONLY_BOX_TEXT"),buttonText:l.getMessage("INTRANET_INVITE_DISABLED_BOX_BUTTON_TEXT"),buttonDesign:E.OUTLINE});if(e){e([new Error(d.PERMISSIONS_RESTRICTED)])}};const g=(e,t=PageManager)=>{I.open({backdropTitle:l.getMessage("INTRANET_INVITE_OPENER_TITLE_MSGVER_1"),testId:"status-box-no-invitation",imageName:"no-invitation.svg",parentWidget:t,description:l.getMessage("INTRANET_INVITE_DISABLED_BOX_TEXT"),buttonText:l.getMessage("INTRANET_INVITE_DISABLED_BOX_BUTTON_TEXT")});if(e){e([new Error(d.PERMISSIONS_RESTRICTED)])}};const p=(e,t)=>{s.alert("",o.getAjaxErrorText(e));if(t){t(e)}};const _=()=>BX.ajax.runAction("intranetmobile.invite.getInviteSettings");const y=e=>{const{adminConfirm:t=false,creatorEmailConfirmed:n=false,canInviteBySMS:i=false,canInviteByLink:o=false,canInviteByEmail:r=false,isBitrix24Included:a=false,isInviteWithLocalEmailAppEnabled:s=true}=e;return{adminConfirm:t,creatorEmailConfirmed:n,canInviteBySMS:i,canInviteByLink:o,canInviteByEmail:r,isBitrix24Included:a,isInviteWithLocalEmailAppEnabled:s}};const S=({parentLayout:e=null,openWidgetConfig:t={},analytics:n={},onInviteSentHandler:i=null,onInviteError:a=null,onViewHiddenWithoutInvitingHandler:s=null,canInviteBySMS:I=false,canInviteByLink:c=false,canInviteByEmail:E=false,creatorEmailConfirmed:d=false,multipleInvite:v=true,adminConfirm:u=false,isBitrix24Included:T=false,isInviteWithLocalEmailAppEnabled:m=true})=>{const f=new r({analytics:n});f.sendDrawerOpenEvent();f.setDepartmentParam(false);const g={enableNavigationBarBorder:false,titleParams:{text:l.getMessage("INTRANET_INVITE_OPENER_TITLE_MSGVER_1"),type:"dialog"},modal:true,backdrop:{showOnTop:false,onlyMediumPosition:false,mediumPositionHeight:530,bounceEnable:true,swipeAllowed:true,swipeContentAllowed:false,horizontalSwipeAllowed:false,shouldResizeContent:true,adoptHeightByKeyboard:true},...t,onReady:n=>{let r=false;let l=false;n.showComponent(new o({layout:n,parentLayout:e,openWidgetConfig:t,analytics:f,onInviteSentHandler:e=>{r=true;if(i){i(e)}},onInviteError:e=>{l=true;if(a){a(e)}},canInviteBySMS:I,canInviteByLink:c,canInviteByEmail:E,creatorEmailConfirmed:d,multipleInvite:v,adminConfirm:u,isBitrix24Included:T,isInviteWithLocalEmailAppEnabled:m}));n.on("onViewRemoved",(()=>{if(!r&&!l&&s){s()}}))}};if(e){e.openWidget("layout",g);return}PageManager.openWidget("layout",g)};n.exports={openIntranetInviteWidget:v,AnalyticsEvent:a,ErrorCode:d}}));
//# sourceMappingURL=extension.map.js