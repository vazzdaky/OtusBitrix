{"version":3,"file":"call-assessment-selector.bundle.js","sources":["../src/pull-manager.js","../src/call-assessment-selector.js"],"sourcesContent":["import { PULL } from 'pull.client';\n\nconst TAG = 'CRM_COPILOT_CALL_ASSESSMENT_SCRIPT_SELECTOR';\nconst COMMAND_UPDATE = 'update_call_assessment';\nconst COMMAND_SELECT = 'select_call_assessment';\n\ndeclare type ListenerOptions = {\n\tonUpdate: Function,\n\tonSelect: Function,\n};\n\nexport class PullManager\n{\n\t#unsubscribeUpdate: Function;\n\t#unsubscribeSelect: Function;\n\n\tconstructor(options: ListenerOptions)\n\t{\n\t\tthis.#unsubscribeUpdate = this.#subscribe(COMMAND_UPDATE, options.onUpdate);\n\t\tthis.#unsubscribeSelect = this.#subscribe(COMMAND_SELECT, options.onSelect);\n\n\t\tthis.#extendsWatch();\n\t}\n\n\t#subscribe(command: string, callback: Function): Function\n\t{\n\t\tif (!PULL)\n\t\t{\n\t\t\treturn () => {};\n\t\t}\n\n\t\treturn PULL.subscribe({\n\t\t\tmoduleId: 'crm',\n\t\t\tcommand,\n\t\t\tcallback,\n\t\t});\n\t}\n\n\t#extendsWatch(): void\n\t{\n\t\tif (PULL)\n\t\t{\n\t\t\tPULL.extendWatch(TAG);\n\t\t}\n\t}\n\n\t#clearWatch(): void\n\t{\n\t\tif (PULL)\n\t\t{\n\t\t\tPULL.clearWatch(TAG);\n\t\t}\n\t}\n\n\tunsubscribe(): void\n\t{\n\t\tthis.#unsubscribeUpdate();\n\t\tthis.#unsubscribeSelect();\n\n\t\tthis.#clearWatch();\n\t}\n}\n","import { Dom, Event, Text, Type } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport type { PopupOptions } from 'main.popup';\nimport { Dialog, DialogOptions, Item, type ItemOptions } from 'ui.entity-selector';\nimport type { DisplayStrategy } from './display-strategy';\nimport { PullManager } from './pull-manager';\n\nimport 'ui.design-tokens';\n\nconst ENTITY_ID = 'copilot_call_script'; /** @php \\Bitrix\\Crm\\Copilot\\CallAssessment\\EntitySelector\\CallScriptProvider */\n\ndeclare type CallAssessmentSelectorOptions = {\n\tid?: string,\n\tcurrentCallAssessment: CallAssessmentItemIdentifier,\n\tdisplayStrategy: DisplayStrategy,\n\tadditionalSelectorOptions ?: AdditionalSelectorOptions,\n\temptyScriptListTitle ?: string,\n\tisPullSubscribe?: boolean,\n\tevents: {\n\t\tonCallAssessmentUpdate?: Function,\n\t},\n};\n\ntype AdditionalSelectorOptions = {\n\tdialog?: DialogOptions,\n\tpopup?: PopupOptions,\n}\n\nexport type CallAssessmentItemIdentifier = {\n\tid?: number;\n\ttitle?: string;\n}\n\n// todo: maybe put it in a separate model class?\ndeclare type CallAssessmentCustomData = {\n\tid: number,\n\ttitle: string,\n\tprompt: string,\n\tgist: ?string,\n\tclientTypeIds: Array<number>,\n\tcallTypeId: ?number,\n\tautoCheckTypeId: ?number,\n\tisEnabled: boolean,\n\tisDefault: boolean,\n\tjobId: number,\n\tstatus: string,\n\tsort: number,\n};\n\nexport class CallAssessmentSelector\n{\n\t#id: string;\n\n\t#currentCallAssessmentId: ?number = null;\n\t#additionalSelectorOptions: AdditionalSelectorOptions;\n\t#displayStrategy: DisplayStrategy;\n\t#emptyScriptListTitle: ?string;\n\n\t#container: HTMLElement;\n\t#currentSelectorItem: ?Item = null;\n\t#dialog: Dialog = null;\n\t#eventEmitter: EventEmitter;\n\t#pull: PullManager;\n\n\t#isDisplayLoadingState: boolean = true;\n\t#isDisabled: boolean = false;\n\n\tisSelectsByPull: boolean = false;\n\t#changesByPullQueue: ItemOptions[] = [];\n\n\tconstructor(options: CallAssessmentSelectorOptions)\n\t{\n\t\tthis.#id = Type.isStringFilled(options.id) ? options.id : Text.getRandom(16);\n\n\t\tconst currentCallAssessment = options.currentCallAssessment;\n\t\tif (Type.isNumber(currentCallAssessment.id) && currentCallAssessment.id > 0)\n\t\t{\n\t\t\tthis.#currentCallAssessmentId = currentCallAssessment.id;\n\t\t}\n\n\t\tthis.#additionalSelectorOptions = options.additionalSelectorOptions ?? {};\n\t\tthis.#emptyScriptListTitle = options.emptyScriptListTitle ?? null;\n\n\t\tthis.#displayStrategy = options.displayStrategy;\n\t\tthis.#displayStrategy.updateTitle(currentCallAssessment.title ?? this.#emptyScriptListTitle);\n\n\t\tthis.#container = this.#displayStrategy.getTargetNode();\n\t\tEvent.bind(this.#container, 'click', this.#toggleDialog.bind(this));\n\n\t\tthis.#bindEvents(options.events);\n\t\tthis.#subscribePull();\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.#id;\n\t}\n\n\tisSelectByPull(): boolean\n\t{\n\t\treturn this.isSelectsByPull;\n\t}\n\n\tgetCurrentCallAssessmentId(): ?number\n\t{\n\t\treturn this.#currentCallAssessmentId;\n\t}\n\n\tgetCurrentCallAssessmentItem(): ?CallAssessmentCustomData\n\t{\n\t\tconst customData = this.#currentSelectorItem?.getCustomData() ?? null;\n\t\tif (customData === null)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn Object.fromEntries(customData);\n\t}\n\n\tgetCurrentSelectorItem(): ?Item\n\t{\n\t\treturn this.#currentSelectorItem;\n\t}\n\n\t#toggleDialog(): void\n\t{\n\t\tif (this.#isDisabled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst dialog = this.getDialog();\n\t\tif (dialog.isOpen())\n\t\t{\n\t\t\tdialog.hide();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdialog.show();\n\t\t}\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\treturn this.#container;\n\t}\n\n\t#loading(isLoading: boolean): void\n\t{\n\t\tif (this.#isDisplayLoadingState)\n\t\t{\n\t\t\tthis.#displayStrategy.setLoading(isLoading);\n\t\t}\n\t}\n\n\tgetDialog(): Dialog\n\t{\n\t\tif (this.#dialog === null)\n\t\t{\n\t\t\tconst parentPopupContainer = this.#container.closest('body');\n\n\t\t\tconst dialogOptions: DialogOptions = {\n\t\t\t\t...(this.#additionalSelectorOptions.dialog ?? {}),\n\t\t\t\ttargetNode: this.#container,\n\t\t\t\tmultiple: false,\n\t\t\t\tdropdownMode: true,\n\t\t\t\tenableSearch: true,\n\t\t\t\tshowAvatars: false,\n\t\t\t\tpreselectedItems: [\n\t\t\t\t\t[ENTITY_ID, this.#currentCallAssessmentId],\n\t\t\t\t],\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: ENTITY_ID,\n\t\t\t\t\t\tdynamicLoad: true,\n\t\t\t\t\t\tdynamicSearch: true,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tpopupOptions: {\n\t\t\t\t\ttargetContainer: parentPopupContainer,\n\t\t\t\t\t...(this.#additionalSelectorOptions.popup ?? {}),\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\t...(this.#additionalSelectorOptions.dialog?.events ?? {}),\n\t\t\t\t\tonLoad: this.#onLoadDialog.bind(this),\n\t\t\t\t\t'Item:onBeforeSelect': this.#onItemBeforeSelect.bind(this),\n\t\t\t\t\t'Item:onBeforeDeselect': this.#onItemBeforeDeselect.bind(this),\n\t\t\t\t\tonShow: (event: BaseEvent) => {\n\t\t\t\t\t\tEvent.bindOnce(parentPopupContainer, 'click', this.#onPopupContainerClick.bind(this));\n\t\t\t\t\t},\n\t\t\t\t\tonHide: () => {\n\t\t\t\t\t\tEvent.unbind(parentPopupContainer, this.#onPopupContainerClick);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tthis.#dialog = new Dialog(dialogOptions);\n\t\t}\n\n\t\treturn this.#dialog;\n\t}\n\n\t#onLoadDialog(event: BaseEvent): void\n\t{\n\t\tthis.#applyChangesByPull();\n\n\t\tconst item = this.#getDialogItem(this.#currentCallAssessmentId);\n\t\tif (item === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#updateCurrentSelectorItem(item);\n\t\tthis.#callAdditionalEvent(event, 'onLoad');\n\t}\n\n\t#onItemBeforeSelect(event: BaseEvent): void\n\t{\n\t\tconst targetItem: Item = event.getData().item;\n\t\tif (targetItem === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#updateCurrentSelectorItem(targetItem);\n\t\tthis.#callAdditionalEvent(event, 'Item:onBeforeSelect');\n\t}\n\n\t#onItemBeforeDeselect(event: BaseEvent): void\n\t{\n\t\tthis.#preventDeselectCurrentSelectorItem(event);\n\t\tthis.#callAdditionalEvent(event, 'Item:onBeforeDeselect');\n\t}\n\n\t#callAdditionalEvent(event: BaseEvent, eventName: string): void\n\t{\n\t\tconst eventCallback = this.#additionalSelectorOptions?.dialog?.events?.[eventName];\n\t\tif (Type.isFunction(eventCallback))\n\t\t{\n\t\t\teventCallback(event);\n\t\t}\n\t}\n\n\t#preventDeselectCurrentSelectorItem(event: BaseEvent): void\n\t{\n\t\tconst targetItem: Item = event.getData().item;\n\t\tif (targetItem === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (targetItem.id === this.#currentCallAssessmentId)\n\t\t{\n\t\t\tevent.preventDefault();\n\t\t}\n\n\t\tevent.getTarget().hide();\n\t}\n\n\t#updateCurrentSelectorItem(item: ?Item): void\n\t{\n\t\tthis.#currentSelectorItem = item ?? null;\n\t\tthis.#currentCallAssessmentId = item?.getId() ?? null;\n\n\t\tthis.#adjustTitle();\n\t}\n\n\t#adjustTitle(): void\n\t{\n\t\tconst title = this.#currentSelectorItem?.getTitle() ?? this.#emptyScriptListTitle;\n\t\tthis.#displayStrategy.updateTitle(title);\n\t}\n\n\t#onPopupContainerClick(clickEvent: BaseEvent): void\n\t{\n\t\tconst { target } = clickEvent;\n\t\tif (\n\t\t\ttarget?.closest('.call-quality__script-selector') === null\n\t\t\t&& target?.closest('.ui-selector-dialog') === null\n\t\t\t&& this.#displayStrategy.getTargetNode() !== target\n\t\t)\n\t\t{\n\t\t\tthis.close();\n\t\t}\n\t}\n\n\tdestroy(): void\n\t{\n\t\tthis.#dialog?.destroy();\n\t\tthis.#pull.unsubscribe();\n\t}\n\n\tclose(): void\n\t{\n\t\tthis.#dialog?.hide();\n\t}\n\n\tdisable(): void\n\t{\n\t\tthis.#isDisabled = true;\n\t\tconst node = this.#displayStrategy?.getTargetNode();\n\n\t\tDom.addClass(node, '--disabled');\n\t\tDom.style(node, {\n\t\t\tcursor: 'not-allowed',\n\t\t\topacity: '.6',\n\t\t});\n\t}\n\n\tenable(): void\n\t{\n\t\tthis.#isDisabled = false;\n\t\tconst node = this.#displayStrategy?.getTargetNode();\n\n\t\tDom.removeClass(node, '--disabled');\n\t\tDom.style(node, {\n\t\t\tcursor: 'inherit',\n\t\t\topacity: '1',\n\t\t});\n\t}\n\n\t#subscribePull(): void\n\t{\n\t\tthis.#pull = new PullManager({\n\t\t\tonUpdate: this.#onUpdateItemByPull.bind(this),\n\t\t\tonSelect: (eventData: Object): void => {\n\t\t\t\tthis.isSelectsByPull = true;\n\t\t\t\tthis.#onSelectItemByPull(eventData);\n\t\t\t\tthis.isSelectsByPull = false;\n\t\t\t},\n\t\t});\n\t}\n\n\t#bindEvents(events: { [eventName: string]: Function }): void\n\t{\n\t\tthis.#eventEmitter = new EventEmitter();\n\t\tthis.#eventEmitter.setEventNamespace('Crm.Copilot.CallAssessmentSelector');\n\n\t\tif (Type.isObject(events))\n\t\t{\n\t\t\tObject.entries(events).forEach(([eventName, listener]) => {\n\t\t\t\tthis.#eventEmitter.subscribe(eventName, listener);\n\t\t\t});\n\t\t}\n\t}\n\n\t#onSelectItemByPull(eventData: Object): void\n\t{\n\t\tconst { selectorId, itemOptions } = eventData;\n\t\tif (selectorId !== this.getId())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.#isDialogLoaded())\n\t\t{\n\t\t\tconst item = new Item(itemOptions);\n\t\t\tconst event = new BaseEvent({ data: { item } });\n\n\t\t\tthis.#updateCurrentSelectorItem(item);\n\t\t\tthis.#callAdditionalEvent(event, 'Item:onBeforeSelect');\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (!itemOptions.id)\n\t\t{\n\t\t\tthis.#currentCallAssessmentId = null;\n\t\t\tthis.getDialog().deselectAll();\n\t\t\tthis.#adjustTitle();\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#getDialogItem(itemOptions.id)?.select();\n\t}\n\n\t#onUpdateItemByPull(eventData: Object): void\n\t{\n\t\tconst { itemOptions } = eventData;\n\t\tif (itemOptions.id === this.#currentCallAssessmentId)\n\t\t{\n\t\t\tthis.#displayStrategy.updateTitle(itemOptions.title ?? this.#emptyScriptListTitle);\n\t\t}\n\n\t\tif (this.#isDialogLoaded())\n\t\t{\n\t\t\tthis.#updateItem(itemOptions);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#addChangeByPull(itemOptions);\n\t\tthis.#eventEmitter.emit('onCallAssessmentUpdate', { callAssessment: itemOptions?.customData });\n\t}\n\n\t#updateItem(itemOptions: ItemOptions, isEmit: boolean = true): void\n\t{\n\t\tconst item = this.#getDialogItem(String(itemOptions.id));\n\t\tif (item === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\titem.setTitle(itemOptions.title);\n\t\titem.setSupertitle(itemOptions.supertitle);\n\t\titem.setBadges(itemOptions.badgesOptions);\n\t\titem.customData = new Map(Object.entries(itemOptions.customData));\n\n\t\tif (isEmit)\n\t\t{\n\t\t\tthis.#eventEmitter.emit('onCallAssessmentUpdate', { callAssessment: itemOptions.customData });\n\t\t}\n\t}\n\n\t#addChangeByPull(callAssessment: ItemOptions): void\n\t{\n\t\tthis.#changesByPullQueue.push(callAssessment);\n\t}\n\n\t#applyChangesByPull(): void\n\t{\n\t\tthis.#changesByPullQueue.forEach((itemOptions) => this.#updateItem(itemOptions, false));\n\t\tthis.#changesByPullQueue = [];\n\t}\n\n\t#isDialogLoaded(): boolean\n\t{\n\t\treturn this.#dialog !== null && !this.getDialog().isLoading();\n\t}\n\n\t#getDialogItem(id: string | number | null): ?Item\n\t{\n\t\tif (id === null)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this.getDialog().getItem([ENTITY_ID, id]);\n\t}\n}\n"],"names":["TAG","PullManager","constructor","options","Object","value","writable","babelHelpers","this","onUpdate","onSelect","unsubscribe","command","callback","PULL","subscribe","moduleId","extendWatch","clearWatch","ENTITY_ID","dialog","getDialog","isOpen","hide","show","isLoading","setLoading","event","item","targetItem","getData","eventName","eventCallback","_babelHelpers$classPr11","_babelHelpers$classPr12","events","_babelHelpers$classPr13","Type","isFunction","id","preventDefault","getTarget","getId","title","_babelHelpers$classPr15","getTitle","updateTitle","clickEvent","target","closest","getTargetNode","close","bind","eventData","isSelectsByPull","EventEmitter","setEventNamespace","isObject","entries","forEach","listener","selectorId","itemOptions","Item","BaseEvent","data","deselectAll","_babelHelpers$classPr16","select","emit","callAssessment","customData","isEmit","String","setTitle","setSupertitle","supertitle","setBadges","badgesOptions","Map","push","getItem","isStringFilled","Text","getRandom","currentCallAssessment","isNumber","additionalSelectorOptions","emptyScriptListTitle","displayStrategy","Event","isSelectByPull","getCurrentCallAssessmentId","getCurrentCallAssessmentItem","_babelHelpers$classPr2","getCustomData","fromEntries","getCurrentSelectorItem","getContainer","parentPopupContainer","dialogOptions","targetNode","multiple","dropdownMode","enableSearch","showAvatars","preselectedItems","entities","dynamicLoad","dynamicSearch","popupOptions","targetContainer","popup","_babelHelpers$classPr6","onLoad","Item:onBeforeSelect","Item:onBeforeDeselect","onShow","bindOnce","onHide","unbind","Dialog","destroy","_babelHelpers$classPr7","_babelHelpers$classPr8","disable","node","_babelHelpers$classPr9","Dom","addClass","style","cursor","opacity","enable","_babelHelpers$classPr10","removeClass"],"mappings":"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"}