this.BX=this.BX||{},this.BX.Crm=this.BX.Crm||{},function(e,s,l,a,t){"use strict";const i="CRM_COPILOT_CALL_ASSESSMENT_SCRIPT_SELECTOR";var o=babelHelpers.classPrivateFieldLooseKey("unsubscribeUpdate"),r=babelHelpers.classPrivateFieldLooseKey("unsubscribeSelect"),b=babelHelpers.classPrivateFieldLooseKey("subscribe"),c=babelHelpers.classPrivateFieldLooseKey("extendsWatch"),d=babelHelpers.classPrivateFieldLooseKey("clearWatch");class n{constructor(e){Object.defineProperty(this,d,{value:P}),Object.defineProperty(this,c,{value:v}),Object.defineProperty(this,b,{value:p}),Object.defineProperty(this,o,{writable:!0,value:void 0}),Object.defineProperty(this,r,{writable:!0,value:void 0}),babelHelpers.classPrivateFieldLooseBase(this,o)[o]=babelHelpers.classPrivateFieldLooseBase(this,b)[b]("update_call_assessment",e.onUpdate),babelHelpers.classPrivateFieldLooseBase(this,r)[r]=babelHelpers.classPrivateFieldLooseBase(this,b)[b]("select_call_assessment",e.onSelect),babelHelpers.classPrivateFieldLooseBase(this,c)[c]()}unsubscribe(){babelHelpers.classPrivateFieldLooseBase(this,o)[o](),babelHelpers.classPrivateFieldLooseBase(this,r)[r](),babelHelpers.classPrivateFieldLooseBase(this,d)[d]()}}function p(e,s){return t.PULL?t.PULL.subscribe({moduleId:"crm",command:e,callback:s}):()=>{}}function v(){t.PULL&&t.PULL.extendWatch(i)}function P(){t.PULL&&t.PULL.clearWatch(i)}const u="copilot_call_script";var h=babelHelpers.classPrivateFieldLooseKey("id"),L=babelHelpers.classPrivateFieldLooseKey("currentCallAssessmentId"),F=babelHelpers.classPrivateFieldLooseKey("additionalSelectorOptions"),H=babelHelpers.classPrivateFieldLooseKey("displayStrategy"),B=babelHelpers.classPrivateFieldLooseKey("emptyScriptListTitle"),y=babelHelpers.classPrivateFieldLooseKey("container"),f=babelHelpers.classPrivateFieldLooseKey("currentSelectorItem"),m=babelHelpers.classPrivateFieldLooseKey("dialog"),g=babelHelpers.classPrivateFieldLooseKey("eventEmitter"),O=babelHelpers.classPrivateFieldLooseKey("pull"),j=babelHelpers.classPrivateFieldLooseKey("isDisplayLoadingState"),S=babelHelpers.classPrivateFieldLooseKey("isDisabled"),K=babelHelpers.classPrivateFieldLooseKey("changesByPullQueue"),C=babelHelpers.classPrivateFieldLooseKey("toggleDialog"),I=babelHelpers.classPrivateFieldLooseKey("loading"),D=babelHelpers.classPrivateFieldLooseKey("onLoadDialog"),w=babelHelpers.classPrivateFieldLooseKey("onItemBeforeSelect"),T=babelHelpers.classPrivateFieldLooseKey("onItemBeforeDeselect"),E=babelHelpers.classPrivateFieldLooseKey("callAdditionalEvent"),A=babelHelpers.classPrivateFieldLooseKey("preventDeselectCurrentSelectorItem"),U=babelHelpers.classPrivateFieldLooseKey("updateCurrentSelectorItem"),_=babelHelpers.classPrivateFieldLooseKey("adjustTitle"),X=babelHelpers.classPrivateFieldLooseKey("onPopupContainerClick"),N=babelHelpers.classPrivateFieldLooseKey("subscribePull"),k=babelHelpers.classPrivateFieldLooseKey("bindEvents"),M=babelHelpers.classPrivateFieldLooseKey("onSelectItemByPull"),R=babelHelpers.classPrivateFieldLooseKey("onUpdateItemByPull"),W=babelHelpers.classPrivateFieldLooseKey("updateItem"),x=babelHelpers.classPrivateFieldLooseKey("addChangeByPull"),q=babelHelpers.classPrivateFieldLooseKey("applyChangesByPull"),Q=babelHelpers.classPrivateFieldLooseKey("isDialogLoaded"),z=babelHelpers.classPrivateFieldLooseKey("getDialogItem");function G(){if(babelHelpers.classPrivateFieldLooseBase(this,S)[S])return;const e=this.getDialog();e.isOpen()?e.hide():e.show()}function J(e){babelHelpers.classPrivateFieldLooseBase(this,j)[j]&&babelHelpers.classPrivateFieldLooseBase(this,H)[H].setLoading(e)}function V(e){babelHelpers.classPrivateFieldLooseBase(this,q)[q]();const s=babelHelpers.classPrivateFieldLooseBase(this,z)[z](babelHelpers.classPrivateFieldLooseBase(this,L)[L]);null!==s&&(babelHelpers.classPrivateFieldLooseBase(this,U)[U](s),babelHelpers.classPrivateFieldLooseBase(this,E)[E](e,"onLoad"))}function Y(e){const s=e.getData().item;null!==s&&(babelHelpers.classPrivateFieldLooseBase(this,U)[U](s),babelHelpers.classPrivateFieldLooseBase(this,E)[E](e,"Item:onBeforeSelect"))}function Z(e){babelHelpers.classPrivateFieldLooseBase(this,A)[A](e),babelHelpers.classPrivateFieldLooseBase(this,E)[E](e,"Item:onBeforeDeselect")}function $(e,l){var a,t,i;const o=null==(a=babelHelpers.classPrivateFieldLooseBase(this,F)[F])||null==(t=a.dialog)||null==(i=t.events)?void 0:i[l];s.Type.isFunction(o)&&o(e)}function ee(e){const s=e.getData().item;null!==s&&(s.id===babelHelpers.classPrivateFieldLooseBase(this,L)[L]&&e.preventDefault(),e.getTarget().hide())}function se(e){var s;babelHelpers.classPrivateFieldLooseBase(this,f)[f]=null!=e?e:null,babelHelpers.classPrivateFieldLooseBase(this,L)[L]=null!=(s=null==e?void 0:e.getId())?s:null,babelHelpers.classPrivateFieldLooseBase(this,_)[_]()}function le(){var e,s;const l=null!=(e=null==(s=babelHelpers.classPrivateFieldLooseBase(this,f)[f])?void 0:s.getTitle())?e:babelHelpers.classPrivateFieldLooseBase(this,B)[B];babelHelpers.classPrivateFieldLooseBase(this,H)[H].updateTitle(l)}function ae(e){const{target:s}=e;null===(null==s?void 0:s.closest(".call-quality__script-selector"))&&null===(null==s?void 0:s.closest(".ui-selector-dialog"))&&babelHelpers.classPrivateFieldLooseBase(this,H)[H].getTargetNode()!==s&&this.close()}function te(){babelHelpers.classPrivateFieldLooseBase(this,O)[O]=new n({onUpdate:babelHelpers.classPrivateFieldLooseBase(this,R)[R].bind(this),onSelect:e=>{this.isSelectsByPull=!0,babelHelpers.classPrivateFieldLooseBase(this,M)[M](e),this.isSelectsByPull=!1}})}function ie(e){babelHelpers.classPrivateFieldLooseBase(this,g)[g]=new l.EventEmitter,babelHelpers.classPrivateFieldLooseBase(this,g)[g].setEventNamespace("Crm.Copilot.CallAssessmentSelector"),s.Type.isObject(e)&&Object.entries(e).forEach((([e,s])=>{babelHelpers.classPrivateFieldLooseBase(this,g)[g].subscribe(e,s)}))}function oe(e){var s;const{selectorId:t,itemOptions:i}=e;if(t===this.getId()){if(!babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]()){const e=new a.Item(i),s=new l.BaseEvent({data:{item:e}});return babelHelpers.classPrivateFieldLooseBase(this,U)[U](e),void babelHelpers.classPrivateFieldLooseBase(this,E)[E](s,"Item:onBeforeSelect")}if(!i.id)return babelHelpers.classPrivateFieldLooseBase(this,L)[L]=null,this.getDialog().deselectAll(),void babelHelpers.classPrivateFieldLooseBase(this,_)[_]();null==(s=babelHelpers.classPrivateFieldLooseBase(this,z)[z](i.id))||s.select()}}function re(e){const{itemOptions:s}=e;var l;s.id===babelHelpers.classPrivateFieldLooseBase(this,L)[L]&&babelHelpers.classPrivateFieldLooseBase(this,H)[H].updateTitle(null!=(l=s.title)?l:babelHelpers.classPrivateFieldLooseBase(this,B)[B]);babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]()?babelHelpers.classPrivateFieldLooseBase(this,W)[W](s):(babelHelpers.classPrivateFieldLooseBase(this,x)[x](s),babelHelpers.classPrivateFieldLooseBase(this,g)[g].emit("onCallAssessmentUpdate",{callAssessment:null==s?void 0:s.customData}))}function be(e,s=!0){const l=babelHelpers.classPrivateFieldLooseBase(this,z)[z](String(e.id));null!==l&&(l.setTitle(e.title),l.setSupertitle(e.supertitle),l.setBadges(e.badgesOptions),l.customData=new Map(Object.entries(e.customData)),s&&babelHelpers.classPrivateFieldLooseBase(this,g)[g].emit("onCallAssessmentUpdate",{callAssessment:e.customData}))}function ce(e){babelHelpers.classPrivateFieldLooseBase(this,K)[K].push(e)}function de(){babelHelpers.classPrivateFieldLooseBase(this,K)[K].forEach((e=>babelHelpers.classPrivateFieldLooseBase(this,W)[W](e,!1))),babelHelpers.classPrivateFieldLooseBase(this,K)[K]=[]}function ne(){return null!==babelHelpers.classPrivateFieldLooseBase(this,m)[m]&&!this.getDialog().isLoading()}function pe(e){return null===e?null:this.getDialog().getItem([u,e])}e.CallAssessmentSelector=class{constructor(e){var l,a,t;Object.defineProperty(this,z,{value:pe}),Object.defineProperty(this,Q,{value:ne}),Object.defineProperty(this,q,{value:de}),Object.defineProperty(this,x,{value:ce}),Object.defineProperty(this,W,{value:be}),Object.defineProperty(this,R,{value:re}),Object.defineProperty(this,M,{value:oe}),Object.defineProperty(this,k,{value:ie}),Object.defineProperty(this,N,{value:te}),Object.defineProperty(this,X,{value:ae}),Object.defineProperty(this,_,{value:le}),Object.defineProperty(this,U,{value:se}),Object.defineProperty(this,A,{value:ee}),Object.defineProperty(this,E,{value:$}),Object.defineProperty(this,T,{value:Z}),Object.defineProperty(this,w,{value:Y}),Object.defineProperty(this,D,{value:V}),Object.defineProperty(this,I,{value:J}),Object.defineProperty(this,C,{value:G}),Object.defineProperty(this,h,{writable:!0,value:void 0}),Object.defineProperty(this,L,{writable:!0,value:null}),Object.defineProperty(this,F,{writable:!0,value:void 0}),Object.defineProperty(this,H,{writable:!0,value:void 0}),Object.defineProperty(this,B,{writable:!0,value:void 0}),Object.defineProperty(this,y,{writable:!0,value:void 0}),Object.defineProperty(this,f,{writable:!0,value:null}),Object.defineProperty(this,m,{writable:!0,value:null}),Object.defineProperty(this,g,{writable:!0,value:void 0}),Object.defineProperty(this,O,{writable:!0,value:void 0}),Object.defineProperty(this,j,{writable:!0,value:!0}),Object.defineProperty(this,S,{writable:!0,value:!1}),this.isSelectsByPull=!1,Object.defineProperty(this,K,{writable:!0,value:[]}),babelHelpers.classPrivateFieldLooseBase(this,h)[h]=s.Type.isStringFilled(e.id)?e.id:s.Text.getRandom(16);const i=e.currentCallAssessment;s.Type.isNumber(i.id)&&i.id>0&&(babelHelpers.classPrivateFieldLooseBase(this,L)[L]=i.id),babelHelpers.classPrivateFieldLooseBase(this,F)[F]=null!=(l=e.additionalSelectorOptions)?l:{},babelHelpers.classPrivateFieldLooseBase(this,B)[B]=null!=(a=e.emptyScriptListTitle)?a:null,babelHelpers.classPrivateFieldLooseBase(this,H)[H]=e.displayStrategy,babelHelpers.classPrivateFieldLooseBase(this,H)[H].updateTitle(null!=(t=i.title)?t:babelHelpers.classPrivateFieldLooseBase(this,B)[B]),babelHelpers.classPrivateFieldLooseBase(this,y)[y]=babelHelpers.classPrivateFieldLooseBase(this,H)[H].getTargetNode(),s.Event.bind(babelHelpers.classPrivateFieldLooseBase(this,y)[y],"click",babelHelpers.classPrivateFieldLooseBase(this,C)[C].bind(this)),babelHelpers.classPrivateFieldLooseBase(this,k)[k](e.events),babelHelpers.classPrivateFieldLooseBase(this,N)[N]()}getId(){return babelHelpers.classPrivateFieldLooseBase(this,h)[h]}isSelectByPull(){return this.isSelectsByPull}getCurrentCallAssessmentId(){return babelHelpers.classPrivateFieldLooseBase(this,L)[L]}getCurrentCallAssessmentItem(){var e,s;const l=null!=(e=null==(s=babelHelpers.classPrivateFieldLooseBase(this,f)[f])?void 0:s.getCustomData())?e:null;return null===l?null:Object.fromEntries(l)}getCurrentSelectorItem(){return babelHelpers.classPrivateFieldLooseBase(this,f)[f]}getContainer(){return babelHelpers.classPrivateFieldLooseBase(this,y)[y]}getDialog(){if(null===babelHelpers.classPrivateFieldLooseBase(this,m)[m]){var e,l,t,i;const o=babelHelpers.classPrivateFieldLooseBase(this,y)[y].closest("body"),r={...null!=(e=babelHelpers.classPrivateFieldLooseBase(this,F)[F].dialog)?e:{},targetNode:babelHelpers.classPrivateFieldLooseBase(this,y)[y],multiple:!1,dropdownMode:!0,enableSearch:!0,showAvatars:!1,preselectedItems:[[u,babelHelpers.classPrivateFieldLooseBase(this,L)[L]]],entities:[{id:u,dynamicLoad:!0,dynamicSearch:!0}],popupOptions:{targetContainer:o,...null!=(l=babelHelpers.classPrivateFieldLooseBase(this,F)[F].popup)?l:{}},events:{...null!=(t=null==(i=babelHelpers.classPrivateFieldLooseBase(this,F)[F].dialog)?void 0:i.events)?t:{},onLoad:babelHelpers.classPrivateFieldLooseBase(this,D)[D].bind(this),"Item:onBeforeSelect":babelHelpers.classPrivateFieldLooseBase(this,w)[w].bind(this),"Item:onBeforeDeselect":babelHelpers.classPrivateFieldLooseBase(this,T)[T].bind(this),onShow:e=>{s.Event.bindOnce(o,"click",babelHelpers.classPrivateFieldLooseBase(this,X)[X].bind(this))},onHide:()=>{s.Event.unbind(o,babelHelpers.classPrivateFieldLooseBase(this,X)[X])}}};babelHelpers.classPrivateFieldLooseBase(this,m)[m]=new a.Dialog(r)}return babelHelpers.classPrivateFieldLooseBase(this,m)[m]}destroy(){var e;null==(e=babelHelpers.classPrivateFieldLooseBase(this,m)[m])||e.destroy(),babelHelpers.classPrivateFieldLooseBase(this,O)[O].unsubscribe()}close(){var e;null==(e=babelHelpers.classPrivateFieldLooseBase(this,m)[m])||e.hide()}disable(){var e;babelHelpers.classPrivateFieldLooseBase(this,S)[S]=!0;const l=null==(e=babelHelpers.classPrivateFieldLooseBase(this,H)[H])?void 0:e.getTargetNode();s.Dom.addClass(l,"--disabled"),s.Dom.style(l,{cursor:"not-allowed",opacity:".6"})}enable(){var e;babelHelpers.classPrivateFieldLooseBase(this,S)[S]=!1;const l=null==(e=babelHelpers.classPrivateFieldLooseBase(this,H)[H])?void 0:e.getTargetNode();s.Dom.removeClass(l,"--disabled"),s.Dom.style(l,{cursor:"inherit",opacity:"1"})}}}(this.BX.Crm.Copilot=this.BX.Crm.Copilot||{},BX,BX.Event,BX.UI.EntitySelector,BX);
//# sourceMappingURL=call-assessment-selector.bundle.map.js