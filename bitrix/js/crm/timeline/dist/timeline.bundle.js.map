{"version":3,"file":"timeline.bundle.js","sources":["../src/animations/expand.js","../src/types.js","../src/items/compatible-item.js","../src/animations/fasten.js","../src/items/history.js","../src/items/scheduled.js","../src/animations/item.js","../src/animations/shift.js","../item/src/stream-type.js","../item/src/components/layout/menu.js","../item/src/action.js","../item/src/components/layout/body/logo.js","../item/src/components/layout/body/calendar-icon.js","../item/src/components/layout/body/logo-calendar.js","../item/src/components/layout/body.js","../item/src/components/enums/button-scope.js","../item/src/components/enums/button-state.js","../item/src/components/enums/button-type.js","../item/src/components/layout/baseButton.js","../item/src/components/layout/button-menu.js","../item/src/components/layout/button.js","../item/src/components/layout/footer/add-button.js","../item/src/components/layout/footer/buttons.js","../item/src/components/layout/footer/menu.js","../item/src/components/layout/footer.js","../item/src/components/layout/header/change-stream-button.js","../item/src/components/layout/header/color-selector.js","../item/src/components/layout/header/format-date.js","../item/src/components/layout/header/hint.js","../item/src/components/enums/tag-type.js","../item/src/components/layout/header/tag.js","../item/src/components/layout/header/title.js","../item/src/components/layout/header/user.js","../item/src/components/layout/header.js","../item/src/components/enums/icon-background-color.js","../item/src/components/layout/icon.js","../item/src/components/layout/marketPanel.js","../item/src/components/layout/userPick.js","../item/src/components/item.js","../item/src/controller-manager.js","../item/src/controllers/base.js","../item/src/item.js","../item/src/layout.js","../item/src/configurable-item.js","../src/animations/item-new.js","../src/stream.js","../src/pull-action-processor.js","../src/streams/entitychat.js","../src/items/modification.js","../src/items/conversion.js","../src/action.js","../src/actions/activity.js","../src/actions/email.js","../src/items/history-activity.js","../src/items/email.js","../src/actions/call.js","../src/items/call.js","../src/items/meeting.js","../src/items/task.js","../src/items/webform.js","../src/items/request.js","../src/actions/openline.js","../src/items/openline.js","../src/items/rest.js","../src/items/visit.js","../src/items/zoom.js","../src/items/order-modification.js","../src/items/external-notice-modification.js","../src/items/external-notice-status-modification.js","../src/items/creation.js","../src/items/restoration.js","../src/items/relation.js","../src/items/link.js","../src/items/unlink.js","../src/items/mark.js","../src/items/comment.js","../src/items/wait.js","../src/items/document.js","../src/items/sender.js","../src/items/bizproc.js","../src/items/scoring.js","../src/streams/history.js","../src/streams/fixedhistory.js","../src/tools/schedule-postpone-controller.js","../src/items/scheduled/activity.js","../src/items/scheduled/call.js","../src/items/scheduled/call-tracker.js","../src/items/scheduled/email.js","../src/items/scheduled/meeting.js","../src/items/scheduled/openline.js","../src/items/scheduled/request.js","../src/items/scheduled/rest.js","../src/items/scheduled/task.js","../src/items/scheduled/wait.js","../src/items/scheduled/webform.js","../src/items/scheduled/zoom.js","../src/streams/schedule.js","../src/tools/audio-playback-rate-selector.js","../src/manager.js","../src/tools/workflow-event-manager.js","../src/actions/schedule-postpone.js","../src/animations/comment.js","../src/index.js"],"sourcesContent":["import { bindOnce, Dom, Tag, Type } from 'main.core';\n\ntype ExpandOptions = {\n\tstartHeight: number;\n}\n\n/** @memberof BX.Crm.Timeline.Animation */\nexport default class Expand\n{\n\t#overlay: HTMLElement | null;\n\t#startHeight: number;\n\t#node: HTMLElement | null;\n\t#callback: Function | null;\n\n\tconstructor()\n\t{\n\t\tthis.#node = null;\n\t\tthis.#callback = null;\n\t\tthis.#overlay = null;\n\t\tthis.#startHeight = 0;\n\t}\n\n\tinitialize(node, callback, options: ExpandOptions)\n\t{\n\t\tthis.#node = node;\n\t\tthis.#callback = BX.type.isFunction(callback) ? callback : null;\n\t\tthis.#startHeight = options?.startHeight || 0;\n\t}\n\n\trun()\n\t{\n\t\tif (this.#isNodeVisible(this.#node) === false)\n\t\t{\n\t\t\tif (this.#callback)\n\t\t\t{\n\t\t\t\tthis.#callback();\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\trequestAnimationFrame(() => {\n\t\t\tconst position = Dom.getPosition(this.#node);\n\n\t\t\tconst elemStyle = getComputedStyle(this.#node);\n\t\t\tconst paddingTop = parseInt(elemStyle.getPropertyValue('padding-top'), 10);\n\t\t\tconst paddingBottom = parseInt(elemStyle.getPropertyValue('padding-bottom'), 10);\n\t\t\tconst marginBottom = parseInt(elemStyle.getPropertyValue('margin-bottom'), 10);\n\n\t\t\tconst startHeight = this.#startHeight;\n\t\t\tDom.style(this.#node, {\n\t\t\t\theight: `${startHeight}px`,\n\t\t\t\toverflowY: 'clip',\n\t\t\t\tposition: 'relative',\n\t\t\t\tpadding: 0,\n\t\t\t\tmarginBottom: 0,\n\t\t\t});\n\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tDom.style(this.#node, 'transition', 'transition: height 220ms ease, opacity 220ms ease, background-color 220ms ease');\n\n\t\t\t\tthis.#overlay = Tag.render`<div class=\"crm-timeline__card_overlay crm-timeline__card-scope\"></div>`;\n\n\t\t\t\tDom.append(this.#overlay, this.#node);\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t// eslint-disable-next-line new-cap\n\t\t\t\t\t(new BX.easing(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tduration: 400,\n\t\t\t\t\t\t\tstart: {\n\t\t\t\t\t\t\t\theight: startHeight,\n\t\t\t\t\t\t\t\toverlayOpacity: 0,\n\t\t\t\t\t\t\t\tpaddingTop: 0,\n\t\t\t\t\t\t\t\tpaddingBottom: 0,\n\t\t\t\t\t\t\t\tmarginBottom: 0,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tfinish: {\n\t\t\t\t\t\t\t\theight: position.height,\n\t\t\t\t\t\t\t\toverlayOpacity: 50,\n\t\t\t\t\t\t\t\tpaddingTop,\n\t\t\t\t\t\t\t\tpaddingBottom,\n\t\t\t\t\t\t\t\tmarginBottom,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\t\t\t\tstep: this.onNodeHeightStep.bind(this),\n\t\t\t\t\t\t\tcomplete: this.onNodeHeightComplete.bind(this),\n\t\t\t\t\t\t},\n\t\t\t\t\t)\n\t\t\t\t\t).animate();\n\t\t\t\t}, 200);\n\t\t\t});\n\t\t});\n\t}\n\n\tonNodeHeightStep(state)\n\t{\n\t\tDom.style(this.#overlay, 'opacity', 1 - (state.overlayOpacity / 100));\n\t\tDom.style(this.#node, {\n\t\t\theight: `${state.height}px`,\n\t\t\tpaddingTop: `${state.paddingTop}px`,\n\t\t\tpaddingBottom: `${state.paddingBottom}px`,\n\t\t\tmarginBottom: `${state.marginBottom}px`,\n\t\t});\n\t}\n\n\tonNodeHeightComplete()\n\t{\n\t\tsetTimeout(() => {\n\t\t\tbindOnce(this.#overlay, 'transitionend', () => {\n\t\t\t\tDom.remove(this.#overlay);\n\t\t\t\tthis.#overlay = null;\n\n\t\t\t\tconst color = Dom.style(this.#node, '--crm-timeline__card-color-background');\n\t\t\t\tDom.style(this.#node, null);\n\t\t\t\tif (Type.isStringFilled(color))\n\t\t\t\t{\n\t\t\t\t\tDom.style(this.#node, '--crm-timeline__card-color-background', color);\n\t\t\t\t}\n\t\t\t});\n\t\t\tDom.style(this.#overlay, 'opacity', 0);\n\t\t\tif (this.#callback)\n\t\t\t{\n\t\t\t\tthis.#callback();\n\t\t\t}\n\t\t}, 400);\n\t}\n\n\t#isNodeVisible(node: HTMLElement): boolean\n\t{\n\t\tconst position = Dom.getPosition(this.#node);\n\n\t\treturn position.width !== 0 && position.height !== 0;\n\t}\n\n\tstatic create(node, callback, options: ExpandOptions): Expand\n\t{\n\t\tconst self = new Expand();\n\t\tself.initialize(node, callback, options);\n\n\t\treturn self;\n\t}\n}\n","/** @memberof BX.Crm.Timeline.Types */\nexport const Item = {\n\tundefined: 0,\n\tactivity: 1,\n\tcreation: 2,\n\tmodification: 3,\n\tlink: 4,\n\tunlink: 5,\n\tmark: 6,\n\tcomment: 7,\n\twait: 8,\n\tbizproc: 9,\n\tconversion: 10,\n\tsender: 11,\n\tdocument: 12,\n\trestoration: 13,\n\torder: 14,\n\torderCheck: 15,\n\tscoring: 16,\n\texternalNotification: 17,\n\tfinalSummary: 18,\n\tdelivery: 19,\n\tfinalSummaryDocuments: 20,\n\tstoreDocument: 21,\n\tproductCompilation: 22,\n\tsignDocument: 23,\n};\n\n/** @memberof BX.Crm.Timeline.Types */\nexport const Mark = {\n\tundefined: 0,\n\twaiting: 1,\n\tsuccess: 2,\n\trenew: 3,\n\tignored: 4,\n\tfailed: 5\n};\n\n/** @memberof BX.Crm.Timeline.Types */\n\n/** @memberof BX.Crm.Timeline.Types */\nexport const Order = {\n\tencourageBuyProducts: 100,\n};\n\n/** @memberof BX.Crm.Timeline.Types */\nexport const EditorMode = {\n\tview: 1,\n\tedit: 2\n};\n","import { Item } from 'crm.timeline.item';\nimport { Type } from 'main.core';\nimport { Timezone } from 'main.date';\nimport { Item as ItemType } from '../types';\n\n/** @memberof BX.Crm.Timeline */\nexport default class CompatibleItem extends Item\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._data = {};\n\t\tthis._container = null;\n\n\t\tthis._typeCategoryId = null;\n\t\tthis._associatedEntityData = null;\n\t\tthis._associatedEntityTypeId = null;\n\t\tthis._associatedEntityId = null;\n\t\tthis._isContextMenuShown = false;\n\t\tthis._contextMenuButton = null;\n\n\t\tthis._activityEditor = null;\n\t\tthis._actions = [];\n\t\tthis._actionContainer = null;\n\n\t\tthis._existedStreamItemDeadLine = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._setId(id);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._container = this.getSetting(\"container\");\n\n\t\tif(!BX.type.isPlainObject(settings['data']))\n\t\t{\n\t\t\tthrow \"Item. A required parameter 'data' is missing.\";\n\t\t}\n\t\tthis._data = settings['data'];\n\n\t\tthis._activityEditor = this.getSetting(\"activityEditor\");\n\n\t\tthis.doInitialize();\n\t}\n\n\tdoInitialize()\n\t{\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\tgetData()\n\t{\n\t\treturn this._data;\n\t}\n\n\tsetData(data)\n\t{\n\t\tif(BX.type.isPlainObject(data))\n\t\t{\n\t\t\tthis._data = data;\n\t\t\tthis.clearCachedData();\n\t\t}\n\t}\n\n\tgetSort(): Array\n\t{\n\t\treturn this._data['sort'] ?? [];\n\t}\n\n\tgetAssociatedEntityData()\n\t{\n\t\tif(this._associatedEntityData === null)\n\t\t{\n\t\t\tthis._associatedEntityData = BX.type.isPlainObject(this._data[\"ASSOCIATED_ENTITY\"])\n\t\t\t\t? this._data[\"ASSOCIATED_ENTITY\"] : {};\n\t\t}\n\n\t\treturn this._associatedEntityData;\n\t}\n\n\tgetAssociatedEntityTypeId()\n\t{\n\t\tif(this._associatedEntityTypeId === null)\n\t\t{\n\t\t\tthis._associatedEntityTypeId = BX.prop.getInteger(this._data, \"ASSOCIATED_ENTITY_TYPE_ID\", 0)\n\t\t}\n\t\treturn this._associatedEntityTypeId;\n\t}\n\n\tgetAssociatedEntityId()\n\t{\n\t\tif(this._associatedEntityId === null)\n\t\t{\n\t\t\tthis._associatedEntityId = BX.prop.getInteger(this._data, \"ASSOCIATED_ENTITY_ID\", 0)\n\t\t}\n\t\treturn this._associatedEntityId;\n\t}\n\n\tsetAssociatedEntityData(associatedEntityData)\n\t{\n\t\tif(!BX.type.isPlainObject(associatedEntityData))\n\t\t{\n\t\t\tassociatedEntityData = {};\n\t\t}\n\n\t\tconst data = this._data;\n\t\tdata.ASSOCIATED_ENTITY = associatedEntityData;\n\n\t\tthis.setData(data);\n\t}\n\n\thasPermissions()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\treturn BX.type.isPlainObject(entityData[\"PERMISSIONS\"]);\n\t}\n\n\tgetPermissions()\n\t{\n\t\treturn BX.prop.getObject(this.getAssociatedEntityData(), \"PERMISSIONS\", {});\n\t}\n\n\tsetPermissions(permissions)\n\t{\n\t\tconst data = this._data;\n\n\t\tif(!Type.isPlainObject(data.ASSOCIATED_ENTITY))\n\t\t{\n\t\t\tdata.ASSOCIATED_ENTITY = {};\n\t\t}\n\n\t\tdata.ASSOCIATED_ENTITY.PERMISSIONS = permissions;\n\n\t\tthis.setData(data);\n\t}\n\n\tgetTextDataParam(name)\n\t{\n\t\treturn BX.prop.getString(this._data, name, \"\");\n\t}\n\n\tgetObjectDataParam(name)\n\t{\n\t\treturn BX.prop.getObject(this._data, name, {});\n\t}\n\n\tgetArrayDataParam(name)\n\t{\n\t\treturn BX.prop.getArray(this._data, name, []);\n\t}\n\n\tgetTypeId()\n\t{\n\t\treturn ItemType.undefined;\n\t}\n\n\tgetTypeCategoryId()\n\t{\n\t\tif(this._typeCategoryId === null)\n\t\t{\n\t\t\tthis._typeCategoryId = BX.prop.getInteger(this._data, \"TYPE_CATEGORY_ID\", 0);\n\t\t}\n\t\treturn this._typeCategoryId;\n\t}\n\n\tgetContainer()\n\t{\n\t\treturn this._container;\n\t}\n\n\tsetContainer(container)\n\t{\n\t\tthis._container = BX.type.isElementNode(container) ? container : null;\n\t}\n\n\tlayout(options)\n\t{\n\t\tif(!BX.type.isElementNode(this._container))\n\t\t{\n\t\t\tthrow \"Item. Container is not assigned.\";\n\t\t}\n\n\t\tthis.prepareLayout(options);\n\t\t//region Actions\n\t\t/**/\n\t\tthis.prepareActions();\n\t\tconst actionQty = this._actions.length;\n\t\tfor(let i = 0; i < actionQty; i++)\n\t\t{\n\t\t\tthis._actions[i].layout();\n\t\t}\n\t\tthis.showActions(actionQty > 0);\n\t\t/**/\n\t\t//endregion\n\t}\n\n\tprepareLayout(options)\n\t{\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t}\n\n\tclearCachedData()\n\t{\n\t\tthis._typeCategoryId = null;\n\t\tthis._associatedEntityData = null;\n\t\tthis._associatedEntityTypeId = null;\n\t\tthis._associatedEntityId = null;\n\t}\n\n\tisDone()\n\t{\n\t\treturn false;\n\t}\n\n\tmarkAsDone(isDone)\n\t{\n\t}\n\n\tview()\n\t{\n\t}\n\n\tedit()\n\t{\n\t}\n\n\tfasten()\n\t{\n\t}\n\n\tunfasten()\n\t{\n\t}\n\n\tremove()\n\t{\n\t}\n\n\tcutOffText(text, length)\n\t{\n\t\tif(!BX.type.isNumber(length))\n\t\t{\n\t\t\tlength = 0;\n\t\t}\n\n\t\tif(length <= 0 || text.length <= length)\n\t\t{\n\t\t\treturn text;\n\t\t}\n\n\t\tlet offset = length - 1;\n\t\tconst whilespaceOffset = text.substring(offset).search(/\\s/i);\n\t\tif(whilespaceOffset > 0)\n\t\t{\n\t\t\toffset += whilespaceOffset;\n\t\t}\n\t\treturn text.substring(0, offset);\n\t}\n\n\tprepareMultilineCutOffElements(text, length, clickHandler)\n\t{\n\t\tif(!BX.type.isNumber(length))\n\t\t{\n\t\t\tlength = 0;\n\t\t}\n\n\t\tif(length <= 0 || text.length <= length)\n\t\t{\n\t\t\treturn [BX.util.htmlspecialchars(text).replace(/(?:\\r\\n|\\r|\\n)/g, '<br>')];\n\t\t}\n\n\t\tlet offset = length - 1;\n\t\tconst whilespaceOffset = text.substring(offset).search(/\\s/i);\n\t\tif(whilespaceOffset > 0)\n\t\t{\n\t\t\toffset += whilespaceOffset;\n\t\t}\n\t\treturn(\n\t\t\t[\n\t\t\t\tBX.util.htmlspecialchars(text.substring(0, offset)).replace(/(?:\\r\\n|\\r|\\n)/g, '<br>') + \"&hellip;&nbsp;\" ,\n\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-letter-more\", href: \"#\" },\n\t\t\t\t\t\tevents: { click: clickHandler },\n\t\t\t\t\t\ttext: this.getMessage(\"details\")\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t]\n\t\t);\n\t}\n\n\tprepareCutOffElements(text, length, clickHandler)\n\t{\n\t\tif(!BX.type.isNumber(length))\n\t\t{\n\t\t\tlength = 0;\n\t\t}\n\n\t\tif(length <= 0 || text.length <= length)\n\t\t{\n\t\t\treturn [BX.util.htmlspecialchars(text)];\n\t\t}\n\n\t\tlet offset = length - 1;\n\t\tconst whilespaceOffset = text.substring(offset).search(/\\s/i);\n\t\tif(whilespaceOffset > 0)\n\t\t{\n\t\t\toffset += whilespaceOffset;\n\t\t}\n\t\treturn(\n\t\t\t[\n\t\t\t\tBX.util.htmlspecialchars(text.substring(0, offset)) + \"&hellip;&nbsp;\" ,\n\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-letter-more\", href: \"#\" },\n\t\t\t\t\t\tevents: { click: clickHandler },\n\t\t\t\t\t\ttext: this.getMessage(\"details\")\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t]\n\t\t);\n\t}\n\n\tprepareAuthorLayout()\n\t{\n\t\tconst authorInfo = this.getObjectDataParam(\"AUTHOR\", null);\n\t\tif(!authorInfo)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst showUrl = BX.prop.getString(authorInfo, \"SHOW_URL\", \"\");\n\t\tif(showUrl === \"\")\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst link = BX.create(\"A\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\tclassName: \"ui-icon ui-icon-common-user crm-entity-stream-content-detail-employee\",\n\t\t\t\t\t\thref: showUrl,\n\t\t\t\t\t\ttarget: \"_blank\",\n\t\t\t\t\t\ttitle: BX.prop.getString(authorInfo, \"FORMATTED_NAME\", \"\")\n\t\t\t\t\t},\n\t\t\t\tchildren: [\n\t\t\t\t\tBX.create('i', {})\n\t\t\t\t]\n\t\t\t}\n\t\t);\n\t\tconst imageUrl = BX.prop.getString(authorInfo, \"IMAGE_URL\", \"\");\n\t\tif(imageUrl !== \"\")\n\t\t{\n\t\t\tlink.children[0].style.backgroundImage = \"url('\" + encodeURI(imageUrl) + \"')\";\n\t\t\tlink.children[0].style.backgroundSize = \"21px\";\n\t\t}\n\n\t\treturn link;\n\t}\n\n\tonActivityCreate(activity, data)\n\t{\n\t}\n\n\tisContextMenuEnabled()\n\t{\n\t\treturn false;\n\t}\n\n\tprepareContextMenuButton()\n\t{\n\t\tthis._contextMenuButton = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-section-context-menu\" },\n\t\t\t\tevents: { click: BX.delegate(this.onContextMenuButtonClick, this) }\n\t\t\t}\n\t\t);\n\t\treturn this._contextMenuButton;\n\t}\n\n\tonContextMenuButtonClick(e)\n\t{\n\t\tif(!this._isContextMenuShown)\n\t\t{\n\t\t\tthis.openContextMenu();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.closeContextMenu();\n\t\t}\n\t}\n\n\topenContextMenu()\n\t{\n\t\tconst menuItems = this.prepareContextMenuItems();\n\n\t\tif (typeof IntranetExtensions !== \"undefined\")\n\t\t{\n\t\t\tmenuItems.push(IntranetExtensions);\n\t\t}\n\n\t\tif(menuItems.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.PopupMenu.show(\n\t\t\tthis._id,\n\t\t\tthis._contextMenuButton,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 16,\n\t\t\t\tangle: { position: \"top\", offset: 0 },\n\t\t\t\tevents:\n\t\t\t\t\t{\n\t\t\t\t\t\tonPopupShow: BX.delegate(this.onContextMenuShow, this),\n\t\t\t\t\t\tonPopupClose: BX.delegate(this.onContextMenuClose, this),\n\t\t\t\t\t\tonPopupDestroy: BX.delegate(this.onContextMenuDestroy, this)\n\t\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\tthis._contextMenu = BX.PopupMenu.currentItem;\n\t}\n\n\tcloseContextMenu()\n\t{\n\t\tif(this._contextMenu)\n\t\t{\n\t\t\tthis._contextMenu.close();\n\t\t}\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\treturn [];\n\t}\n\n\tonContextMenuShow()\n\t{\n\t\tthis._isContextMenuShown = true;\n\t\tBX.addClass(this._contextMenuButton, \"active\");\n\t}\n\n\tonContextMenuClose()\n\t{\n\t\tif(this._contextMenu)\n\t\t{\n\t\t\tthis._contextMenu.popupWindow.destroy();\n\t\t}\n\t}\n\n\tonContextMenuDestroy()\n\t{\n\t\tthis._isContextMenuShown = false;\n\t\tBX.removeClass(this._contextMenuButton, \"active\");\n\t\tthis._contextMenu = null;\n\n\t\tif(typeof(BX.PopupMenu.Data[this._id]) !== \"undefined\")\n\t\t{\n\t\t\tdelete(BX.PopupMenu.Data[this._id]);\n\t\t}\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = CompatibleItem.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic getUserTimezoneOffset()\n\t{\n\t\treturn Timezone.Offset.USER_TO_SERVER;\n\t}\n\n\tstatic messages = {};\n}\n","/** @memberof BX.Crm.Timeline.Animation */\nexport default class Fasten\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._initialItem = null;\n\t\tthis._finalItem = null;\n\t\tthis._events = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._initialItem = this.getSetting(\"initialItem\");\n\t\tthis._finalItem = this.getSetting(\"finalItem\");\n\n\t\tthis._anchor = this.getSetting(\"anchor\");\n\t\tthis._events = this.getSetting(\"events\", {});\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultValue)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultValue;\n\t}\n\n\taddFixedHistoryItem()\n\t{\n\t\tconst node = this._finalItem.getWrapper();\n\t\tBX.addClass(node, 'crm-entity-stream-section-animate-start');\n\t\tif (this._anchor.parentNode && node)\n\t\t{\n\t\t\tthis._anchor.parentNode.insertBefore(node, this._anchor.nextSibling);\n\t\t}\n\t\tsetTimeout( BX.delegate(\n\t\t\tfunction() {\n\t\t\t\tBX.removeClass(node, 'crm-entity-stream-section-animate-start');\n\t\t\t},\n\t\t\tthis\n\t\t), 0);\n\t}\n\n\trun()\n\t{\n\t\tconst node = this._initialItem.getWrapper();\n\t\tthis._clone = node.cloneNode(true);\n\n\t\tBX.addClass(this._clone, 'crm-entity-stream-section-animate-start crm-entity-stream-section-top-fixed');\n\n\t\tthis._startPosition = BX.pos(node);\n\t\tthis._clone.style.position = \"absolute\";\n\t\tthis._clone.style.width = this._startPosition.width + \"px\";\n\n\t\tlet _cloneHeight = this._startPosition.height;\n\t\tconst _minHeight = 65;\n\t\tconst _sumPaddingContent = 18;\n\t\tif (_cloneHeight < _sumPaddingContent + _minHeight)\n\t\t\t_cloneHeight = _sumPaddingContent + _minHeight;\n\n\t\tthis._clone.style.height = _cloneHeight + \"px\";\n\t\tthis._clone.style.top = this._startPosition.top + \"px\";\n\t\tthis._clone.style.left = this._startPosition.left + \"px\";\n\t\tthis._clone.style.zIndex = 960;\n\n\t\tdocument.body.appendChild(this._clone);\n\n\t\tsetTimeout(\n\t\t\tBX.proxy(\n\t\t\t\tfunction (){\n\t\t\t\t\tBX.addClass(this._clone, \"crm-entity-stream-section-casper\" )\n\t\t\t\t},\n\t\t\t\tthis\n\t\t\t),\n\t\t\t0\n\t\t);\n\n\t\tthis._anchorPosition = BX.pos(this._anchor);\n\t\tconst finish = {\n\t\t\ttop: this._anchorPosition.top,\n\t\t\theight: _cloneHeight + 15,\n\t\t\topacity: 1\n\t\t};\n\n\t\tconst _difference = this._startPosition.top - this._anchorPosition.bottom;\n\t\tconst _deepHistoryLimit = 2 * (document.body.clientHeight + this._startPosition.height);\n\n\t\tif (_difference > _deepHistoryLimit)\n\t\t{\n\t\t\tfinish.top = this._startPosition.top - _deepHistoryLimit;\n\t\t\tfinish.opacity = 0;\n\t\t}\n\n\t\tlet _duration = Math.abs(finish.top - this._startPosition.top) * 2;\n\t\t_duration = (_duration < 1500) ? 1500 : _duration;\n\n\t\tconst movingEvent = new BX.easing({\n\t\t\tduration: _duration,\n\t\t\tstart: {top: this._startPosition.top, height: 0, opacity: 1},\n\t\t\tfinish: finish,\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tthis._clone.style.top = state.top + \"px\";\n\t\t\t\tthis._clone.style.opacity = state.opacity;\n\t\t\t\tthis._anchor.style.height = state.height + \"px\";\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tthis.finish();\n\t\t\t}, this)\n\t\t});\n\t\tmovingEvent.animate();\n\t}\n\n\tfinish()\n\t{\n\t\tthis._anchor.style.height = 0;\n\t\tthis.addFixedHistoryItem();\n\t\tBX.remove(this._clone);\n\n\t\tif(BX.type.isFunction(this._events[\"complete\"]))\n\t\t{\n\t\t\tthis._events[\"complete\"]();\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Fasten();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import { DatetimeConverter } from 'crm.timeline.tools';\nimport { Dom, Type } from 'main.core';\n\nimport CompatibleItem from './compatible-item';\nimport { Item as ItemType } from '../types';\nimport Fasten from '../animations/fasten';\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class History extends CompatibleItem\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._history = null;\n\t\tthis._fixedHistory = null;\n\t\tthis._typeId = null;\n\t\tthis._createdTime = null;\n\t\tthis._isFixed = false;\n\t\tthis._headerClickHandler = BX.delegate(this.onHeaderClick, this);\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._history = this.getSetting(\"history\");\n\t\tthis._fixedHistory = this.getSetting(\"fixedHistory\");\n\t}\n\n\tgetTypeId()\n\t{\n\t\tif(this._typeId === null)\n\t\t{\n\t\t\tthis._typeId = BX.prop.getInteger(this._data, \"TYPE_ID\", ItemType.undefined);\n\t\t}\n\t\treturn this._typeId;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn \"\";\n\t}\n\n\tisContextMenuEnabled()\n\t{\n\t\treturn !(this.isReadOnly());\n\t}\n\n\tgetCreatedTimestamp()\n\t{\n\t\treturn this.getTextDataParam(\"CREATED_SERVER\");\n\t}\n\n\tgetCreatedTime()\n\t{\n\t\tif(this._createdTime === null)\n\t\t{\n\t\t\tconst time = BX.parseDate(\n\t\t\t\tthis.getCreatedTimestamp(),\n\t\t\t\tfalse,\n\t\t\t\t\"YYYY-MM-DD\",\n\t\t\t\t\"YYYY-MM-DD HH:MI:SS\"\n\t\t\t);\n\n\t\t\tthis._createdTime = (new DatetimeConverter(time)).toUserTime().getValue();\n\t\t}\n\t\treturn this._createdTime;\n\t}\n\n\tgetCreatedDate()\n\t{\n\t\treturn BX.prop.extractDate(new Date(this.getCreatedTime().getTime()));\n\t}\n\n\tgetOwnerInfo()\n\t{\n\t\treturn this._history ? this._history.getOwnerInfo() : null;\n\t}\n\n\tgetOwnerTypeId()\n\t{\n\t\treturn BX.prop.getInteger(this.getOwnerInfo(), \"ENTITY_TYPE_ID\", BX.CrmEntityType.enumeration.undefined);\n\t}\n\n\tgetOwnerId()\n\t{\n\t\treturn BX.prop.getInteger(this.getOwnerInfo(), \"ENTITY_ID\", 0);\n\t}\n\n\tisReadOnly()\n\t{\n\t\treturn this._history.isReadOnly();\n\t}\n\n\tisEditable()\n\t{\n\t\treturn !this.isReadOnly();\n\t}\n\n\tisDone()\n\t{\n\t\tconst typeId = this.getTypeId();\n\t\tif(typeId === ItemType.activity)\n\t\t{\n\t\t\tconst entityData = this.getAssociatedEntityData();\n\t\t\treturn BX.CrmActivityStatus.isFinal(BX.prop.getInteger(entityData, \"STATUS\", 0));\n\t\t}\n\t\treturn false;\n\t}\n\n\tisFixed()\n\t{\n\t\treturn this._isFixed;\n\t}\n\n\t/**\n\t * deprecated\n\t */\n\tfasten(e)\n\t{\n\t\tif (this._fixedHistory._items.length >= 7)\n\t\t{\n\t\t\tif (!this.fastenLimitPopup)\n\t\t\t{\n\t\t\t\tthis.fastenLimitPopup = new BX.PopupWindow(\n\t\t\t\t\t'timeline_fasten_limit_popup_' + this._id,\n\t\t\t\t\tthis._switcher,\n\t\t\t\t\t{\n\t\t\t\t\t\tcontent: BX.message('CRM_TIMELINE_FASTEN_LIMIT_MESSAGE'),\n\t\t\t\t\t\tdarkMode: true,\n\t\t\t\t\t\tautoHide: true,\n\t\t\t\t\t\tzIndex: 990,\n\t\t\t\t\t\tangle: true,\n\t\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\t\tbindOptions: { forceBindPosition: true}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.fastenLimitPopup.show();\n\t\t\tthis.closeContextMenu();\n\t\t\treturn;\n\t\t}\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._history._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"CHANGE_FASTEN_ITEM\",\n\t\t\t\t\t\t\"VALUE\": 'Y',\n\t\t\t\t\t\t\"OWNER_TYPE_ID\":  this.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this.getOwnerId(),\n\t\t\t\t\t\t\"ID\": this._id\n\t\t\t\t\t},\n\t\t\t}\n\t\t);\n\n\t\tthis.closeContextMenu();\n\t}\n\n\t/**\n\t * deprecated\n\t */\n\tonSuccessFasten(result)\n\t{\n\t\tif (result && BX.type.isNotEmptyString(result.ERROR))\n\t\t\treturn;\n\n\t\tif (!this.isFixed())\n\t\t{\n\t\t\tthis._data.IS_FIXED = 'Y';\n\t\t\tconst fixedItem = this._fixedHistory.createItem(this._data);\n\t\t\tfixedItem._isFixed = true;\n\t\t\tthis._fixedHistory.addItem(fixedItem, 0);\n\t\t\tfixedItem.layout({ add: false });\n\t\t\tthis.refreshLayout();\n\t\t\tconst animation = Fasten.create(\n\t\t\t\t\"\",\n\t\t\t\t{\n\t\t\t\t\tinitialItem: this,\n\t\t\t\t\tfinalItem: fixedItem,\n\t\t\t\t\tanchor: this._fixedHistory._anchor\n\t\t\t\t}\n\t\t\t);\n\t\t\tanimation.run();\n\t\t}\n\n\t\tthis.closeContextMenu();\n\t}\n\n\t/**\n\t * deprecated\n\t */\n\tunfasten(e)\n\t{\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._history._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"CHANGE_FASTEN_ITEM\",\n\t\t\t\t\t\t\"VALUE\": 'N',\n\t\t\t\t\t\t\"OWNER_TYPE_ID\": this.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this.getOwnerId(),\n\t\t\t\t\t\t\"ID\": this._id\n\t\t\t\t\t},\n\t\t\t}\n\t\t);\n\n\t\tthis.closeContextMenu();\n\t}\n\n\t/**\n\t * deprecated\n\t */\n\tonSuccessUnfasten(result)\n\t{\n\t\tif (result && BX.type.isNotEmptyString(result.ERROR))\n\t\t\treturn;\n\n\t\tlet item;\n\t\tlet historyItem;\n\n\t\tif (this.isFixed())\n\t\t{\n\t\t\titem = this;\n\t\t\thistoryItem = this._history.findItemById(this._id);\n\t\t}\n\t\telse\n\t\t{\n\t\t\titem = this._fixedHistory.findItemById(this._id);\n\t\t\thistoryItem = this;\n\t\t}\n\n\t\tif (item)\n\t\t{\n\t\t\tconst index = this._fixedHistory.getItemIndex(item);\n\t\t\titem.clearAnimate();\n\t\t\tthis._fixedHistory.removeItemByIndex(index);\n\t\t\tif (historyItem)\n\t\t\t{\n\t\t\t\thistoryItem._data.IS_FIXED = 'N';\n\t\t\t\thistoryItem.refreshLayout();\n\t\t\t\tBX.LazyLoad.showImages();\n\t\t\t}\n\t\t}\n\t}\n\n\tclearAnimate()\n\t{\n\t\tif (!BX.type.isDomNode(this._wrapper))\n\t\t\treturn ;\n\n\t\tconst wrapperPosition = BX.pos(this._wrapper);\n\t\tconst hideEvent = new BX.easing({\n\t\t\tduration: 1000,\n\t\t\tstart: {height: wrapperPosition.height, opacity: 1, marginBottom: 15},\n\t\t\tfinish: {height: 0, opacity: 0, marginBottom: 0},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tthis._wrapper.style.height = state.height + \"px\";\n\t\t\t\tthis._wrapper.style.opacity = state.opacity;\n\t\t\t\tthis._wrapper.style.marginBottom = state.marginBottom;\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tthis.clearLayout();\n\t\t\t}, this)\n\t\t});\n\n\t\thideEvent.animate();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\";\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\treturn [];\n\t}\n\n\tprepareContent()\n\t{\n\t\tlet wrapperClassName = this.getWrapperClassName();\n\t\tif(wrapperClassName !== \"\")\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-history\" + \" \" + wrapperClassName;\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-history\";\n\t\t}\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: wrapperClassName}});\n\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: this.getIconClassName() } }));\n\n\t\tif (this.isContextMenuEnabled())\n\t\t{\n\t\t\tDom.append(this.prepareContextMenuButton(), wrapper);\n\t\t}\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{ attrs: { className: \"crm-entity-stream-section-content\" }, children: [ contentWrapper ] }\n\t\t\t)\n\t\t);\n\n\t\tconst header = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\t\tchildren:\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tattrs: {href: \"#\"},\n\t\t\t\t\t\t\t\t\t\t\t\tevents: {click: this._headerClickHandler},\n\t\t\t\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t),\n\t\t\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-time\"},\n\t\t\t\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\n\t\tcontentWrapper.appendChild(header);\n\n\t\tcontentWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: this.prepareContentDetails()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tprepareLayout(options)\n\t{\n\t\tthis._wrapper = this.prepareContent();\n\t\tif(this._wrapper)\n\t\t{\n\t\t\tconst enableAdd = BX.type.isPlainObject(options) ? BX.prop.getBoolean(options, \"add\", true) : true;\n\t\t\tif(enableAdd)\n\t\t\t{\n\t\t\t\tconst anchor = BX.type.isPlainObject(options) && BX.type.isElementNode(options[\"anchor\"]) ? options[\"anchor\"] : null;\n\t\t\t\tif(anchor && anchor.nextSibling)\n\t\t\t\t{\n\t\t\t\t\tthis._container.insertBefore(this._wrapper,  anchor.nextSibling);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis._container.appendChild(this._wrapper);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.markAsTerminated(this._history.checkItemForTermination(this));\n\t\t}\n\t}\n\n\tonHeaderClick(e)\n\t{\n\t\tthis.view();\n\t\te.preventDefault ? e.preventDefault() : (e.returnValue = false);\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\treturn BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-event-title\" }, text: this.getTitle() });\n\t}\n\n\tprepareFixedSwitcherLayout()\n\t{\n\t\tconst isFixed = (this.getTextDataParam(\"IS_FIXED\") === 'Y');\n\t\tthis._switcher = BX.create(\"span\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-section-top-fixed-btn\" },\n\t\t\t\tevents: {\n\t\t\t\t\tclick: isFixed ? BX.delegate(this.unfasten, this) : BX.delegate(this.fasten, this)\n\t\t\t\t}\n\t\t\t});\n\t\tif (isFixed)\n\t\t\tBX.addClass(this._switcher, \"crm-entity-stream-section-top-fixed-btn-active\");\n\n\t\tif (!this.isReadOnly() && !isFixed)\n\t\t{\n\t\t\tconst manager = this._history.getManager();\n\t\t\tif (!manager.isSpotlightShowed())\n\t\t\t{\n\t\t\t\tmanager.setSpotlightShowed();\n\t\t\t\tBX.addClass(this._switcher, \"crm-entity-stream-section-top-fixed-btn-spotlight\");\n\t\t\t\tconst spotlight = new BX.SpotLight({\n\t\t\t\t\ttargetElement: this._switcher,\n\t\t\t\t\ttargetVertex: \"middle-center\",\n\t\t\t\t\tlightMode: false,\n\t\t\t\t\tid: \"CRM_TIMELINE_FASTEN_SWITCHER\",\n\t\t\t\t\tzIndex: 900,\n\t\t\t\t\ttop: -3,\n\t\t\t\t\tleft: -1,\n\t\t\t\t\tautoSave: true,\n\t\t\t\t\tcontent: BX.message('CRM_TIMELINE_SPOTLIGHT_FASTEN_MESSAGE')\n\t\t\t\t});\n\t\t\t\tspotlight.show();\n\t\t\t}\n\t\t}\n\n\t\treturn this._switcher;\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\n\t\tconst statusNode = this.getStatusNode();\n\t\tif (Type.isDomNode(statusNode))\n\t\t{\n\t\t\tDom.append(statusNode, header);\n\t\t}\n\n\t\theader.appendChild(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\treturn header;\n\t}\n\n\tgetStatusNode(): ?HTMLElement\n\t{\n\t\treturn null;\n\t}\n\n\tonActivityCreate(activity, data)\n\t{\n\t\tthis._history.getManager().onActivityCreated(activity, data);\n\t}\n\n\tformatTime(time)\n\t{\n\t\tif (this.isFixed())\n\t\t{\n\t\t\treturn this._fixedHistory.formatTime(time);\n\t\t}\n\n\t\treturn this._history.formatTime(time);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new History();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic isCounterEnabled(deadline)\n\t{\n\t\tif(!BX.type.isDate(deadline))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet start = new Date();\n\t\tstart.setHours(0);\n\t\tstart.setMinutes(0);\n\t\tstart.setSeconds(0);\n\t\tstart.setMilliseconds(0);\n\t\tstart = start.getTime();\n\n\t\tlet end = new Date();\n\t\tend.setHours(23);\n\t\tend.setMinutes(59);\n\t\tend.setSeconds(59);\n\t\tend.setMilliseconds(999);\n\t\tend = end.getTime();\n\n\t\tconst time = deadline.getTime();\n\t\treturn time < start || (time >= start && time <= end);\n\t}\n\n\tstatic isCounterEnabledByLightTime(lightTime)\n\t{\n\t\tif(!BX.type.isDate(lightTime))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst now = (new Date()).getTime();\n\n\t\tconst time = lightTime.getTime();\n\t\treturn time < now;\n\t}\n}\n","import CompatibleItem from \"./compatible-item\";\nimport History from \"./history\";\nimport {Item as ItemType} from \"../types\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Scheduled extends CompatibleItem\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._schedule = null;\n\t\tthis._deadlineNode = null;\n\n\t\tthis._headerClickHandler = BX.delegate(this.onHeaderClick, this);\n\t\tthis._setAsDoneButtonHandler = BX.delegate(this.onSetAsDoneButtonClick, this);\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._schedule = this.getSetting(\"schedule\");\n\t\tif(!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"Scheduled. The field 'activityEditor' is not assigned.\";\n\t\t}\n\n\t\tif(this.hasPermissions() && !this.verifyPermissions())\n\t\t{\n\t\t\tthis.loadPermissions();\n\t\t}\n\t}\n\n\tgetTypeId()\n\t{\n\t\treturn ItemType.undefined;\n\t}\n\n\tverifyPermissions()\n\t{\n\t\tconst userId = BX.prop.getInteger(this.getPermissions(), \"USER_ID\", 0);\n\t\treturn userId <= 0 || userId === this._schedule.getUserId();\n\t}\n\n\tloadPermissions()\n\t{\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._schedule.getServiceUrl(),\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata: { \"ACTION\": \"GET_PERMISSIONS\", \"TYPE_ID\": this.getTypeId(), \"ID\": this.getAssociatedEntityId() },\n\t\t\t\tonsuccess: this.onPermissionsLoad.bind(this)\n\t\t\t}\n\t\t);\n\t}\n\n\tonPermissionsLoad(result)\n\t{\n\t\tconst permissions = BX.prop.getObject(result, \"PERMISSIONS\", null);\n\t\tif(!permissions)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setPermissions(permissions);\n\t\twindow.setTimeout(function(){ this.refreshLayout(); }.bind(this), 0);\n\t}\n\n\tgetDeadline()\n\t{\n\t\treturn null;\n\t}\n\n\tgetLightTime()\n\t{\n\t\treturn null;\n\t}\n\n\thasDeadline()\n\t{\n\t\treturn BX.type.isDate(this.getDeadline());\n\t}\n\n\tisCounterEnabled()\n\t{\n\t\tif (this.isDone())\n\t\t{\n\t\t\treturn this._existedStreamItemDeadLine && History.isCounterEnabledByLightTime(this._existedStreamItemDeadLine);\n\t\t}\n\n\t\tconst lightTime = this.getLightTime();\n\n\t\treturn lightTime && History.isCounterEnabledByLightTime(lightTime);\n\t}\n\n\tisIncomingChannel()\n\t{\n\t\treturn false;\n\t}\n\n\tgetSourceId()\n\t{\n\t\treturn BX.prop.getInteger(this.getAssociatedEntityData(), \"ID\", 0);\n\t}\n\n\tonSetAsDoneCompleted(data)\n\t{\n\t\tif(!BX.prop.getBoolean(data, \"COMPLETED\"))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.markAsDone(true);\n\t\tthis._schedule.onItemMarkedAsDone(\n\t\t\tthis,\n\t\t\t{ 'historyItemData': BX.prop.getObject(data, \"HISTORY_ITEM\") }\n\t\t);\n\t}\n\n\tonPosponeCompleted(data)\n\t{\n\t}\n\n\trefreshDeadline()\n\t{\n\t\tthis._deadlineNode.innerHTML = this.formatDateTime(this.getDeadline());\n\t}\n\n\tformatDateTime(time)\n\t{\n\t\treturn this._schedule.formatDateTime(time);\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon\";\n\t}\n\n\tisReadOnly()\n\t{\n\t\treturn this._schedule.isReadOnly();\n\t}\n\n\tisEditable()\n\t{\n\t\treturn !this.isReadOnly();\n\t}\n\n\tcanPostpone()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\tif (this.isIncomingChannel())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst perms = BX.prop.getObject(this.getAssociatedEntityData(), \"PERMISSIONS\", {});\n\t\treturn BX.prop.getBoolean(perms, \"POSTPONE\", false);\n\t}\n\n\tisDone()\n\t{\n\t\treturn BX.CrmActivityStatus.isFinal(\n\t\t\tBX.prop.getInteger(this.getAssociatedEntityData(), \"STATUS\", 0)\n\t\t);\n\t}\n\n\tcanComplete()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst perms = BX.prop.getObject(this.getAssociatedEntityData(), \"PERMISSIONS\", {});\n\t\treturn BX.prop.getBoolean(perms, \"COMPLETE\", false);\n\t}\n\n\tsetAsDone(isDone)\n\t{\n\t}\n\n\tprepareContent(options)\n\t{\n\t\treturn null;\n\t}\n\n\tprepareLayout(options)\n\t{\n\t\tthis._wrapper = this.prepareContent();\n\t\tif(this._wrapper)\n\t\t{\n\t\t\tconst enableAdd = BX.type.isPlainObject(options) ? BX.prop.getBoolean(options, \"add\", true) : true;\n\t\t\tif(enableAdd)\n\t\t\t{\n\t\t\t\tconst anchor = BX.type.isPlainObject(options) && BX.type.isElementNode(options[\"anchor\"]) ? options[\"anchor\"] : null;\n\t\t\t\tif(anchor && anchor.nextSibling)\n\t\t\t\t{\n\t\t\t\t\tthis._container.insertBefore(this._wrapper, anchor.nextSibling);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis._container.appendChild(this._wrapper);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.markAsTerminated(this._schedule.checkItemForTermination(this));\n\t\t}\n\t}\n\n\tonHeaderClick(e)\n\t{\n\t\tthis.view();\n\t\te.preventDefault ? e.preventDefault() : (e.returnValue = false);\n\t}\n\n\tonSetAsDoneButtonClick(e)\n\t{\n\t\tif(this.canComplete())\n\t\t{\n\t\t\tthis.setAsDone(!this.isDone());\n\t\t}\n\t}\n\n\tonActivityCreate(activity, data)\n\t{\n\t\tthis._schedule.getManager().onActivityCreated(activity, data);\n\t}\n\n\tstatic isDone(data)\n\t{\n\t\tconst entityData = BX.prop.getObject(data, \"ASSOCIATED_ENTITY\", {});\n\t\treturn BX.CrmActivityStatus.isFinal(BX.prop.getInteger(entityData, \"STATUS\", 0));\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Scheduled();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","/** @memberof BX.Crm.Timeline.Animation */\nexport default class Item\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._initialItem = null;\n\t\tthis._finalItem = null;\n\t\tthis._events = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._initialItem = this.getSetting(\"initialItem\");\n\t\tthis._finalItem = this.getSetting(\"finalItem\");\n\n\t\tthis._anchor = this.getSetting(\"anchor\");\n\t\tthis._events = this.getSetting(\"events\", {});\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\trun()\n\t{\n\t\tthis._node = this._initialItem.getWrapper();\n\t\tconst originalPosition = BX.pos(this._node);\n\t\tthis._initialYPosition = originalPosition.top;\n\t\tthis._initialXPosition = originalPosition.left;\n\t\tthis._initialWidth = this._node.offsetWidth;\n\t\tthis._initialHeight = this._node.offsetHeight;\n\n\t\tthis._anchorYPosition = BX.pos(this._anchor).top;\n\n\t\tthis.createStub();\n\t\tthis.createGhost();\n\t\tthis.moveGhost();\n\t}\n\n\tcreateStub()\n\t{\n\t\tthis._stub = BX.create(\n\t\t\t\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-section crm-entity-stream-section-planned crm-entity-stream-section-shadow\" },\n\t\t\t\tchildren :\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tprops: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\t\t\t\tstyle: { height: this._initialHeight + \"px\" }\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\n\t\tthis._node.parentNode.insertBefore(this._stub, this._node);\n\t}\n\n\tcreateGhost()\n\t{\n\t\tthis._ghostNode = this._node;\n\t\tthis._ghostNode.style.position = \"absolute\";\n\t\tthis._ghostNode.style.width = this._initialWidth + \"px\";\n\t\tthis._ghostNode.style.height = this._initialHeight + \"px\";\n\t\tthis._ghostNode.style.top = this._initialYPosition + \"px\";\n\t\tthis._ghostNode.style.left = this._initialXPosition + \"px\";\n\t\tdocument.body.appendChild(this._ghostNode);\n\t\tsetTimeout(BX.proxy(function (){BX.addClass(this._ghostNode, \"crm-entity-stream-section-casper\" )}, this), 20);\n\t}\n\n\tmoveGhost()\n\t{\n\t\tconst node = this._ghostNode;\n\t\tconst movingEvent = new BX.easing({\n\t\t\tduration: 500,\n\t\t\tstart: {top: this._initialYPosition},\n\t\t\tfinish: {top: this._anchorYPosition},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tnode.style.top = state.top + \"px\";\n\t\t\t}, this)\n\t\t});\n\t\tsetTimeout( BX.proxy(function () {\n\t\t\tmovingEvent.animate();\n\t\t\tnode.style.boxShadow = \"\";\n\t\t}, this), 500);\n\n\t\tconst placeEventAnim = new BX.easing({\n\t\t\tduration: 500,\n\t\t\tstart: {height: 0},\n\t\t\tfinish: {height: this._initialHeight + 20},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tthis._anchor.style.height = state.height + \"px\";\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tif (BX.type.isFunction(this._events[\"complete\"]))\n\t\t\t\t{\n\t\t\t\t\tthis._events[\"complete\"]();\n\t\t\t\t}\n\n\t\t\t\tthis.addHistoryItem();\n\t\t\t\tthis.removeGhost();\n\t\t\t}, this)\n\t\t});\n\t\tsetTimeout(function (){placeEventAnim.animate()}, 500);\n\t}\n\n\taddHistoryItem()\n\t{\n\t\tconst node = this._finalItem.getWrapper();\n\n\t\tthis._anchor.parentNode.insertBefore(node, this._anchor.nextSibling);\n\n\t\tthis._finalItemHeight = this._anchor.offsetHeight - node.offsetHeight;\n\t\tthis._anchor.style.height = 0;\n\t\tnode.style.marginBottom = this._finalItemHeight + \"px\";\n\t}\n\n\tremoveGhost()\n\t{\n\t\tconst ghostNode = this._ghostNode;\n\t\tconst finalNode = this._finalItem.getWrapper();\n\n\t\tghostNode.style.overflow = \"hidden\";\n\t\tconst hideCasperItem = new BX.easing({\n\t\t\tduration: 70,\n\t\t\tstart: {opacity: 100, height: ghostNode.offsetHeight, marginBottom: this._finalItemHeight},\n\t\t\tfinish: {opacity: 0, height: finalNode.offsetHeight, marginBottom: 20},\n\t\t\t// transition : BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tghostNode.style.opacity = state.opacity / 100;\n\t\t\t\tghostNode.style.height = state.height + \"px\";\n\t\t\t\tfinalNode.style.marginBottom = state.marginBottom + \"px\";\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tghostNode.remove();\n\t\t\t\tfinalNode.style.marginBottom = \"\";\n\t\t\t\tthis.collapseStub();\n\n\t\t\t}, this)\n\t\t});\n\t\thideCasperItem.animate();\n\t}\n\n\tcollapseStub()\n\t{\n\t\tconst removePlannedEvent = new BX.easing({\n\t\t\tduration: 500,\n\t\t\tstart: {opacity: 100, height: this._initialHeight, marginBottom: 15},\n\t\t\tfinish: {opacity: 0, height: 0, marginBottom: 0},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tthis._stub.style.height = state.height + \"px\";\n\t\t\t\tthis._stub.style.marginBottom = state.marginBottom + \"px\";\n\t\t\t\tthis._stub.style.opacity = state.opacity / 100;\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tthis.inited = false\n\t\t\t}, this)\n\n\t\t});\n\t\tremovePlannedEvent.animate();\n\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Item();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import { Dom } from 'main.core';\n\n/** @memberof BX.Crm.Timeline.Animation */\nexport default class Shift\n{\n\tconstructor()\n\t{\n\t\tthis._node = null;\n\t\tthis._anchor = null;\n\t\tthis._nodeParent  = null;\n\t\tthis._startPosition = null;\n\t\tthis._events = null;\n\t}\n\n\tinitialize(node, anchor, startPosition, shadowNode, events, additionalShift)\n\t{\n\t\tthis._node = node;\n\t\tthis._shadowNode = shadowNode;\n\t\tthis._anchor = anchor;\n\t\tthis._nodeParent  = node.parentNode;\n\t\tthis._startPosition = startPosition;\n\t\tthis._events = BX.type.isPlainObject(events) ? events : {};\n\t\tthis.additionalShift = additionalShift ?? 0;\n\t}\n\n\trun()\n\t{\n\t\tthis._anchorPosition = BX.pos(this._anchor);\n\n\t\tsetTimeout(\n\t\t\tBX.proxy(\n\t\t\t\tfunction (){\n\t\t\t\t\tBX.addClass(this._node, \"crm-entity-stream-section-casper\" )\n\t\t\t\t},\n\t\t\t\tthis\n\t\t\t),\n\t\t\t0\n\t\t);\n\n\t\t// const nodeHeight = Dom.getPosition(this._node).height;\n\t\tconst nodeHeight = Dom.getPosition(this._node).height;\n\t\tconst nodeMarginBottom = parseFloat(getComputedStyle(this._node).marginBottom);\n\t\tconst nodeMarginTop = parseFloat(getComputedStyle(this._node).marginTop);\n\t\tconst nodeHeightWithMargin = nodeHeight + nodeMarginBottom + nodeMarginTop;\n\n\t\tconst expandPlaceEvent = new BX.easing({\n\t\t\tduration: 600,\n\t\t\tstart: { height: 0 },\n\t\t\tfinish: { height: nodeHeightWithMargin },\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: (state) => {\n\t\t\t\tthis._anchor.style.height = state.height + \"px\";\n\t\t\t},\n\t\t});\n\n\t\tconst movingEvent = new BX.easing({\n\t\t\tduration: 1000,\n\t\t\tstart: { top: this._startPosition.top },\n\t\t\tfinish: {\n\t\t\t\ttop: this._anchorPosition.top - nodeHeightWithMargin + this.additionalShift,\n\t\t\t},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tthis._node.style.top = state.top + \"px\";\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tthis.finish();\n\t\t\t}, this)\n\t\t});\n\n\t\texpandPlaceEvent.animate();\n\t\tmovingEvent.animate();\n\t}\n\n\tfinish()\n\t{\n\t\tif(BX.type.isFunction(this._events[\"complete\"]))\n\t\t{\n\t\t\tthis._events[\"complete\"]();\n\t\t}\n\t\tif( this._shadowNode !== false )\n\t\t{\n\t\t\t// this._stub.height = 0;\n\t\t}\n\t}\n\n\tstatic create(node, anchor, startPosition, shadowNode, events, additionalShift: number)\n\t{\n\t\tconst self = new Shift();\n\t\tself.initialize(node, anchor, startPosition, shadowNode, events, additionalShift);\n\t\treturn self;\n\t}\n}\n","export const StreamType = {\n\thistory: 0,\n\tscheduled: 1,\n\tpinned: 2,\n}","import { MenuManager } from 'main.popup';\n\nimport { Action } from '../../action';\n\nexport class Menu\n{\n\t#menuOptions = {};\n\t#vueComponent = {};\n\n\tconstructor(vueComponent: Object, menuItems: Array, menuOptions: ?Object)\n\t{\n\t\tthis.#vueComponent = vueComponent;\n\t\tthis.#menuOptions = menuOptions || {};\n\t\tthis.#menuOptions = {\n\t\t\tangle: false,\n\t\t\tcacheable: false,\n\t\t\t...this.#menuOptions,\n\t\t};\n\n\t\tthis.#menuOptions.items = [];\n\t\tfor (const item of menuItems)\n\t\t{\n\t\t\tthis.#menuOptions.items.push(this.createMenuItem(item));\n\t\t}\n\t}\n\n\tgetMenuItems(): Array\n\t{\n\t\treturn this.#menuOptions.items;\n\t}\n\n\tshow(): void\n\t{\n\t\tMenuManager.show(this.#menuOptions);\n\t}\n\n\tcreateMenuItem(item): Object\n\t{\n\t\tif (Object.prototype.hasOwnProperty.call(item, 'delimiter') && item.delimiter)\n\t\t{\n\t\t\treturn {\n\t\t\t\ttext: item.title || '',\n\t\t\t\tdelimiter: true,\n\t\t\t};\n\t\t}\n\n\t\tconst result = {\n\t\t\ttext: item.title,\n\t\t\tvalue: item.title,\n\t\t};\n\n\t\tif (item.icon)\n\t\t{\n\t\t\tresult.className = `menu-popup-item-${item.icon}`;\n\t\t}\n\n\t\tif (item.menu)\n\t\t{\n\t\t\tresult.items = [];\n\t\t\tfor (const subItem of Object.values(item.menu.items || {}))\n\t\t\t{\n\t\t\t\tresult.items.push(this.createMenuItem(subItem));\n\t\t\t}\n\t\t}\n\t\telse if (item.action)\n\t\t{\n\t\t\tif (item.action.type === 'redirect')\n\t\t\t{\n\t\t\t\tresult.href = item.action.value;\n\t\t\t}\n\t\t\telse if (item.action.type === 'jsCode')\n\t\t\t{\n\t\t\t\tresult.onclick = item.action.value;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.onclick = () => {\n\t\t\t\t\tvoid this.onMenuItemClick(item);\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tonMenuItemClick(item): void\n\t{\n\t\tconst menu = MenuManager.getCurrentMenu();\n\t\tif (menu)\n\t\t{\n\t\t\tmenu.close();\n\t\t}\n\n\t\tconst action = new Action(item.action);\n\n\t\tvoid action.execute(this.#vueComponent);\n\t}\n\n\tstatic showMenu(vueComponent: Object, menuItems: Array, menuOptions: ?Object): void\n\t{\n\t\tconst menu = new Menu(vueComponent, menuItems, menuOptions);\n\n\t\tmenu.show();\n\t}\n}\n","import { DatetimeConverter } from 'crm.timeline.tools';\nimport { ajax as Ajax, Dom, Type } from 'main.core';\nimport { DateTimeFormat } from 'main.date';\nimport { rest as Rest } from 'rest.client';\nimport { UI } from 'ui.notification';\nimport { Menu } from './components/layout/menu';\nimport { sendData } from 'ui.analytics';\n\ndeclare type AnimationParams = {\n\ttarget: string,\n\ttype: string,\n\tforever: boolean,\n}\n\nconst AnimationTarget = {\n\tblock: 'block',\n\titem: 'item',\n};\n\nconst AnimationType = {\n\tdisable: 'disable',\n\tloader: 'loader',\n};\n\nconst ActionType = {\n\tJS_EVENT: 'jsEvent',\n\tAJAX_ACTION: {\n\t\tSTARTED: 'ajaxActionStarted',\n\t\tFINISHED: 'ajaxActionFinished',\n\t\tFAILED: 'ajaxActionFailed',\n\t},\n\n\tisJsEvent(type: string): boolean\n\t{\n\t\treturn (type === this.JS_EVENT);\n\t},\n\n\tisAjaxAction(type: string): boolean\n\t{\n\t\treturn (\n\t\t\ttype === this.AJAX_ACTION.STARTED\n\t\t\t|| type === this.AJAX_ACTION.FINISHED\n\t\t\t|| type === this.AJAX_ACTION.FAILED\n\t\t);\n\t}\n};\n\nObject.freeze(ActionType.AJAX_ACTION);\nObject.freeze(ActionType);\n\nexport { ActionType };\n\nexport class Action\n{\n\t#type: string = null;\n\t#value: string | Object  = null;\n\t#actionParams: ?Object = null;\n\t#animation: ?AnimationParams = null;\n\t#analytics: ?Object = null;\n\n\tconstructor(params)\n\t{\n\t\tthis.#type = params.type;\n\t\tthis.#value = params.value;\n\t\tthis.#actionParams = params.actionParams;\n\t\tthis.#animation = Type.isPlainObject(params.animation) ? params.animation : null;\n\t\tthis.#analytics = Type.isPlainObject(params.analytics) ? params.analytics : null;\n\t}\n\n\texecute(vueComponent): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif (this.isJsEvent())\n\t\t\t{\n\t\t\t\tvueComponent.$Bitrix.eventEmitter.emit('crm:timeline:item:action', {\n\t\t\t\t\taction: this.#value,\n\t\t\t\t\tactionType: ActionType.JS_EVENT,\n\t\t\t\t\tactionData: this.#actionParams,\n\t\t\t\t\tanimationCallbacks: {\n\t\t\t\t\t\tonStart: this.#startAnimation.bind(this, vueComponent),\n\t\t\t\t\t\tonStop: this.#stopAnimation.bind(this, vueComponent),\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis.#sendAnalytics();\n\n\t\t\t\tresolve(true);\n\t\t\t}\n\t\t\telse if (this.isJsCode())\n\t\t\t{\n\t\t\t\tthis.#startAnimation(vueComponent);\n\t\t\t\teval(this.#value);\n\t\t\t\tthis.#stopAnimation(vueComponent);\n\t\t\t\tthis.#sendAnalytics();\n\t\t\t\tresolve(true);\n\t\t\t}\n\t\t\telse if (this.isAjaxAction() || this.isAjaxJsonAction())\n\t\t\t{\n\t\t\t\tthis.#startAnimation(vueComponent);\n\t\t\t\tvueComponent.$Bitrix.eventEmitter.emit('crm:timeline:item:action', {\n\t\t\t\t\taction: this.#value,\n\t\t\t\t\tactionType: ActionType.AJAX_ACTION.STARTED,\n\t\t\t\t\tactionData: this.#actionParams,\n\t\t\t\t});\n\n\t\t\t\tconst ajaxConfig = {\n\t\t\t\t\t[this.isAjaxJsonAction() ? 'json' : 'data']: this.#prepareRunActionParams(this.#actionParams),\n\t\t\t\t};\n\t\t\t\tif (this.#analytics)\n\t\t\t\t{\n\t\t\t\t\tajaxConfig.analytics = this.#analytics;\n\t\t\t\t}\n\n\t\t\t\tAjax.runAction(\n\t\t\t\t\tthis.#value,\n\t\t\t\t\tajaxConfig,\n\t\t\t\t).then(\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tthis.#stopAnimation(vueComponent);\n\t\t\t\t\t\tvueComponent.$Bitrix.eventEmitter.emit('crm:timeline:item:action', {\n\t\t\t\t\t\t\taction: this.#value,\n\t\t\t\t\t\t\tactionType: ActionType.AJAX_ACTION.FINISHED,\n\t\t\t\t\t\t\tactionData: this.#actionParams,\n\t\t\t\t\t\t\tresponse,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tresolve(response);\n\t\t\t\t\t},\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tthis.#stopAnimation(vueComponent, true);\n\t\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\t\tcontent: response.errors[0].message,\n\t\t\t\t\t\t\tautoHideDelay: 5000,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tvueComponent.$Bitrix.eventEmitter.emit('crm:timeline:item:action', {\n\t\t\t\t\t\t\taction: this.#value,\n\t\t\t\t\t\t\tactionType: ActionType.AJAX_ACTION.FAILED,\n\t\t\t\t\t\t\tactionParams: this.#actionParams,\n\t\t\t\t\t\t\tresponse,\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tresolve(response);\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (this.isCallRestBatch())\n\t\t\t{\n\t\t\t\tthis.#startAnimation(vueComponent);\n\t\t\t\tvueComponent.$Bitrix.eventEmitter.emit('crm:timeline:item:action', {\n\t\t\t\t\taction: this.#value,\n\t\t\t\t\tactionType: 'ajaxActionStarted',\n\t\t\t\t\tactionData: this.#actionParams,\n\t\t\t\t});\n\t\t\t\tRest.callBatch(\n\t\t\t\t\tthis.#prepareCallBatchParams(this.#actionParams),\n\t\t\t\t\t(restResult) => {\n\t\t\t\t\t\tfor (const result in restResult)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst response = restResult[result].answer;\n\t\t\t\t\t\t\tif (response.error)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.#stopAnimation(vueComponent);\n\t\t\t\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\t\t\t\tcontent: response.error.error_description,\n\t\t\t\t\t\t\t\t\tautoHideDelay: 5000,\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tvueComponent.$Bitrix.eventEmitter.emit('crm:timeline:item:action', {\n\t\t\t\t\t\t\t\t\taction: this.#value,\n\t\t\t\t\t\t\t\t\tactionType: 'ajaxActionFailed',\n\t\t\t\t\t\t\t\t\tactionParams: this.#actionParams,\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\treject(restResult);\n\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.#stopAnimation(vueComponent);\n\t\t\t\t\t\tvueComponent.$Bitrix.eventEmitter.emit('crm:timeline:item:action', {\n\t\t\t\t\t\t\taction: this.#value,\n\t\t\t\t\t\t\tactionType: 'ajaxActionFinished',\n\t\t\t\t\t\t\tactionData: this.#actionParams,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tresolve(restResult);\n\t\t\t\t\t},\n\t\t\t\t\ttrue\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (this.isRedirect())\n\t\t\t{\n\t\t\t\tthis.#startAnimation(vueComponent);\n\n\t\t\t\tconst linkAttrs = {\n\t\t\t\t\thref: this.#value,\n\t\t\t\t};\n\t\t\t\tif (this.#actionParams && this.#actionParams.target)\n\t\t\t\t{\n\t\t\t\t\tlinkAttrs.target = this.#actionParams.target;\n\t\t\t\t}\n\t\t\t\t// this magic allows auto opening internal links in slider if possible:\n\t\t\t\tconst link = Dom.create('a', {\n\t\t\t\t\tattrs: linkAttrs,\n\t\t\t\t\ttext: '',\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\tdisplay: 'none',\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\tDom.append(link, document.body);\n\t\t\t\tlink.click();\n\t\t\t\tsetTimeout(() => Dom.remove(link), 10);\n\n\t\t\t\tthis.#sendAnalytics();\n\n\t\t\t\tresolve(this.#value);\n\t\t\t}\n\t\t\telse if (this.isShowMenu())\n\t\t\t{\n\t\t\t\tMenu.showMenu(\n\t\t\t\t\tvueComponent,\n\t\t\t\t\tthis.#prepareMenuItems(this.#value.items, vueComponent),\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'actionMenu',\n\t\t\t\t\t\tbindElement: vueComponent.$el,\n\t\t\t\t\t\tminWidth: vueComponent.$el.offsetWidth,\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tthis.#sendAnalytics();\n\n\t\t\t\tresolve(true);\n\t\t\t}\n\t\t\telse if (this.isShowInfoHelper())\n\t\t\t{\n\t\t\t\tBX.UI.InfoHelper?.show(this.#value);\n\n\t\t\t\tthis.#sendAnalytics();\n\n\t\t\t\tresolve(true);\n\t\t\t}\n\t\t\telse {\n\t\t\t\treject(false);\n\t\t\t}\n\t\t});\n\t}\n\n\tisJsEvent(): boolean\n\t{\n\t\treturn (this.#type === 'jsEvent');\n\t}\n\n\tisJsCode(): boolean\n\t{\n\t\treturn (this.#type === 'jsCode');\n\t}\n\n\tisAjaxAction(): boolean\n\t{\n\t\treturn (this.#type === 'runAjaxAction');\n\t}\n\n\tisAjaxJsonAction(): boolean\n\t{\n\t\treturn (this.#type === 'runAjaxJsonAction');\n\t}\n\n\tisCallRestBatch(): boolean\n\t{\n\t\treturn (this.#type === 'callRestBatch');\n\t}\n\n\tisRedirect(): boolean\n\t{\n\t\treturn (this.#type === 'redirect');\n\t}\n\n\tisShowInfoHelper(): boolean\n\t{\n\t\treturn (this.#type === 'showInfoHelper');\n\t}\n\n\tisShowMenu(): boolean\n\t{\n\t\treturn (this.#type === 'showMenu');\n\t}\n\n\tgetValue(): string | Object\n\t{\n\t\treturn this.#value;\n\t}\n\n\tgetActionParam(param: string)\n\t{\n\t\treturn this.#actionParams && this.#actionParams.hasOwnProperty(param)\n\t\t\t? this.#actionParams[param]\n\t\t\t: null\n\t\t;\n\t}\n\n\t#prepareRunActionParams(params): Object\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isUndefined(params))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\t\tfor (const paramName in params)\n\t\t{\n\t\t\tconst paramValue = params[paramName];\n\t\t\tif (Type.isDate(paramValue))\n\t\t\t{\n\t\t\t\tresult[paramName] = DateTimeFormat.format(DatetimeConverter.getSiteDateTimeFormat(), paramValue);\n\t\t\t}\n\t\t\telse if (Type.isPlainObject(paramValue))\n\t\t\t{\n\t\t\t\tresult[paramName] = this.#prepareRunActionParams(paramValue);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult[paramName] = paramValue;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#prepareCallBatchParams(params): Object\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isUndefined(params))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tfor (const paramName in params)\n\t\t{\n\t\t\tresult[paramName] = {\n\t\t\t\tmethod: params[paramName].method,\n\t\t\t\tparams: this.#prepareRunActionParams(params[paramName].params)\n\t\t\t};\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#prepareMenuItems(items: Object, vueComponent: Object): Array\n\t{\n\t\treturn Object.values(items)\n\t\t\t.filter((item) => (item.state !== 'hidden' && item.scope !== 'mobile' && (!vueComponent.isReadOnly || !item.hideIfReadonly)))\n\t\t\t.sort((a, b) => (a.sort - b.sort))\n\t\t;\n\t}\n\n\t#startAnimation(vueComponent)\n\t{\n\t\tif (!this.#isAnimationValid())\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif (this.#animation.target === AnimationTarget.item)\n\t\t{\n\t\t\tif (this.#animation.type === AnimationType.disable)\n\t\t\t{\n\t\t\t\tvueComponent.$root.setFaded(true);\n\t\t\t}\n\t\t\tif (this.#animation.type === AnimationType.loader)\n\t\t\t{\n\t\t\t\tvueComponent.$root.showLoader(true);\n\t\t\t}\n\t\t}\n\t\tif (this.#animation.target === AnimationTarget.block)\n\t\t{\n\t\t\tif (this.#animation.type === AnimationType.disable)\n\t\t\t{\n\t\t\t\tif (Type.isFunction(vueComponent.setDisabled))\n\t\t\t\t{\n\t\t\t\t\tvueComponent.setDisabled(true);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.#animation.type === AnimationType.loader)\n\t\t\t{\n\t\t\t\tif (Type.isFunction(vueComponent.setLoading))\n\t\t\t\t{\n\t\t\t\t\tvueComponent.setLoading(true);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t#stopAnimation(vueComponent, force = false)\n\t{\n\t\tif (!this.#isAnimationValid())\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif (this.#animation.forever && !force)\n\t\t{\n\t\t\treturn; // should not be stopped\n\t\t}\n\n\t\tif (this.#animation.target === AnimationTarget.item)\n\t\t{\n\t\t\tif (this.#animation.type === AnimationType.disable)\n\t\t\t{\n\t\t\t\tvueComponent.$root.setFaded(false);\n\t\t\t}\n\t\t\tif (this.#animation.type === AnimationType.loader)\n\t\t\t{\n\t\t\t\tvueComponent.$root.showLoader(false);\n\t\t\t}\n\t\t}\n\t\tif (this.#animation.target === AnimationTarget.block)\n\t\t{\n\t\t\tif (this.#animation.type === AnimationType.disable)\n\t\t\t{\n\t\t\t\tif (Type.isFunction(vueComponent.setDisabled))\n\t\t\t\t{\n\t\t\t\t\tvueComponent.setDisabled(false);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.#animation.type === AnimationType.loader)\n\t\t\t{\n\t\t\t\tif (Type.isFunction(vueComponent.setLoading))\n\t\t\t\t{\n\t\t\t\t\tvueComponent.setLoading(false);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t#isAnimationValid(): boolean\n\t{\n\t\tif (!this.#animation)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!AnimationTarget.hasOwnProperty(this.#animation.target))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn AnimationType.hasOwnProperty(this.#animation.type);\n\t}\n\n\t#sendAnalytics()\n\t{\n\t\tif (this.#analytics && this.#analytics.hit)\n\t\t{\n\t\t\tconst clonedAnalytics = {...this.#analytics};\n\t\t\tdelete clonedAnalytics.hit;\n\n\t\t\tsendData(clonedAnalytics);\n\t\t}\n\t}\n}\n","import {Action} from \"../../../action\";\nimport {Text} from \"main.core\";\n\nexport const Logo = {\n\tprops: {\n\t\ttype: String,\n\t\taddIcon: String,\n\t\taddIconType: String,\n\t\ticon: String,\n\t\ticonType: String,\n\t\tbackgroundUrl: String,\n\t\tbackgroundSize: Number,\n\t\tinCircle: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\taction: Object,\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tcurrentIcon: this.icon,\n\t\t}\n\t},\n\tcomputed: {\n\t\tclassName(): string\n\t\t{\n\t\t\treturn [\n\t\t\t\t'crm-timeline__card-logo',\n\t\t\t\t`--${this.type}`, {\n\t\t\t\t'--clickable': this.action,\n\t\t\t\t}\n\t\t\t];\n\t\t},\n\n\t\ticonClassname()\n\t\t{\n\t\t\treturn [\n\t\t\t\t'crm-timeline__card-logo_icon',\n\t\t\t\t`--${this.currentIcon}`,\n\t\t\t\t{\n\t\t\t\t\t'--in-circle': this.inCircle,\n\t\t\t\t\t[`--type-${this.iconType}`]: !!this.iconType && !this.backgroundUrl,\n\t\t\t\t\t'--custom-bg': !!this.backgroundUrl,\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\n\t\taddIconClassname() {\n\t\t\treturn [\n\t\t\t\t'crm-timeline__card-logo_add-icon',\n\t\t\t\t`--type-${this.addIconType}`,\n\t\t\t\t`--icon-${this.addIcon}`\n\t\t\t]\n\t\t},\n\n\t\ticonInteriorStyle()\n\t\t{\n\t\t\tconst result = {};\n\n\t\t\tif (this.backgroundUrl)\n\t\t\t{\n\t\t\t\tresult.backgroundImage = 'url(' + encodeURI(Text.encode(this.backgroundUrl)) + ')';\n\t\t\t}\n\n\t\t\tif (this.backgroundSize)\n\t\t\t{\n\t\t\t\tresult.backgroundSize = parseInt(this.backgroundSize) + 'px';\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}\n\t},\n\twatch: {\n\t\ticon(newIcon): void\n\t\t{\n\t\t\tthis.currentIcon = newIcon;\n\t\t}\n\t},\n\tmethods: {\n\t\texecuteAction() {\n\t\t\tif (!this.action)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst action = new Action(this.action);\n\t\t\taction.execute(this);\n\t\t},\n\t\tsetIcon(icon: String) {\n\t\t\tthis.currentIcon = icon;\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div :class=\"className\" @click=\"executeAction\">\n\t\t\t<div class=\"crm-timeline__card-logo_content\">\n\t\t\t\t<div :class=\"iconClassname\">\n\t\t\t\t\t<i :style=\"iconInteriorStyle\"></i>\n\t\t\t\t</div>\n\t\t\t\t<div :class=\"addIconClassname\" v-if=\"addIcon\">\n\t\t\t\t\t<i></i>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n};\n","import { DatetimeConverter } from 'crm.timeline.tools';\nimport { DateTimeFormat } from 'main.date';\n\nexport const CalendarIcon = {\n\tprops: {\n\t\ttimestamp: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t\tdefault: 0,\n\t\t},\n\t\tcalendarEventId: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\n\tcomputed: {\n\t\tdate(): string\n\t\t{\n\t\t\treturn this.formatUserTime('d');\n\t\t},\n\t\tmonth(): string\n\t\t{\n\t\t\treturn this.formatUserTime('F');\n\t\t},\n\t\tdayWeek(): string\n\t\t{\n\t\t\treturn this.formatUserTime('D');\n\t\t},\n\t\ttime(): string\n\t\t{\n\t\t\treturn this.getDateTimeConverter().toTimeString();\n\t\t},\n\t\tuserTime(): Date\n\t\t{\n\t\t\treturn this.getDateTimeConverter().getValue();\n\t\t},\n\t\thasCalendarEventId(): boolean\n\t\t{\n\t\t\treturn (this.calendarEventId > 0);\n\t\t},\n\t},\n\n\tmethods: {\n\t\tgetDateTimeConverter(): DatetimeConverter\n\t\t{\n\t\t\treturn DatetimeConverter.createFromServerTimestamp(this.timestamp).toUserTime();\n\t\t},\n\t\tformatUserTime(format: string): string\n\t\t{\n\t\t\treturn DateTimeFormat.format(format, this.userTime);\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"crm-timeline__calendar-icon-container\">\n\t\t\t<div v-if=\"hasCalendarEventId\" class=\"crm-timeline__calendar-icon_event_icon\"></div>\n\t\t\t<div class=\"crm-timeline__calendar-icon\">\n\t\t\t\t<header class=\"crm-timeline__calendar-icon_top\">\n\t\t\t\t\t<div class=\"crm-timeline__calendar-icon_bullets\">\n\t\t\t\t\t\t<div class=\"crm-timeline__calendar-icon_bullet\"></div>\n\t\t\t\t\t\t<div class=\"crm-timeline__calendar-icon_bullet\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</header>\n\t\t\t\t<main class=\"crm-timeline__calendar-icon_content\">\n\t\t\t\t\t<div class=\"crm-timeline__calendar-icon_day\">{{ date }}</div>\n\t\t\t\t\t<div class=\"crm-timeline__calendar-icon_month\">{{ month }}</div>\n\t\t\t\t\t<div class=\"crm-timeline__calendar-icon_date\">\n\t\t\t\t\t\t<span class=\"crm-timeline__calendar-icon_day-week\">{{ dayWeek }}</span>\n\t\t\t\t\t\t<span class=\"crm-timeline__calendar-icon_time\">{{ time }}</span>\n\t\t\t\t\t</div>\n\t\t\t\t</main>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Text, Type } from 'main.core';\nimport { BitrixVue } from 'ui.vue3';\nimport { CalendarIcon } from './calendar-icon';\n\nimport { Logo } from './logo';\n\nexport const LogoCalendar = BitrixVue.cloneComponent(Logo, {\n\tcomponents: {\n\t\tCalendarIcon,\n\t},\n\n\tprops: {\n\t\ttimestamp: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t\tdefault: 0,\n\t\t},\n\t\taddIcon: String,\n\t\taddIconType: String,\n\t\tcalendarEventId: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t\tbackgroundColor: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\n\tcomputed: {\n\t\taddIconClassname(): string[]\n\t\t{\n\t\t\treturn [\n\t\t\t\t'crm-timeline__card-logo_add-icon',\n\t\t\t\t`--type-${this.addIconType}`,\n\t\t\t\t`--icon-${this.addIcon}`,\n\t\t\t];\n\t\t},\n\t\tlogoStyle(): Object\n\t\t{\n\t\t\tif (Type.isStringFilled(this.backgroundColor))\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\t'--crm-timeline__logo-background': Text.encode(this.backgroundColor),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {};\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div \n\t\t\t:class=\"className\"\n\t\t\t:style=\"logoStyle\"\n\t\t\t@click=\"executeAction\"\n\t\t>\n\t\t\t<div class=\"crm-timeline__card-logo_content\">\n\t\t\t\t<CalendarIcon :timestamp=\"timestamp\" :calendar-event-id=\"calendarEventId\" />\n\t\t\t\t<div :class=\"addIconClassname\" v-if=\"addIcon\">\n\t\t\t\t\t<i></i>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n});\n","import { Type } from 'main.core';\nimport { Logo } from './body/logo';\nimport { LogoCalendar } from './body/logo-calendar';\n\nexport const Body = {\n\tcomponents: {\n\t\tLogo,\n\t\tLogoCalendar,\n\t},\n\tprops: {\n\t\tlogo: Object,\n\t\tblocks: Object,\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tblockRefs: {},\n\t\t}\n\t},\n\tmounted() {\n\t\tconst blocks = this.$refs.blocks;\n\t\tif (!blocks || !this.visibleBlocks)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.visibleBlocks.forEach((block, index) => {\n\t\t\tif (Type.isDomNode(blocks[index].$el))\n\t\t\t{\n\t\t\t\tblocks[index].$el.setAttribute('data-id', block.id);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthrow new Error('Vue component \"' + block.rendererName + '\" was not found');\n\t\t\t}\n\t\t});\n\t},\n\tbeforeUpdate() {\n\t\tthis.blockRefs = {};\n\t},\n\tcomputed: {\n\t\tvisibleBlocks(): Array\n\t\t{\n\t\t\tif (!Type.isPlainObject(this.blocks))\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\treturn Object.keys(this.blocks)\n\t\t\t\t.map((id) => ({id, ...this.blocks[id]}))\n\t\t\t\t.filter((item) => (item.scope !== 'mobile'))\n\t\t\t\t.sort((a, b) => {\n\t\t\t\t\tlet aSort = a.sort === undefined ? 0 : a.sort\n\t\t\t\t\tlet bSort = b.sort === undefined ? 0 : b.sort\n\n\t\t\t\t\tif (aSort < bSort) {\n\t\t\t\t\t\treturn -1;\n\t\t\t\t\t}\n\t\t\t\t\tif (aSort > bSort) {\n\t\t\t\t\t\treturn  1;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn 0\n\t\t\t\t})\n\t\t\t;\n\t\t},\n\t\tcontentContainerClassname(): Array {\n\t\t\treturn [\n\t\t\t\t'crm-timeline__card-container', {\n\t\t\t\t'--without-logo': !this.logo,\n\t\t\t\t}\n\t\t\t];\n\t\t}\n\t},\n\tmethods: {\n\t\tgetContentBlockById(blockId: string): ?Object\n\t\t{\n\t\t\treturn this.blockRefs[blockId] ?? null;\n\t\t},\n\t\tgetLogo(): ?Object\n\t\t{\n\t\t\treturn this.$refs.logo;\n\t\t},\n\t\tsaveRef(ref: Object, id: string): void\n\t\t{\n\t\t\tthis.blockRefs[id] = ref;\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"crm-timeline__card-body\">\n\t\t\t<div v-if=\"logo\" class=\"crm-timeline__card-logo_container\">\n\t\t\t\t<LogoCalendar v-if=\"logo.icon === 'calendar'\" v-bind=\"logo\"></LogoCalendar>\n\t\t\t\t<Logo v-else v-bind=\"logo\" ref=\"logo\"></Logo>\n\t\t\t</div>\n\t\t\t<div :class=\"contentContainerClassname\">\n\t\t\t\t<div\n\t\t\t\t\tv-for=\"block in visibleBlocks\"\n\t\t\t\t\t:key=\"block.id\"\n\t\t\t\t\tclass=\"crm-timeline__card-container_block\"\n\t\t\t\t>\n\t\t\t\t\t<component\n\t\t\t\t\t\t:is=\"block.rendererName\"\n\t\t\t\t\t\tv-bind=\"block.properties\"\n\t\t\t\t\t\t:ref=\"(el) => this.saveRef(el, block.id)\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n};\n","export class ButtonScope {\n\tstatic MOBILE = 'mobile';\n}","export class ButtonState\n{\n\tstatic DEFAULT = '';\n\tstatic LOADING = 'loading';\n\tstatic DISABLED = 'disabled';\n\tstatic HIDDEN = 'hidden';\n\tstatic LOCKED = 'locked';\n\tstatic AI_LOADING = 'ai-loading';\n\tstatic AI_SUCCESS = 'ai-success';\n}\n","export class ButtonType {\n\tstatic ICON = 'icon';\n\tstatic PRIMARY = 'primary';\n\tstatic SECONDARY = 'secondary';\n\tstatic LIGHT = 'light';\n\tstatic AI = 'ai';\n}","import { Button as UIButton } from 'ui.buttons';\nimport { ButtonState } from '../enums/button-state';\nimport { Action } from '../../action';\n\nexport const BaseButton = {\n\tprops: {\n\t\tid: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\ttooltip: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tstate: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: ButtonState.DEFAULT,\n\t\t},\n\t\tprops: Object,\n\t\taction: Object,\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tcurrentState: this.state,\n\t\t};\n\t},\n\n\tcomputed: {\n\t\titemStateToButtonStateDict(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\t[ButtonState.LOADING]: UIButton.State.WAITING,\n\t\t\t\t[ButtonState.DISABLED]: UIButton.State.DISABLED,\n\t\t\t\t[ButtonState.AI_LOADING]: UIButton.State.AI_WAITING,\n\t\t\t};\n\t\t},\n\t},\n\n\tmethods: {\n\t\tsetDisabled(disabled: boolean): void\n\t\t{\n\t\t\tif (disabled)\n\t\t\t{\n\t\t\t\tthis.setButtonState(ButtonState.DISABLED);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.setButtonState(ButtonState.DEFAULT);\n\t\t\t}\n\t\t},\n\n\t\tsetLoading(loading: boolean): void\n\t\t{\n\t\t\tif (loading)\n\t\t\t{\n\t\t\t\tthis.setButtonState(ButtonState.LOADING);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.setButtonState(ButtonState.DEFAULT);\n\t\t\t}\n\t\t},\n\n\t\tsetButtonState(state): void\n\t\t{\n\t\t\tif (this.currentState !== state)\n\t\t\t{\n\t\t\t\tthis.currentState = state;\n\t\t\t}\n\t\t},\n\n\t\tonLayoutUpdated(): void\n\t\t{\n\t\t\tthis.setButtonState(this.state);\n\t\t},\n\n\t\texecuteAction(): void\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.action && this.currentState !== ButtonState.DISABLED\n\t\t\t\t&& this.currentState !== ButtonState.LOADING\n\t\t\t\t&& this.currentState !== ButtonState.AI_LOADING\n\t\t\t)\n\t\t\t{\n\t\t\t\tconst action = new Action(this.action);\n\n\t\t\t\taction.execute(this);\n\t\t\t}\n\t\t},\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.$Bitrix.eventEmitter.subscribe('layout:updated', this.onLayoutUpdated);\n\t},\n\n\tbeforeUnmount(): void\n\t{\n\t\tthis.$Bitrix.eventEmitter.unsubscribe('layout:updated', this.onLayoutUpdated);\n\t},\n\n\ttemplate: `<button></button>`,\n};\n","import { Type } from 'main.core';\n\nimport { ButtonState } from '../enums/button-state';\nimport { Menu } from './menu';\n\nexport class ButtonMenu extends Menu\n{\n\tconstructor(vueComponent: Object, menuItems: Array, menuOptions: ?Object)\n\t{\n\t\tsuper(vueComponent, menuItems, menuOptions);\n\n\t\tthis.#applyMenuItems();\n\t}\n\n\t/**\n\t * @override\n\t */\n\tcreateMenuItem(item: Object): Object\n\t{\n\t\tconst result = {\n\t\t\ttext: item.title,\n\t\t\tvalue: item.title,\n\t\t};\n\n\t\tif (Type.isStringFilled(item.state))\n\t\t{\n\t\t\tswitch (item.state)\n\t\t\t{\n\t\t\t\tcase ButtonState.AI_LOADING:\n\t\t\t\t\tresult.className = 'menu-popup-item-ai-loading menu-popup-item-disabled';\n\t\t\t\t\tbreak;\n\t\t\t\tcase ButtonState.AI_SUCCESS:\n\t\t\t\t\tresult.className = 'menu-popup-item-accept menu-popup-item-disabled';\n\t\t\t\t\tbreak;\n\t\t\t\tcase ButtonState.DISABLED:\n\t\t\t\t\tresult.className = 'menu-popup-no-icon menu-popup-item-disabled';\n\t\t\t\t\tbreak;\n\t\t\t\tcase ButtonState.LOCKED:\n\t\t\t\t\tresult.className = 'menu-popup-item-locked';\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tresult.className = '';\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isObject(item.action))\n\t\t{\n\t\t\tif (item.action.type === 'redirect')\n\t\t\t{\n\t\t\t\tresult.href = item.action.value;\n\t\t\t}\n\t\t\telse if (item.action.type === 'jsCode')\n\t\t\t{\n\t\t\t\tresult.onclick = item.action.value;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.onclick = () => {\n\t\t\t\t\tvoid this.onMenuItemClick(item);\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#applyMenuItems(): void\n\t{\n\t\tconst items = this.getMenuItems();\n\t\tif (!items)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst emptyClassItems = items.filter((item: Object) => item.className === '');\n\t\tif (emptyClassItems.length === items.length)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\titems.forEach((item: Object) => {\n\t\t\tif (item.className === '')\n\t\t\t{\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\titem.className = 'menu-popup-empty-icon';\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic showMenu(vueComponent: Object, menuItems: Array, menuOptions: ?Object): void\n\t{\n\t\tconst menu = new ButtonMenu(vueComponent, menuItems, menuOptions);\n\n\t\tmenu.show();\n\t}\n}\n","import { BitrixVue } from 'ui.vue3';\nimport { Text, Type } from 'main.core';\nimport {\n\tButton as UIButton,\n\tButtonOptions,\n\tButtonState as UIButtonState,\n\tSplitButton as UISplitButton,\n} from 'ui.buttons';\n\nimport { BaseButton } from './baseButton';\nimport { ButtonType } from '../enums/button-type';\nimport { ButtonState } from '../enums/button-state';\nimport { ButtonMenu } from './button-menu';\n\nimport 'ui.hint';\n\nexport const Button = BitrixVue.cloneComponent(BaseButton, {\n\tprops: {\n\t\ttype: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: ButtonType.SECONDARY,\n\t\t},\n\t\ticonName: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tsize: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: 'extra_small',\n\t\t},\n\t\tmenuItems: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tpopup: null,\n\t\t\tuiButton: Object.freeze(null),\n\t\t\ttimerSecondsRemaining: 0,\n\t\t\tcurrentState: this.state,\n\t\t\thintText: Type.isStringFilled(this.tooltip) ? Text.encode(this.tooltip) : '',\n\t\t};\n\t},\n\n\tcomputed:\n\t{\n\t\titemTypeToButtonColorDict(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\t[ButtonType.PRIMARY]: UIButton.Color.PRIMARY,\n\t\t\t\t[ButtonType.SECONDARY]: UIButton.Color.LIGHT_BORDER,\n\t\t\t\t[ButtonType.LIGHT]: UIButton.Color.LIGHT,\n\t\t\t\t[ButtonType.ICON]: UIButton.Color.LINK,\n\t\t\t\t[ButtonType.AI]: UIButton.Color.AI,\n\t\t\t};\n\t\t},\n\n\t\tbuttonContainerRef(): HTMLElement | undefined\n\t\t{\n\t\t\treturn this.$refs.buttonContainer;\n\t\t},\n\t},\n\n\tmethods:\n\t{\n\t\tgetButtonOptions(): ButtonOptions\n\t\t{\n\t\t\tconst upperCaseIconName = Type.isString(this.iconName) ? this.iconName.toUpperCase() : '';\n\t\t\tconst upperCaseButtonSize = Type.isString(this.size) ? this.size.toUpperCase() : 'extra_small';\n\t\t\tconst btnColor = this.itemTypeToButtonColorDict[this.type] || UIButton.Color.LIGHT_BORDER;\n\t\t\tconst titleText = this.type === ButtonType.ICON ? '' : this.title;\n\n\t\t\treturn {\n\t\t\t\tid: this.id,\n\t\t\t\tround: true,\n\t\t\t\tdependOnTheme: false,\n\t\t\t\tsize: UIButton.Size[upperCaseButtonSize],\n\t\t\t\ttext: titleText,\n\t\t\t\tcolor: btnColor,\n\t\t\t\tstate: this.itemStateToButtonStateDict[this.currentState],\n\t\t\t\ticon: UIButton.Icon[upperCaseIconName],\n\t\t\t\tprops: Type.isPlainObject(this.props) ? this.props : {},\n\t\t\t};\n\t\t},\n\n\t\tgetUiButton(): ?UIButton\n\t\t{\n\t\t\treturn this.uiButton;\n\t\t},\n\n\t\tdisableWithTimer(sec: number)\n\t\t{\n\t\t\tthis.setButtonState(ButtonState.DISABLED);\n\t\t\tconst btn = this.getUiButton();\n\t\t\tlet remainingSeconds = sec;\n\n\t\t\tbtn.setText(this.formatSeconds(remainingSeconds));\n\n\t\t\tconst timer = setInterval(() => {\n\t\t\t\tif (remainingSeconds < 1)\n\t\t\t\t{\n\t\t\t\t\tclearInterval(timer);\n\t\t\t\t\tbtn.setText(this.title);\n\n\t\t\t\t\tthis.setButtonState(ButtonState.DEFAULT);\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tremainingSeconds--;\n\t\t\t\tbtn.setText(this.formatSeconds(remainingSeconds));\n\t\t\t}, 1000);\n\t\t},\n\n\t\tformatSeconds(sec: number): string\n\t\t{\n\t\t\tconst minutes = Math.floor(sec / 60);\n\t\t\tconst seconds = sec % 60;\n\n\t\t\tconst formatMinutes = this.formatNumber(minutes);\n\t\t\tconst formatSeconds = this.formatNumber(seconds);\n\n\t\t\treturn `${formatMinutes}:${formatSeconds}`;\n\t\t},\n\n\t\tformatNumber(num: number): string\n\t\t{\n\t\t\treturn num < 10 ? `0${num}` : num;\n\t\t},\n\n\t\tsetButtonState(state): void\n\t\t{\n\t\t\tthis.parentSetButtonState(state);\n\t\t\tthis.getUiButton()?.setState(this.itemStateToButtonStateDict[this.currentState] ?? null);\n\t\t},\n\n\t\tcreateSplitButton(): UISplitButton\n\t\t{\n\t\t\tconst menuItems = Object.keys(this.menuItems).map((key) => this.menuItems[key]);\n\t\t\tconst options = this.getButtonOptions();\n\t\t\tconst showMenu = () => {\n\t\t\t\tButtonMenu.showMenu(\n\t\t\t\t\tthis,\n\t\t\t\t\tmenuItems,\n\t\t\t\t\t{\n\t\t\t\t\t\tid: `split-button-menu-${this.id}`,\n\t\t\t\t\t\tclassName: 'crm-timeline__split-button-menu',\n\t\t\t\t\t\twidth: 250,\n\t\t\t\t\t\tangle: true,\n\t\t\t\t\t\tcacheable: false,\n\t\t\t\t\t\toffsetLeft: 13,\n\t\t\t\t\t\tbindElement: this.$el.querySelector('.ui-btn-menu'),\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t};\n\n\t\t\toptions.menuButton = {\n\t\t\t\tonclick: (element, event: PointerEvent) => {\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tshowMenu();\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tif (options.state === UIButtonState.DISABLED)\n\t\t\t{\n\t\t\t\toptions.mainButton = {\n\t\t\t\t\tonclick: (element, event: PointerEvent) => {\n\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\tshowMenu();\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn new UISplitButton(options);\n\t\t},\n\n\t\trenderButton(): void\n\t\t{\n\t\t\tif (!this.buttonContainerRef)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.buttonContainerRef.innerHTML = '';\n\n\t\t\tconst button = this.menuItems\n\t\t\t\t? this.createSplitButton()\n\t\t\t\t: new UIButton(this.getButtonOptions())\n\t\t\t;\n\n\t\t\tbutton.renderTo(this.buttonContainerRef);\n\n\t\t\tthis.uiButton = button;\n\t\t},\n\n\t\tsetTooltip(tooltip: string): void\n\t\t{\n\t\t\tthis.hintText = tooltip;\n\t\t},\n\n\t\tshowTooltip(): void\n\t\t{\n\t\t\tif (this.hintText === '')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tBX.UI.Hint.show(\n\t\t\t\tthis.$el,\n\t\t\t\tthis.hintText,\n\t\t\t\ttrue,\n\t\t\t);\n\t\t},\n\n\t\thideTooltip(): void\n\t\t{\n\t\t\tif (this.hintText === '')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tBX.UI.Hint.hide(this.$el);\n\t\t},\n\n\t\tisInViewport(): boolean\n\t\t{\n\t\t\tconst rect = this.$el.getBoundingClientRect();\n\n\t\t\treturn (\n\t\t\t\trect.top >= 0\n\t\t\t\t&& rect.left >= 0\n\t\t\t\t&& rect.bottom <= (window.innerHeight || document.documentElement.clientHeight)\n\t\t\t\t&& rect.right <= (window.innerWidth || document.documentElement.clientWidth)\n\t\t\t);\n\t\t},\n\n\t\tisPropEqual(propName: string, value: any): boolean\n\t\t{\n\t\t\treturn this.getButtonOptions().props[propName] === value;\n\t\t},\n\t},\n\n\twatch: {\n\t\tstate(newValue): void\n\t\t{\n\t\t\tthis.setButtonState(newValue);\n\t\t},\n\n\t\ttooltip(newValue): void\n\t\t{\n\t\t\tthis.hintText = Type.isStringFilled(newValue)\n\t\t\t\t? Text.encode(newValue)\n\t\t\t\t: ''\n\t\t\t;\n\t\t},\n\t},\n\n\tmounted(): void\n\t{\n\t\tthis.renderButton();\n\t},\n\n\tupdated(): void\n\t{\n\t\tthis.renderButton();\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t\t:class=\"$attrs.class\"\n\t\t\tref=\"buttonContainer\"\n\t\t\t@click=\"executeAction\"\n\t\t\t@mouseover=\"showTooltip\"\n\t\t\t@mouseleave=\"hideTooltip\"\n\t\t>\n\t\t</div>\n\t`,\n});\n","import {ButtonState} from \"../../enums/button-state\";\nimport {BitrixVue} from 'ui.vue3';\nimport {BaseButton} from '../baseButton';\nimport {Loader} from 'main.loader';\n\nexport const AdditionalButtonIcon = Object.freeze({\n\tNOTE: 'note',\n\tSCRIPT: 'script',\n\tPRINT: 'print',\n\tDOTS: 'dots',\n});\n\nexport const AdditionalButtonColor = Object.freeze({\n\tDEFAULT: 'default',\n\tPRIMARY: 'primary',\n});\n\nexport const AdditionalButton = BitrixVue.cloneComponent(BaseButton, {\n\tprops: {\n\t\ticonName: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t\tvalidator(value: string): boolean {\n\t\t\t\treturn Object.values(AdditionalButtonIcon).indexOf(value) > -1;\n\t\t\t},\n\t\t},\n\t\tcolor: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: AdditionalButtonColor.DEFAULT,\n\t\t\tvalidator(value: string)\n\t\t\t{\n\t\t\t\treturn Object.values(AdditionalButtonColor).indexOf(value) > -1;\n\t\t\t},\n\t\t},\n\t},\n\n\tcomputed: {\n\t\tclassName(): Array {\n\t\t\treturn [\n\t\t\t\t'crm-timeline__card_add-button', {\n\t\t\t\t\t[`--icon-${this.iconName}`]: this.iconName,\n\t\t\t\t\t[`--color-${this.color}`]: this.color,\n\t\t\t\t\t[`--state-${this.currentState}`]: this.currentState,\n\t\t\t\t},\n\t\t\t]\n\t\t},\n\n\t\tButtonState(): ButtonState {\n\t\t\treturn ButtonState;\n\t\t},\n\n\t\tloaderHtml(): string {\n\t\t\tconst loader = new Loader({\n\t\t\t\tmode: 'inline',\n\t\t\t\tsize: 20,\n\t\t\t});\n\n\t\t\tloader.show();\n\t\t\treturn loader.layout.outerHTML;\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<transition name=\"crm-timeline__card_add-button-fade\" mode=\"out-in\">\n\t\t\t<div\n\t\t\t\tv-if=\"currentState === ButtonState.LOADING\"\n\t\t\t\tv-html=\"loaderHtml\"\n\t\t\t\tclass=\"crm-timeline__card_add-button\"\n\t\t\t></div>\n\t\t\t<div\n\t\t\t\tv-else\n\t\t\t\t:title=\"title\"\n\t\t\t\t@click=\"executeAction\"\n\t\t\t\t:class=\"className\">\n\t\t\t</div>\n\t\t</transition>\n\t`\n});","import {Button} from '../button';\n\nexport const Buttons = {\n\tcomponents: {\n\t\tButton,\n\t},\n\tprops: {\n\t\titems: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: () => [],\n\t\t},\n\t},\n\tmethods: {\n\t\tgetButtonById(buttonId: string): ?Object\n\t\t{\n\t\t\tconst buttons = this.$refs.buttons;\n\n\t\t\treturn this.items.reduce((found, button, index) =>\n\t\t\t{\n\t\t\t\tif (found)\n\t\t\t\t{\n\t\t\t\t\treturn found;\n\t\t\t\t}\n\t\t\t\tif (button.id === buttonId)\n\t\t\t\t{\n\t\t\t\t\treturn buttons[index];\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t}, null);\n\t\t},\n\t},\n\ttemplate:\n\t\t`\n\t\t\t<div class=\"crm-timeline__card-action_buttons\">\n\t\t\t\t<Button class=\"crm-timeline__card-action-btn\" v-for=\"item in items\" v-bind=\"item\" ref=\"buttons\" />\n\t\t\t</div>\n\t\t`\n};\n","import {MenuManager} from \"main.popup\";\nimport {Menu as LayoutMenu} from \"../../layout/menu\";\nconst MenuId = 'timeline-more-button-menu';\nimport {AdditionalButton, AdditionalButtonColor, AdditionalButtonIcon} from './add-button';\n\nexport const Menu = {\n\tcomponents: {\n\t\tAdditionalButton,\n\t},\n\tprops: {\n\t\tbuttons: Array, // buttons that didn't fit into footer\n\t\titems: Object, // real menu items\n\t},\n\tinject: [\n\t\t'isReadOnly',\n\t],\n\tcomputed: {\n\t\tisMenuFilled(): boolean\n\t\t{\n\t\t\tconst menuItems = this.menuItems;\n\n\t\t\treturn menuItems.length > 0;\n\t\t},\n\n\t\titemsArray(): Array\n\t\t{\n\t\t\tif (!this.items)\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\treturn Object.values(this.items)\n\t\t\t\t.filter((item) => (item.state !== 'hidden' && item.scope !== 'mobile' && (!this.isReadOnly || !item.hideIfReadonly)))\n\t\t\t\t.sort((a, b) => (a.sort - b.sort))\n\t\t\t;\n\t\t},\n\n\t\tmenuItems(): Array\n\t\t{\n\t\t\tlet result = this.buttons;\n\t\t\tif (this.buttons.length && this.itemsArray.length)\n\t\t\t{\n\t\t\t\tresult.push({delimiter: true});\n\t\t\t}\n\t\t\tresult = [...result, ...this.itemsArray];\n\n\t\t\treturn result;\n\t\t},\n\n\t\tbuttonProps()\n\t\t{\n\t\t\treturn {\n\t\t\t\tcolor: AdditionalButtonColor.DEFAULT,\n\t\t\t\ticon: AdditionalButtonIcon.DOTS,\n\t\t\t}\n\t\t},\n\t},\n\n\tbeforeUnmount(): void\n\t{\n\t\tconst menu = MenuManager.getMenuById(MenuId);\n\t\tif (menu)\n\t\t{\n\t\t\tmenu.destroy();\n\t\t}\n\t},\n\n\tmethods: {\n\t\tshowMenu(): void\n\t\t{\n\t\t\tLayoutMenu.showMenu(\n\t\t\t\tthis,\n\t\t\t\tthis.menuItems,\n\t\t\t\t{\n\t\t\t\t\tid: MenuId,\n\t\t\t\t\tclassName: 'crm-timeline__card_more-menu',\n\t\t\t\t\twidth: 230,\n\t\t\t\t\tangle: false,\n\t\t\t\t\tcacheable: false,\n\t\t\t\t\tbindElement: this.$el,\n\t\t\t\t}\n\t\t\t);\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div v-if=\"isMenuFilled\" class=\"crm-timeline__card-action_menu-item\" @click=\"showMenu\">\n\t\t\t<AdditionalButton iconName=\"dots\" color=\"default\"></AdditionalButton>\n\t\t</div>\n\t`\n};\n","import { Type } from 'main.core';\nimport { ButtonScope } from '../enums/button-scope';\nimport { ButtonState } from '../enums/button-state';\nimport { ButtonType } from '../enums/button-type';\nimport { Button } from './button';\nimport { AdditionalButton } from './footer/add-button';\nimport { Buttons } from './footer/buttons';\nimport { Menu } from './footer/menu';\n\nexport const Footer = {\n\tcomponents: {\n\t\tButtons,\n\t\tMenu,\n\t\tButton,\n\t\tAdditionalButton,\n\t},\n\tprops: {\n\t\tbuttons: Object,\n\t\tmenu: Object,\n\t\tadditionalButtons: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: () => ({}),\n\t\t},\n\t\tmaxBaseButtonsCount: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t\tdefault: 3,\n\t\t},\n\n\t},\n\tinject: [\n\t\t'isReadOnly',\n\t],\n\tcomputed: {\n\t\tcontainerClassname(): Array {\n\t\t\treturn [\n\t\t\t\t'crm-timeline__card-action', {\n\t\t\t\t'--no-margin-top': this.baseButtons.length < 1,\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\tbaseButtons(): Array\n\t\t{\n\t\t\treturn this.visibleAndSortedButtons.slice(0, this.maxBaseButtonsCount);\n\t\t},\n\n\t\tmoreButtons(): Array\n\t\t{\n\t\t\treturn this.visibleAndSortedButtons.slice(this.maxBaseButtonsCount);\n\t\t},\n\n\n\t\tvisibleAndSortedButtons() {\n\t\t\treturn this.visibleButtons.sort(this.buttonsSorter);\n\t\t},\n\n\t\tvisibleAndSortedAdditionalButtons() {\n\t\t\treturn this.visibleAdditionalButtons.sort(this.buttonsSorter);\n\t\t},\n\n\t\tvisibleButtons(): Array\n\t\t{\n\t\t\tif (!Type.isPlainObject(this.buttons))\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\treturn this.buttons\n\t\t\t\t?  Object.keys(this.buttons)\n\t\t\t\t\t.map((id) => ({id, ...this.buttons[id]}))\n\t\t\t\t\t.filter(this.visibleButtonsFilter)\n\t\t\t\t: [];\n\t\t},\n\n\t\tvisibleAdditionalButtons(): Array {\n\t\t\treturn this.additionalButtonsArray\n\t\t\t\t? Object.values(this.additionalButtonsArray).filter(this.visibleButtonsFilter)\n\t\t\t\t: [];\n\t\t},\n\n\t\tadditionalButtonsArray() {\n\t\t\treturn Object.entries(this.additionalButtons).map(([id, button]) => {\n\t\t\t\treturn {id, type: ButtonType.ICON, ...button};\n\t\t\t});\n\t\t},\n\n\t\thasMenu(): boolean\n\t\t{\n\t\t\treturn this.moreButtons.length || (Type.isPlainObject(this.menu) && Object.keys(this.menu).length);\n\t\t},\n\t},\n\tmethods: {\n\t\tvisibleButtonsFilter(buttonItem) {\n\t\t\treturn buttonItem.state !== ButtonState.HIDDEN\n\t\t\t\t&& buttonItem.scope !== ButtonScope.MOBILE\n\t\t\t\t&& (!this.isReadOnly || !buttonItem.hideIfReadonly);\n\t\t},\n\n\t\tbuttonsSorter(buttonA, buttonB) {\n\t\t\treturn buttonA?.sort - buttonB?.sort;\n\t\t},\n\n\t\tgetButtonById(buttonId: string): ?Object\n\t\t{\n\t\t\tif (this.$refs.buttons)\n\t\t\t{\n\t\t\t\tconst foundButton = this.$refs.buttons.getButtonById(buttonId);\n\t\t\t\tif (foundButton)\n\t\t\t\t{\n\t\t\t\t\treturn foundButton;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.$refs.additionalButtons)\n\t\t\t{\n\t\t\t\treturn this.visibleAndSortedAdditionalButtons.reduce((found, button, index) =>\n\t\t\t\t{\n\t\t\t\t\tif (found)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn found;\n\t\t\t\t\t}\n\t\t\t\t\tif (button.id === buttonId)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn buttons[index];\n\t\t\t\t\t}\n\n\t\t\t\t\treturn null;\n\t\t\t\t}, null);\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\n\t\tgetMenu(): ?Object\n\t\t{\n\t\t\tif (this.$refs.menu)\n\t\t\t{\n\t\t\t\treturn this.$refs.menu;\n\t\t\t}\n\n\t\t\treturn null;\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div :class=\"containerClassname\">\n\t\t\t<div class=\"crm-timeline__card-action_menu\">\n\t\t\t\t<div\n\t\t\t\t\tv-for=\"button in visibleAndSortedAdditionalButtons\"\n\t\t\t\t\t:key=\"button.id\"\n\t\t\t\t\tclass=\"crm-timeline__card-action_menu-item\"\n\t\t\t\t>\n\t\t\t\t\t<additional-button\n\t\t\t\t\t\tv-bind=\"button\"\n\t\t\t\t\t>\n\t\t\t\t\t</additional-button>\n\t\t\t\t</div>\n\t\t\t\t<Menu v-if=\"hasMenu\" :buttons=\"moreButtons\" v-bind=\"menu\" ref=\"menu\"/>\n\t\t\t</div>\n\t\t\t<Buttons ref=\"buttons\" :items=\"baseButtons\" />\n\t\t</div>\n\t`\n};\n","import { Action } from \"../../../action\";\n\nexport const ChangeStreamButton = {\n\tprops: {\n\t\tdisableIfReadonly: Boolean,\n\t\ttype: String,\n\t\ttitle: String,\n\t\taction: Object,\n\t},\n\tdata(): Object {\n\t\treturn {\n\t\t\tisReadonlyMode: false,\n\t\t\tisComplete: false,\n\t\t}\n\t},\n\tinject: [\n\t\t'isReadOnly',\n\t],\n\tmounted()\n\t{\n\t\tthis.isReadonlyMode = this.isReadOnly;\n\t},\n\tcomputed: {\n\t\tisShowPinButton() {\n\t\t\treturn this.type === 'pin' && !this.isReadonlyMode;\n\t\t},\n\n\t\tisShowUnpinButton() {\n\t\t\treturn this.type==='unpin' && !this.isReadonlyMode;\n\t\t},\n\t},\n\tmethods: {\n\t\texecuteAction() {\n\t\t\tif (!this.action)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isComplete = true;\n\n\t\t\tconst action = new Action(this.action);\n\t\t\taction.execute(this)\n\t\t\t\t.then(() => {})\n\t\t\t\t.catch(() => {\n\t\t\t\t\tthis.isComplete = false;\n\t\t\t\t})\n\t\t\t;\n\t\t},\n\t\tonClick(): void\n\t\t{\n\t\t\tif (this.action)\n\t\t\t{\n\t\t\t\tconst action = new Action(this.action);\n\t\t\t\taction.execute(this);\n\t\t\t}\n\t\t},\n\t\tsetDisabled(disabled: boolean)\n\t\t{\n\t\t\tif (!this.isReadonly && !disabled)\n\t\t\t{\n\t\t\t\tthis.isReadonlyMode = false;\n\t\t\t}\n\t\t\tif (disabled)\n\t\t\t{\n\t\t\t\tthis.isReadonlyMode = true;\n\t\t\t}\n\t\t},\n\t\tmarkCheckboxUnchecked(): void\n\t\t{\n\t\t\tthis.isComplete = false;\n\t\t}\n\t},\n\n\ttemplate: `\n\t\t<div class=\"crm-timeline__card-top_controller\">\n\t\t\t<input\n\t\t\t\tv-if=\"type === 'complete'\"\n\t\t\t\t@click=\"executeAction\"\n\t\t\t\ttype=\"checkbox\"\n\t\t\t\t:disabled=\"isReadonlyMode\"\n\t\t\t\t:checked=\"isComplete\"\n\t\t\t\tclass=\"crm-timeline__card-top_checkbox\"\n\t\t\t/>\n\t\t\t<div\n\t\t\t\tv-else-if=\"isShowPinButton\"\n\t\t\t\t:title=\"title\"\n\t\t\t\t@click=\"executeAction\"\n\t\t\t\tclass=\"crm-timeline__card-top_icon --pin\"\n\t\t\t></div>\n\t\t\t<div\n\t\t\t\tv-else-if=\"isShowUnpinButton\"\n\t\t\t\t:title=\"title\"\n\t\t\t\t@click=\"executeAction\"\n\t\t\t\tclass=\"crm-timeline__card-top_icon --unpin\"\n\t\t\t></div>\n\t\t</div>\n\t`,\n};\n","import { ColorSelector as ColorSelectorPopup, ColorSelectorEvents } from 'crm.field.color-selector';\nimport { EventEmitter } from 'main.core.events';\nimport { hint } from 'ui.vue3.directives.hint';\nimport { Action } from '../../../action';\n\nexport const ColorSelector = {\n\tdirectives: { hint },\n\n\tprops: {\n\t\tvaluesList: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tselectedValueId: {\n\t\t\ttype: String,\n\t\t\tdefault: 'default',\n\t\t},\n\t\treadOnlyMode: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tcurrentValueId: this.selectedValueId,\n\t\t};\n\t},\n\n\tmethods: {\n\t\tgetValue(): Array\n\t\t{\n\t\t\treturn this.currentValueId;\n\t\t},\n\t\tsetValue(value: string): void\n\t\t{\n\t\t\tthis.currentValueId = value;\n\n\t\t\tif (this.itemSelector)\n\t\t\t{\n\t\t\t\tthis.itemSelector.setValue(value);\n\t\t\t}\n\t\t},\n\t\tonItemSelectorValueChange({ data }): void\n\t\t{\n\t\t\tconst valueId = data.value;\n\n\t\t\tif (this.currentValueId !== valueId)\n\t\t\t{\n\t\t\t\tthis.currentValueId = valueId;\n\n\t\t\t\tthis.emitEvent('ColorSelector:Change', { colorId: valueId });\n\t\t\t}\n\t\t},\n\n\t\temitEvent(eventName: string, actionParams: Object): void\n\t\t{\n\t\t\tconst action = new Action({\n\t\t\t\ttype: 'jsEvent',\n\t\t\t\tvalue: eventName,\n\t\t\t\tactionParams,\n\t\t\t});\n\n\t\t\taction.execute(this);\n\t\t},\n\t},\n\n\tmounted(): void\n\t{\n\t\tvoid this.$nextTick(() => {\n\t\t\tthis.itemSelector = new ColorSelectorPopup({\n\t\t\t\ttarget: this.$refs.itemSelectorRef,\n\t\t\t\tcolorList: this.valuesList,\n\t\t\t\tselectedColorId: this.currentValueId,\n\t\t\t\treadOnlyMode: this.readOnlyMode,\n\t\t\t});\n\n\t\t\tif (!this.readOnlyMode)\n\t\t\t{\n\t\t\t\tEventEmitter.subscribe(\n\t\t\t\t\tthis.itemSelector,\n\t\t\t\t\tColorSelectorEvents.EVENT_COLORSELECTOR_VALUE_CHANGE,\n\t\t\t\t\tthis.onItemSelectorValueChange,\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\t},\n\n\tcomputed: {\n\t\thint(): ?Object\n\t\t{\n\t\t\tif (this.readOnlyMode)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttext: this.$Bitrix.Loc.getMessage('CRM_ACTIVITY_TODO_COLOR_SELECTOR_HINT'),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tangle: {\n\t\t\t\t\t\toffset: 30,\n\t\t\t\t\t\tposition: 'top',\n\t\t\t\t\t},\n\t\t\t\t\toffsetTop: 2,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"crm-activity__todo-editor-v2_color-selector\">\n\t\t\t<div ref=\"itemSelectorRef\" v-hint=\"hint\"></div>\n\t\t</div>\n\t`,\n};\n","import { DatetimeConverter } from 'crm.timeline.tools';\n\nexport const FormatDate = {\n\tname: 'FormatDate',\n\tprops: {\n\t\ttimestamp: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t\tdefault: 0,\n\t\t},\n\n\t\tdatePlaceholder: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\n\t\tuseShortTimeFormat: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\n\t\tclass: {\n\t\t\ttype: [Array, Object, String],\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t}\n\t},\n\tcomputed: {\n\t\tformattedDate() {\n\t\t\tif (!this.timestamp)\n\t\t\t{\n\t\t\t\treturn this.datePlaceholder;\n\t\t\t}\n\t\t\tconst converter = DatetimeConverter.createFromServerTimestamp(this.timestamp).toUserTime();\n\n\t\t\treturn this.useShortTimeFormat ? converter.toTimeString() : converter.toDatetimeString({delimiter: ', '});\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div :class=\"$props.class\">{{ formattedDate }}</div>\n\t`\n}","import { Popup, PopupOptions } from 'main.popup';\nimport {Event, Runtime, Dom} from 'main.core';\nimport { Action } from '../../../action';\n\nexport const Hint = {\n\tdata(): Object {\n\t\treturn {\n\t\t\tisMouseOnHintArea: false,\n\t\t\thintPopup: null,\n\t\t}\n\t},\n\tprops: {\n\t\ticon: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\ttextBlocks: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: [],\n\t\t},\n\t},\n\tcomputed: {\n\t\thintContentIcon(): ?HTMLElement {\n\t\t\tif (this.icon === '')\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst iconElement = Dom.create('i');\n\n\t\t\treturn Dom.create('div', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassname: this.hintContentIconClassname,\n\t\t\t\t},\n\t\t\t\tchildren: [iconElement],\n\t\t\t});\n\t\t},\n\n\t\thintContentText(): HTMLElement {\n\t\t\treturn Dom.create('div', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassname: 'crm-timeline__hint_popup-content-text',\n\t\t\t\t},\n\t\t\t\tchildren: this.hintContentTextBlocks,\n\t\t\t});\n\t\t},\n\n\t\thintContentTextBlocks(): HTMLElement[] {\n\t\t\treturn this.textBlocks.map(this.getContentBlockNode);\n\t\t},\n\n\t\thintContentIconClassname(): string {\n\t\t\tconst baseClassname = 'crm-timeline__hint_popup-content-icon';\n\t\t\treturn `${baseClassname} --${this.icon}`;\n\t\t},\n\n\t\thintIconClassname(): Array {\n\t\t\treturn [\n\t\t\t\t'ui-hint',\n\t\t\t\t'crm-timeline__header-hint', {\n\t\t\t\t'--active': this.hintPopup,\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\n\t\thasContent(): boolean {\n\t\t\treturn this.textBlocks.length > 0;\n\t\t},\n\t},\n\tmethods: {\n\t\tgetHintContent(): HTMLElement {\n\t\t\treturn Dom.create('div', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassname: 'crm-timeline__hint_popup-content'\n\t\t\t\t},\n\t\t\t\tstyle: {\n\t\t\t\t\tdisplay: 'flex',\n\t\t\t\t},\n\t\t\t\tchildren: [this.hintContentIcon, this.hintContentText],\n\t\t\t});\n\t\t},\n\n\t\tgetPopupOptions(): PopupOptions {\n\t\t\treturn {\n\t\t\t\tdarkMode: true,\n\t\t\t\tautoHide: false,\n\t\t\t\tcontent: this.getHintContent(),\n\t\t\t\tmaxWidth: 400,\n\t\t\t\tbindOptions: {\n\t\t\t\t\tposition: 'top',\n\t\t\t\t},\n\t\t\t\tanimation: 'fading-slide',\n\t\t\t}\n\t\t},\n\n\t\tgetPopupPosition(): {left: number, right: number} {\n\t\t\tconst hintElem = this.$refs.hint;\n\t\t\tconst defaultAngleLeftOffset = Popup.getOption('angleLeftOffset');\n\t\t\tconst { width: hintWidth, left: hintLeftOffset, top: hintTopOffset } = Dom.getPosition(hintElem);\n\t\t\tconst { width: popupWidth } = Dom.getPosition(this.hintPopup?.getPopupContainer());\n\t\t\treturn {\n\t\t\t\tleft: hintLeftOffset + defaultAngleLeftOffset - (popupWidth - hintWidth) / 2,\n\t\t\t\ttop: hintTopOffset + 15,\n\t\t\t}\n\t\t},\n\n\t\tgetPopupAngleOffset(popupContainer: HTMLElement): number {\n\t\t\tconst angleWidth = 33;\n\t\t\tconst { width: popupWidth } = Dom.getPosition(popupContainer);\n\t\t\treturn (popupWidth - angleWidth) / 2;\n\t\t},\n\n\t\tonMouseEnterToPopup(): void {\n\t\t\tthis.isMouseOnHintArea = true;\n\t\t},\n\n\t\tonHintAreaMouseLeave(): void {\n\t\t\tthis.isMouseOnHintArea = false;\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (!this.isMouseOnHintArea)\n\t\t\t\t{\n\t\t\t\t\tthis.hideHintPopup();\n\t\t\t\t}\n\t\t\t}, 400);\n\t\t},\n\n\t\tonMouseEnterToHint(): void {\n\t\t\tthis.isMouseOnHintArea = true;\n\t\t\tthis.showHintPopupWithDebounce();\n\t\t},\n\n\t\tshowHintPopup(): void {\n\t\t\tif (!this.isMouseOnHintArea || this.hintPopup && this.hintPopup.isShown())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.hintPopup = new Popup(this.getPopupOptions());\n\t\t\tconst popupContainer = this.hintPopup.getPopupContainer();\n\t\t\tEvent.bind(popupContainer, 'mouseenter', this.onMouseEnterToPopup);\n\t\t\tEvent.bind(popupContainer, 'mouseleave', this.onHintAreaMouseLeave);\n\t\t\tthis.hintPopup.show();\n\t\t\tthis.hintPopup.setBindElement(this.getPopupPosition());\n\t\t\tthis.hintPopup.setAngle(false);\n\t\t\tthis.hintPopup.setAngle({offset: this.getPopupAngleOffset(popupContainer, this.$refs.hint)});\n\t\t\tthis.hintPopup.adjustPosition();\n\t\t\tthis.hintPopup.show();\n\t\t},\n\n\t\tshowHintPopupWithDebounce() {\n\t\t\tRuntime.debounce(this.showHintPopup, 300, this)();\n\t\t},\n\n\t\thideHintPopup(): void {\n\t\t\tif (!this.hintPopup)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.hintPopup.close();\n\t\t\tconst popupContainer = this.hintPopup.getPopupContainer();\n\t\t\tEvent.unbind(popupContainer, 'mouseenter', this.onMouseEnterToPopup);\n\t\t\tEvent.unbind(popupContainer, 'mouseleave', this.onHintAreaMouseLeave);\n\t\t\tthis.hintPopup.destroy();\n\t\t\tthis.hintPopup = null;\n\t\t},\n\n\t\thideHintPopupWithDebounce(): void {\n\t\t\treturn Runtime.debounce(this.hideHintPopup, 300, this);\n\t\t},\n\n\t\tgetContentBlockNode(contentBlock): HTMLElement | null {\n\t\t\tif (contentBlock.type === 'text')\n\t\t\t{\n\t\t\t\treturn this.getTextNode(contentBlock.options);\n\t\t\t}\n\t\t\telse if (contentBlock.type === 'link')\n\t\t\t{\n\t\t\t\treturn this.getLinkNode(contentBlock.options);\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\n\t\tgetTextNode(textOptions = {}): HTMLElement {\n\t\t\treturn Dom.create('span', {text: textOptions.text});\n\t\t},\n\n\t\tgetLinkNode(linkOptions = {}): HTMLElement {\n\t\t\tconst link = Dom.create('span', {text: linkOptions.text});\n\t\t\tDom.addClass(link, 'crm-timeline__hint_popup-content-link');\n\t\t\tlink.onclick = () => {\n\t\t\t\tthis.executeAction(linkOptions.action);\n\t\t\t}\n\n\t\t\treturn link;\n\t\t},\n\n\t\texecuteAction(actionObj): void {\n\t\t\tif (actionObj)\n\t\t\t{\n\t\t\t\tconst action = new Action(actionObj);\n\t\t\t\taction.execute(this);\n\t\t\t}\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<span\n\t\t\tref=\"hint\"\n\t\t\t@click.stop.prevent\n\t\t\t@mouseenter=\"onMouseEnterToHint\"\n\t\t\t@mouseleave=\"onHintAreaMouseLeave\"\n\t\t\tv-if=\"hasContent\"\n\t\t\t:class=\"hintIconClassname\"\n\t\t>\n\t\t\t<span class=\"ui-hint-icon\" />\n\t\t</span>\n\t`\n}\n","export class TagType\n{\n\tstatic PRIMARY = 'primary';\n\tstatic SECONDARY = 'secondary';\n\tstatic SUCCESS = 'success';\n\tstatic WARNING = 'warning';\n\tstatic FAILURE = 'failure';\n\tstatic LAVENDER = 'lavender';\n}\n","import { Dom, Runtime, Type } from 'main.core';\nimport { Label } from 'ui.label';\n\nimport { Action } from '../../../action';\nimport { TagType } from '../../enums/tag-type';\n\nimport 'ui.hint';\n\nexport const Tag = {\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\thint: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\taction: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t\ttype: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: TagType.SECONDARY,\n\t\t},\n\t\tstate: String,\n\t},\n\tcomputed:\n\t{\n\t\tclassName(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\t'crm-timeline__card-status': true,\n\t\t\t\t'--clickable': Boolean(this.action),\n\t\t\t\t'--hint': Boolean(this.hint),\n\t\t\t};\n\t\t},\n\n\t\ttagTypeToLabelColorDict(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\t[TagType.PRIMARY]: Label.Color.LIGHT_BLUE,\n\t\t\t\t[TagType.SECONDARY]: Label.Color.LIGHT,\n\t\t\t\t[TagType.LAVENDER]: Label.Color.LAVENDER,\n\t\t\t\t[TagType.SUCCESS]: Label.Color.LIGHT_GREEN,\n\t\t\t\t[TagType.WARNING]: Label.Color.LIGHT_YELLOW,\n\t\t\t\t[TagType.FAILURE]: Label.Color.LIGHT_RED,\n\t\t\t};\n\t\t},\n\n\t\ttagContainerRef(): HTMLDivElement\n\t\t{\n\t\t\treturn this.$refs.tag;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tgetLabelColorFromTagType(tagType): String\n\t\t{\n\t\t\tconst lowerCaseTagType = tagType ? tagType.toLowerCase() : '';\n\t\t\tconst labelColor = this.tagTypeToLabelColorDict[lowerCaseTagType];\n\n\t\t\treturn labelColor || Label.Color.LIGHT;\n\t\t},\n\n\t\t// eslint-disable-next-line consistent-return\n\t\trenderTag(tagOptions): HTMLElement | null\n\t\t{\n\t\t\tif (!tagOptions || !this.tagContainerRef)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst { title, type } = tagOptions;\n\n\t\t\tconst uppercaseTitle = title && Type.isString(title) ? title.toUpperCase() : '';\n\t\t\tconst label = new Label({\n\t\t\t\ttext: uppercaseTitle,\n\t\t\t\tcolor: this.getLabelColorFromTagType(type),\n\t\t\t\tfill: true,\n\t\t\t});\n\n\t\t\tDom.clean(this.tagContainerRef);\n\t\t\tDom.append(label.render(), this.tagContainerRef);\n\t\t},\n\n\t\texecuteAction(): void\n\t\t{\n\t\t\tif (!this.action)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst action = new Action(this.action);\n\t\t\taction.execute(this);\n\t\t},\n\n\t\tshowTooltip(): void\n\t\t{\n\t\t\tif (this.hint === '')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tRuntime.debounce(\n\t\t\t\t() => {\n\t\t\t\t\tBX.UI.Hint.show(\n\t\t\t\t\t\tthis.$el,\n\t\t\t\t\t\tthis.hint,\n\t\t\t\t\t\ttrue,\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\t50,\n\t\t\t\tthis,\n\t\t\t)();\n\t\t},\n\n\t\thideTooltip(): void\n\t\t{\n\t\t\tif (this.hint === '')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tBX.UI.Hint.hide(this.$el);\n\t\t},\n\t},\n\n\tmounted(): void\n\t{\n\t\tthis.renderTag({ title: this.title, type: this.type });\n\t},\n\n\tupdated(): void\n\t{\n\t\tthis.renderTag({ title: this.title, type: this.type });\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t\tref=\"tag\"\n\t\t\t:class=\"className\"\n\t\t\t@mouseover=\"showTooltip\"\n\t\t\t@mouseleave=\"hideTooltip\"\n\t\t\t@click=\"executeAction\"\n\t\t></div>\n\t`,\n};\n","import {Action} from \"../../../action\";\n\nexport const Title = {\n\tprops: {\n\t\ttitle: String,\n\t\taction: Object,\n\t},\n\tinject: ['isLogMessage'],\n\tcomputed: {\n\t\tclassName(): Array {\n\t\t\treturn [\n\t\t\t\t'crm-timeline__card-title', {\n\t\t\t\t'--light': this.isLogMessage,\n\t\t\t\t'--action': !!this.action,\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\n\t\thref(): ?string {\n\t\t\tif (!this.action)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tconst action = new Action(this.action);\n\t\t\tif (action.isRedirect())\n\t\t\t{\n\t\t\t\treturn action.getValue();\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\n\t},\n\tmethods: {\n\t\texecuteAction(): void\n\t\t{\n\t\t\tif (!this.action)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst action = new Action(this.action);\n\t\t\taction.execute(this);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<a\n\t\t\tv-if=\"href\"\n\t\t\t:href=\"href\"\n\t\t\t:class=\"className\"\n\t\t\ttabindex=\"0\"\n\t\t\t:title=\"title\"\n\t\t>\n\t\t\t{{title}}\n\t\t</a>\n\t\t<span\n\t\t\tv-else\n\t\t\t@click=\"executeAction\"\n\t\t\t:class=\"className\"\n\t\t\ttabindex=\"0\"\n\t\t\t:title=\"title\"\n\t\t>\n\t\t\t{{title}}\n\t\t</span>`\n};\n","import {Text} from \"main.core\"\n\nexport const User = {\n\tprops: {\n\t\ttitle: String,\n\t\tdetailUrl: String,\n\t\timageUrl: String,\n\t},\n\tinject: ['isLogMessage'],\n\tcomputed: {\n\t\tstyles()\n\t\t{\n\t\t\tif (!this.imageUrl)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tbackgroundImage: \"url('\" + encodeURI(Text.encode(this.imageUrl)) + \"')\",\n\t\t\t\tbackgroundSize: '21px'\n\t\t\t};\n\t\t},\n\n\t\tclassName() {\n\t\t\treturn [\n\t\t\t\t'ui-icon',\n\t\t\t\t'ui-icon-common-user',\n\t\t\t\t'crm-timeline__user-icon', {\n\t\t\t\t'--muted': this.isLogMessage,\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `<a :class=\"className\" :href=\"detailUrl\"\n\t\t\t\t  target=\"_blank\" :title=\"title\"><i :style=\"styles\"></i></a>`\n};\n","import { Runtime, Type } from 'main.core';\nimport { ChangeStreamButton } from './header/change-stream-button';\nimport { ColorSelector } from './header/color-selector';\nimport { FormatDate } from './header/format-date';\nimport { Hint } from './header/hint';\nimport { Tag } from './header/tag';\nimport { Title } from './header/title';\nimport { User } from './header/user';\n\nexport const Header = {\n\tcomponents: {\n\t\tColorSelector,\n\t\tChangeStreamButton,\n\t\tTitle,\n\t\tTag,\n\t\tUser,\n\t\tFormatDate,\n\t\tHint,\n\t},\n\tprops: {\n\t\ttitle: String,\n\t\ttitleAction: Object,\n\t\tdate: Number,\n\t\tdatePlaceholder: String,\n\t\tuseShortTimeFormat: Boolean,\n\t\tchangeStreamButton: Object | null,\n\t\ttags: Object,\n\t\tuser: Object,\n\t\tinfoHelper: Object,\n\t\tcolorSettings: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\tinject: [\n\t\t'isReadOnly',\n\t\t'isLogMessage',\n\t],\n\tcomputed: {\n\t\tvisibleTags(): Array\n\t\t{\n\t\t\tif (!Type.isPlainObject(this.tags))\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\treturn this.tags\n\t\t\t\t? Object.values(this.tags).filter((element) => this.isVisibleTagFilter(element))\n\t\t\t\t: []\n\t\t\t;\n\t\t},\n\n\t\tvisibleAndAscSortedTags(): Array\n\t\t{\n\t\t\tconst tagsCopy = Runtime.clone(this.visibleTags);\n\n\t\t\treturn tagsCopy.sort(this.tagsAscSorter);\n\t\t},\n\n\t\tisShowDate(): boolean\n\t\t{\n\t\t\treturn this.date || this.datePlaceholder;\n\t\t},\n\n\t\tclassName(): Object {\n\t\t\treturn [\n\t\t\t\t'crm-timeline__card-top',\n\t\t\t\t{\n\t\t\t\t\t'--log-message': this.isReadOnly || this.isLogMessage,\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\t},\n\tmethods: {\n\t\tisVisibleTagFilter(tag): Boolean\n\t\t{\n\t\t\treturn (\n\t\t\t\ttag.state !== 'hidden'\n\t\t\t\t&& tag.scope !== 'mobile'\n\t\t\t\t&& (!this.isReadOnly || !tag.hideIfReadonly)\n\t\t\t);\n\t\t},\n\n\t\ttagsAscSorter(tagA, tagB): Number\n\t\t{\n\t\t\treturn tagA.sort - tagB.sort;\n\t\t},\n\n\t\tgetChangeStreamButton(): ?Object\n\t\t{\n\t\t\treturn this.$refs.changeStreamButton;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.$watch(\n\t\t\t'colorSettings',\n\t\t\t(newColorSettings) => {\n\t\t\t\tthis.$refs.colorSelector.setValue(newColorSettings.selectedValueId);\n\t\t\t},\n\t\t\t{\n\t\t\t\tdeep: true,\n\t\t\t},\n\t\t);\n\t},\n\ttemplate: `\n\t\t<div :class=\"className\">\n\t\t\t<div class=\"crm-timeline__card-top_info\">\n\t\t\t\t<div class=\"crm-timeline__card-top_info_left\">\n\t\t\t\t\t<ChangeStreamButton \n\t\t\t\t\t\tv-if=\"changeStreamButton\" \n\t\t\t\t\t\tv-bind=\"changeStreamButton\" \n\t\t\t\t\t\tref=\"changeStreamButton\"\n\t\t\t\t\t/>\n\t\t\t\t\t<Title :title=\"title\" :action=\"titleAction\"></Title>\n\t\t\t\t\t<Hint v-if=\"infoHelper\" v-bind=\"infoHelper\"></Hint>\n\t\t\t\t</div>\n\t\t\t\t<div ref=\"tags\" class=\"crm-timeline__card-top_info_right\">\n\t\t\t\t\t<Tag\n\t\t\t\t\t\tv-for=\"(tag, index) in visibleAndAscSortedTags\"\n\t\t\t\t\t\t:key=\"index\"\n\t\t\t\t\t\tv-bind=\"tag\"\n\t\t\t\t\t/>\n\t\t\t\t\t<FormatDate\n\t\t\t\t\t\tv-if=\"isShowDate\"\n\t\t\t\t\t\t:timestamp=\"date\"\n\t\t\t\t\t\t:use-short-time-format=\"useShortTimeFormat\"\n\t\t\t\t\t\t:date-placeholder=\"datePlaceholder\"\n\t\t\t\t\t\tclass=\"crm-timeline__card-time\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"crm-timeline__card-top_components-container\">\n\t\t\t\t<ColorSelector\n\t\t\t\t\tv-if=\"colorSettings\"\n\t\t\t\t\tref=\"colorSelector\"\n\t\t\t\t\t:valuesList=\"colorSettings.valuesList\"\n\t\t\t\t\t:selectedValueId=\"colorSettings.selectedValueId\"\n\t\t\t\t\t:readOnlyMode=\"colorSettings.readOnlyMode\"\n\t\t\t\t/>\n\t\t\t\t<User v-bind=\"user\"></User>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","export class IconBackgroundColor {\n\tstatic PRIMARY = 'primary';\n\tstatic PRIMARY_ALT = 'primary_alt';\n\tstatic FAILURE = 'failure';\n}","import { Dom, Text, Type } from 'main.core';\nimport { Counter } from 'ui.cnt';\nimport { IconBackgroundColor } from '../enums/icon-background-color';\n\nexport const Icon = {\n\tprops: {\n\t\tcode: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: 'none',\n\t\t},\n\t\tcounterType: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tbackgroundColorToken: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: IconBackgroundColor.PRIMARY,\n\t\t},\n\t\tbackgroundUri: String,\n\t\tbackgroundColor: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\tinject: ['isLogMessage'],\n\tcomputed: {\n\t\tclassName(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\t'crm-timeline__card_icon': true,\n\t\t\t\t[`--bg-${this.backgroundColorToken}`]: Boolean(this.backgroundColorToken),\n\t\t\t\t[`--code-${this.code}`]: Boolean(this.code) && !this.backgroundUri,\n\t\t\t\t'--custom-bg': Boolean(this.backgroundUri),\n\t\t\t\t'--muted': this.isLogMessage,\n\t\t\t};\n\t\t},\n\n\t\tcounterNodeContainer(): HTMLDivElement\n\t\t{\n\t\t\treturn this.$refs.counter;\n\t\t},\n\n\t\tstyles(): Object\n\t\t{\n\t\t\tif (!this.backgroundUri)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tbackgroundImage: `url('${encodeURI(Text.encode(this.backgroundUri))}')`,\n\t\t\t};\n\t\t},\n\n\t\ticonStyle(): Object\n\t\t{\n\t\t\tif (Type.isStringFilled(this.backgroundColor))\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\t'--crm-timeline-card-icon-background': Text.encode(this.backgroundColor),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {};\n\t\t},\n\t},\n\n\tmethods: {\n\t\trenderCounter() {\n\t\t\tif (!this.counterType)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tDom.clean(this.counterNodeContainer);\n\t\t\tconst counter = new Counter({\n\t\t\t\tvalue: 1,\n\t\t\t\tborder: true,\n\t\t\t\tcolor: Counter.Color[this.counterType.toUpperCase()],\n\t\t\t});\n\t\t\tcounter.renderTo(this.counterNodeContainer);\n\t\t},\n\t},\n\tmounted() {\n\t\tthis.renderCounter();\n\t},\n\twatch: {\n\t\tcounterType(newCounterType): void // update if counter state changed\n\t\t{\n\t\t\tvoid this.$nextTick(() => {\n\t\t\t\tthis.renderCounter();\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div :class=\"className\" :style=\"iconStyle\">\n\t\t\t<i :style=\"styles\"></i>\n\t\t\t<div ref=\"counter\" v-show=\"!!counterType\" class=\"crm-timeline__card_icon_counter\"></div>\n\t\t</div>\n\t`\n};\n","import {Type} from \"main.core\";\nimport {Action} from \"../../action\";\n\nexport const MarketPanel = {\n\tprops: {\n\t\ttext: String,\n\t\tdetailsText: String,\n\t\tdetailsTextAction: Object,\n\n\t},\n\tcomputed: {\n\t\tneedShowDetailsText(): boolean\n\t\t{\n\t\t\treturn Type.isStringFilled(this.detailsText);\n\t\t},\n\t\thref(): ?string\n\t\t{\n\t\t\tif (!this.detailsTextAction)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tconst action = new Action(this.detailsTextAction);\n\t\t\tif (action.isRedirect())\n\t\t\t{\n\t\t\t\treturn action.getValue();\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t},\n\tmethods: {\n\t\texecuteAction(): void\n\t\t{\n\t\t\tif (this.detailsTextAction)\n\t\t\t{\n\t\t\t\tconst action = new Action(this.detailsTextAction);\n\t\t\t\taction.execute(this);\n\t\t\t}\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"crm-timeline__card-bottom\">\n\t\t<div class=\"crm-timeline__card-market\">\n\t\t\t<div class=\"crm-timeline__card-market_container\">\n\t\t\t\t<span class=\"crm-timeline__card-market_logo\"></span>\n\t\t\t\t<span class=\"crm-timeline__card-market_text\">{{ text }}</span>\n\t\t\t\t<a\n\t\t\t\t\tv-if=\"href && needShowDetailsText\"\n\t\t\t\t\t:href=\"href\"\n\t\t\t\t\tclass=\"crm-timeline__card-market_more\"\n\t\t\t\t>\n\t\t\t\t\t{{detailsText}}\n\t\t\t\t</a>\n\t\t\t\t<span\n\t\t\t\t\tv-if=\"!href && needShowDetailsText\"\n\t\t\t\t\t@click=\"executeAction\"\n\t\t\t\t\tclass=\"crm-timeline__card-market_more\"\n\t\t\t\t>\n\t\t\t\t{{detailsText}}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t<div class=\"crm-timeline__card-market_cross\"><i></i></div>\n\t\t</div>\n\t\t</div>\n\t`\n};\n","export const UserPick = {\n\ttemplate: `\n\t\t<div class=\"ui-icon ui-icon-common-user crm-timeline__card-top_user-icon\">\n\t\t\t<i></i>\n\t\t</div>\n\t`\n}","import { Dom, Runtime, Text, Type } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\nimport { Loader } from 'main.loader';\nimport { StreamType } from '../stream-type';\nimport { Body } from './layout/body';\nimport { Footer } from './layout/footer';\nimport { Header } from './layout/header';\nimport { Icon } from './layout/icon';\nimport { MarketPanel } from './layout/marketPanel';\nimport { UserPick } from './layout/userPick';\n\nexport const Item = {\n\tcomponents: {\n\t\tIcon,\n\t\tHeader,\n\t\tBody,\n\t\tFooter,\n\t\tMarketPanel,\n\t\tUserPick,\n\t},\n\tprops: {\n\t\tinitialLayout: Object,\n\t\tid: String,\n\t\tuseShortTimeFormat: Boolean,\n\t\tisLogMessage: Boolean,\n\t\tisReadOnly: Boolean,\n\t\tcurrentUser: Object | null,\n\t\tonAction: Function,\n\t\tinitialColor: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t\tstreamType: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t\tdefault: StreamType.history,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tlayout: this.initialLayout,\n\t\t\tcolor: this.initialColor,\n\t\t\tisFaded: false,\n\t\t\tloader: Object.freeze(null),\n\t\t};\n\t},\n\tprovide() {\n\t\treturn {\n\t\t\tisLogMessage: Boolean(this.initialLayout?.isLogMessage),\n\t\t\tisReadOnly: this.isReadOnly,\n\t\t\tcurrentUser: this.currentUser,\n\t\t};\n\t},\n\tcreated(): void\n\t{\n\t\tthis.$Bitrix.eventEmitter.subscribe('crm:timeline:item:action', this.onActionEvent);\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tthis.$Bitrix.eventEmitter.unsubscribe('crm:timeline:item:action', this.onActionEvent);\n\t},\n\tmethods: {\n\t\tonActionEvent(event: BaseEvent): void\n\t\t{\n\t\t\tconst eventData = event.getData();\n\t\t\tthis.onAction(Runtime.clone(eventData));\n\t\t},\n\t\tsetLayout(newLayout: Object): void\n\t\t{\n\t\t\tthis.layout = newLayout;\n\t\t\tthis.isFaded = false;\n\t\t\tthis.$Bitrix.eventEmitter.emit('layout:updated');\n\t\t},\n\t\tsetColor(newColor: Object): void\n\t\t{\n\t\t\tthis.color = newColor;\n\t\t},\n\n\t\tsetFaded(faded: boolean)\n\t\t{\n\t\t\tthis.isFaded = faded;\n\t\t},\n\n\t\tshowLoader(showLoader: boolean)\n\t\t{\n\t\t\tif (showLoader)\n\t\t\t{\n\t\t\t\tthis.setFaded(true);\n\t\t\t\tif (!this.loader)\n\t\t\t\t{\n\t\t\t\t\tthis.loader = new Loader();\n\t\t\t\t}\n\t\t\t\tthis.loader.show(this.$el.parentNode);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (this.loader)\n\t\t\t\t{\n\t\t\t\t\tthis.loader.hide();\n\t\t\t\t}\n\t\t\t\tthis.setFaded(false);\n\t\t\t}\n\t\t},\n\n\t\tgetContentBlockById(blockId: string): ?Object\n\t\t{\n\t\t\tif (!this.$refs.body)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.$refs.body.getContentBlockById(blockId);\n\t\t},\n\n\t\tgetLogo(): ?Object\n\t\t{\n\t\t\tif (!this.$refs.body)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.$refs.body.getLogo();\n\t\t},\n\n\t\tgetHeaderChangeStreamButton(): ?Object\n\t\t{\n\t\t\tif (!this.$refs.header)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.$refs.header.getChangeStreamButton();\n\t\t},\n\n\t\tgetFooterButtonById(buttonId: string): ?Object\n\t\t{\n\t\t\tif (!this.$refs.footer)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.$refs.footer.getButtonById(buttonId);\n\t\t},\n\n\t\tgetFooterMenu(): ?Object\n\t\t{\n\t\t\tif (!this.$refs.footer)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.$refs.footer.getMenu();\n\t\t},\n\n\t\thighlightContentBlockById(blockId: string, isHighlighted: boolean): void\n\t\t{\n\t\t\tif (!isHighlighted)\n\t\t\t{\n\t\t\t\tthis.isFaded = false;\n\t\t\t}\n\n\t\t\tconst block = this.getContentBlockById(blockId);\n\t\t\tif (!block)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (isHighlighted)\n\t\t\t{\n\t\t\t\tthis.isFaded = true;\n\t\t\t\tDom.addClass(block.$el, '--highlighted');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.isFaded = false;\n\t\t\t\tDom.removeClass(block.$el, '--highlighted');\n\t\t\t}\n\t\t},\n\t},\n\tcomputed: {\n\t\ttimelineCardClassname(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\t'crm-timeline__card': true,\n\t\t\t\t'crm-timeline__card-scope': true,\n\t\t\t\t'--stream-type-history': this.streamType === StreamType.history,\n\t\t\t\t'--stream-type-scheduled': this.streamType === StreamType.scheduled,\n\t\t\t\t'--stream-type-pinned': this.streamType === StreamType.pinned,\n\t\t\t\t'--log-message': this.isLogMessage,\n\t\t\t};\n\t\t},\n\t\ttimelineCardStyle(): Object\n\t\t{\n\t\t\tif (Type.isPlainObject(this.color) && this.streamType === StreamType.scheduled)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\t'--crm-timeline__card-color-background': Text.encode(this.color.itemBackground),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {};\n\t\t},\n\t},\n\ttemplate: `\n\t  \t<div class=\"crm-timeline__card-wrapper\">\n\t\t\t<div class=\"crm-timeline__card_icon_container\">\n\t\t\t\t<Icon v-bind=\"layout.icon\"></Icon>\n\t\t\t</div>\n\t\t\t<div \n\t\t\t\t:data-id=\"id\" \n\t\t\t\tref=\"timelineCard\" \n\t\t\t\t:class=\"timelineCardClassname\"\n\t\t\t\t:style=\"timelineCardStyle\"\n\t\t\t>\n\t\t\t\t<div class=\"crm-timeline__card_fade\" v-if=\"isFaded\"></div>\n\t\t\t\t<Header \n\t\t\t\t\tv-if=\"layout.header\"\n\t\t\t\t\tv-bind=\"layout.header\"\n\t\t\t\t\t:use-short-time-format=\"useShortTimeFormat\"\n\t\t\t\t\tref=\"header\"\n\t\t\t\t/>\n\t\t\t\t<Body v-if=\"layout.body\" v-bind=\"layout.body\" ref=\"body\"></Body>\n\t\t\t\t<Footer v-if=\"layout.footer\" v-bind=\"layout.footer\" ref=\"footer\"></Footer>\n\t\t\t\t<MarketPanel v-if=\"layout.marketPanel\" v-bind=\"layout.marketPanel\"></MarketPanel>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import ConfigurableItem from \"./configurable-item\";\n\nexport default class ControllerManager\n{\n\t#id: ?string = null;\n\n\tconstructor(id)\n\t{\n\t\tthis.#id = id;\n\t}\n\n\tgetItemControllers(item: ConfigurableItem): Array\n\t{\n\t\tconst foundControllers = [];\n\t\tfor (const controller of ControllerManager.getRegisteredControllers())\n\t\t{\n\t\t\tif (controller.isItemSupported(item))\n\t\t\t{\n\t\t\t\tconst controllerInstance = new controller();\n\t\t\t\tcontrollerInstance.onInitialize(item);\n\t\t\t\tfoundControllers.push(controllerInstance);\n\t\t\t}\n\t\t}\n\n\t\treturn foundControllers;\n\t}\n\n\tstatic getInstance(timelineId): ControllerManager\n\t{\n\t\tif (!this.#instances.hasOwnProperty(timelineId))\n\t\t{\n\t\t\tthis.#instances[timelineId] = new ControllerManager(timelineId);\n\t\t}\n\n\t\treturn this.#instances[timelineId];\n\t}\n\n\tstatic registerController(controller): void\n\t{\n\t\tthis.#availableControllers.push(controller);\n\t}\n\n\tstatic getRegisteredControllers(): Array\n\t{\n\t\treturn this.#availableControllers;\n\t}\n\n\tstatic #instances = {};\n\tstatic #availableControllers = [];\n}\n","import { ajax as Ajax } from 'main.core';\nimport { UI } from 'ui.notification';\n\nimport ConfigurableItem from '../configurable-item';\n\nexport type ActionParams =\n{\n\taction: String,\n\tactionType: String,\n\tactionData: ?Object,\n\tresponse: ?Object,\n\tanimationCallbacks: ?ActionAnimationCallbacks,\n\tconfirmationText: ?String,\n};\n\nexport type ActionAnimationCallbacks =\n{\n\tonStart: ?Function,\n\tonStop: ?Function,\n};\n\nexport class Base\n{\n\tgetDeleteActionMethod(): string\n\t{\n\t\treturn '';\n\t}\n\n\tgetDeleteActionCfg(recordId: Number, ownerTypeId: Number, ownerId: Number): Object\n\t{\n\t\treturn {\n\t\t\tdata: {\n\t\t\t\trecordId,\n\t\t\t\townerTypeId,\n\t\t\t\townerId,\n\t\t\t},\n\t\t};\n\t}\n\n\tonInitialize(item: ConfigurableItem): void\n\t{}\n\n\tonItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{}\n\n\tgetContentBlockComponents(item: ConfigurableItem): Object\n\t{\n\t\treturn {};\n\t}\n\n\tonAfterItemRefreshLayout(item: ConfigurableItem): void\n\t{}\n\n\tonAfterItemLayout(item: ConfigurableItem, options): void\n\t{}\n\n\t/**\n\t * Will be executed before item node deleted from DOM\n\t * @param item\n\t */\n\tonBeforeItemClearLayout(item: ConfigurableItem): void\n\t{}\n\n\t/**\n\t * Delete timeline record action\n\t *\n\t * @param recordId Timeline record ID\n\t * @param ownerTypeId Owner type ID\n\t * @param ownerId Owner type ID\n\t * @param animationCallbacks\n\t *\n\t * @returns {Promise}\n\t *\n\t * @protected\n\t */\n\trunDeleteAction(recordId: Number, ownerTypeId: Number, ownerId: Number, animationCallbacks: ?Object): Promise\n\t{\n\t\tif (animationCallbacks.onStart)\n\t\t{\n\t\t\tanimationCallbacks.onStart();\n\t\t}\n\n\t\treturn Ajax.runAction(\n\t\t\tthis.getDeleteActionMethod(),\n\t\t\tthis.getDeleteActionCfg(recordId, ownerTypeId, ownerId),\n\t\t).then(() => {\n\t\t\tif (animationCallbacks.onStop)\n\t\t\t{\n\t\t\t\tanimationCallbacks.onStop();\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}, (response) => {\n\t\t\tUI.Notification.Center.notify({\n\t\t\t\tcontent: response.errors[0].message,\n\t\t\t\tautoHideDelay: 5000,\n\t\t\t});\n\n\t\t\tif (animationCallbacks.onStop)\n\t\t\t{\n\t\t\t\tanimationCallbacks.onStop();\n\t\t\t}\n\n\t\t\treturn true;\n\t\t});\n\t}\n\n\t/**\n\t * Schedule TODO activity action\n\t *\n\t * @param activityId Activity ID\n\t * @param scheduleDate Date to use in editor\n\t *\n\t * @protected\n\t */\n\trunScheduleAction(activityId: Number, scheduleDate: String): void\n\t{\n\t\tconst menuBar = BX.Crm?.Timeline?.MenuBar?.getDefault();\n\t\tif (menuBar)\n\t\t{\n\t\t\tmenuBar.setActiveItemById('todo');\n\t\t\tmenuBar.scrollIntoView();\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tconst todoEditor = menuBar.getItemById('todo');\n\n\t\t\t\ttodoEditor.focus();\n\t\t\t\ttodoEditor.setParentActivityId(activityId);\n\t\t\t\ttodoEditor.setDeadLine(scheduleDate);\n\t\t\t}, 250);\n\t\t}\n\t}\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn false;\n\t}\n}\n","import { Dom, Type } from 'main.core';\n\nexport default class Item\n{\n\tconstructor()\n\t{\n\t\tthis._id = '';\n\t\tthis._isTerminated = false;\n\t\tthis._wrapper = null;\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this._id;\n\t}\n\n\t_setId(id): void\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t}\n\n\t/**\n\t * @abstract\n\t */\n\tsetData(data): void\n\t{\n\t\tthrow new Error('Item.setData() must be overridden');\n\t}\n\n\t/**\n\t * @abstract\n\t */\n\tlayout(options): void\n\t{\n\t\tthrow new Error('Item.layout() must be overridden');\n\t}\n\n\trefreshLayout()\n\t{\n\t\tconst anchor = this._wrapper.previousSibling;\n\t\tthis.clearLayout();\n\n\t\tthis.layout({ anchor: anchor });\n\t}\n\n\tclearLayout()\n\t{\n\t\tDom.remove(this._wrapper);\n\t\tthis._wrapper = undefined;\n\t}\n\n\tdestroy()\n\t{\n\t\tthis.clearLayout();\n\t}\n\n\tgetWrapper(): ?HTMLElement\n\t{\n\t\treturn this._wrapper;\n\t}\n\n\tsetWrapper(wrapper: HTMLElement): void\n\t{\n\t\tthis._wrapper = wrapper;\n\t}\n\n\taddWrapperClass(className, timeout): void\n\t{\n\t\tif(!this._wrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tDom.addClass(this._wrapper, className);\n\n\t\tif(Type.isNumber(timeout) && timeout >= 0)\n\t\t{\n\t\t\twindow.setTimeout(this.removeWrapperClass.bind(this, className), timeout);\n\t\t}\n\t}\n\n\tremoveWrapperClass(className, timeout): void\n\t{\n\t\tif(!this._wrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.removeClass(this._wrapper, className);\n\t\tif(Type.isNumber(timeout) && timeout >= 0)\n\t\t{\n\t\t\twindow.setTimeout(this.addWrapperClass.bind(this, className), timeout);\n\t\t}\n\t}\n\n\tisTerminated(): boolean\n\t{\n\t\treturn this._isTerminated;\n\t}\n\n\tmarkAsTerminated(terminated): void\n\t{\n\t\tterminated = !!terminated;\n\n\t\tif (this._isTerminated === terminated)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._isTerminated = terminated;\n\t\tif (!this._wrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (terminated)\n\t\t{\n\t\t\tDom.addClass(this._wrapper, 'crm-entity-stream-section-last');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this._wrapper, 'crm-entity-stream-section-last');\n\t\t}\n\t}\n\n\tgetAssociatedEntityTypeId(): ?Number\n\t{\n\t\treturn null;\n\t}\n\n\tgetAssociatedEntityId(): ?Number\n\t{\n\t\treturn null;\n\t}\n\n}\n","import {Runtime} from 'main.core';\n\nexport default class Layout {\n\t#layout: Object = null;\n\n\tconstructor (layout: Object) {\n\t\tthis.#layout = layout;\n\t}\n\n\tasPlainObject (): Object {\n\t\treturn Runtime.clone(this.#layout);\n\t}\n\n\tgetFooterMenuItemById (id: string): ?Object {\n\t\tconst items = this.#layout?.footer?.menu?.items ?? {};\n\n\t\treturn items.hasOwnProperty(id) ? items.id : null;\n\t}\n\n\taddFooterMenuItem (menuItem: Object): void {\n\t\tthis.#layout.footer = this.#layout.footer || {};\n\t\tthis.#layout.footer.menu = this.#layout.footer.menu || {};\n\t\tthis.#layout.footer.menu.items = this.#layout.footer.menu.items || {};\n\t\tthis.#layout.footer.menu.items[menuItem.id] = menuItem;\n\t}\n}\n","import { StreamType } from 'crm.timeline.item';\nimport { DatetimeConverter } from 'crm.timeline.tools';\nimport { ajax, Dom, Text, Type } from 'main.core';\nimport { BitrixVue } from 'ui.vue3';\nimport { Item } from './components/item';\nimport ControllerManager from './controller-manager';\nimport { Base } from './controllers/base';\nimport TimelineItem from './item';\nimport Layout from './layout';\n\ndeclare type ConfigurableItemParams = {\n\ttimelineId: string,\n\tcontainer: HTMLElement,\n\titemClassName: string,\n\tuseShortTimeFormat: boolean,\n\tisReadOnly: boolean,\n\tcurrentUser: ?Object,\n\townerTypeId: number,\n\townerId: number,\n\tdata: ConfigurableItemData,\n\tstreamType: number;\n};\n\ndeclare type ConfigurableItemData = {\n\ttype: string,\n\ttimestamp: ?Number,\n\tsort: ?Array,\n\tlayout: ?Object,\n\tpayload: ?Object,\n\tcolor: ?Object,\n}\n\nexport default class ConfigurableItem extends TimelineItem\n{\n\t#container: HTMLElement = null;\n\t#itemClassName: string = null;\n\t#type: string = null;\n\t#dataPayload: ?Object = null;\n\t#timelineId: string = null;\n\t#timestamp: number = null;\n\t#sort: Array = null;\n\t#useShortTimeFormat: boolean = false;\n\t#isReadOnly: boolean = false;\n\t#currentUser: ?Object = null;\n\t#ownerTypeId: number = null;\n\t#ownerId: number = null;\n\t#controllers: Base[] = null;\n\t#layoutComponent: ?Object = null;\n\t#layoutApp: ?Object = null;\n\t#layout: ?Layout = null;\n\t#streamType: number = null;\n\t#color: ?Object = null;\n\n\tinitialize(id, settings: ConfigurableItemParams): void\n\t{\n\t\tthis._setId(id);\n\t\tsettings = settings || {};\n\t\tthis.#timelineId = settings.timelineId || '';\n\t\tthis.setContainer(settings.container || null);\n\t\tthis.#itemClassName = settings.itemClassName || '';\n\n\t\tif (Type.isPlainObject(settings.data))\n\t\t{\n\t\t\tthis.setData(settings.data);\n\n\t\t\tthis.#useShortTimeFormat = settings.useShortTimeFormat || false;\n\t\t\tthis.#isReadOnly = settings.isReadOnly || false;\n\t\t\tthis.#currentUser = settings.currentUser || null;\n\t\t\tthis.#ownerTypeId = settings.ownerTypeId;\n\t\t\tthis.#ownerId = settings.ownerId;\n\t\t\tthis.#streamType = settings.streamType || StreamType.history;\n\t\t}\n\n\t\tthis.#controllers = ControllerManager.getInstance(this.#timelineId).getItemControllers(this);\n\t}\n\n\tsetData(data: ConfigurableItemData): void\n\t{\n\t\tthis.#type = data.type || null;\n\t\tthis.#timestamp = data.timestamp || null;\n\t\tthis.#sort = data.sort || [];\n\t\tthis.#layout = new Layout(data.layout || {});\n\t\tthis.#dataPayload = data.payload || {};\n\t\tthis.#color = data.color ?? null;\n\t}\n\n\tgetColor(): ?Object\n\t{\n\t\treturn this.#color;\n\t}\n\n\tgetLayout(): Layout\n\t{\n\t\treturn this.#layout;\n\t}\n\n\tgetType(): string\n\t{\n\t\treturn this.#type;\n\t}\n\n\tgetDataPayload(): ?Object\n\t{\n\t\treturn this.#dataPayload;\n\t}\n\n\tlayout(options): void\n\t{\n\t\tthis.setWrapper(Dom.create({tag: 'div', attrs: {className: this.#itemClassName}}));\n\t\tthis.initLayoutApp(options);\n\t}\n\n\tinitWrapper(): HTMLElement\n\t{\n\t\tthis.setWrapper(Dom.create({tag: 'div', attrs: {className: this.#itemClassName}}));\n\n\t\treturn this._wrapper;\n\t}\n\n\tinitLayoutApp(options): void\n\t{\n\t\tthis.#initLayoutApp();\n\n\t\tif (this.needBindToContainer(options))\n\t\t{\n\t\t\tconst bindTo = this.getBindToNode(options);\n\t\t\tif (bindTo && !this.#useAnchorNextSibling(options))\n\t\t\t{\n\t\t\t\tDom.insertBefore(this.getWrapper(), bindTo);\n\t\t\t}\n\t\t\telse if (bindTo && bindTo.nextSibling)\n\t\t\t{\n\t\t\t\tDom.insertBefore(this.getWrapper(), bindTo.nextSibling);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.append(this.getWrapper(), this.#container);\n\t\t\t}\n\t\t}\n\n\t\tfor (const controller of this.#controllers)\n\t\t{\n\t\t\tcontroller.onAfterItemLayout(this, options);\n\t\t}\n\t}\n\n\tneedBindToContainer(options): Boolean\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\treturn BX.prop.getBoolean(options, 'add', true);\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tgetBindToNode(options): ?HTMLElement\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\treturn Type.isElementNode(options['anchor']) ? options['anchor'] : null;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t#useAnchorNextSibling(options): ?HTMLElement\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\treturn Type.isBoolean(options['useAnchorNextSibling']) ? options['useAnchorNextSibling'] : true;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\trefreshLayout(): void\n\t{\n\t\t// try to refresh layout via vue reactivity, if possible:\n\t\tif (this.#layoutComponent)\n\t\t{\n\t\t\tthis.#layoutComponent.setColor(this.getColor());\n\t\t\tthis.#layoutComponent.setLayout(this.getLayout().asPlainObject());\n\n\t\t\tfor (const controller of this.#controllers)\n\t\t\t{\n\t\t\t\tcontroller.onAfterItemRefreshLayout(this);\n\t\t\t}\n\t\t\tthis.#layoutComponent.showLoader(false);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsuper.refreshLayout();\n\t\t}\n\t}\n\n\tgetLayoutComponent(): ?Object\n\t{\n\t\treturn this.#layoutComponent;\n\t}\n\n\tforceRefreshLayout(): void\n\t{\n\t\tconst bindTo = this.getWrapper()?.nextSibling;\n\t\tthis.clearLayout();\n\t\tthis.layout({anchor: bindTo, useAnchorNextSibling: false});\n\t}\n\n\tgetLayoutContentBlockById(id: string): ?Object\n\t{\n\t\treturn this.#layoutComponent?.getContentBlockById(id);\n\t}\n\n\tgetLogo(): ?Object\n\t{\n\t\treturn this.#layoutComponent?.getLogo();\n\t}\n\n\tgetLayoutFooterButtonById(id: string): ?Object\n\t{\n\t\treturn this.#layoutComponent?.getFooterButtonById(id);\n\t}\n\n\tgetLayoutFooterMenu(): ?Object\n\t{\n\t\treturn this.#layoutComponent?.getFooterMenu();\n\t}\n\n\tgetLayoutHeaderChangeStreamButton(): ?Object\n\t{\n\t\treturn this.#layoutComponent?.getHeaderChangeStreamButton();\n\t}\n\n\thighlightContentBlockById(blockId: string, isHighlighted: boolean): void\n\t{\n\t\tthis.#layoutComponent?.highlightContentBlockById(blockId, isHighlighted);\n\t}\n\n\tclearLayout(): void\n\t{\n\t\tfor (const controller of this.#controllers)\n\t\t{\n\t\t\tcontroller.onBeforeItemClearLayout(this);\n\t\t}\n\t\tthis.#layoutApp.unmount();\n\t\tthis.#layoutApp = null;\n\t\tthis.#layoutComponent = null;\n\t\tsuper.clearLayout();\n\t}\n\n\tgetCreatedDate(): Date\n\t{\n\t\tconst timestamp = this.#timestamp ? this.#timestamp : Date.now() / 1000;\n\n\t\treturn BX.prop.extractDate(DatetimeConverter.createFromServerTimestamp(timestamp).toUserTime().getValue());\n\t}\n\n\tgetSourceId(): number\n\t{\n\t\tlet id = this.getId();\n\t\tif (!Type.isInteger(id))\n\t\t{\n\t\t\t// id is like ACTIVITY_12\n\t\t\tid = Text.toInteger(id.replace(/^\\D+/g, ''));\n\t\t}\n\n\t\treturn id;\n\t}\n\n\t#initLayoutApp(): void\n\t{\n\t\tif (!this.#layoutApp)\n\t\t{\n\t\t\tthis.#layoutApp = BitrixVue.createApp(Item, this.#getLayoutAppProps());\n\n\t\t\tconst contentBlockComponents = this.#getContentBlockComponents();\n\t\t\tfor (const componentName in contentBlockComponents)\n\t\t\t{\n\t\t\t\tthis.#layoutApp.component(componentName, contentBlockComponents[componentName]);\n\t\t\t}\n\n\t\t\tthis.#layoutComponent = this.#layoutApp.mount(this.getWrapper());\n\t\t}\n\t}\n\n\t#getLayoutAppProps(): Object\n\t{\n\t\treturn {\n\t\t\tinitialLayout: this.getLayout().asPlainObject(),\n\t\t\tinitialColor: this.#streamType === StreamType.scheduled ? this.#color : null,\n\t\t\tid: String(this.getId()),\n\t\t\tuseShortTimeFormat: this.#useShortTimeFormat,\n\t\t\tisReadOnly: this.isReadOnly(),\n\t\t\tcurrentUser: this.getCurrentUser(),\n\t\t\tstreamType: this.#streamType,\n\t\t\tonAction: this.#onLayoutAppAction.bind(this),\n\t\t};\n\t}\n\n\t#onLayoutAppAction(eventData: ?Object)\n\t{\n\t\tfor (const controller of this.#controllers)\n\t\t{\n\t\t\tcontroller.onItemAction(this, eventData);\n\t\t}\n\t}\n\n\t#getContentBlockComponents(): Object\n\t{\n\t\tlet components = {};\n\t\tfor (const controller of this.#controllers)\n\t\t{\n\t\t\tcomponents = Object.assign(components, controller.getContentBlockComponents(this));\n\t\t}\n\n\t\treturn components;\n\t}\n\n\tsetContainer(container): void\n\t{\n\t\tthis.#container = container;\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\treturn this.#container;\n\t}\n\n\tgetDeadline(): ?Date\n\t{\n\t\tif (!this.#timestamp)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn DatetimeConverter.createFromServerTimestamp(this.#timestamp).toUserTime().getValue();\n\t}\n\n\tgetSort(): Array\n\t{\n\t\treturn this.#sort;\n\t}\n\n\tisReadOnly(): boolean\n\t{\n\t\treturn this.#isReadOnly;\n\t}\n\n\tgetCurrentUser(): ?Object\n\t{\n\t\treturn this.#currentUser;\n\t}\n\n\tclone(): ConfigurableItem\n\t{\n\t\treturn ConfigurableItem.create(this.getId(), {\n\t\t\ttimelineId: this.#timelineId,\n\t\t\tcontainer: this.getContainer(),\n\t\t\titemClassName: this.#itemClassName,\n\t\t\tuseShortTimeFormat: this.#useShortTimeFormat,\n\t\t\tisReadOnly: this.#isReadOnly,\n\t\t\tcurrentUser: this.#currentUser,\n\t\t\tstreamType: this.#streamType,\n\t\t\tdata: {\n\t\t\t\ttype: this.#type,\n\t\t\t\ttimestamp: this.#timestamp,\n\t\t\t\tsort: this.#sort,\n\t\t\t\tlayout: this.getLayout().asPlainObject(),\n\t\t\t},\n\t\t});\n\t}\n\n\treloadFromServer(forceRefreshLayout: boolean = false): Promise\n\t{\n\t\tconst data = {\n\t\t\townerTypeId: this.#ownerTypeId,\n\t\t\townerId: this.#ownerId,\n\t\t};\n\t\tif (this.#streamType === StreamType.history || this.#streamType === StreamType.pinned)\n\t\t{\n\t\t\tdata.historyIds = [ this.getId() ];\n\t\t}\n\t\telse if (this.#streamType === StreamType.scheduled)\n\t\t{\n\t\t\tdata.activityIds = [ this.getId() ];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthrow new Error('Wrong stream type');\n\t\t}\n\n\t\treturn ajax.runAction('crm.timeline.item.load', {data})\n\t\t\t.then(response => {\n\t\t\t\tObject.values(response.data).forEach(item => {\n\t\t\t\t\tif (item.id === this.getId())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.setData(item);\n\t\t\t\t\t\tif (forceRefreshLayout)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.forceRefreshLayout();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.refreshLayout();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn true;\n\t\t\t})\n\t\t\t.catch(err => {\n\t\t\t\tconsole.error(err);\n\t\t\t\treturn true;\n\t\t\t});\n\t}\n\n\tstatic create(id, settings): ConfigurableItem\n\t{\n\t\tconst self = new ConfigurableItem();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Shift from './shift';\nimport { Dom, Tag, Type, bindOnce } from 'main.core';\nimport CompatibleItem from '../items/compatible-item';\nimport ConfigurableItem from '../../item/src/configurable-item';\n\n/** @memberof BX.Crm.Timeline.Animation */\nexport default class ItemNew\n{\n\t#startPosition: DOMRect;\n\t#node: HTMLElement;\n\t#anchor: HTMLElement;\n\t#areAnimatedItemsVisible: boolean;\n\t#id: string;\n\t#initialItem: CompatibleItem | ConfigurableItem | null;\n\t#finalItem: any;\n\t#events: any;\n\t#settings: any;\n\t#stub: HTMLElement;\n\n\tconstructor()\n\t{\n\t\tthis.#id = '';\n\t\tthis.#settings = {};\n\t\tthis.#initialItem = null;\n\t\tthis.#finalItem = null;\n\t\tthis.#events = null;\n\t\tthis.#areAnimatedItemsVisible = false;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis.#id = Type.isStringFilled(id) ? id : BX.util.getRandomString(4);\n\t\tthis.#settings = settings || {};\n\n\t\tthis.#initialItem = this.getSetting('initialItem');\n\t\tthis.#finalItem = this.getSetting('finalItem');\n\n\t\tthis.#anchor = this.getSetting('anchor');\n\t\tthis.#events = this.getSetting('events', {});\n\n\t\tthis.#node = this.#initialItem.getWrapper();\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.#id;\n\t}\n\n\tgetSetting(name: string, defaultval): any\n\t{\n\t\treturn Object.hasOwn(this.#settings, name) ? this.#settings[name] : defaultval;\n\t}\n\n\taddHistoryItem()\n\t{\n\t\tif (this.#finalItem.getWrapper() === null && !(this.#finalItem instanceof CompatibleItem))\n\t\t{\n\t\t\tthis.#finalItem.initWrapper();\n\t\t\tthis.#finalItem.initLayoutApp({ add: false });\n\t\t}\n\n\t\tDom.style(this.#anchor, {\n\t\t\theight: 0,\n\t\t});\n\t\tthis.#makeNodeStatic(this.#finalItem.getWrapper());\n\t\tDom.insertBefore(this.#finalItem.getWrapper(), this.#anchor.nextSibling);\n\t\trequestAnimationFrame(() => {\n\t\t\tDom.style(this.#finalItem.getWrapper(), {\n\t\t\t\topacity: 1,\n\t\t\t});\n\t\t});\n\t}\n\n\trun()\n\t{\n\t\tthis.#areAnimatedItemsVisible = this.#isNodeVisible(this.#node);\n\t\tif (this.#areAnimatedItemsVisible === false)\n\t\t{\n\t\t\tthis.finish();\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#prepareInitialItemBeforeShift();\n\t\tthis.#prepareFinalItemBeforeShift();\n\n\t\tsetTimeout(() => {\n\t\t\tthis.shiftAndReplaceInitialWithFinal();\n\t\t\tthis.collapseStub();\n\t\t}, 300);\n\t}\n\n\t#prepareInitialItemBeforeShift(): void\n\t{\n\t\tDom.addClass(this.#node, 'crm-entity-stream-section-animate-start');\n\n\t\tthis.#startPosition = Dom.getPosition(this.#node);\n\t\tthis.#makeNodeAbsoluteWithSavePosition(this.#node);\n\n\t\tthis.addStubForInitialItem(this.#node);\n\t\tDom.append(this.#node, document.body);\n\t}\n\n\t#prepareFinalItemBeforeShift(): void\n\t{\n\t\tif (!(this.#finalItem instanceof CompatibleItem))\n\t\t{\n\t\t\tthis.#finalItem.initWrapper();\n\t\t\tthis.#finalItem.initLayoutApp({ add: false });\n\t\t}\n\n\t\tDom.style(this.#finalItem.getWrapper(), 'opacity', 0);\n\t\tDom.append(this.#finalItem.getWrapper(), document.body);\n\t\trequestAnimationFrame(() => {\n\t\t\tthis.#makeNodeAbsoluteWithSavePosition(this.#finalItem.getWrapper(), this.#startPosition);\n\t\t});\n\t}\n\n\tcollapseStub(): void\n\t{\n\t\tbindOnce(this.#stub, 'transitionend', () => {\n\t\t\tDom.remove(this.#stub);\n\t\t});\n\n\t\tDom.style(this.#stub, {\n\t\t\theight: 0,\n\t\t\tmargin: 0,\n\t\t});\n\t}\n\n\tshift(): void\n\t{\n\t\tconst shift = Shift.create(\n\t\t\tthis.#node,\n\t\t\tthis.#anchor,\n\t\t\tthis.#startPosition,\n\t\t\tthis.#stub,\n\t\t\t{ complete: this.finish.bind(this) },\n\t\t);\n\n\t\tshift.run();\n\n\t\tconst heightDiff = Dom.getPosition(this.#finalItem.getWrapper()).height - this.#startPosition.height;\n\n\t\tconst newNodeShift = Shift.create(\n\t\t\tthis.#finalItem.getWrapper(),\n\t\t\tthis.#anchor,\n\t\t\tDom.getPosition(this.#finalItem.getWrapper()),\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t\theightDiff + 1,\n\t\t);\n\n\t\tnewNodeShift.run();\n\t}\n\n\tshiftAndReplaceInitialWithFinal(): void\n\t{\n\t\tthis.shift();\n\n\t\tsetTimeout(() => {\n\t\t\tthis.#replaceInitialWithFinal();\n\t\t}, 100);\n\t}\n\n\t#replaceInitialWithFinal(): void\n\t{\n\t\tDom.style(this.#node, 'opacity', 0);\n\t\tDom.style(this.#finalItem.getWrapper(), 'opacity', 0.5);\n\t}\n\n\taddStubForInitialItem(node: HTMLElement): void\n\t{\n\t\tconst wrapper = this.#initialItem.getWrapper();\n\n\t\tthis.#stub = Tag.render`\n\t\t\t<div class=\"crm-entity-stream-section crm-entity-stream-section-planned crm-entity-stream-section-shadow\">\n\t\t\t\t<div\n\t\t\t\t\tclass=\"crm-entity-stream-section-content\"\n\t\t\t\t\tstyle=\"height: ${wrapper.clientHeight}px;\"\n\t\t\t\t></div>\n\t\t\t</div>\n\t\t`;\n\n\t\tconst height = Dom.getPosition(wrapper).height;\n\n\t\tDom.style(this.#stub, {\n\t\t\theight: `${height}px`,\n\t\t\tmargin: getComputedStyle(wrapper).margin,\n\t\t\tanimation: 'none',\n\t\t\ttransition: 'height 0.2s ease-in-out',\n\t\t});\n\n\t\tDom.insertBefore(this.#stub, node);\n\t}\n\n\tfinish()\n\t{\n\t\tif (this.#areAnimatedItemsVisible)\n\t\t{\n\t\t\tDom.removeClass(this.#node, 'crm-entity-stream-section-animate-start');\n\t\t}\n\t\tsetTimeout(() => {\n\t\t\tthis.#initialItem.clearLayout();\n\t\t\tDom.remove(this.#node);\n\n\t\t\tthis.addHistoryItem();\n\n\t\t\tif (Type.isFunction(this.#events.complete))\n\t\t\t{\n\t\t\t\tthis.#events.complete();\n\t\t\t}\n\t\t}, 500);\n\t}\n\n\t#makeNodeAbsoluteWithSavePosition(node: HTMLElement, pos?: DOMRect): void\n\t{\n\t\tconst nodePosition = Dom.getPosition(node);\n\t\tconst position = pos || nodePosition;\n\n\t\tDom.style(node, {\n\t\t\tposition: 'absolute',\n\t\t\twidth: `${position.width}px`,\n\t\t\theight: `${nodePosition.height}px`,\n\t\t\ttop: `${position.top}px`,\n\t\t\tleft: `${position.left}px`,\n\t\t\tzIndex: 960,\n\t\t});\n\t}\n\n\t#makeNodeStatic(node: HTMLElement): void\n\t{\n\t\tDom.style(node, {\n\t\t\tposition: null,\n\t\t\twidth: null,\n\t\t\theight: null,\n\t\t\ttop: null,\n\t\t\tleft: null,\n\t\t});\n\t}\n\n\t#isNodeVisible(node: HTMLElement): boolean\n\t{\n\t\tconst nodePosition = Dom.getPosition(node);\n\n\t\treturn node.offsetParent !== null && nodePosition.height > 0 && nodePosition.width > 0;\n\t}\n\n\tstatic create(id: string, settings): this\n\t{\n\t\tconst self = new ItemNew();\n\t\tself.initialize(id, settings);\n\n\t\treturn self;\n\t}\n}\n","import { ConfigurableItem, Item, StreamType } from 'crm.timeline.item';\nimport { Dom, Type } from 'main.core';\nimport { DateTimeFormat, Timezone } from 'main.date';\nimport ItemAnimation from './animations/item';\nimport ItemNew from './animations/item-new';\nimport Manager from './manager';\n\n/** @memberof BX.Crm.Timeline */\nexport default class Steam\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._container = null;\n\t\tthis._manager = null;\n\t\tthis._activityEditor = null;\n\n\t\tthis._timeFormat = \"\";\n\t\tthis._year = 0;\n\n\t\tthis._isStubMode = false;\n\t\tthis._userId = 0;\n\t\tthis._readOnly = false;\n\t\tthis._streamType = StreamType.history;\n\t\tthis._anchor = null;\n\n\t\tthis._serviceUrl = \"\";\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._container = BX(this.getSetting(\"container\"));\n\t\tif (!BX.type.isElementNode(this._container))\n\t\t{\n\t\t\tthrow \"Timeline. Container node is not found.\";\n\t\t}\n\t\tthis._editorContainer = BX(this.getSetting(\"editorContainer\"));\n\t\tthis._manager = this.getSetting(\"manager\");\n\t\tif (!(this._manager instanceof Manager))\n\t\t{\n\t\t\tthrow \"Timeline. Manager instance is not found.\";\n\t\t}\n\n\t\t//\n\t\tconst datetimeFormat = BX.message(\"FORMAT_DATETIME\").replace(/:SS/, \"\");\n\t\tconst dateFormat = BX.message(\"FORMAT_DATE\");\n\t\tthis._timeFormat = BX.date.convertBitrixFormat(BX.util.trim(datetimeFormat.replace(dateFormat, \"\")));\n\t\t//\n\t\tthis._year = (new Date()).getFullYear();\n\n\t\tthis._activityEditor = this.getSetting(\"activityEditor\");\n\n\t\tthis._isStubMode = BX.prop.getBoolean(this._settings, \"isStubMode\", false);\n\t\tthis._readOnly = BX.prop.getBoolean(this._settings, \"readOnly\", false);\n\t\tthis._userId = BX.prop.getInteger(this._settings, \"userId\", 0);\n\t\tthis._serviceUrl = BX.prop.getString(this._settings, \"serviceUrl\", \"\");\n\n\t\tthis.doInitialize();\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tisScheduleStream(): boolean\n\t{\n\t\treturn this.getStreamType() === StreamType.scheduled;\n\t}\n\n\tisFixedHistoryStream(): boolean\n\t{\n\t\treturn this.getStreamType() === StreamType.pinned;\n\t}\n\n\tisHistoryStream(): boolean\n\t{\n\t\treturn this.getStreamType() === StreamType.history;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\tdoInitialize()\n\t{\n\t}\n\n\tlayout()\n\t{\n\t}\n\n\tisStubMode()\n\t{\n\t\treturn this._isStubMode;\n\t}\n\n\tisReadOnly()\n\t{\n\t\treturn this._readOnly;\n\t}\n\n\tgetUserId()\n\t{\n\t\treturn this._userId;\n\t}\n\n\tgetServiceUrl()\n\t{\n\t\treturn this._serviceUrl;\n\t}\n\n\tgetAnchor(): ?HTMLElement\n\t{\n\t\treturn this._anchor;\n\t}\n\n\tgetStreamType() {\n\t\treturn this._streamType;\n\t}\n\n\trefreshLayout()\n\t{\n\t}\n\n\tgetManager()\n\t{\n\t\treturn this._manager;\n\t}\n\n\tgetOwnerInfo()\n\t{\n\t\treturn this._manager.getOwnerInfo();\n\t}\n\n\treload()\n\t{\n\t\tconst currentUrl = this.getSetting(\"currentUrl\");\n\t\tconst ajaxId = this.getSetting(\"ajaxId\");\n\t\tif (ajaxId !== \"\")\n\t\t{\n\t\t\tBX.ajax.insertToNode(BX.util.add_url_param(currentUrl, {bxajaxid: ajaxId}), \"comp_\" + ajaxId);\n\t\t}\n\t\telse\n\t\t{\n\t\t\twindow.location = currentUrl;\n\t\t}\n\t}\n\n\tgetUserTimezoneOffset()\n\t{\n\t\treturn Timezone.Offset.USER_TO_SERVER;\n\t}\n\n\tgetServerTimezoneOffset()\n\t{\n\t\treturn Timezone.Offset.SERVER_TO_UTC;\n\t}\n\n\t// @todo replace by DatetimeConverter\n\tformatTime(time, now, utc)\n\t{\n\t\treturn DateTimeFormat.format(this._timeFormat, time, now, utc);\n\t}\n\n\t// @todo replace by DatetimeConverter\n\tformatDate(date)\n\t{\n\t\treturn (\n\t\t\tDateTimeFormat.format(\n\t\t\t\t[\n\t\t\t\t\t[\"today\", \"today\"],\n\t\t\t\t\t[\"tommorow\", \"tommorow\"],\n\t\t\t\t\t[\"yesterday\", \"yesterday\"],\n\t\t\t\t\t[\"\", (date.getFullYear() === this._year) ? DateTimeFormat.getFormat('DAY_MONTH_FORMAT') : DateTimeFormat.getFormat('LONG_DATE_FORMAT')],\n\t\t\t\t],\n\t\t\t\tdate\n\t\t\t)\n\t\t);\n\t}\n\n\tcutOffText(text, length): string\n\t{\n\t\tif (!BX.type.isNumber(length))\n\t\t{\n\t\t\tlength = 0;\n\t\t}\n\n\t\tif (length <= 0 || text.length <= length)\n\t\t{\n\t\t\treturn text;\n\t\t}\n\n\t\tlet offset = length - 1;\n\t\tconst whitespaceOffset = text.substring(offset).search(/\\s/i);\n\t\tif (whitespaceOffset > 0)\n\t\t{\n\t\t\toffset += whitespaceOffset;\n\t\t}\n\t\treturn text.substring(0, offset) + \"...\";\n\t}\n\n\tgetItems(): Array\n\t{\n\t\treturn [];\n\t}\n\n\t/**\n\t * @abstract\n\t */\n\tsetItems(items: Array): void\n\t{\n\t\tthrow new Error('Stream.setItems() must be overridden');\n\t}\n\n\tgetLastItem(): ?Item\n\t{\n\t\tconst items = this.getItems();\n\n\t\treturn items.length > 0 ? items[items.length - 1] : null;\n\t}\n\n\tfindItemById(id): ?Item\n\t{\n\t\tid = id.toString();\n\n\t\treturn this.getItems().find(item => item.getId() === id) || null;\n\t}\n\n\tgetItemIndex(item: Item): number\n\t{\n\t\treturn this.getItems().findIndex((currentItem) => (currentItem === item));\n\t}\n\n\tremoveItemByIndex(index): void\n\t{\n\t\tconst items = this.getItems();\n\t\tif (index < items.length)\n\t\t{\n\t\t\titems.splice(index, 1);\n\t\t\tthis.setItems(items);\n\t\t}\n\t}\n\n\t/**\n\t * @abstract\n\t */\n\tcreateItem(data): Item\n\t{\n\t\tthrow new Error('Stream.createItem() must be overridden');\n\t}\n\n\tcreateItemCopy(item: Item): Item\n\t{\n\t\tif (item instanceof ConfigurableItem)\n\t\t{\n\t\t\treturn item.clone();\n\t\t}\n\n\t\treturn this.createItem(item.getData());\n\t}\n\n\trefreshItem(item: Item, animateUpdate: boolean = true, animateMove: true): Promise\n\t{\n\t\tconst index = this.getItemIndex(item);\n\t\tif(index < 0)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tthis.removeItemByIndex(index);\n\n\t\tlet itemPositionChanged = false;\n\t\tlet newIndex = 0;\n\t\tlet newItem;\n\t\tif (this.isScheduleStream())\n\t\t{\n\t\t\tnewItem = this.createItemCopy(item);\n\t\t\tnewIndex = this.calculateItemIndex(newItem);\n\n\t\t\titemPositionChanged = newIndex !== index;\n\t\t}\n\n\t\tif(!itemPositionChanged)\n\t\t{\n\t\t\tthis.addItem(item, newIndex);\n\t\t\titem.refreshLayout();\n\t\t\tif (animateUpdate)\n\t\t\t{\n\t\t\t\treturn this.animateItemAdding(item);\n\t\t\t}\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst anchor = this.createAnchor(newIndex);\n\t\tthis.addItem(newItem, newIndex);\n\t\tif (animateMove)\n\t\t{\n\t\t\tnewItem.layout({add: false});\n\n\t\t\treturn new Promise((resolve) => {\n\t\t\t\tconst animation = ItemAnimation.create(\n\t\t\t\t\t'',\n\t\t\t\t\t{\n\t\t\t\t\t\tinitialItem: item,\n\t\t\t\t\t\tfinalItem: newItem,\n\t\t\t\t\t\tanchor: anchor,\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tcomplete: () => {\n\t\t\t\t\t\t\t\titem.destroy();\n\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\tanimation.run();\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnewItem.layout({anchor: anchor});\n\t\t\titem.destroy();\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\t}\n\n\tcalculateItemIndex(item: Item): Number\n\t{\n\t\treturn 0;\n\t}\n\n\tcreateAnchor(index): HTMLElement\n\t{\n\t\treturn null;\n\t}\n\n\t/**\n\t * @abstract\n\t */\n\taddItem(item: Item, index): void\n\t{\n\t\tthrow new Error('Stream.addItem() must be overridden');\n\t}\n\n\t/**\n\t * @abstract\n\t */\n\tdeleteItem(item: Item): void\n\t{\n\t\tthrow new Error('Stream.deleteItem() must be overridden');\n\t}\n\n\tdeleteItemAnimated(item: Item): void\n\t{\n\t\tif (!Type.isDomNode(item.getWrapper()))\n\t\t{\n\t\t\tthis.deleteItem(item);\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\treturn new Promise((resolve) => {\n\t\t\tconst wrapperPosition = Dom.getPosition(item.getWrapper());\n\n\t\t\tif (Dom.hasClass(item.getWrapper(), 'crm-entity-stream-section-planned'))\n\t\t\t{\n\t\t\t\tDom.style(item.getWrapper(), {\n\t\t\t\t\tanimation: 'none',\n\t\t\t\t\topacity: 1,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst hideEvent = new BX.easing({\n\t\t\t\tduration: 1000,\n\t\t\t\tstart: {height: wrapperPosition.height, opacity: 1, marginBottom: 15},\n\t\t\t\tfinish: {height: 0, opacity: 0, marginBottom: 0},\n\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\tstep: (state) => {\n\t\t\t\t\tDom.style(item.getWrapper(), {\n\t\t\t\t\t\theight:  state.height + 'px',\n\t\t\t\t\t\topacity:  state.opacity,\n\t\t\t\t\t\tmarginBottom:  state.marginBottom,\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tcomplete: () => {\n\t\t\t\t\tthis.deleteItem(item)\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\thideEvent.animate();\n\t\t});\n\t}\n\n\tmoveItemToStream(item: Item, destinationStream: Steam, destinationItem: Item): void\n\t{\n\t\tthis.removeItemByIndex(this.getItemIndex(item));\n\t\tif (this.getItems().length > 0)\n\t\t{\n\t\t\tthis.refreshLayout();\n\t\t}\n\n\t\treturn new Promise((resolve) => {\n\t\t\tconst animation = ItemNew.create(\n\t\t\t\t'',\n\t\t\t\t{\n\t\t\t\t\tinitialItem: item,\n\t\t\t\t\tfinalItem: destinationItem,\n\t\t\t\t\tanchor: destinationStream.createAnchor(),\n\t\t\t\t\tevents: {complete: () => {\n\t\t\t\t\t\t\tthis.refreshLayout();\n\t\t\t\t\t\t\tdestinationStream.refreshLayout();\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t}}\n\t\t\t\t}\n\t\t\t);\n\t\t\tanimation.run();\n\t\t});\n\t}\n\n\tanimateItemAdding(item): Promise\n\t{\n\t\treturn Promise.resolve();\n\t}\n}\n","import { ajax, clone, Loc, Type } from 'main.core';\nimport Fasten from './animations/fasten';\nimport CompatibleItem from './items/compatible-item';\nimport Stream from './stream';\n\ndeclare type PullActionProcessorMessage = {\n\taction: string,\n\titem: Object,\n\tstream: string,\n\tid: string,\n\tparams: Object | null,\n};\n\ndeclare type PullActionProcessorProps = {\n\tscheduleStream: Stream,\n\tfixedHistoryStream: Stream,\n\thistoryStream: Stream,\n\townerTypeId: number,\n\townerId: number,\n\tuserId: number,\n};\n\nexport default class PullActionProcessor\n{\n\t#scheduleStream: Stream = null;\n\t#fixedHistoryStream: Stream = null;\n\t#historyStream: Stream = null;\n\n\t#itemsQueue = [];\n\t#itemsQueueProcessing = false;\n\n\t#reloadingMessagesQueue: PullActionProcessorMessage[] = [];\n\n\t#ownerTypeId: number;\n\t#ownerId: number;\n\n\t#userId: number;\n\n\tconstructor(params: PullActionProcessorProps)\n\t{\n\t\tif (\n\t\t\t!Type.isObject(params.scheduleStream)\n\t\t\t|| !Type.isObject(params.fixedHistoryStream)\n\t\t\t|| !Type.isObject(params.historyStream)\n\t\t)\n\t\t{\n\t\t\tthrow new Error(`params scheduleStream, fixedHistoryStream and historyStream are required`);\n\t\t}\n\n\t\tif (!Type.isNumber(params.ownerTypeId) || !Type.isNumber(params.ownerId))\n\t\t{\n\t\t\tthrow new Error('params ownerTypeId and ownerId are required');\n\t\t}\n\n\t\tthis.#scheduleStream = params.scheduleStream;\n\t\tthis.#fixedHistoryStream = params.fixedHistoryStream;\n\t\tthis.#historyStream = params.historyStream;\n\t\tthis.#ownerTypeId = params.ownerTypeId;\n\t\tthis.#ownerId = params.ownerId;\n\t\tthis.#userId = params.userId;\n\t}\n\n\tprocessAction(actionParams: PullActionProcessorMessage): void\n\t{\n\t\tif (this.#itemDataShouldBeReloaded(actionParams))\n\t\t{\n\t\t\tthis.#reloadingMessagesQueue.push(actionParams);\n\t\t\tthis.#fetchItems();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#addToQueue(actionParams);\n\t\t}\n\t}\n\n\t#itemDataShouldBeReloaded(actionParams: PullActionProcessorMessage)\n\t{\n\t\tconst { item } = actionParams;\n\n\t\tif (!item)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst canBeReloaded = BX.prop.getBoolean(item, 'canBeReloaded', true);\n\t\tif (!canBeReloaded)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst appLanguage = Loc.getMessage('LANGUAGE_ID').toLowerCase();\n\t\tconst languageId = BX.prop.getString(item, 'languageId', appLanguage).toLowerCase();\n\n\t\t// maybe item was built under user with different language\n\t\tif (languageId !== appLanguage)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst targetUsersList = BX.prop.getArray(item, 'targetUsersList', []);\n\n\t\t// maybe item has user-specific information\n\t\treturn targetUsersList.length > 0 && !targetUsersList.includes(this.#userId);\n\t}\n\n\t#addToQueue(actionParams: PullActionProcessorMessage)\n\t{\n\t\tthis.#itemsQueue.push(actionParams);\n\t\tif (!this.#itemsQueueProcessing)\n\t\t{\n\t\t\tthis.#processQueueItem();\n\t\t}\n\t}\n\n\t#processQueueItem(): void\n\t{\n\t\tif (!this.#itemsQueue.length)\n\t\t{\n\t\t\tthis.#itemsQueueProcessing = false;\n\n\t\t\treturn;\n\t\t}\n\t\tthis.#itemsQueueProcessing = true;\n\t\tconst actionParams = this.#itemsQueue.shift();\n\n\t\tconst stream = this.#getStreamByName(actionParams.stream);\n\n\t\tconst promises = [];\n\t\tswitch (actionParams.action)\n\t\t{\n\t\t\tcase 'add':\n\t\t\t\tpromises.push(this.#addItem(actionParams.id, actionParams.item, stream));\n\t\t\t\tbreak;\n\t\t\tcase 'update':\n\t\t\t\tpromises.push(this.#updateItem(actionParams.id, actionParams.item, stream, false, true));\n\t\t\t\tif (stream.isHistoryStream())\n\t\t\t\t{\n\t\t\t\t\t// fixed history stream can contain the same item as a history stream, so both should be updated:\n\t\t\t\t\tpromises.push(this.#updateItem(actionParams.id, actionParams.item, this.#fixedHistoryStream, false, true));\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'delete':\n\t\t\t\tpromises.push(this.#deleteItem(actionParams.id, stream));\n\t\t\t\tif (stream.isHistoryStream())\n\t\t\t\t{\n\t\t\t\t\t// fixed history stream can contain the same item as a history stream, so both should be updated:\n\t\t\t\t\tpromises.push(this.#deleteItem(actionParams.id, this.#fixedHistoryStream));\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'move':\n\t\t\t\t// move item from one stream to another one:\n\t\t\t\tconst sourceStream = this.#getStreamByName(actionParams.params.fromStream);\n\t\t\t\tpromises.push(this.#moveItem(actionParams.params.fromId, sourceStream, actionParams.id, stream, actionParams.item));\n\t\t\t\tbreak;\n\t\t\tcase 'changePinned':\n\t\t\t\t// pin or unpin item\n\t\t\t\tif (this.#getStreamByName(actionParams.params.fromStream).isHistoryStream())\n\t\t\t\t{\n\t\t\t\t\tpromises.push(this.#pinItem(actionParams.id, actionParams.item));\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tpromises.push(this.#unpinItem(actionParams.id, actionParams.item));\n\t\t\t\t}\n\t\t}\n\n\t\tPromise.all(promises).then(() => {\n\t\t\tthis.#processQueueItem();\n\t\t})\n\t}\n\n\tasync #addItem(id: number, itemData: Object, stream: Stream): Promise\n\t{\n\t\tconst existedStreamItem = stream.findItemById(id);\n\t\tif (existedStreamItem)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\tconst streamItem = stream.createItem(itemData);\n\t\tif (!streamItem)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst index = stream.calculateItemIndex(streamItem);\n\t\tconst anchor = stream.createAnchor(index);\n\t\tawait stream.addItem(streamItem, index);\n\t\tstreamItem.layout({ anchor });\n\n\t\treturn stream.animateItemAdding(streamItem);\n\t}\n\n\t#updateItem(id: number, itemData: Object, stream: Stream, animateUpdate: boolean = true, animateMove: true): Promise\n\t{\n\t\tconst isDone = BX.prop.getString(itemData['ASSOCIATED_ENTITY'], 'COMPLETED') === 'Y';\n\t\tconst existedStreamItem = stream.findItemById(id);\n\t\tif (!existedStreamItem)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tif (existedStreamItem instanceof CompatibleItem && isDone)\n\t\t{\n\t\t\texistedStreamItem._existedStreamItemDeadLine = existedStreamItem.getLightTime();\n\t\t}\n\n\t\texistedStreamItem.setData(itemData);\n\t\treturn stream.refreshItem(existedStreamItem, animateUpdate, animateMove);\n\t}\n\n\t#deleteItem(id: number, stream: Stream): Promise\n\t{\n\t\tconst item = stream.findItemById(id);\n\t\tif (item)\n\t\t{\n\t\t\treturn stream.deleteItemAnimated(item);\n\t\t}\n\n\t\treturn Promise.resolve();\n\t}\n\n\t#moveItem(sourceId: string, sourceStream: Stream, destinationId: string, destinationStream: Stream, destinationItemData: Object): Promise\n\t{\n\t\tconst sourceItem = sourceStream.findItemById(sourceId);\n\t\tif (!sourceItem)\n\t\t{\n\t\t\treturn this.#addItem(destinationId, destinationItemData, destinationStream);\n\t\t}\n\n\t\tconst existedDestinationItem = destinationStream.findItemById(destinationId);\n\t\tif (sourceItem && existedDestinationItem)\n\t\t{\n\t\t\treturn this.#deleteItem(sourceId, sourceStream);\n\t\t}\n\n\t\tconst destinationItem = destinationStream.createItem(destinationItemData);\n\t\tdestinationStream.addItem(destinationItem, destinationStream.calculateItemIndex(destinationItem));\n\n\t\tif (destinationItem instanceof CompatibleItem)\n\t\t{\n\t\t\tdestinationItem.layout({ add: false });\n\t\t}\n\n\t\treturn sourceStream.moveItemToStream(sourceItem, destinationStream, destinationItem);\n\t}\n\n\t#pinItem(id: number, itemData: Object): Promise\n\t{\n\t\tif (this.#fixedHistoryStream.findItemById(id))\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst historyItem = this.#historyStream.findItemById(id);\n\t\tif (!historyItem) // fixed history item does not exist into history items stream, so just add to fixed history stream\n\t\t{\n\t\t\treturn this.#addItem(id, itemData, this.#fixedHistoryStream);\n\t\t}\n\t\tif (historyItem instanceof CompatibleItem)\n\t\t{\n\t\t\thistoryItem.onSuccessFasten();\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\telse\n\t\t{\n\t\t\t// hide files block in comment content before pin\n\t\t\tconst historyCommentBlock = historyItem.getLayoutContentBlockById('commentContentWeb');\n\t\t\tif (historyCommentBlock)\n\t\t\t{\n\t\t\t\thistoryCommentBlock.setIsFilesBlockDisplayed(false);\n\t\t\t\thistoryCommentBlock.setIsMoving();\n\t\t\t}\n\n\t\t\treturn this.#updateItem(id, itemData, this.#historyStream, false, false).then(() => {\n\t\t\t\tconst fixedHistoryItem = this.#fixedHistoryStream.createItem(itemData);\n\t\t\t\tfixedHistoryItem.initWrapper();\n\t\t\t\tthis.#fixedHistoryStream.addItem(fixedHistoryItem, 0);\n\n\t\t\t\treturn new Promise((resolve) => {\n\t\t\t\t\tconst animation = Fasten.create(\n\t\t\t\t\t\t'',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tinitialItem: historyItem,\n\t\t\t\t\t\t\tfinalItem: fixedHistoryItem,\n\t\t\t\t\t\t\tanchor: this.#fixedHistoryStream.getAnchor(),\n\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\tcomplete: () => {\n\t\t\t\t\t\t\t\t\tfixedHistoryItem.initLayoutApp({ add: false });\n\n\t\t\t\t\t\t\t\t\t// show files block in comment content after pin record\n\t\t\t\t\t\t\t\t\tif (historyCommentBlock)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\thistoryCommentBlock.setIsFilesBlockDisplayed();\n\t\t\t\t\t\t\t\t\t\thistoryCommentBlock.setIsMoving(false);\n\n\t\t\t\t\t\t\t\t\t\tconst fixedHistoryCommentBlock = fixedHistoryItem.getLayoutContentBlockById('commentContentWeb');\n\t\t\t\t\t\t\t\t\t\tif (fixedHistoryCommentBlock)\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tfixedHistoryCommentBlock.setIsFilesBlockDisplayed();\n\t\t\t\t\t\t\t\t\t\t\tfixedHistoryCommentBlock.setIsMoving(false);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\tanimation.run();\n\t\t\t\t})\n\t\t\t});\n\t\t}\n\t}\n\n\t#unpinItem(id: number, itemData: Object): Promise\n\t{\n\t\tconst fixedHistoryItem = this.#fixedHistoryStream.findItemById(id);\n\t\tif (fixedHistoryItem instanceof CompatibleItem)\n\t\t{\n\t\t\tfixedHistoryItem.onSuccessUnfasten();\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this.#updateItem(id, itemData, this.#historyStream, false, false).then(() => {\n\t\t\t\treturn this.#deleteItem(id, this.#fixedHistoryStream);\n\t\t\t});\n\t\t}\n\t}\n\n\t#getStreamByName(streamName): Stream\n\t{\n\t\tswitch (streamName)\n\t\t{\n\t\t\tcase 'scheduled':\n\t\t\t\treturn this.#scheduleStream;\n\t\t\tcase 'fixedHistory':\n\t\t\t\treturn this.#fixedHistoryStream;\n\t\t\tcase 'history':\n\t\t\t\treturn this.#historyStream;\n\t\t}\n\n\t\tthrow new Error(`Stream \"${streamName}\" not found`);\n\t}\n\n\t#fetchItems()\n\t{\n\t\tsetTimeout(() => {\n\n\t\t\tconst messages = clone(this.#reloadingMessagesQueue);\n\t\t\tthis.#reloadingMessagesQueue = [];\n\n\t\t\tconst activityIds = [];\n\t\t\tconst historyIds = [];\n\n\t\t\tmessages.forEach(message => {\n\t\t\t\tconst container = message.stream === 'scheduled' ? activityIds : historyIds;\n\t\t\t\tcontainer.push(message.id);\n\t\t\t});\n\n\t\t\tif (messages.length)\n\t\t\t{\n\t\t\t\tconst data = {\n\t\t\t\t\tactivityIds,\n\t\t\t\t\thistoryIds,\n\t\t\t\t\townerTypeId: this.#ownerTypeId,\n\t\t\t\t\townerId: this.#ownerId,\n\t\t\t\t};\n\n\t\t\t\tajax.runAction('crm.timeline.item.load', { data })\n\t\t\t\t\t.then(response => {\n\t\t\t\t\t\tmessages.forEach(message => {\n\t\t\t\t\t\t\tif (response.data[message.id])\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tmessage.item = response.data[message.id];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.#addToQueue(message);\n\t\t\t\t\t\t})\n\t\t\t\t\t})\n\t\t\t\t\t.catch(err => {\n\t\t\t\t\t\tconsole.error(err);\n\t\t\t\t\t\tmessages.forEach(message => this.#addToQueue(message));\n\t\t\t\t\t});\n\t\t\t}\n\n\t\t}, 1500);\n\t}\n}\n","import { Dom, Reflection, Text, Type } from 'main.core';\nimport Stream from '../stream';\n\n/** @memberof BX.Crm.Timeline.Streams */\nexport default class EntityChat extends Stream\n{\n\tstatic LayoutType = {\n\t\tnone: 0,\n\t\tinvitation: 1,\n\t\tsummary: 2,\n\t};\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._data = null;\n\t\tthis._layoutType = EntityChat.LayoutType.none;\n\n\t\tthis._wrapper = null;\n\t\tthis._contentWrapper = null;\n\t\tthis._messageWrapper = null;\n\t\tthis._messageDateNode = null;\n\t\tthis._messageTexWrapper = null;\n\t\tthis._messageTextNode = null;\n\t\tthis._userWrapper = null;\n\t\tthis._extraUserCounter = null;\n\t\tthis.isLoading = false;\n\n\t\tthis._openChatHandler = BX.delegate(this.onOpenChat, this);\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._data = BX.prop.getObject(this._settings, \"data\", {});\n\t}\n\n\tgetData()\n\t{\n\t\treturn this._data;\n\t}\n\n\tsetData(data)\n\t{\n\t\tthis._data = BX.type.isPlainObject(data) ? data : {};\n\t}\n\n\tisEnabled()\n\t{\n\t\treturn BX.prop.getBoolean(this._data, \"ENABLED\", true);\n\t}\n\n\t/**\n\t * @private\n\t * @return {boolean}\n\t */\n\tisRestricted()\n\t{\n\t\treturn BX.prop.getBoolean(this._data, \"IS_RESTRICTED\", false);\n\t}\n\n\t/**\n\t * @private\n\t * @return {void}\n\t */\n\tapplyLockScript()\n\t{\n\t\tconst lockScript = BX.prop.getString(this._data, \"LOCK_SCRIPT\", null);\n\t\tif (BX.Type.isString(lockScript) && lockScript !== '')\n\t\t{\n\t\t\teval(lockScript);\n\t\t}\n\t}\n\n\tgetChatId()\n\t{\n\t\treturn BX.prop.getInteger(this._data, \"CHAT_ID\", 0);\n\t}\n\n\tgetUserId()\n\t{\n\t\tconst userId = parseInt(top.BX.message(\"USER_ID\"));\n\t\treturn !isNaN(userId) ? userId : 0;\n\t}\n\n\tgetMessageData()\n\t{\n\t\treturn BX.prop.getObject(this._data, \"MESSAGE\", {});\n\t}\n\n\tsetMessageData(data)\n\t{\n\t\tthis._data[\"MESSAGE\"] = BX.type.isPlainObject(data) ? data : {};\n\t}\n\n\tgetUserInfoData()\n\t{\n\t\treturn BX.prop.getObject(this._data, \"USER_INFOS\", {});\n\t}\n\n\tsetUserInfoData(data)\n\t{\n\t\tthis._data[\"USER_INFOS\"] = BX.type.isPlainObject(data) ? data : {};\n\t}\n\n\thasUserInfo(userId)\n\t{\n\t\treturn userId > 0 && BX.type.isPlainObject(this.getUserInfoData()[userId]);\n\t}\n\n\tgetUserInfo(userId)\n\t{\n\t\tconst userInfos = this.getUserInfoData();\n\t\treturn userId > 0 && BX.type.isPlainObject(userInfos[userId]) ? userInfos[userId] : null;\n\t}\n\n\tremoveUserInfo(userId)\n\t{\n\t\tconst userInfos = this.getUserInfoData();\n\t\tif(userId > 0 && BX.type.isPlainObject(userInfos[userId]))\n\t\t{\n\t\t\tdelete userInfos[userId];\n\t\t}\n\t}\n\n\tsetUnreadMessageCounter(userId, counter)\n\t{\n\t\tconst userInfos = this.getUserInfoData();\n\t\tif(userId > 0 && BX.type.isPlainObject(userInfos[userId]))\n\t\t{\n\t\t\tuserInfos[userId][\"counter\"] = counter;\n\t\t}\n\t}\n\n\tlayout()\n\t{\n\t\tif(!this.isEnabled() || this.isStubMode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._wrapper = BX.create(\"div\", { props: { className: \"crm-entity-stream-section crm-entity-stream-section-live-im\" } });\n\t\tthis._container.appendChild(this._wrapper);\n\n\t\tthis._wrapper.appendChild(\n\t\t\tBX.create(\"div\", { props: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-live-im\" } })\n\t\t);\n\n\t\tthis._contentWrapper = BX.create(\"div\", { props: { className: \"crm-entity-stream-content-live-im-detail\" } });\n\n\t\tthis._wrapper.appendChild(\n\t\t\tBX.create(\"div\",\n\t\t\t\t{\n\t\t\t\t\tprops: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"div\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tprops: { className: \"crm-entity-stream-content-event\" },\n\t\t\t\t\t\t\t\t\tchildren: [ this._contentWrapper ]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis._userWrapper = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-user-avatars\" } });\n\t\tthis._contentWrapper.appendChild(\n\t\t\tBX.create(\"div\",\n\t\t\t\t{\n\t\t\t\t\tprops: { className: \"crm-entity-stream-live-im-users\" },\n\t\t\t\t\tchildren: [ this._userWrapper ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis._extraUserCounter = BX.create(\"div\",{ props: { className: \"crm-entity-stream-live-im-user-counter\" } });\n\t\tthis._contentWrapper.appendChild(this._extraUserCounter);\n\n\t\tthis._layoutType = EntityChat.LayoutType.none;\n\t\tif(this.getChatId() > 0)\n\t\t{\n\t\t\tthis.renderSummary();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.renderInvitation();\n\t\t}\n\n\t\tBX.bind(this._contentWrapper, \"click\", this._openChatHandler);\n\t\tBX.addCustomEvent(\"onPullEvent-im\", this.onChatEvent.bind(this));\n\t}\n\n\trefreshLayout()\n\t{\n\t\tBX.cleanNode(this._contentWrapper);\n\t\tthis._userWrapper = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-user-avatars\" } });\n\t\tthis._contentWrapper.appendChild(\n\t\t\tBX.create(\"div\",\n\t\t\t\t{\n\t\t\t\t\tprops: { className: \"crm-entity-stream-live-im-users\" },\n\t\t\t\t\tchildren: [ this._userWrapper ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tthis._extraUserCounter = BX.create(\"div\",{ props: { className: \"crm-entity-stream-live-im-user-counter\" } });\n\t\tthis._contentWrapper.appendChild(this._extraUserCounter);\n\n\t\tthis._layoutType = EntityChat.LayoutType.none;\n\t\tif(this.getChatId() > 0)\n\t\t{\n\t\t\tthis.renderSummary();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.renderInvitation();\n\t\t}\n\t}\n\n\trenderInvitation()\n\t{\n\t\tthis._layoutType = EntityChat.LayoutType.invitation;\n\t\tthis.refreshUsers();\n\n\t\tthis._messageTextNode = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-user-invite-text\" } });\n\t\tthis._contentWrapper.appendChild(this._messageTextNode);\n\n\t\tthis._messageTextNode.innerHTML = this.getMessage(\"invite\");\n\t}\n\n\trenderSummary()\n\t{\n\t\tthis._layoutType = EntityChat.LayoutType.summary;\n\t\tthis.refreshUsers();\n\n\t\tthis._contentWrapper.appendChild(\n\t\t\tBX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-separator\" } })\n\t\t);\n\n\t\tthis._messageWrapper = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-messanger\" } });\n\t\tthis._contentWrapper.appendChild(this._messageWrapper);\n\n\t\tthis._messageDateNode = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-time\" } });\n\t\tthis._messageWrapper.appendChild(this._messageDateNode);\n\n\t\tthis._messageTexWraper = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-message\" } });\n\t\tthis._messageWrapper.appendChild(this._messageTexWraper);\n\n\t\tthis._messageTextNode = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-message-text\" } });\n\t\tthis._messageTexWraper.appendChild(this._messageTextNode);\n\n\t\tthis._messageCounterNode = BX.create(\"div\", { props: { className: \"crm-entity-stream-live-im-message-counter\" } });\n\t\tthis._messageWrapper.appendChild(this._messageCounterNode);\n\n\t\tthis.refreshSummary();\n\t}\n\n\trefreshUsers()\n\t{\n\t\tBX.cleanNode(this._userWrapper);\n\n\t\tconst infos = this.getUserInfoData();\n\t\tconst list = Object.values(infos);\n\n\t\tif(list.length === 0)\n\t\t{\n\t\t\tthis._userWrapper.appendChild(\n\t\t\t\tBX.create(\"span\",\n\t\t\t\t\t{\n\t\t\t\t\t\tprops: { className: \"crm-entity-stream-live-im-user-avatar ui-icon ui-icon-common-user\" },\n\t\t\t\t\t\tchildren: [ BX.create(\"i\") ]\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst count = list.length >= 3 ? 3 : list.length;\n\t\t\tfor(let i = 0; i < count; i++)\n\t\t\t{\n\t\t\t\tconst info = list[i];\n\n\t\t\t\tconst icon = BX.create(\"i\");\n\t\t\t\tconst imageUrl = BX.prop.getString(info, \"avatar\", \"\");\n\t\t\t\tif (Type.isStringFilled(imageUrl))\n\t\t\t\t{\n\t\t\t\t\ticon.style.backgroundImage = \"url('\" +  encodeURI(Text.encode(imageUrl)) + \"')\";\n\t\t\t\t}\n\n\t\t\t\tthis._userWrapper.appendChild(\n\t\t\t\t\tBX.create(\"span\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tprops: { className: \"crm-entity-stream-live-im-user-avatar ui-icon ui-icon-common-user\" },\n\t\t\t\t\t\t\tchildren: [ icon ]\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif(this._layoutType === EntityChat.LayoutType.summary)\n\t\t{\n\t\t\tif(list.length > 3)\n\t\t\t{\n\t\t\t\tthis._extraUserCounter.display = \"\";\n\t\t\t\tthis._extraUserCounter.innerHTML = \"+\" + (list.length - 3).toString();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif(this._extraUserCounter.innerHTML !== \"\")\n\t\t\t\t{\n\t\t\t\t\tthis._extraUserCounter.innerHTML = \"\";\n\t\t\t\t}\n\t\t\t\tthis._extraUserCounter.display = \"none\";\n\t\t\t}\n\t\t}\n\t\telse //if(this._layoutType === EntityChat.LayoutType.invitation)\n\t\t{\n\t\t\tif(this._extraUserCounter.innerHTML !== \"\")\n\t\t\t{\n\t\t\t\tthis._extraUserCounter.innerHTML = \"\";\n\t\t\t}\n\t\t\tthis._extraUserCounter.display = \"none\";\n\n\t\t\tthis._userWrapper.appendChild(\n\t\t\t\tBX.create(\"span\", { props: { className: \"crm-entity-stream-live-im-user-invite-btn\" } })\n\t\t\t);\n\t\t}\n\t}\n\n\trefreshSummary()\n\t{\n\t\tif(this._layoutType !== EntityChat.LayoutType.summary)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst message = this.getMessageData();\n\n\t\t//region Message Date\n\t\tconst isoDate = BX.prop.getString(message, \"date\", \"\");\n\t\tif(isoDate === \"\")\n\t\t{\n\t\t\tthis._messageDateNode.innerHTML = \"\";\n\t\t}\n\t\telse\n\t\t{\n\t\t\t// @todo replace by DatetimeConverter\n\t\t\tconst remoteDate = (new Date(isoDate)).getTime() / 1000 + this.getServerTimezoneOffset() + this.getUserTimezoneOffset();\n\t\t\tconst localTime = (new Date).getTime() / 1000 + this.getServerTimezoneOffset() + this.getUserTimezoneOffset();\n\t\t\tthis._messageDateNode.innerHTML = this.formatTime(remoteDate, localTime, true);\n\t\t}\n\t\t//endregion\n\n\t\t//region Message Text\n\t\tlet text = BX.prop.getString(message, \"text\", \"\");\n\t\tconst params = BX.prop.getObject(message, \"params\", {});\n\t\tif(text === \"\" && !params.ATTACH && !params.FILE_ID)\n\t\t{\n\t\t\tthis._messageTextNode.innerHTML = \"\";\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst MessengerCommon = Reflection.getClass('top.BX.MessengerCommon');\n\t\t\tconst MessengerParser = Reflection.getClass('top.BX.Messenger.v2.Lib.Parser');\n\t\t\tif (MessengerCommon)\n\t\t\t{\n\t\t\t\ttext = MessengerCommon.purifyText(text, params);\n\t\t\t}\n\t\t\telse if (MessengerParser)\n\t\t\t{\n\t\t\t\ttext = MessengerParser.purify({\n\t\t\t\t\ttext,\n\t\t\t\t\tattach: params.ATTACH,\n\t\t\t\t\tfiles: typeof params.FILE_ID === 'object' && params.FILE_ID.length > 0,\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis._messageTextNode.innerText = text;\n\t\t}\n\t\t//endregion\n\n\t\t//region Unread Message Counter\n\t\tlet counter = 0;\n\t\tconst userId = this.getUserId();\n\t\tif(userId > 0)\n\t\t{\n\t\t\tcounter = BX.prop.getInteger(\n\t\t\t\tBX.prop.getObject(\n\t\t\t\t\tBX.prop.getObject(this._data, \"USER_INFOS\", {}),\n\t\t\t\t\tuserId,\n\t\t\t\t\tnull\n\t\t\t\t),\n\t\t\t\t\"counter\",\n\t\t\t\t0\n\t\t\t);\n\t\t}\n\n\t\tthis._messageCounterNode.innerHTML = counter.toString();\n\t\tthis._messageCounterNode.style.display = counter > 0 ? \"\" : \"none\";\n\t\t//endregion\n\t}\n\n\trefreshUsersAnimated()\n\t{\n\t\tBX.removeClass(this._userWrapper, 'crm-entity-stream-live-im-message-show');\n\t\tBX.addClass(this._userWrapper, 'crm-entity-stream-live-im-message-hide');\n\n\t\twindow.setTimeout(\n\t\t\tfunction()\n\t\t\t{\n\t\t\t\tthis.refreshUsers();\n\t\t\t\twindow.setTimeout(\n\t\t\t\t\tfunction()\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.removeClass(this._userWrapper, 'crm-entity-stream-live-im-message-hide');\n\t\t\t\t\t\tBX.addClass(this._userWrapper, 'crm-entity-stream-live-im-message-show');\n\t\t\t\t\t}.bind(this),\n\t\t\t\t\t50\n\t\t\t\t);\n\t\t\t}.bind(this),\n\t\t\t500\n\t\t);\n\t}\n\n\trefreshSummaryAnimated()\n\t{\n\t\tBX.removeClass(this._messageWrapper, 'crm-entity-stream-live-im-message-show');\n\t\tBX.addClass(this._messageWrapper, 'crm-entity-stream-live-im-message-hide');\n\n\t\twindow.setTimeout(\n\t\t\tfunction()\n\t\t\t{\n\t\t\t\tthis.refreshSummary();\n\t\t\t\twindow.setTimeout(\n\t\t\t\t\tfunction()\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.removeClass(this._messageWrapper, 'crm-entity-stream-live-im-message-hide');\n\t\t\t\t\t\tBX.addClass(this._messageWrapper, 'crm-entity-stream-live-im-message-show');\n\t\t\t\t\t}.bind(this),\n\t\t\t\t\t50\n\t\t\t\t);\n\t\t\t}.bind(this),\n\t\t\t500\n\t\t);\n\t}\n\n\tloading(isLoading: boolean)\n\t{\n\t\tif (this._contentWrapper && this._contentWrapper.classList)\n\t\t{\n\t\t\tif (isLoading)\n\t\t\t{\n\t\t\t\tDom.addClass(this._contentWrapper, 'crm-entity-chat-loading');\n\t\t\t\tthis.isLoading = true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.removeClass(this._contentWrapper, 'crm-entity-chat-loading');\n\t\t\t\tthis.isLoading = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tonOpenChat(e)\n\t{\n\t\tif (Type.isUndefined(top.BX.Messenger.Public) || this.isLoading)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isRestricted())\n\t\t{\n\t\t\tthis.applyLockScript();\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst ownerInfo = this.getOwnerInfo();\n\t\tconst entityId = BX.prop.getInteger(ownerInfo, 'ENTITY_ID', 0);\n\t\tconst entityTypeId = BX.prop.getInteger(ownerInfo, 'ENTITY_TYPE_ID', 0);\n\n\t\tconst data = {\n\t\t\tdata: {\n\t\t\t\tentityId,\n\t\t\t\tentityTypeId,\n\t\t\t},\n\t\t};\n\n\t\tconst successCallback = (response) => {\n\t\t\tthis.loading(false);\n\t\t\tconst chatId = response.data.chatId;\n\t\t\ttop.BX.Messenger.Public.openChat(`chat${chatId}`);\n\t\t};\n\n\t\tconst errorCallback = (error) => {\n\t\t\tthis.loading(false);\n\t\t\tconst errorMessage = error.errors[0].message;\n\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\tcontent: errorMessage,\n\t\t\t\tautoHideDelay: 5000,\n\t\t\t});\n\t\t};\n\n\t\tthis.loading(true);\n\t\tBX.ajax.runAction('crm.timeline.chat.get', data).then(successCallback, errorCallback);\n\t}\n\n\tonChatEvent(command, params, extras)\n\t{\n\t\tconst chatId = this.getChatId();\n\t\tif(chatId <= 0 || chatId !== BX.prop.getInteger(params, \"chatId\", 0))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(command === \"chatUserAdd\")\n\t\t{\n\t\t\tthis.setUserInfoData(BX.mergeEx(this.getUserInfoData(), BX.prop.getObject(params, \"users\", {})));\n\t\t\tthis.refreshUsersAnimated();\n\t\t}\n\t\telse if(command === \"chatUserLeave\")\n\t\t{\n\t\t\tthis.removeUserInfo(BX.prop.getInteger(params, \"userId\", 0));\n\t\t\tthis.refreshUsersAnimated();\n\t\t}\n\t\telse if(command === \"messageChat\")\n\t\t{\n\t\t\t//Message was added.\n\t\t\tthis.setMessageData(BX.prop.getObject(params, \"message\", {}));\n\t\t\tthis.setUnreadMessageCounter(this.getUserId(), BX.prop.getInteger(params, \"counter\", 0));\n\t\t\tthis.refreshSummaryAnimated();\n\t\t}\n\t\telse if(command === \"messageUpdate\" || command === \"messageDelete\")\n\t\t{\n\t\t\t//Message was modified or removed.\n\t\t\tif(command === \"messageDelete\")\n\t\t\t{\n\t\t\t\t//HACK: date is not in ISO format\n\t\t\t\tdelete params[\"date\"];\n\t\t\t}\n\n\t\t\tconst message = this.getMessageData();\n\t\t\tif(BX.prop.getInteger(message, \"id\", 0) === BX.prop.getInteger(params, \"id\", 0))\n\t\t\t{\n\t\t\t\tthis.setMessageData(BX.mergeEx(message, params));\n\t\t\t\tthis.refreshSummaryAnimated();\n\t\t\t}\n\t\t}\n\t\telse if(command === \"readMessageChat\")\n\t\t{\n\t\t\tthis.setUnreadMessageCounter(this.getUserId(), 0);\n\t\t\tthis.refreshSummaryAnimated();\n\t\t}\n\t\telse if(command === \"unreadMessageChat\")\n\t\t{\n\t\t\tthis.setUnreadMessageCounter(this.getUserId(), BX.prop.getInteger(params, \"counter\", 0));\n\t\t\tthis.refreshSummaryAnimated();\n\t\t}\n\t}\n\n\tgetMessage(name)\n\t{\n\t\treturn BX.prop.getString(EntityChat.messages, name, name);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new EntityChat();\n\t\tself.initialize(id, settings);\n\t\tEntityChat.items[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic items = {};\n\tstatic messages = {};\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Modification extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Modification.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getTextDataParam(\"TITLE\");\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-info\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\" } })\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst header = this.prepareHeaderLayout();\n\n\t\tconst contentChildren = [];\n\t\tif (BX.type.isNotEmptyString(this.getTextDataParam(\"START_NAME\")))\n\t\t{\n\t\t\tcontentChildren.push(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detain-info-status\"},\n\t\t\t\t\t\ttext: this.getTextDataParam(\"START_NAME\")\n\t\t\t\t\t})\n\t\t\t);\n\t\t\tcontentChildren.push(\n\t\t\t\tBX.create(\"SPAN\",{ attrs: { className: \"crm-entity-stream-content-detail-info-separator-icon\" } })\n\t\t\t);\n\t\t}\n\n\t\tif (BX.type.isNotEmptyString(this.getTextDataParam(\"FINISH_NAME\")))\n\t\t{\n\t\t\tcontentChildren.push(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detain-info-status\" },\n\t\t\t\t\t\ttext: this.getTextDataParam(\"FINISH_NAME\")\n\t\t\t\t\t})\n\t\t\t);\n\t\t}\n\n\n\t\tcontent.appendChild(header);\n\t\tcontent.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-info\" },\n\t\t\t\t\t\t\t\t\tchildren: contentChildren\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t]\n\t\t\t\t})\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Modification();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class Conversion extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Conversion.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getTextDataParam(\"TITLE\");\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-convert crm-entity-stream-section-history\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-convert\" } })\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst header = this.prepareHeaderLayout();\n\n\t\tcontent.appendChild(header);\n\n\t\tconst entityNodes = [];\n\t\tconst entityInfos = this.getArrayDataParam(\"ENTITIES\");\n\t\tlet i = 0;\n\t\tconst length = entityInfos.length;\n\t\tfor(; i < length; i++)\n\t\t{\n\t\t\tconst entityInfo = entityInfos[i];\n\n\t\t\tlet entityNode;\n\t\t\tif(BX.prop.getString(entityInfo, 'SHOW_URL', \"\") === \"\")\n\t\t\t{\n\t\t\t\tentityNode = BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-convert\" },\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detain-convert-status\" },\n\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-status-text\" },\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: BX.CrmEntityType.getNotFoundMessage(entityInfo['ENTITY_TYPE_ID'])\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tentityNode = BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-convert\" },\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detain-convert-status\" },\n\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-status-text\" },\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: entityInfo['ENTITY_TYPE_CAPTION']\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\tBX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-convert-separator-icon\" } }),\n\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detain-convert-status\" },\n\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-detail-target\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thref: entityInfo['SHOW_URL']\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: entityInfo['TITLE']\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\tentityNodes.push(entityNode);\n\t\t}\n\n\t\tcontent.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: entityNodes\n\t\t\t\t})\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Conversion();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","/** @memberof BX.Crm.Timeline */\nexport default class Action\n{\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._container = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._container = this.getSetting(\"container\");\n\t\tif(!BX.type.isElementNode(this._container))\n\t\t{\n\t\t\tthrow \"BX.CrmTimelineAction: Could not find container.\";\n\t\t}\n\n\t\tthis.doInitialize();\n\t}\n\n\tdoInitialize()\n\t{\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\tlayout()\n\t{\n\t\tthis.doLayout();\n\t}\n\n\tdoLayout()\n\t{\n\t}\n}\n","import Action from \"../action\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class Activity extends Action\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._activityEditor = null;\n\t\tthis._entityData = null;\n\t\tthis._item = null;\n\t\tthis._isEnabled = true;\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._entityData = this.getSetting(\"entityData\");\n\t\tif(!BX.type.isPlainObject(this._entityData))\n\t\t{\n\t\t\tthrow \"BX.Crm.Timeline.Actions.Activity. A required parameter 'entityData' is missing.\";\n\t\t}\n\n\t\tthis._activityEditor = this.getSetting(\"activityEditor\");\n\t\tif(!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"BX.Crm.Timeline.Actions.Activity. A required parameter 'activityEditor' is missing.\";\n\t\t}\n\n\t\tthis._item = this.getSetting(\"item\");\n\t\tthis._isEnabled = this.getSetting(\"enabled\", true);\n\t}\n\n\tgetActivityId()\n\t{\n\t\treturn BX.prop.getInteger(this._entityData, \"ID\", 0);\n\t}\n\n\tloadActivityCommunications(callback)\n\t{\n\t\tthis._activityEditor.getActivityCommunications(\n\t\t\tthis.getActivityId(),\n\t\t\tfunction(communications)\n\t\t\t{\n\t\t\t\tif(BX.type.isFunction(callback))\n\t\t\t\t{\n\t\t\t\t\tcallback(communications);\n\t\t\t\t}\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\t}\n\n\tgetItemData()\n\t{\n\t\treturn this._item ?  this._item.getData() : null;\n\t}\n}\n","import Activity from \".//activity\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport class Email extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._clickHandler = BX.delegate(this.onClick, this);\n\t\tthis._saveHandler = BX.delegate(this.onSave, this);\n\t}\n\n\tonClick(e)\n\t{\n\t\tconst settings =\n\t\t\t{\n\t\t\t\t\"ownerType\": BX.CrmEntityType.resolveName(BX.prop.getInteger(this._entityData, \"OWNER_TYPE_ID\", 0)),\n\t\t\t\t\"ownerID\": BX.prop.getInteger(this._entityData, \"OWNER_ID\", 0),\n\t\t\t\t\"ownerUrl\": BX.prop.getString(this._entityData, \"OWNER_URL\", \"\"),\n\t\t\t\t\"ownerTitle\": BX.prop.getString(this._entityData, \"OWNER_TITLE\", \"\"),\n\t\t\t\t\"originalMessageID\": BX.prop.getInteger(this._entityData, \"ID\", 0),\n\t\t\t\t\"messageType\": \"RE\"\n\t\t\t};\n\n\t\tif (BX.CrmActivityProvider && top.BX.Bitrix24 && top.BX.Bitrix24.Slider)\n\t\t{\n\t\t\tconst activity = this._activityEditor.addEmail(settings);\n\t\t\tactivity.addOnSave(this._saveHandler);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.loadActivityCommunications(\n\t\t\t\tBX.delegate(\n\t\t\t\t\tfunction(communications)\n\t\t\t\t\t{\n\t\t\t\t\t\tsettings['communications'] = BX.type.isArray(communications) ? communications : [];\n\t\t\t\t\t\tsettings['communicationsLoaded'] = true;\n\n\t\t\t\t\t\tBX.CrmActivityEmail.prepareReply(settings);\n\n\t\t\t\t\t\tconst activity = this._activityEditor.addEmail(settings);\n\t\t\t\t\t\tactivity.addOnSave(this._saveHandler);\n\t\t\t\t\t},\n\t\t\t\t\tthis\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t\treturn BX.PreventDefault(e);\n\t}\n\n\tonSave(activity, data)\n\t{\n\t\tif(BX.type.isFunction(this._item.onActivityCreate))\n\t\t{\n\t\t\tthis._item.onActivityCreate(activity, data);\n\t\t}\n\t}\n}\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport class HistoryEmail extends Email\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoLayout()\n\t{\n\t\tthis._container.appendChild(\n\t\t\tBX.create(\"A\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-action-reply-btn\" },\n\t\t\t\t\tevents: { \"click\": this._clickHandler }\n\t\t\t\t})\n\t\t);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new HistoryEmail();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport class ScheduleEmail extends Email\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoLayout()\n\t{\n\t\tthis._container.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-action-reply-btn\" },\n\t\t\t\t\tevents: { \"click\": this._clickHandler }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new ScheduleEmail();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import History from \"./history\";\nimport {Mark} from \"../types\";\nimport {HistoryEmail} from \"../actions/email\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class HistoryActivity extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoInitialize()\n\t{\n\t\tsuper.doInitialize();\n\t\tif(!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"HistoryActivity. The field 'activityEditor' is not assigned.\";\n\t\t}\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn BX.prop.getString(this.getAssociatedEntityData(), \"SUBJECT\", \"\");\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\n\t\tconst typeCategoryId = this.getTypeCategoryId();\n\t\tif(typeCategoryId === BX.CrmActivityType.email)\n\t\t{\n\t\t\treturn this.getMessage(direction === BX.CrmActivityDirection.incoming ? \"incomingEmail\" : \"outgoingEmail\");\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.call)\n\t\t{\n\t\t\treturn this.getMessage(direction === BX.CrmActivityDirection.incoming ? \"incomingCall\" : \"outgoingCall\");\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.meeting)\n\t\t{\n\t\t\treturn this.getMessage(\"meeting\");\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.task)\n\t\t{\n\t\t\treturn this.getMessage(\"task\");\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.provider)\n\t\t{\n\t\t\tconst providerId = BX.prop.getString(entityData, \"PROVIDER_ID\", \"\");\n\n\t\t\tif(providerId === \"CRM_WEBFORM\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"webform\");\n\t\t\t}\n\t\t\telse if (providerId === \"CRM_SMS\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"sms\");\n\t\t\t}\n\t\t\telse if (providerId === \"CRM_REQUEST\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"activityRequest\");\n\t\t\t}\n\t\t\telse if (providerId === \"IMOPENLINES_SESSION\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"openLine\");\n\t\t\t}\n\t\t\telse if (providerId === \"REST_APP\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"restApplication\");\n\t\t\t}\n\t\t\telse if (providerId === \"VISIT_TRACKER\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"visit\");\n\t\t\t}\n\t\t\telse if (providerId === \"ZOOM\")\n\t\t\t{\n\t\t\t\treturn this.getMessage(\"zoom\");\n\t\t\t}\n\t\t}\n\n\t\treturn \"\";\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\treturn BX.create(\"A\",\n\t\t\t{\n\t\t\t\tattrs: { href: \"#\",  className: \"crm-entity-stream-content-event-title\" },\n\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\ttext: this.getTypeDescription()\n\t\t\t}\n\t\t);\n\t}\n\n\tprepareTimeLayout()\n\t{\n\t\treturn BX.create(\"SPAN\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t}\n\t\t);\n\t}\n\n\tprepareMarkLayout()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst markTypeId = BX.prop.getInteger(entityData, \"MARK_TYPE_ID\", 0);\n\t\tif(markTypeId <= 0)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet messageName = \"\";\n\t\tif(markTypeId === Mark.success)\n\t\t{\n\t\t\tmessageName = \"SuccessMark\";\n\t\t}\n\t\telse if(markTypeId === Mark.renew)\n\t\t{\n\t\t\tmessageName = \"RenewMark\";\n\t\t}\n\n\t\tif(messageName === \"\")\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet markText = \"\";\n\t\tconst typeCategoryId = this.getTypeCategoryId();\n\t\tif(typeCategoryId === BX.CrmActivityType.email)\n\t\t{\n\t\t\tmarkText = this.getMessage(\"email\" + messageName);\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.call)\n\t\t{\n\t\t\tmarkText = this.getMessage(\"call\" + messageName);\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.meeting)\n\t\t{\n\t\t\tmarkText = this.getMessage(\"meeting\" + messageName);\n\t\t}\n\t\telse if(typeCategoryId === BX.CrmActivityType.task)\n\t\t{\n\t\t\tmarkText = this.getMessage(\"task\" + messageName);\n\t\t}\n\n\t\tif(markText === \"\")\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn(\n\t\t\tBX.create(\n\t\t\t\t\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tprops: { className: \"crm-entity-stream-content-event-skipped\" },\n\t\t\t\t\ttext: markText\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst typeCategoryId = this.getTypeCategoryId();\n\t\tif(typeCategoryId === BX.CrmActivityType.email)\n\t\t{\n\t\t\tthis._actions.push(\n\t\t\t\tHistoryEmail.create(\n\t\t\t\t\t\"email\",\n\t\t\t\t\t{\n\t\t\t\t\t\titem: this,\n\t\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\t\tactivityEditor: this._activityEditor\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tif(this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst menuItems = [];\n\n\t\tif (!this.isReadOnly())\n\t\t{\n\t\t\tif (this.isEditable())\n\t\t\t{\n\t\t\t\tmenuItems.push({ id: \"edit\", text: this.getMessage(\"menuEdit\"), onclick: BX.delegate(this.edit, this)});\n\t\t\t}\n\t\t\tmenuItems.push({ id: \"remove\", text: this.getMessage(\"menuDelete\"), onclick: BX.delegate(this.processRemoval, this)});\n\n\t\t\tif (this.isFixed() || this._fixedHistory.findItemById(this._id))\n\t\t\t\tmenuItems.push({ id: \"unfasten\", text: this.getMessage(\"menuUnfasten\"), onclick: BX.delegate(this.unfasten, this)});\n\t\t\telse\n\t\t\t\tmenuItems.push({ id: \"fasten\", text: this.getMessage(\"menuFasten\"), onclick: BX.delegate(this.fasten, this)});\n\t\t}\n\t\treturn menuItems;\n\t}\n\n\tview()\n\t{\n\t\tthis.closeContextMenu();\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\tif(id > 0)\n\t\t{\n\t\t\tthis._activityEditor.viewActivity(id);\n\t\t}\n\t}\n\n\tedit()\n\t{\n\t\tthis.closeContextMenu();\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityData = this.getAssociatedEntityData();\n\t\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\t\tif(id > 0)\n\t\t\t{\n\t\t\t\tthis._activityEditor.editActivity(id);\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessRemoval()\n\t{\n\t\tthis.closeContextMenu();\n\t\tthis._detetionConfirmDlgId = \"entity_timeline_deletion_\" + this.getId() + \"_confirm\";\n\t\tlet dlg = BX.Crm.ConfirmationDialog.get(this._detetionConfirmDlgId);\n\t\tif(!dlg)\n\t\t{\n\t\t\tdlg = BX.Crm.ConfirmationDialog.create(\n\t\t\t\tthis._detetionConfirmDlgId,\n\t\t\t\t{\n\t\t\t\t\ttitle: this.getMessage(\"removeConfirmTitle\"),\n\t\t\t\t\tcontent: this.getRemoveMessage()\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tdlg.open().then(BX.delegate(this.onRemovalConfirm, this), BX.delegate(this.onRemovalCancel, this));\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\treturn this.getMessage('removeConfirm');\n\t}\n\n\tonRemovalConfirm(result)\n\t{\n\t\tif(BX.prop.getBoolean(result, \"cancel\", true))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.remove();\n\t}\n\n\tonRemovalCancel()\n\t{\n\t}\n\n\tremove()\n\t{\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\n\t\t\tif(id > 0)\n\t\t\t{\n\t\t\t\tconst activityEditor = this._activityEditor;\n\t\t\t\tconst item = activityEditor.getItemById(id);\n\t\t\t\tif (item)\n\t\t\t\t{\n\t\t\t\t\tactivityEditor.deleteActivity(id, true);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst serviceUrl = BX.util.add_url_param(activityEditor.getSetting('serviceUrl', ''),\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: id,\n\t\t\t\t\t\t\taction: 'get_activity',\n\t\t\t\t\t\t\townertype: activityEditor.getSetting('ownerType', ''),\n\t\t\t\t\t\t\townerid: activityEditor.getSetting('ownerID', '')\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\tBX.ajax({\n\t\t\t\t\t\t'url': serviceUrl,\n\t\t\t\t\t\t'method': 'POST',\n\t\t\t\t\t\t'dataType': 'json',\n\t\t\t\t\t\t'data':\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t'ACTION' : 'GET_ACTIVITY',\n\t\t\t\t\t\t\t\t'ID': id,\n\t\t\t\t\t\t\t\t'OWNER_TYPE': activityEditor.getSetting('ownerType', ''),\n\t\t\t\t\t\t\t\t'OWNER_ID': activityEditor.getSetting('ownerID', '')\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\tonsuccess: BX.delegate(\n\t\t\t\t\t\t\tfunction(data)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif(typeof(data['ACTIVITY']) !== 'undefined')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tactivityEditor._handleActivityChange(data['ACTIVITY']);\n\t\t\t\t\t\t\t\t\twindow.setTimeout(BX.delegate(this.remove ,this), 500);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tthis\n\t\t\t\t\t\t),\n\t\t\t\t\t\tonfailure: function(data){}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new HistoryActivity();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import HistoryActivity from \"./history-activity\";\nimport {HistoryEmail} from \"../actions/email\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Email extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst emailInfo = BX.prop.getObject(entityData, \"EMAIL_INFO\", null);\n\t\tconst statusText = emailInfo !== null ? BX.prop.getString(emailInfo, \"STATUS_TEXT\", \"\") : \"\";\n\t\tconst error = emailInfo !== null ? BX.prop.getBoolean(emailInfo, \"STATUS_ERROR\", false) : false;\n\t\tconst className = !error ? \"crm-entity-stream-content-event-skipped\" : \"crm-entity-stream-content-event-missing\";\n\t\tif(statusText !== \"\")\n\t\t{\n\t\t\theader.appendChild(\n\t\t\t\tBX.create(\n\t\t\t\t\t\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tprops: { className: className},\n\t\t\t\t\t\ttext: statusText\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tconst markNode = this.prepareMarkLayout();\n\t\tif(markNode)\n\t\t{\n\t\t\theader.appendChild(markNode);\n\t\t}\n\n\t\theader.appendChild(this.prepareTimeLayout());\n\t\treturn header;\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tconst menuItems = [];\n\n\t\tif (!this.isReadOnly())\n\t\t{\n\t\t\tmenuItems.push({id: \"view\", text: this.getMessage(\"menuView\"), onclick: BX.delegate(this.view, this)});\n\n\t\t\tmenuItems.push({ id: \"remove\", text: this.getMessage(\"menuDelete\"), onclick: BX.delegate(this.processRemoval, this)});\n\n\t\t\tif (this.isFixed() || this._fixedHistory.findItemById(this._id))\n\t\t\t\tmenuItems.push({ id: \"unfasten\", text: this.getMessage(\"menuUnfasten\"), onclick: BX.delegate(this.unfasten, this)});\n\t\t\telse\n\t\t\t\tmenuItems.push({ id: \"fasten\", text: this.getMessage(\"menuFasten\"), onclick: BX.delegate(this.fasten, this)});\n\t\t}\n\n\t\treturn menuItems;\n\t}\n\n\treply()\n\t{\n\t}\n\n\treplyAll()\n\t{\n\t}\n\n\tforward()\n\t{\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst title = BX.util.htmlspecialchars(this.getTitle());\n\t\treturn this.getMessage('emailRemove').replace(\"#TITLE#\", title);\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst communicationTitle = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst communicationShowUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\t\tconst communicationValue = BX.prop.getString(communication, \"VALUE\", \"\");\n\n\t\tconst outerWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-email\"}});\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-email\" }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(outerWrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [ wrapper ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Header\n\t\tconst header = this.prepareHeaderLayout();\n\t\twrapper.appendChild(header);\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\t//Details\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-email\"}\n\t\t\t}\n\t\t);\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: [ detailWrapper ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//TODO: Add status text\n\t\t/*\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-content-detail-email-read-status\" } })\n\t\t);\n\t\t*/\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-email-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst communicationWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-email-to\"}}\n\t\t);\n\t\tdetailWrapper.appendChild(communicationWrapper);\n\n\t\t//Communications\n\t\tif(communicationTitle !== \"\")\n\t\t{\n\t\t\tif(communicationShowUrl !== \"\")\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: { href: communicationShowUrl },\n\t\t\t\t\t\t\ttext: communicationTitle\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: communicationTitle }));\n\t\t\t}\n\t\t}\n\n\t\tif(communicationValue !== \"\")\n\t\t{\n\t\t\tif(communicationTitle !== \"\")\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: \" \" }));\n\t\t\t}\n\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\tBX.create(\n\t\t\t\t\t\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-email-address\" },\n\t\t\t\t\t\ttext: communicationValue\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\t//Content\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-email-fragment\" },\n\t\t\t\t\tchildren: this.prepareCutOffElements(description, 128, this._headerClickHandler)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\twrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\twrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\twrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn outerWrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._actions.push(\n\t\t\tHistoryEmail.create(\n\t\t\t\t\"email\",\n\t\t\t\t{\n\t\t\t\t\titem: this,\n\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\tactivityEditor: this._activityEditor\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Email();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport class Call extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._clickHandler = BX.delegate(this.onClick, this);\n\t\tthis._menu = null;\n\t\tthis._isMenuShown = false;\n\t\tthis._menuItems = null;\n\t}\n\n\tgetButton()\n\t{\n\t\treturn null;\n\t}\n\n\tonClick(e)\n\t{\n\t\tif(typeof(window.top['BXIM']) === 'undefined')\n\t\t{\n\t\t\twindow.alert(this.getMessage(\"telephonyNotSupported\"));\n\t\t\treturn;\n\t\t}\n\n\t\tlet phone = \"\";\n\t\tconst itemData = this.getItemData();\n\t\tconst phones = BX.prop.getArray(itemData, \"PHONE\", []);\n\n\t\tif(phones.length === 1)\n\t\t{\n\t\t\tthis.addCall(phones[0]['VALUE']);\n\t\t}\n\t\telse if(phones.length > 1)\n\t\t{\n\t\t\tthis.showMenu();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst communication = BX.prop.getObject(this._entityData, \"COMMUNICATION\", null);\n\t\t\tif(communication)\n\t\t\t{\n\t\t\t\tif(BX.prop.getString(communication, \"TYPE\") === \"PHONE\")\n\t\t\t\t{\n\t\t\t\t\tphone = BX.prop.getString(communication, \"VALUE\");\n\t\t\t\t\tif(phone)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.addCall(phone);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn BX.PreventDefault(e);\n\t}\n\n\tshowMenu()\n\t{\n\t\tif(this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.prepareMenuItems();\n\n\t\tif(!this._menuItems || this._menuItems.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\n\t\tthis._menu = new BX.PopupMenuWindow(\n\t\t\tthis._id,\n\t\t\tthis._container,\n\t\t\tthis._menuItems,\n\t\t\t{\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 16,\n\t\t\t\tevents:\n\t\t\t\t\t{\n\t\t\t\t\t\tonPopupShow: BX.delegate(this.onMenuShow, this),\n\t\t\t\t\t\tonPopupClose: BX.delegate(this.onMenuClose, this),\n\t\t\t\t\t\tonPopupDestroy: BX.delegate(this.onMenuDestroy, this)\n\t\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis._menu.popupWindow.show();\n\t}\n\n\tcloseMenu()\n\t{\n\t\tif(!this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._menu)\n\t\t{\n\t\t\tthis._menu.close();\n\t\t}\n\t}\n\n\tprepareMenuItems()\n\t{\n\t\tif(this._menuItems)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst itemData = this.getItemData();\n\t\tconst phones = BX.prop.getArray(itemData, \"PHONE\", []);\n\t\tconst handler = BX.delegate(this.onMenuItemClick, this);\n\t\tthis._menuItems = [];\n\n\t\tif(phones.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet i = 0;\n\t\tconst l = phones.length;\n\t\tfor(; i < l; i++)\n\t\t{\n\t\t\tconst value = BX.prop.getString(phones[i], \"VALUE\");\n\t\t\tconst formattedValue = BX.prop.getString(phones[i], \"VALUE_FORMATTED\");\n\t\t\tconst complexName = BX.prop.getString(phones[i], \"COMPLEX_NAME\");\n\t\t\tconst itemText = (complexName ? complexName + ': ' : '') + (formattedValue ? formattedValue : value);\n\n\t\t\tif(value !== \"\")\n\t\t\t{\n\t\t\t\tthis._menuItems.push({ id: value, text:  itemText, onclick: handler});\n\t\t\t}\n\t\t}\n\t}\n\n\tonMenuItemClick(e, item)\n\t{\n\t\tthis.closeMenu();\n\t\tthis.addCall(item.id);\n\t}\n\n\tonMenuShow()\n\t{\n\t\tthis._isMenuShown = true;\n\t}\n\n\tonMenuClose()\n\t{\n\t\tthis._isMenuShown = false;\n\t\tthis._menu.popupWindow.destroy();\n\t}\n\n\tonMenuDestroy()\n\t{\n\t\tthis._menu = null;\n\t}\n\n\taddCall(phone)\n\t{\n\t\tconst communication = BX.prop.getObject(this._entityData, \"COMMUNICATION\", null);\n\t\tlet entityTypeId = parseInt(BX.prop.getString(communication, \"ENTITY_TYPE_ID\", \"0\"));\n\t\tif(isNaN(entityTypeId))\n\t\t{\n\t\t\tentityTypeId = 0;\n\t\t}\n\n\t\tlet entityId = parseInt(BX.prop.getString(communication, \"ENTITY_ID\", \"0\"));\n\t\tif(isNaN(entityId))\n\t\t{\n\t\t\tentityId = 0;\n\t\t}\n\n\t\tlet ownerTypeId = 0;\n\t\tlet ownerId = 0;\n\n\t\tconst ownerInfo = BX.prop.getObject(this._settings, \"ownerInfo\");\n\t\tif(ownerInfo)\n\t\t{\n\t\t\townerTypeId = BX.prop.getInteger(ownerInfo, \"ENTITY_TYPE_ID\", 0);\n\t\t\townerId = BX.prop.getInteger(ownerInfo, \"ENTITY_ID\", 0);\n\t\t}\n\n\t\tif(ownerTypeId <= 0 || ownerId <= 0)\n\t\t{\n\t\t\townerTypeId = BX.prop.getInteger(this._entityData, \"OWNER_TYPE_ID\", 0);\n\t\t\townerId = BX.prop.getInteger(this._entityData, \"OWNER_ID\", \"0\");\n\t\t}\n\n\t\tif(ownerTypeId <= 0 || ownerId <= 0)\n\t\t{\n\t\t\townerTypeId = entityTypeId;\n\t\t\townerId = entityId;\n\t\t}\n\n\t\tlet activityId = parseInt(BX.prop.getString(this._entityData, \"ID\", \"0\"));\n\t\tif(isNaN(activityId))\n\t\t{\n\t\t\tactivityId = 0;\n\t\t}\n\n\t\tconst params =\n\t\t\t{\n\t\t\t\t\"ENTITY_TYPE_NAME\": BX.CrmEntityType.resolveName(entityTypeId),\n\t\t\t\t\"ENTITY_ID\": entityId,\n\t\t\t\t\"AUTO_FOLD\": true\n\t\t\t};\n\t\tif(ownerTypeId !== entityTypeId || ownerId !== entityId)\n\t\t{\n\t\t\tparams[\"BINDINGS\"] = [ { \"OWNER_TYPE_NAME\": BX.CrmEntityType.resolveName(ownerTypeId), \"OWNER_ID\": ownerId } ];\n\t\t}\n\n\t\tif(activityId > 0)\n\t\t{\n\t\t\tparams[\"SRC_ACTIVITY_ID\"] = activityId;\n\t\t}\n\n\t\twindow.top['BXIM'].phoneTo(phone, params);\n\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Call.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic messages = {};\n}\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport class HistoryCall extends Call\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._button = null;\n\t}\n\n\tgetButton()\n\t{\n\t\treturn this._button;\n\t}\n\n\tdoLayout()\n\t{\n\t\tthis._button = BX.create(\"A\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-action-reply-btn\" },\n\t\t\t\tevents: { \"click\": this._clickHandler }\n\t\t\t}\n\t\t);\n\t\tthis._container.appendChild(this._button);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new HistoryCall();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n\nexport class ScheduleCall extends Call\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoLayout()\n\t{\n\t\tthis._container.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-action-reply-btn\" },\n\t\t\t\t\tevents: { \"click\": this._clickHandler }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new ScheduleCall();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import {HistoryCall} from \"../actions/call\";\nimport HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Call extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._playerDummyClickHandler = BX.delegate(this.onPlayerDummyClick, this);\n\t\tthis._playerWrapper = null;\n\t\tthis._transcriptWrapper = null;\n\t\tthis._mediaFileInfo = null;\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst callInfo = BX.prop.getObject(entityData, \"CALL_INFO\", null);\n\t\tconst callTypeText = callInfo !== null ? BX.prop.getString(callInfo, \"CALL_TYPE_TEXT\", \"\") : \"\";\n\t\tif(callTypeText !== \"\")\n\t\t{\n\t\t\treturn callTypeText;\n\t\t}\n\n\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\t\treturn this.getMessage(direction === BX.CrmActivityDirection.incoming ? \"incomingCall\" : \"outgoingCall\");\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\n\t\t//Position is important\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst callInfo = BX.prop.getObject(entityData, \"CALL_INFO\", null);\n\t\tconst hasCallInfo = callInfo !== null;\n\t\tconst isSuccessfull = hasCallInfo ? BX.prop.getBoolean(callInfo, \"SUCCESSFUL\", false) : false;\n\t\tconst statusText = hasCallInfo ? BX.prop.getString(callInfo, \"STATUS_TEXT\", \"\") : \"\";\n\n\t\tif(hasCallInfo && statusText.length)\n\t\t{\n\t\t\theader.appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tclassName: isSuccessfull\n\t\t\t\t\t\t\t\t\t? \"crm-entity-stream-content-event-successful\"\n\t\t\t\t\t\t\t\t\t: \"crm-entity-stream-content-event-missing\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: statusText\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\theader.appendChild(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst communicationTitle = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst communicationShowUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\t\tconst communicationValue = BX.prop.getString(communication, \"VALUE\", \"\");\n\t\tconst communicationValueFormatted = BX.prop.getString(communication, \"FORMATTED_VALUE\", communicationValue);\n\n\t\tconst callInfo = BX.prop.getObject(entityData, \"CALL_INFO\", null);\n\t\tconst hasCallInfo = callInfo !== null;\n\t\tconst durationText = hasCallInfo ? BX.prop.getString(callInfo, \"DURATION_TEXT\", \"\") : \"\";\n\t\tconst hasTranscript = hasCallInfo ? BX.prop.getBoolean(callInfo, \"HAS_TRANSCRIPT\", \"\") : \"\";\n\t\tconst isTranscriptPending = hasCallInfo ? BX.prop.getBoolean(callInfo, \"TRANSCRIPT_PENDING\", \"\") : \"\";\n\t\tconst callId = hasCallInfo ? BX.prop.getString(callInfo, \"CALL_ID\", \"\") : \"\";\n\t\tconst callComment = hasCallInfo ? BX.prop.getString(callInfo, \"COMMENT\", \"\") : \"\";\n\n\t\tconst outerWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-call\"}});\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-call\" }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(outerWrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [ wrapper ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Header\n\t\tconst header = this.prepareHeaderLayout();\n\t\twrapper.appendChild(header);\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\t//Details\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"}\n\t\t\t}\n\t\t);\n\t\twrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Content\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\tchildren: this.prepareMultilineCutOffElements(description, 128, this._headerClickHandler)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif(hasCallInfo)\n\t\t{\n\t\t\tconst callInfoWrapper = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-call crm-entity-stream-content-detail-call-inline\"}\n\t\t\t\t}\n\t\t\t);\n\t\t\tdetailWrapper.appendChild(callInfoWrapper);\n\n\t\t\tthis._mediaFileInfo = BX.prop.getObject(entityData, \"MEDIA_FILE_INFO\", null);\n\t\t\tif(this._mediaFileInfo !== null)\n\t\t\t{\n\t\t\t\tthis._playerWrapper = this._history.getManager().renderAudioDummy(durationText, this._playerDummyClickHandler);\n\t\t\t\tcallInfoWrapper.appendChild(\n\t\t\t\t\tthis._playerWrapper\n\t\t\t\t);\n\t\t\t\tcallInfoWrapper.appendChild(this._history.getManager().getAudioPlaybackRateSelector().render());\n\t\t\t}\n\n\t\t\tif(hasTranscript)\n\t\t\t{\n\t\t\t\tthis._transcriptWrapper = BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-audio-transcript-wrap-container\"},\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tclick: function(e)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif(BX.Voximplant && BX.Voximplant.Transcript)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tBX.Voximplant.Transcript.create({\n\t\t\t\t\t\t\t\t\t\tcallId: callId\n\t\t\t\t\t\t\t\t\t}).show();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-audio-transcript-icon\"}\t}),\n\t\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-audio-transcript-conversation\"}, text: BX.message(\"CRM_TIMELINE_CALL_TRANSCRIPT\") } )\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\tcallInfoWrapper.appendChild(this._transcriptWrapper);\n\t\t\t}\n\t\t\telse if(isTranscriptPending)\n\t\t\t{\n\t\t\t\tthis._transcriptWrapper = BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-audio-transcript-wrap-container-pending\"},\n\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-audio-transcript-icon-pending\"}, html: '<svg class=\"crm-transcript-loader-circular\" viewBox=\"25 25 50 50\"><circle class=\"crm-transcript-loader-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"></circle></svg>'}),\n\t\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-audio-transcript-conversation\"}, text: BX.message(\"CRM_TIMELINE_CALL_TRANSCRIPT_PENDING\") } )\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\tcallInfoWrapper.appendChild(this._transcriptWrapper);\n\t\t\t}\n\n\t\t\tif(callComment)\n\t\t\t{\n\t\t\t\tdetailWrapper.appendChild(BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\"},\n\t\t\t\t\t\ttext: callComment\n\t\t\t\t\t}\n\t\t\t\t));\n\t\t\t}\n\t\t}\n\t\tconst communicationWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-contact-info\"}\n\t\t\t}\n\t\t);\n\t\tdetailWrapper.appendChild(communicationWrapper);\n\n\t\t//Communications\n\t\tif(communicationTitle !== \"\")\n\t\t{\n\t\t\tif(communicationShowUrl !== \"\")\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: { href: communicationShowUrl },\n\t\t\t\t\t\t\ttext: communicationTitle\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: communicationTitle }));\n\t\t\t}\n\t\t}\n\n\t\tif(communicationValueFormatted !== \"\")\n\t\t{\n\t\t\tif(communicationTitle !== \"\")\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: \" \" }));\n\t\t\t}\n\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\tBX.create(\n\t\t\t\t\t\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-email-address\" },\n\t\t\t\t\t\ttext: communicationValueFormatted\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\twrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\twrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly()) {\n\n\t\t\twrapper.appendChild(this.prepareFixedSwitcherLayout());\n\t\t}\n\n\n\t\treturn outerWrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._actions.push(\n\t\t\tHistoryCall.create(\n\t\t\t\t\"call\",\n\t\t\t\t{\n\t\t\t\t\titem: this,\n\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\townerInfo: this._history.getOwnerInfo()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\t\tconst messageName = (direction === BX.CrmActivityDirection.incoming) ? 'incomingCallRemove' : 'outgoingCallRemove';\n\t\tconst title = BX.util.htmlspecialchars(this.getTitle());\n\t\treturn this.getMessage(messageName).replace(\"#TITLE#\", title);\n\t}\n\n\tonPlayerDummyClick(e)\n\t{\n\t\tconst stubNode = this._playerWrapper.querySelector(\".crm-audio-cap-wrap\");\n\t\tif(stubNode)\n\t\t{\n\t\t\tBX.addClass(stubNode, \"crm-audio-cap-wrap-loader\");\n\t\t}\n\n\t\tthis._history.getManager().getAudioPlaybackRateSelector().addPlayer(this._history.getManager().loadMediaPlayer(\n\t\t\t\"history_\" + this.getId(),\n\t\t\tthis._mediaFileInfo[\"URL\"],\n\t\t\tthis._mediaFileInfo[\"TYPE\"],\n\t\t\tthis._playerWrapper,\n\t\t\tthis._mediaFileInfo[\"DURATION\"],\n\t\t\t{\n\t\t\t\tplaybackRate: this._history.getManager().getAudioPlaybackRateSelector().getRate()\n\t\t\t}\n\t\t));\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Call();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Meeting extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper()\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\n\t\tconst markNode = this.prepareMarkLayout();\n\t\tif(markNode)\n\t\t{\n\t\t\theader.appendChild(markNode);\n\t\t}\n\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst communicationTitle = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst communicationShowUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\t\tconst communicationValue = BX.prop.getString(communication, \"VALUE\", \"\");\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-meeting\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-meeting\" } })\n\t\t);\n\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Content\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\tchildren: this.prepareCutOffElements(description, 128, this._headerClickHandler)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst communicationWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-contact-info\"}});\n\t\tdetailWrapper.appendChild(communicationWrapper);\n\n\t\tif(communicationTitle !== '')\n\t\t{\n\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{ text: this.getMessage(\"reciprocal\") + \": \" }\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tif(communicationShowUrl !== '')\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"A\", { attrs: { href: communicationShowUrl }, text: communicationTitle }));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: communicationTitle }));\n\t\t\t}\n\t\t}\n\n\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: \" \" + communicationValue }));\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\tcontentWrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst title = BX.util.htmlspecialchars(this.getTitle());\n\t\treturn this.getMessage('meetingRemove').replace(\"#TITLE#\", title);\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Meeting();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Task extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\n\t\tconst markNode = this.prepareMarkLayout();\n\t\tif(markNode)\n\t\t{\n\t\t\theader.appendChild(markNode);\n\t\t}\n\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst communicationTitle = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst communicationShowUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-task\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-task\" } })\n\t\t);\n\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Content\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\tchildren: this.prepareCutOffElements(description, 128, this._headerClickHandler)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst communicationWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-contact-info\"}});\n\t\tdetailWrapper.appendChild(communicationWrapper);\n\n\t\tif(communicationTitle !== '')\n\t\t{\n\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{ text: this.getMessage(\"reciprocal\") + \": \" }\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tif(communicationShowUrl !== '')\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"A\", { attrs: { href: communicationShowUrl }, text: communicationTitle }));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: communicationTitle }));\n\t\t\t}\n\t\t}\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\tcontentWrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst title = BX.util.htmlspecialchars(this.getTitle());\n\t\treturn this.getMessage('taskRemove').replace(\"#TITLE#\", title);\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Task();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class WebForm extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-crmForm\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-crmForm\" } })\n\t\t);\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\tcontentWrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new WebForm();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Request extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\t//var entityData = this.getAssociatedEntityData();\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-today crm-entity-stream-section-robot\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-robot\" } })\n\t\t);\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Content\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\tchildren: this.prepareCutOffElements(description, 128, this._headerClickHandler)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\tcontentWrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tisEditable()\n\t{\n\t\treturn false;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Request();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \".//activity\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport class OpenLine extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._clickHandler = BX.delegate(this.onClick, this);\n\t\tthis._button = null;\n\t}\n\n\tgetButton()\n\t{\n\t\treturn this._button;\n\t}\n\n\tonClick()\n\t{\n\t\tif(typeof(window.top['BXIM']) === 'undefined')\n\t\t{\n\t\t\twindow.alert(this.getMessage(\"openLineNotSupported\"));\n\t\t\treturn;\n\t\t}\n\n\t\tlet slug = \"\";\n\t\tconst communication = BX.prop.getObject(this._entityData, \"COMMUNICATION\", null);\n\t\tif(communication)\n\t\t{\n\t\t\tif(BX.prop.getString(communication, \"TYPE\") === \"IM\")\n\t\t\t{\n\t\t\t\tslug = BX.prop.getString(communication, \"VALUE\");\n\t\t\t}\n\t\t}\n\n\t\tif(slug !== \"\")\n\t\t{\n\t\t\twindow.top['BXIM'].openMessengerSlider(slug, {RECENT: 'N', MENU: 'N'});\n\t\t}\n\t}\n\n\tdoLayout()\n\t{\n\t\tthis._button = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-action-reply-btn\" },\n\t\t\t\tevents: { \"click\": this._clickHandler }\n\t\t\t}\n\t\t);\n\t\tthis._container.appendChild(this._button);\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = OpenLine.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new OpenLine();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import HistoryActivity from \"./history-activity\";\nimport {OpenLine as OpenLineAction} from \"../actions/openline\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class OpenLine extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst communicationTitle = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst communicationShowUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-IM\"}});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-IM\" } })\n\t\t);\n\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Content\n\t\tconst entityDetailWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-IM\"}}\n\t\t);\n\t\tdetailWrapper.appendChild(entityDetailWrapper);\n\n\t\tconst messageWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-IM-messages\"}}\n\t\t);\n\t\tentityDetailWrapper.appendChild(messageWrapper);\n\n\t\tconst openLineData = BX.prop.getObject(this.getAssociatedEntityData(), \"OPENLINE_INFO\", null);\n\t\tif(openLineData)\n\t\t{\n\t\t\tconst messages = BX.prop.getArray(openLineData, \"MESSAGES\", []);\n\t\t\tlet i = 0;\n\t\t\tconst length = messages.length;\n\t\t\tfor(; i < length; i++)\n\t\t\t{\n\t\t\t\tconst message = messages[i];\n\t\t\t\tconst isExternal = BX.prop.getBoolean(message, \"IS_EXTERNAL\", true);\n\n\t\t\t\tmessageWrapper.appendChild(\n\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tclassName: isExternal\n\t\t\t\t\t\t\t\t\t\t? \"crm-entity-stream-content-detail-IM-message-incoming\"\n\t\t\t\t\t\t\t\t\t\t: \"crm-entity-stream-content-detail-IM-message-outgoing\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\thtml: BX.prop.getString(message, \"MESSAGE\", \"\")\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\n\t\tconst communicationWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-contact-info\"}});\n\t\tdetailWrapper.appendChild(communicationWrapper);\n\n\t\tif(communicationTitle !== '')\n\t\t{\n\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{ text: this.getMessage(\"reciprocal\") + \": \" }\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tif(communicationShowUrl !== '')\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"A\", { attrs: { href: communicationShowUrl }, text: communicationTitle }));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: communicationTitle }));\n\t\t\t}\n\t\t}\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\tcontentWrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._actions.push(\n\t\t\tOpenLineAction.create(\n\t\t\t\t\"openline\",\n\t\t\t\t{\n\t\t\t\t\titem: this,\n\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\townerInfo: this._history.getOwnerInfo()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tview()\n\t{\n\t\tif(typeof(window.top['BXIM']) === 'undefined')\n\t\t{\n\t\t\twindow.alert(this.getMessage(\"openLineNotSupported\"));\n\t\t\treturn;\n\t\t}\n\n\t\tlet slug = \"\";\n\t\tconst communication = BX.prop.getObject(this.getAssociatedEntityData(), \"COMMUNICATION\", null);\n\t\tif(communication)\n\t\t{\n\t\t\tif(BX.prop.getString(communication, \"TYPE\") === \"IM\")\n\t\t\t{\n\t\t\t\tslug = BX.prop.getString(communication, \"VALUE\");\n\t\t\t}\n\t\t}\n\n\t\tif(slug !== \"\")\n\t\t{\n\t\t\twindow.top['BXIM'].openMessengerSlider(slug, {RECENT: 'N', MENU: 'N'});\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new OpenLine();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Rest extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tif (entityData['APP_TYPE'] && entityData['APP_TYPE']['NAME'])\n\t\t{\n\t\t\treturn entityData['APP_TYPE']['NAME'];\n\t\t}\n\n\t\treturn super.getTypeDescription();\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\t//var entityData = this.getAssociatedEntityData();\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-today crm-entity-stream-section-rest\"}});\n\n\t\tconst iconNode = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-rest\"}});\n\n\t\twrapper.appendChild(iconNode);\n\n\t\tif (entityData['APP_TYPE'] && entityData['APP_TYPE']['ICON_SRC'])\n\t\t{\n\t\t\tif (iconNode)\n\t\t\t{\n\t\t\t\ticonNode.style.backgroundImage = \"url('\" +  entityData['APP_TYPE']['ICON_SRC'] + \"')\";\n\t\t\t\ticonNode.style.backgroundPosition = \"center center\";\n\t\t\t\ticonNode.style.backgroundSize = \"cover\";\n\t\t\t\ticonNode.style.backgroundColor = \"transparent\";\n\t\t\t}\n\t\t}\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Content\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\tchildren: this.prepareCutOffElements(description, 128, this._headerClickHandler)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\tif (!this.isReadOnly())\n\t\t\tcontentWrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Rest();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class Visit extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._playerDummyClickHandler = BX.delegate(this.onPlayerDummyClick, this);\n\t\tthis._playerWrapper = null;\n\t\tthis._transcriptWrapper = null;\n\t\tthis._mediaFileInfo = null;\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst visitInfo = BX.prop.getObject(entityData, \"VISIT_INFO\", {});\n\t\tconst recordLength = BX.prop.getInteger(visitInfo, \"RECORD_LENGTH\", 0);\n\t\tconst recordLengthFormatted = BX.prop.getString(visitInfo, \"RECORD_LENGTH_FORMATTED_FULL\", \"\");\n\n\t\theader.appendChild(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: (recordLength > 0 ? recordLengthFormatted + ', ' + BX.message('CRM_TIMELINE_VISIT_AT') + ' ' : '') + this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst communicationTitle = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst communicationShowUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\n\t\tconst visitInfo = BX.prop.getObject(entityData, \"VISIT_INFO\", {});\n\t\tconst recordLength = BX.prop.getInteger(visitInfo, \"RECORD_LENGTH\", 0);\n\t\tconst recordLengthFormatted = BX.prop.getString(visitInfo, \"RECORD_LENGTH_FORMATTED_SHORT\", \"\");\n\t\tconst vkProfile = BX.prop.getString(visitInfo, \"VK_PROFILE\", \"\");\n\n\t\tconst outerWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-visit\"}});\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-visit\" }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [ wrapper ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//Header\n\t\tconst header = this.prepareHeaderLayout();\n\t\twrapper.appendChild(header);\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\t//Details\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail crm-entity-stream-content-detail-call-inline\"}\n\t\t\t}\n\t\t);\n\t\twrapper.appendChild(detailWrapper);\n\n\t\tthis._mediaFileInfo = BX.prop.getObject(entityData, \"MEDIA_FILE_INFO\", null);\n\t\tif(this._mediaFileInfo !== null && recordLength > 0)\n\t\t{\n\t\t\tthis._playerWrapper = this._history.getManager().renderAudioDummy(recordLengthFormatted, this._playerDummyClickHandler);\n\t\t\tdetailWrapper.appendChild(\n\t\t\t\t//crm-entity-stream-content-detail-call\n\t\t\t\tthis._playerWrapper\n\t\t\t);\n\t\t\tdetailWrapper.appendChild(this._history.getManager().getAudioPlaybackRateSelector().render());\n\t\t}\n\n\t\tconst communicationWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-contact-info\"}\n\t\t\t}\n\t\t);\n\t\twrapper.appendChild(communicationWrapper);\n\n\t\t//Communications\n\t\tif(communicationTitle !== \"\")\n\t\t{\n\t\t\tcommunicationWrapper.appendChild(document.createTextNode(BX.message(\"CRM_TIMELINE_VISIT_WITH\") + ' '));\n\t\t\tif(communicationShowUrl !== \"\")\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: { href: communicationShowUrl },\n\t\t\t\t\t\t\ttext: communicationTitle\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommunicationWrapper.appendChild(BX.create(\"SPAN\", { text: communicationTitle }));\n\t\t\t}\n\t\t}\n\n\t\tif(BX.type.isNotEmptyString(vkProfile))\n\t\t{\n\t\t\tcommunicationWrapper.appendChild(document.createTextNode(\" \"));\n\t\t\tcommunicationWrapper.appendChild(\n\t\t\t\tBX.create(\n\t\t\t\t\t\"a\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-detail-additional\",\n\t\t\t\t\t\t\t\ttarget: \"_blank\",\n\t\t\t\t\t\t\t\thref: this.getVkProfileUrl(vkProfile)\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: BX.message('CRM_TIMELINE_VISIT_VKONTAKTE_PROFILE')\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t)\n\n\t\t}\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\twrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\treturn outerWrapper;\n\t}\n\n\tonPlayerDummyClick(e)\n\t{\n\t\tconst stubNode = this._playerWrapper.querySelector(\".crm-audio-cap-wrap\");\n\t\tif(stubNode)\n\t\t{\n\t\t\tBX.addClass(stubNode, \"crm-audio-cap-wrap-loader\");\n\t\t}\n\n\t\tthis._history.getManager().getAudioPlaybackRateSelector().addPlayer(this._history.getManager().loadMediaPlayer(\n\t\t\t\"history_\" + this.getId(),\n\t\t\tthis._mediaFileInfo[\"URL\"],\n\t\t\tthis._mediaFileInfo[\"TYPE\"],\n\t\t\tthis._playerWrapper,\n\t\t\tthis._mediaFileInfo[\"DURATION\"],\n\t\t\t{\n\t\t\t\tplaybackRate: this._history.getManager().getAudioPlaybackRateSelector().getRate()\n\t\t\t}\n\t\t));\n\t}\n\n\tgetVkProfileUrl(profile)\n\t{\n\t\treturn 'https://vk.com/' + BX.util.htmlspecialchars(profile);\n\t}\n\n\tview()\n\t{\n\t\tif (BX.getClass('BX.Crm.Restriction.Bitrix24') && BX.Crm.Restriction.Bitrix24.isRestricted('visit'))\n\t\t{\n\t\t\treturn BX.Crm.Restriction.Bitrix24.getHandler('visit').call();\n\t\t}\n\t\tsuper.view();\n\t}\n\n\tedit()\n\t{\n\t\tif (BX.getClass('BX.Crm.Restriction.Bitrix24') && BX.Crm.Restriction.Bitrix24.isRestricted('visit'))\n\t\t{\n\t\t\treturn BX.Crm.Restriction.Bitrix24.getHandler('visit').call();\n\t\t}\n\t\tsuper.edit();\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Visit();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class Zoom extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._videoDummy = null;\n\t\tthis._audioDummy = null;\n\t\tthis._videoPlayer = null;\n\t\tthis._audioPlayer = null;\n\t\tthis._audioLengthElement = null;\n\t\tthis._recordings = [];\n\t\tthis._currentRecordingIndex = 0;\n\t\tthis.zoomActivitySubject = null;\n\n\t\tthis._downloadWrapper = null;\n\t\tthis._downloadSubject = null;\n\t\tthis._downloadSubjectDetail = null;\n\t\tthis._downloadVideoLink = null;\n\t\tthis._downloadSeparator = null;\n\t\tthis._downloadAudioLink = null;\n\t\tthis._playVideoLink = null;\n\t\tthis.detailZoomCopyVideoLink = null;\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\tif (!this._data.hasOwnProperty('PROVIDER_DATA') || this._data[\"PROVIDER_DATA\"][\"ZOOM_EVENT_TYPE\"] !== 'ZOOM_CONF_JOINED')\n\t\t{\n\t\t\theader.appendChild(this.prepareSuccessfulLayout());\n\t\t}\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareSuccessfulLayout()\n\t{\n\t\treturn BX.create(\"SPAN\", {\n\t\t\tattrs:{ className: \"crm-entity-stream-content-event-successful\"},\n\t\t\ttext: BX.message('CRM_TIMELINE_ZOOM_SUCCESSFUL_ACTIVITY')\n\t\t});\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\tif (this._data.hasOwnProperty('PROVIDER_DATA') && this._data[\"PROVIDER_DATA\"][\"ZOOM_EVENT_TYPE\"] === 'ZOOM_CONF_JOINED')\n\t\t{\n\t\t\treturn BX.create(\"SPAN\", {\n\t\t\t\tattrs:{ className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\ttext: BX.message('CRM_TIMELINE_ZOOM_JOINED_CONFERENCE')\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn BX.create(\"SPAN\", {\n\t\t\t\tattrs:{ className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\ttext: BX.message('CRM_TIMELINE_ZOOM_CONFERENCE_END')\n\t\t\t});\n\t\t}\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history\"}});\n\t\tlet entityDetailWrapper;\n\t\tconst zoomData = BX.prop.getObject(this.getAssociatedEntityData(), \"ZOOM_INFO\", null);\n\t\tconst subject = BX.prop.getString(this.getAssociatedEntityData(), \"SUBJECT\", null);\n\n\t\tthis._recordings = BX.prop.getArray(zoomData, \"RECORDINGS\", []);\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-zoom\" } })\n\t\t);\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail\"}});\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\tif (this._data.hasOwnProperty('PROVIDER_DATA') && this._data[\"PROVIDER_DATA\"][\"ZOOM_EVENT_TYPE\"] === 'ZOOM_CONF_JOINED')\n\t\t{\n\t\t\tentityDetailWrapper = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\ttext: zoomData['CONF_URL']\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tentityDetailWrapper = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tif (this._recordings.length > 0)\n\t\t\t{\n\t\t\t\tif (this._recordings.length > 1)\n\t\t\t\t{\n\t\t\t\t\t//render video parts header\n\n\t\t\t\t\tconst tabs = this._recordings.map(function (recording, index) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tid: index,\n\t\t\t\t\t\t\ttitle: BX.message(\"CRM_TIMELINE_ZOOM_MEETING_RECORD_PART\").replace(\"#NUMBER#\", index + 1),\n\t\t\t\t\t\t\ttime: recording[\"AUDIO\"] ? recording[\"AUDIO\"][\"LENGTH_FORMATTED\"] : \"\",\n\t\t\t\t\t\t\tactive: index === 0\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tconst tabsComponent = new Zoom.TabsComponent({\n\t\t\t\t\t\ttabs: tabs,\n\t\t\t\t\t});\n\t\t\t\t\ttabsComponent.eventEmitter.subscribe(\"onTabChange\", this._onTabChange.bind(this));\n\t\t\t\t\tdetailWrapper.appendChild(tabsComponent.render());\n\t\t\t\t}\n\n\t\t\t\tthis._videoDummy = BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tprops: { className: \"crm-entity-stream-content-detail-zoom-video-wrap\"},\n\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tprops: { className: \"crm-entity-stream-content-detail-zoom-video\" },\n\t\t\t\t\t\t\t\t\tevents:\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tclick: this._onVideoDummyClick.bind(this)\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video-inner\"},\n\t\t\t\t\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video-btn\"},\n\t\t\t\t\t\t\t\t\t\t\t\t\tdataset: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\thint: BX.message(\"CRM_TIMELINE_ZOOM_LOGIN_REQUIRED\"),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'hintNoIcon': 'Y'\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"SPAN\", {\n\t\t\t\t\t\t\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video-text\"},\n\t\t\t\t\t\t\t\t\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_ZOOM_CLICK_TO_WATCH\")\n\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t\t});\n\n\t\t\t\tBX.UI.Hint.init(this._videoDummy);\n\n\t\t\t\tthis._audioDummy = this._history.getManager().renderAudioDummy(\"00:15\", this._onAudioDummyClick.bind(this));\n\t\t\t\tthis._audioLengthElement = this._audioDummy.querySelector('.crm-audio-cap-time');\n\n\t\t\t\tif (zoomData['RECORDINGS'][0]['VIDEO'])\n\t\t\t\t{\n\t\t\t\t\t//video download link with token valid for 24h\n\t\t\t\t\tconst videoLinkExpireTS = (zoomData['RECORDINGS'][0]['VIDEO']['END_DATE_TS'] * 1000) + (60 * 60 * 23 * 1000);\n\t\t\t\t\tif (videoLinkExpireTS < Date.now())\n\t\t\t\t\t{\n\t\t\t\t\t\tconst videoLinkContainer = BX.create(\"DIV\", {\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-detail-zoom-desc\",\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tthis._playVideoLink = BX.create(\"DIV\", {\n\t\t\t\t\t\t\thtml: BX.message(\"CRM_TIMELINE_ZOOM_PLAY_LINK_VIDEO\"),\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tthis._detailZoomCopyVideoLink = BX.create(\"A\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t\tclassName: 'ui-link ui-link-dashed',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_ZOOM_COPY_PASSWORD\")\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tvideoLinkContainer.appendChild(this._playVideoLink);\n\t\t\t\t\t\tvideoLinkContainer.appendChild(this._detailZoomCopyVideoLink);\n\t\t\t\t\t\tentityDetailWrapper.appendChild(videoLinkContainer);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tentityDetailWrapper.appendChild(this._videoDummy);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (zoomData['RECORDINGS'][0]['AUDIO'])\n\t\t\t\t{\n\t\t\t\t\tconst zoomAudioDetailWrapper = BX.create(\"DIV\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-call crm-entity-stream-content-detail-call-inline\"},\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\tzoomAudioDetailWrapper.appendChild(this._audioDummy);\n\t\t\t\t\tzoomAudioDetailWrapper.appendChild(this._history.getManager().getAudioPlaybackRateSelector().render());\n\t\t\t\t\tentityDetailWrapper.appendChild(zoomAudioDetailWrapper);\n\t\t\t\t}\n\n\t\t\t\tthis._downloadWrapper = BX.create(\"DIV\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-desc\"},\n\t\t\t\t});\n\n\t\t\t\tentityDetailWrapper.appendChild(this._downloadWrapper);\n\n\t\t\t\tthis._downloadSubject = BX.create(\"SPAN\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-desc-subject\"},\n\t\t\t\t});\n\t\t\t\tthis._downloadSubjectDetail = BX.create(\"SPAN\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-desc-detail\"},\n\t\t\t\t});\n\t\t\t\tthis._downloadVideoLink = BX.create(\"A\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-desc-link\"},\n\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_ZOOM_DOWNLOAD_VIDEO\")\n\t\t\t\t});\n\t\t\t\tthis._downloadSeparator = BX.create(\"SPAN\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-desc-separate\"},\n\t\t\t\t\thtml: \"&mdash;\"\n\t\t\t\t});\n\t\t\t\tthis._downloadAudioLink = BX.create(\"A\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-desc-link\"},\n\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_ZOOM_DOWNLOAD_AUDIO\")\n\t\t\t\t});\n\t\t\t\tthis.setCurrentRecording(0);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.zoomActivitySubject = BX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\t\ttext: subject\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tentityDetailWrapper.appendChild(this.zoomActivitySubject);\n\n\t\t\t\tif (zoomData['HAS_RECORDING'] === 'Y')\n\t\t\t\t{\n\t\t\t\t\tentityDetailWrapper.appendChild(BX.create(\"DIV\", {\n\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video\"},\n\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video-inner\"},\n\t\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video-img\"},\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\tBX.create(\"SPAN\", {\n\t\t\t\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-video-text\"},\n\t\t\t\t\t\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_ZOOM_MEETING_RECORD_IN_PROCESS\")\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t]\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t/*else\n\t\t{\n\t\t\tdetailWrapper.appendChild(BX.create(\"span\", {text: \"456\"}));\n\n\t\t\tvar entityDetailWrapper = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\ttext: BX.prop.getString(zoomData, \"CONF_URL\", \"\")\n\t\t\t\t}\n\t\t\t);\n\t\t}*/\n\t\t//Content //todo\n\n\n\t\tif(entityDetailWrapper)\n\t\t{\n\t\t\tdetailWrapper.appendChild(entityDetailWrapper);\n\t\t}\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\t_onVideoDummyClick()\n\t{\n\t\tBX.UI.Hint.hide();\n\t\tconst recording = this._recordings[this._currentRecordingIndex][\"VIDEO\"];\n\t\tif(!recording)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis._videoPlayer = this._history.getManager().loadMediaPlayer(\n\t\t\t\"zoom_video_\" + this.getId(),\n\t\t\trecording[\"DOWNLOAD_URL\"],\n\t\t\t\"video/mp4\",\n\t\t\tthis._videoDummy,\n\t\t\trecording[\"LENGTH\"],\n\t\t\t{\n\t\t\t\tvideo: true,\n\t\t\t\tskin: \"\",\n\t\t\t\twidth: 480,\n\t\t\t\theight: 270\n\t\t\t}\n\t\t);\n\t}\n\n\t_onAudioDummyClick()\n\t{\n\t\tconst recording = this._recordings[this._currentRecordingIndex][\"AUDIO\"];\n\t\tif(!recording)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis._history.getManager().getAudioPlaybackRateSelector().addPlayer(this._audioPlayer = this._history.getManager().loadMediaPlayer(\n\t\t\t\"zoom_audio_\" + this.getId(),\n\t\t\trecording[\"DOWNLOAD_URL\"],\n\t\t\t\"audio/mp4\",\n\t\t\tthis._audioDummy,\n\t\t\trecording[\"LENGTH\"],\n\t\t\t{\n\t\t\t\tplaybackRate: this._history.getManager().getAudioPlaybackRateSelector().getRate()\n\t\t\t}\n\t\t));\n\t}\n\n\t_onTabChange(event)\n\t{\n\t\tthis.setCurrentRecording(event.data.tabId);\n\t}\n\n\tsetCurrentRecording(recordingIndex)\n\t{\n\t\tthis._currentRecordingIndex = recordingIndex;\n\t\tconst videoRecording = this._recordings[this._currentRecordingIndex][\"VIDEO\"];\n\t\tconst audioRecording = this._recordings[this._currentRecordingIndex][\"AUDIO\"];\n\n\t\tif(videoRecording)\n\t\t{\n\t\t\tthis._videoDummy.hidden = false;\n\t\t\tif(this._videoPlayer)\n\t\t\t{\n\t\t\t\tthis._videoPlayer.pause();\n\t\t\t\tthis._videoPlayer.setSource(videoRecording[\"DOWNLOAD_URL\"]);\n\t\t\t\tthis._downloadVideoLink.href = videoRecording[\"DOWNLOAD_URL\"];\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._videoDummy.hidden = true;\n\t\t}\n\n\t\tif(audioRecording)\n\t\t{\n\t\t\tthis._audioDummy.hidden = false;\n\t\t\tif(this._audioPlayer)\n\t\t\t{\n\t\t\t\tthis._audioPlayer.pause();\n\t\t\t\tthis._audioPlayer.setSource(audioRecording[\"DOWNLOAD_URL\"]);\n\t\t\t}\n\t\t\tthis._downloadAudioLink.href = audioRecording[\"DOWNLOAD_URL\"];\n\t\t\tthis._audioLengthElement.innerText = audioRecording[\"LENGTH_FORMATTED\"];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._audioDummy.hidden = true;\n\t\t}\n\n\t\tBX.clean(this._downloadWrapper);\n\t\tif(audioRecording || videoRecording)\n\t\t{\n\t\t\tconst lengthHuman = audioRecording ? audioRecording[\"LENGTH_HUMAN\"] : videoRecording[\"LENGTH_HUMAN\"];\n\t\t\tthis._downloadWrapper.appendChild(this._downloadSubject);\n\t\t\tthis._downloadSubject.innerHTML = BX.util.htmlspecialchars(BX.message(\"CRM_TIMELINE_ZOOM_MEETING_RECORD\").replace(\"#DURATION#\", lengthHuman)) + \" &mdash; \"\n\t\t\tthis._downloadWrapper.appendChild(this._downloadSubjectDetail);\n\t\t}\n\t\tif (videoRecording)\n\t\t{\n\t\t\tthis._downloadSubjectDetail.appendChild(this._downloadVideoLink);\n\t\t\tthis._downloadVideoLink.href = videoRecording['DOWNLOAD_URL'];\n\t\t\tif (audioRecording)\n\t\t\t{\n\t\t\t\tthis._downloadSubjectDetail.appendChild(this._downloadSeparator);\n\t\t\t}\n\n\t\t\tif (this._playVideoLink)\n\t\t\t{\n\t\t\t\tthis._playVideoLink.lastElementChild.href = videoRecording[\"PLAY_URL\"];\n\t\t\t\tthis._downloadVideoLink.href = videoRecording[\"PLAY_URL\"];\n\t\t\t}\n\t\t\tif (this._detailZoomCopyVideoLink)\n\t\t\t{\n\t\t\t\tBX.clipboard.bindCopyClick(this._detailZoomCopyVideoLink, {\n\t\t\t\t\ttext: videoRecording['PASSWORD'],\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tif (audioRecording)\n\t\t{\n\t\t\tthis._downloadSubjectDetail.appendChild(this._downloadAudioLink);\n\t\t\tthis._downloadAudioLink.href = audioRecording['DOWNLOAD_URL'];\n\t\t}\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Zoom();\n\t\tself.initialize(id, settings);\n\n\t\t//todo: remove debug\n\t\tif(!window['zoom'])\n\t\t{\n\t\t\twindow['zoom'] = [];\n\t\t}\n\t\twindow['zoom'].push(self);\n\t\treturn self;\n\t}\n}\n\nZoom.TabsComponent = class\n{\n\tconstructor(config)\n\t{\n\t\tthis.tabs = BX.prop.getArray(config, \"tabs\", []);\n\t\tthis.elements = {\n\t\t\tcontainer: null,\n\t\t\ttabs: {}\n\t\t};\n\t\tthis.eventEmitter = new BX.Event.EventEmitter(this, 'Zoom.TabsComponent');\n\t}\n\n\trender()\n\t{\n\t\tif(this.elements.container)\n\t\t{\n\t\t\treturn this.elements.container;\n\t\t}\n\n\t\tthis.elements.container = BX.create(\"DIV\", {\n\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-section-wrapper\"},\n\t\t\tchildren: [\n\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-section-list\"},\n\t\t\t\t\tchildren: this.tabs.map(this._renderTab, this)\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\t\treturn this.elements.container;\n\t}\n\n\t_renderTab(tabDescription)\n\t{\n\t\tconst tabId = tabDescription.id;\n\t\tthis.elements.tabs[tabId] = BX.create(\"DIV\", {\n\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-section\" + (tabDescription.active ? \" crm-entity-stream-content-detail-zoom-section-active\": \"\")},\n\t\t\tchildren: [\n\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-section-inner\"},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-section-title\"},\n\t\t\t\t\t\t\ttext: tabDescription.title\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\tprops: {className: \"crm-entity-stream-content-detail-zoom-section-time\"},\n\t\t\t\t\t\t\ttext: tabDescription.time\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\tclick: function()\n\t\t\t\t{\n\t\t\t\t\tthis.setActiveTab(tabDescription.id)\n\t\t\t\t}.bind(this)\n\t\t\t}\n\t\t});\n\t\treturn this.elements.tabs[tabId];\n\t}\n\n\tsetActiveTab(tabId)\n\t{\n\t\tif(!this.elements.tabs[tabId])\n\t\t{\n\t\t\tthrow new Error (\"Tab \" + tabId + \" is not found\");\n\t\t}\n\t\tfor (let id in this.elements.tabs)\n\t\t{\n\t\t\tif(!this.elements.tabs.hasOwnProperty(id))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tid = Number.parseInt(id, 10);\n\t\t\tif (id === tabId)\n\t\t\t{\n\t\t\t\tthis.elements.tabs[id].classList.add(\"crm-entity-stream-content-detail-zoom-section-active\");\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.elements.tabs[id].classList.remove(\"crm-entity-stream-content-detail-zoom-section-active\");\n\t\t\t}\n\t\t}\n\t\tthis.eventEmitter.emit(\"onTabChange\", {\n\t\t\ttabId: tabId\n\t\t});\n\t}\n};\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class OrderModification extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = OrderModification.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getTextDataParam(\"TITLE\");\n\t}\n\n\tgetStatusInfo()\n\t{\n\t\tconst statusInfo = {};\n\t\tlet value = null;\n\t\tlet classCode = null;\n\t\tconst fieldName = this.getTextDataParam(\"CHANGED_ENTITY\");\n\t\tconst fields = this.getObjectDataParam('FIELDS');\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tif (fieldName === BX.CrmEntityType.names.order)\n\t\t{\n\t\t\tif (BX.prop.get(fields, 'ORDER_CANCELED') === 'Y')\n\t\t\t{\n\t\t\t\tvalue = \"canceled\";\n\t\t\t\tclassCode  = \"not-paid\";\n\t\t\t}\n\t\t\telse if (BX.prop.get(fields, 'ORDER_DONE') === 'Y')\n\t\t\t{\n\t\t\t\tvalue = \"done\";\n\t\t\t\tclassCode  = \"done\";\n\t\t\t}\n\t\t\telse if (BX.prop.getString(entityData, \"VIEWED\", '') === 'Y')\n\t\t\t{\n\t\t\t\tvalue = \"viewed\";\n\t\t\t\tclassCode  = \"done\";\n\t\t\t}\n\t\t\telse if (BX.prop.getString(entityData, \"SENT\", '') === 'Y')\n\t\t\t{\n\t\t\t\tvalue = \"sent\";\n\t\t\t\tclassCode  = \"sent\";\n\t\t\t}\n\t\t}\n\t\tif (fieldName === BX.CrmEntityType.names.orderpayment)\n\t\t{\n\t\t\tconst psStatusCode = BX.prop.get(fields, 'STATUS_CODE', false);\n\t\t\tif (psStatusCode)\n\t\t\t{\n\t\t\t\tif (psStatusCode === 'ERROR')\n\t\t\t\t{\n\t\t\t\t\tvalue = \"orderPaymentError\";\n\t\t\t\t\tclassCode = \"payment-error\";\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (BX.prop.getString(entityData, \"VIEWED\", '') === 'Y')\n\t\t\t{\n\t\t\t\tvalue = \"viewed\";\n\t\t\t\tclassCode  = \"done\";\n\t\t\t}\n\t\t\telse if (BX.prop.getString(entityData, \"SENT\", '') === 'Y')\n\t\t\t{\n\t\t\t\tvalue = \"sent\";\n\t\t\t\tclassCode  = \"sent\";\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tvalue = BX.prop.get(fields, 'ORDER_PAID') === 'Y' ? \"paid\" : \"unpaid\";\n\t\t\t\tclassCode  = BX.prop.get(fields, 'ORDER_PAID') === 'Y' ? \"paid\" : \"not-paid\";\n\t\t\t}\n\t\t}\n\t\telse if (fieldName === BX.CrmEntityType.names.ordershipment && BX.prop.get(fields, 'ORDER_DEDUCTED', false))\n\t\t{\n\t\t\tvalue = BX.prop.get(fields, 'ORDER_DEDUCTED') === 'Y' ? \"deducted\" : \"unshipped\";\n\t\t\tclassCode  = BX.prop.get(fields, 'ORDER_DEDUCTED') === 'Y' ? \"shipped\" : \"not-shipped\";\n\t\t}\n\t\telse if (fieldName === BX.CrmEntityType.names.ordershipment && BX.prop.get(fields, 'ORDER_ALLOW_DELIVERY', false))\n\t\t{\n\t\t\tvalue = BX.prop.get(fields, 'ORDER_ALLOW_DELIVERY') === 'Y' ? \"allowedDelivery\" : \"disallowedDelivery\";\n\t\t\tclassCode  = BX.prop.get(fields, 'ORDER_ALLOW_DELIVERY') === 'Y' ? \"allowed-delivery\" : \"disallowed-delivery\";\n\t\t}\n\n\t\tif (value)\n\t\t{\n\t\t\tstatusInfo.className = \"crm-entity-stream-content-event-\" + classCode;\n\t\t\tstatusInfo.message = this.getMessage(value);\n\t\t}\n\n\t\treturn statusInfo;\n\t}\n\n\tgetHeaderChildren()\n\t{\n\t\tconst children = [\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\t\tevents: {click: this._headerClickHandler},\n\t\t\t\t\ttext: this.getTitle(),\n\t\t\t\t}\n\t\t\t)\n\t\t];\n\t\tconst statusInfo = this.getStatusInfo();\n\t\tif (BX.type.isNotEmptyObject(statusInfo))\n\t\t{\n\t\t\tchildren.push(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: statusInfo.className },\n\t\t\t\t\t\ttext: statusInfo.message\n\t\t\t\t\t}\n\t\t\t\t));\n\t\t}\n\t\tchildren.push(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t));\n\t\treturn children;\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\t\tconst entityId = this.getAssociatedEntityId();\n\t\tconst title = BX.prop.getString(entityData, \"TITLE\");\n\t\tconst htmlTitle = BX.prop.getString(entityData, \"HTML_TITLE\", \"\");\n\t\tconst showUrl = BX.prop.getString(entityData, \"SHOW_URL\", \"\");\n\t\tconst nodes = [];\n\t\tif(title !== \"\")\n\t\t{\n\t\t\tconst descriptionNode = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-description\"}});\n\n\t\t\tif(showUrl === \"\" || (entityTypeId === this.getOwnerTypeId() && entityId === this.getOwnerId()))\n\t\t\t{\n\t\t\t\tdescriptionNode.appendChild(BX.create(\"SPAN\", { text: title + \" \" + htmlTitle}));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (htmlTitle === \"\")\n\t\t\t\t{\n\t\t\t\t\tdescriptionNode.appendChild(BX.create(\"A\", {attrs: {href: showUrl}, text: title}));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tdescriptionNode.appendChild(BX.create(\"SPAN\", { text: title + \" \"}));\n\t\t\t\t\tdescriptionNode.appendChild(BX.create(\"A\", {attrs: {href: showUrl}, text: htmlTitle}));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst legend = BX.prop.getString(entityData, \"LEGEND\");\n\t\t\tif(legend !== \"\")\n\t\t\t{\n\t\t\t\tdescriptionNode.appendChild(BX.create(\"SPAN\", { html: \" \" + legend }));\n\t\t\t}\n\n\t\t\tconst sublegend = BX.prop.getString(entityData, \"SUBLEGEND\", '');\n\t\t\tif (sublegend !== '')\n\t\t\t{\n\t\t\t\tdescriptionNode.appendChild(BX.create(\"BR\"));\n\t\t\t\tdescriptionNode.appendChild(BX.create(\"SPAN\", { text: \" \" + sublegend}));\n\t\t\t}\n\t\t\tnodes.push(descriptionNode);\n\t\t}\n\n\t\treturn nodes;\n\t}\n\n\tprepareViewedContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\t\tconst entityId = this.getAssociatedEntityId();\n\t\tconst title = BX.prop.getString(entityData, \"TITLE\");\n\t\tconst showUrl = BX.prop.getString(entityData, \"SHOW_URL\", \"\");\n\t\tconst nodes = [];\n\n\t\tif (title !== \"\")\n\t\t{\n\t\t\tconst sublegend = BX.prop.getString(entityData, \"SUBLEGEND\", '');\n\t\t\tif (sublegend !== \"\")\n\t\t\t{\n\t\t\t\tconst descriptionNode = BX.create(\"DIV\", {\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-description\"},\n\t\t\t\t\ttext: sublegend,\n\t\t\t\t});\n\t\t\t\tnodes.push(descriptionNode);\n\t\t\t}\n\n\n\t\t\tif(entityTypeId === this.getOwnerTypeId() && entityId === this.getOwnerId())\n\t\t\t{\n\t\t\t\tnodes.push(BX.create(\"SPAN\", { text: title }));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tnodes.push(BX.create(\"A\", { attrs: { href: showUrl }, text: title }));\n\t\t\t}\n\n\t\t\tconst legend = BX.prop.getString(entityData, \"LEGEND\");\n\t\t\tif(legend !== \"\")\n\t\t\t{\n\t\t\t\tnodes.push(BX.create(\"SPAN\", { html: \" \" + legend }));\n\t\t\t}\n\t\t}\n\n\t\treturn nodes;\n\t}\n\n\tprepareSentContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\t\tconst entityId = this.getAssociatedEntityId();\n\t\tconst title = BX.prop.getString(entityData, \"TITLE\");\n\t\tconst showUrl = BX.prop.getString(entityData, 'SHOW_URL', '');\n\t\tconst destination = BX.prop.getString(entityData, 'DESTINATION_TITLE', '');\n\t\tconst nodes = [];\n\n\t\tif (title !== \"\")\n\t\t{\n\t\t\tconst detailNode = BX.create('DIV', {attrs: {className: 'crm-entity-stream-content-detail-description'}});\n\t\t\tif(showUrl === \"\" || (entityTypeId === this.getOwnerTypeId() && entityId === this.getOwnerId()))\n\t\t\t{\n\t\t\t\tdetailNode.appendChild(BX.create(\"SPAN\", { text: title }));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdetailNode.appendChild(BX.create('A', { attrs: { href: showUrl }, text: title }));\n\t\t\t}\n\n\t\t\tconst legend = BX.prop.getString(entityData, \"LEGEND\");\n\t\t\tif(legend !== \"\")\n\t\t\t{\n\t\t\t\tdetailNode.appendChild(BX.create(\"SPAN\", { html: \" \" + legend }));\n\t\t\t}\n\n\t\t\tif (destination)\n\t\t\t{\n\t\t\t\tdetailNode.appendChild(BX.create('SPAN', {\n\t\t\t\t\tattrs: { className: 'crm-entity-stream-content-detail-order-destination' },\n\t\t\t\t\ttext: destination,\n\t\t\t\t}));\n\t\t\t}\n\n\t\t\tnodes.push(detailNode);\n\n\t\t\tconst sliderLinkNode = BX.create('A', {\n\t\t\t\tattrs: {href: \"#\"},\n\t\t\t\ttext: this.getMessage('orderPaymentProcess'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick: BX.proxy(this.startSalescenterApplication, this),\n\t\t\t\t},\n\t\t\t});\n\t\t\tnodes.push(sliderLinkNode);\n\t\t}\n\n\t\treturn nodes;\n\t}\n\n\tstartSalescenterApplication()\n\t{\n\t\tBX.loadExt('salescenter.manager').then(function()\n\t\t{\n\t\t\tconst fields = this.getObjectDataParam('FIELDS'),\n\t\t\t\townerTypeId = BX.prop.get(fields, 'OWNER_TYPE_ID', BX.CrmEntityType.enumeration.deal);\n\t\t\tlet ownerId = BX.prop.get(fields, 'OWNER_ID', 0);\n\t\t\tconst paymentId = BX.prop.get(fields, 'PAYMENT_ID', 0),\n\t\t\t\tshipmentId = BX.prop.get(fields, 'SHIPMENT_ID', 0),\n\t\t\t\torderId = BX.prop.get(fields, 'ORDER_ID', 0)\n\t\t\t;\n\n\t\t\t// compatibility\n\t\t\tif (!ownerId)\n\t\t\t{\n\t\t\t\townerId = BX.prop.get(fields, 'DEAL_ID', 0);\n\t\t\t}\n\n\t\t\tBX.Salescenter.Manager.openApplication({\n\t\t\t\tdisableSendButton: '',\n\t\t\t\tcontext: 'deal',\n\t\t\t\townerTypeId: ownerTypeId,\n\t\t\t\townerId: ownerId,\n\t\t\t\tmode: ownerTypeId === BX.CrmEntityType.enumeration.deal ? 'payment_delivery' : 'payment',\n\t\t\t\ttemplateMode: 'view',\n\t\t\t\torderId: orderId,\n\t\t\t\tpaymentId: paymentId,\n\t\t\t\tshipmentId: shipmentId,\n\t\t\t});\n\t\t}.bind(this));\n\t}\n\n\tpreparePaidPaymentContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData(),\n\t\t\ttitle = BX.prop.getString(entityData, \"TITLE\"),\n\t\t\tdate = BX.prop.getString(entityData, \"DATE\", \"\"),\n\t\t\tpaySystemName = BX.prop.getString(entityData, \"PAY_SYSTEM_NAME\", \"\"),\n\t\t\tsum = BX.prop.getString(entityData, 'SUM', ''),\n\t\t\tcurrency = BX.prop.getString(entityData, 'CURRENCY', ''),\n\t\t\tnodes = [];\n\n\t\tif(title !== \"\")\n\t\t{\n\t\t\tconst paymentDetail = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-payment\"}});\n\t\t\tpaymentDetail.appendChild(\n\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-payment-value\"},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-payment-text\"},\n\t\t\t\t\t\t\thtml: sum,\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-payment-currency\"},\n\t\t\t\t\t\t\thtml: currency,\n\t\t\t\t\t\t}),\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t);\n\n\t\t\tconst logotip = BX.prop.getString(entityData, \"LOGOTIP\", null);\n\t\t\tif (logotip)\n\t\t\t{\n\t\t\t\tpaymentDetail.appendChild(\n\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-payment-logo\"},\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\tbackgroundImage: \"url(\" + encodeURI(logotip) + \")\",\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\t\t\tnodes.push(paymentDetail);\n\n\t\t\tconst descriptionNode = BX.create(\"DIV\", {\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-description\"},\n\t\t\t\tchildren: [\n\t\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\t\ttext: date\n\t\t\t\t\t}),\n\t\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-description-info\"},\n\t\t\t\t\t\ttext: this.getMessage('orderPaySystemTitle')\n\t\t\t\t\t}),\n\t\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\t\ttext: paySystemName\n\t\t\t\t\t}),\n\t\t\t\t]\n\t\t\t});\n\t\t\tnodes.push(descriptionNode);\n\t\t}\n\n\t\treturn nodes;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst fields = this.getObjectDataParam('FIELDS'),\n\t\t\tisPaid = BX.prop.get(fields, 'ORDER_PAID') === 'Y',\n\t\t\tisClick = BX.prop.get(fields, 'PAY_SYSTEM_CLICK') === 'Y',\n\t\t\tisManualContinuePay = BX.prop.get(fields, 'MANUAL_CONTINUE_PAY') === 'Y',\n\t\t\tisManualAddCheck = BX.prop.get(fields, 'NEED_MANUAL_ADD_CHECK') === 'Y',\n\t\t\tentityId = this.getAssociatedEntityTypeId();\n\n\t\tif (entityId === BX.CrmEntityType.enumeration.orderpayment && isPaid)\n\t\t{\n\t\t\treturn this.preparePaidPaymentContent();\n\t\t}\n\t\telse if (entityId === BX.CrmEntityType.enumeration.orderpayment && isClick)\n\t\t{\n\t\t\treturn this.prepareClickedPaymentContent();\n\t\t}\n\t\telse if (entityId === BX.CrmEntityType.enumeration.order && isManualContinuePay)\n\t\t{\n\t\t\treturn this.prepareManualContinuePayContent();\n\t\t}\n\t\telse if (entityId === BX.CrmEntityType.enumeration.orderpayment && isManualAddCheck)\n\t\t{\n\t\t\treturn this.prepareManualAddCheck();\n\t\t}\n\n\t\treturn this.prepareItemOrderContent();\n\t}\n\n\tprepareItemOrderContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst isViewed = BX.prop.getString(entityData, \"VIEWED\", '') === 'Y';\n\t\tconst isSent = BX.prop.getString(entityData, \"SENT\", '') === 'Y';\n\t\tconst fields = this.getObjectDataParam('FIELDS');\n\t\tconst psStatusCode = BX.prop.get(fields, 'STATUS_CODE', false);\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: 'crm-entity-stream-section crm-entity-stream-section-history'}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: 'crm-entity-stream-section-icon ' + this.getIconClassName() } })\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst header = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\t\tchildren: this.getHeaderChildren()\n\t\t\t});\n\n\t\tlet contentChildren = null;\n\t\tif (isViewed)\n\t\t{\n\t\t\tcontentChildren = this.prepareViewedContentDetails();\n\t\t}\n\t\telse if (isSent)\n\t\t{\n\t\t\tcontentChildren = this.prepareSentContentDetails();\n\t\t}\n\t\telse if (psStatusCode === 'ERROR')\n\t\t{\n\t\t\tcontentChildren = this.prepareErrorPaymentContentDetails();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcontentChildren = this.prepareContentDetails();\n\t\t}\n\n\t\tcontent.appendChild(header);\n\t\tcontent.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: contentChildren\n\t\t\t\t})\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tpreparePaidPaymentContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: 'crm-entity-stream-section'}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: 'crm-entity-stream-section-icon crm-entity-stream-section-icon-wallet' } })\n\t\t);\n\n\t\tconst header = [\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: {href: \"#\"},\n\t\t\t\t\t\t\t\t\tevents: {click: this._headerClickHandler},\n\t\t\t\t\t\t\t\t\ttext: this.getMessage('orderPaymentSuccessTitle')\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t];\n\t\theader.push(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst headerWrap = BX.create(\"DIV\", {\n\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\tchildren: header\n\t\t});\n\n\t\tconst contentChildren = this.preparePaidPaymentContentDetails();\n\t\tcontent.appendChild(headerWrap);\n\t\tcontent.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: contentChildren\n\t\t\t\t})\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tprepareErrorPaymentContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData(),\n\t\t\tdate = BX.prop.getString(entityData, 'DATE', ''),\n\t\t\tfields = this.getObjectDataParam('FIELDS'),\n\t\t\tpaySystemName = BX.prop.getString(fields, 'PAY_SYSTEM_NAME', ''),\n\t\t\tpaySystemError = BX.prop.getString(fields, 'STATUS_DESCRIPTION', ''),\n\t\t\tnodes = [];\n\n\t\tconst descriptionNode = BX.create('DIV', {\n\t\t\tattrs: {className: 'crm-entity-stream-content-detail-description'},\n\t\t\tchildren: [\n\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\ttext: date\n\t\t\t\t}),\n\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\tattrs: {className: 'crm-entity-stream-content-detail-description-info'},\n\t\t\t\t\ttext: this.getMessage('orderPaySystemTitle')\n\t\t\t\t}),\n\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\ttext: paySystemName\n\t\t\t\t}),\n\t\t\t]\n\t\t});\n\t\tnodes.push(descriptionNode);\n\n\t\tconst errorDetailNode = BX.create('DIV', {\n\t\t\tattrs: {className: 'crm-entity-stream-content-event-payment-initiate-pay-error'},\n\t\t\ttext: this.getMessage('orderPaymentStatusErrorReason').replace(\"#PAYSYSTEM_ERROR#\", paySystemError),\n\t\t});\n\n\t\tnodes.push(errorDetailNode);\n\n\t\treturn nodes;\n\t}\n\n\tprepareClickedPaymentContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: 'crm-entity-stream-section crm-entity-stream-section-history'}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: 'crm-entity-stream-section-icon ' + this.getIconClassName() } })\n\t\t);\n\n\t\tconst header = [\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: {href: \"#\"},\n\t\t\t\t\t\t\t\t\tevents: {click: this._headerClickHandler},\n\t\t\t\t\t\t\t\t\ttext: this.getTitle(),\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t];\n\t\theader.push(\n\t\t\tBX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst headerWrap = BX.create(\"DIV\", {\n\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\tchildren: header\n\t\t});\n\n\t\tconst contentChildren = this.prepareClickedPaymentContentDetails();\n\t\tcontent.appendChild(headerWrap);\n\t\tcontent.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: contentChildren\n\t\t\t\t})\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tprepareClickedPaymentContentDetails()\n\t{\n\t\tconst fields = this.getObjectDataParam('FIELDS'),\n\t\t\tpaySystemName = BX.prop.getString(fields, 'PAY_SYSTEM_NAME', ''),\n\t\t\tnodes = [];\n\n\t\tif(paySystemName !== '')\n\t\t{\n\t\t\tconst descriptionNode = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-detail-description\"}});\n\t\t\tdescriptionNode.appendChild(\n\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-clicked-description-info\" },\n\t\t\t\t\ttext: this.getMessage('orderPaymentPaySystemClick')\n\t\t\t\t})\n\t\t\t);\n\t\t\tdescriptionNode.appendChild(\n\t\t\t\tBX.create('SPAN', {\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-clicked-description-name\" },\n\t\t\t\t\ttext: paySystemName\n\t\t\t\t})\n\t\t\t);\n\n\t\t\tnodes.push(descriptionNode);\n\t\t}\n\n\t\treturn nodes;\n\t}\n\n\tprepareManualContinuePayContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: 'crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-advice'}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", {\n\t\t\t\tattrs: { className: 'crm-entity-stream-section-icon crm-entity-stream-section-icon-advice' },\n\t\t\t\tchildren: [BX.create('i')],\n\t\t\t})\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {\n\t\t\tattrs: {className: \"crm-entity-stream-advice-info\"},\n\t\t\ttext: this.getMessage('orderManualContinuePay'),\n\t\t});\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-advice-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tprepareManualAddCheck()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst showUrl = BX.prop.getString(entityData, \"SHOW_URL\", \"\");\n\n\t\tconst wrapper = BX.create(\n\t\t\t\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: 'crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-advice'\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t\twrapper.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'crm-entity-stream-section-icon crm-entity-stream-section-icon-advice'\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst htmlTitle = this.getMessage('orderManualAddCheck').replace(\"#HREF#\", showUrl);\n\t\tconst content = BX.create(\n\t\t\t\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"crm-entity-stream-advice-info\",\n\t\t\t\t},\n\t\t\t\thtml: htmlTitle,\n\t\t\t}\n\t\t);\n\n\t\tconst link = BX.create(\n\t\t\t\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"crm-entity-stream-advice-info\",\n\t\t\t\t},\n\t\t\t\tchildren: [\n\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\"A\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-detail-target\",\n\t\t\t\t\t\t\t\thref: \"#\",\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\tclick: BX.delegate(function (e) {\n\t\t\t\t\t\t\t\t\ttop.BX.Helper.show('redirect=detail&code=13742126');\n\t\t\t\t\t\t\t\t\te.preventDefault ? e.preventDefault() : (e.returnValue = false);\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\thtml: this.getMessage('orderManualAddCheckHelpLink'),\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t]\n\t\t\t}\n\t\t);\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\n\t\t\t\t\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: \"crm-entity-stream-advice-content\"\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [ content, link ]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn 'crm-entity-stream-section-icon-store';\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new OrderModification();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import OrderModification from \"./order-modification\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class ExternalNoticeModification extends OrderModification\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn 'crm-entity-stream-section-icon-restApp';\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new ExternalNoticeModification();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import ExternalNoticeModification from \"./external-notice-modification\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class ExternalNoticeStatusModification extends ExternalNoticeModification\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\tconst nodes = [];\n\t\tconst contentChildren = [];\n\n\t\tif (BX.type.isNotEmptyString(this.getTextDataParam(\"START_NAME\")))\n\t\t{\n\t\t\tcontentChildren.push(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detain-info-status\"},\n\t\t\t\t\t\ttext: this.getTextDataParam(\"START_NAME\")\n\t\t\t\t\t})\n\t\t\t);\n\t\t\tcontentChildren.push(\n\t\t\t\tBX.create(\"SPAN\",{ attrs: { className: \"crm-entity-stream-content-detail-info-separator-icon\" } })\n\t\t\t);\n\t\t}\n\n\t\tif (BX.type.isNotEmptyString(this.getTextDataParam(\"FINISH_NAME\")))\n\t\t{\n\t\t\tcontentChildren.push(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detain-info-status\" },\n\t\t\t\t\t\ttext: this.getTextDataParam(\"FINISH_NAME\")\n\t\t\t\t\t})\n\t\t\t);\n\t\t}\n\n\t\tnodes.push(BX.create(\"DIV\",\t{\n\t\t\tattrs: { className: \"crm-entity-stream-content-detail-info\" },\n\t\t\tchildren: contentChildren\n\t\t}));\n\n\t\treturn nodes;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new ExternalNoticeStatusModification();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryItem from \"./history\";\nimport {Item as ItemType} from \"../types\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Creation extends HistoryItem\n{\n\tstatic messages = {};\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Creation();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tdoInitialize()\n\t{\n\t\tsuper.doInitialize();\n\t\tif (!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"Creation. The field 'activityEditor' is not assigned.\";\n\t\t}\n\t}\n\n\tgetTitle()\n\t{\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tif (entityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst typeId = BX.prop.getInteger(entityData, \"TYPE_ID\");\n\t\t\tconst title = this.getMessage(typeId === BX.CrmActivityType.task ? \"task\" : \"activity\");\n\t\t\treturn title.replace(/#TITLE#/gi, this.cutOffText(BX.prop.getString(entityData, \"SUBJECT\")), 64);\n\t\t}\n\n\t\tif (entityTypeId === BX.CrmEntityType.enumeration.storeDocument)\n\t\t{\n\t\t\tconst docType = BX.prop.getString(entityData, \"DOC_TYPE\");\n\t\t\tif (docType === 'A')\n\t\t\t{\n\t\t\t\treturn this.getMessage('arrivalDocument');\n\t\t\t}\n\t\t\tif (docType === 'S')\n\t\t\t{\n\t\t\t\treturn this.getMessage('storeAdjustmentDocument');\n\t\t\t}\n\t\t\tif (docType === 'M')\n\t\t\t{\n\t\t\t\treturn this.getMessage('movingDocument');\n\t\t\t}\n\t\t\tif (docType === 'D')\n\t\t\t{\n\t\t\t\treturn this.getMessage('deductDocument');\n\t\t\t}\n\t\t\tif (docType === 'W')\n\t\t\t{\n\t\t\t\treturn this.getMessage('shipmentDocument');\n\t\t\t}\n\n\t\t\treturn '';\n\t\t}\n\n\t\tconst entityTypeName = BX.CrmEntityType.resolveName(this.getAssociatedEntityTypeId()).toLowerCase();\n\t\tlet msg = this.getMessage(entityTypeName);\n\t\tconst isMessageNotFound = (msg === entityTypeName);\n\t\tif (!BX.type.isNotEmptyString(msg) || isMessageNotFound)\n\t\t{\n\t\t\tmsg = this.getTextDataParam(\"TITLE\");\n\t\t}\n\n\t\treturn msg;\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-createEntity\";\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\n\t\tif (\n\t\t\tentityTypeId === BX.CrmEntityType.enumeration.ordershipment\n\t\t\t|| entityTypeId === BX.CrmEntityType.enumeration.orderpayment\n\t\t)\n\t\t{\n\t\t\tconst data = this.getData();\n\t\t\tdata.TYPE_CATEGORY_ID = ItemType.modification;\n\t\t\tif (data.hasOwnProperty('ASSOCIATED_ENTITY'))\n\t\t\t{\n\t\t\t\tdata.ASSOCIATED_ENTITY.HTML_TITLE = '';\n\t\t\t}\n\n\t\t\tconst createOrderEntityItem = this._history.createOrderEntityItem(data);\n\t\t\treturn createOrderEntityItem.prepareContent();\n\t\t}\n\n\t\treturn super.prepareContent();\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\t\tconst entityId = this.getAssociatedEntityId();\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tif (entityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst link = BX.create(\"A\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {href: \"#\"},\n\t\t\t\t\thtml: this.cutOffText(BX.prop.getString(entityData, \"DESCRIPTION_RAW\"), 128)\n\t\t\t\t}\n\t\t\t);\n\t\t\tBX.bind(link, \"click\", this._headerClickHandler);\n\n\t\t\treturn [link];\n\t\t}\n\n\t\tconst title = BX.prop.getString(entityData, \"TITLE\", \"\");\n\t\tlet htmlTitle = BX.prop.getString(entityData, \"HTML_TITLE\", \"\");\n\t\tconst showUrl = BX.prop.getString(entityData, \"SHOW_URL\", \"\");\n\n\t\tif (\n\t\t\tentityTypeId === BX.CrmEntityType.enumeration.deal\n\t\t\t&& BX.prop.getObject(entityData, \"ORDER\", null)\n\t\t)\n\t\t{\n\t\t\tconst orderData = BX.prop.getObject(entityData, \"ORDER\", null);\n\t\t\thtmlTitle = this.getMessage('dealOrderTitle')\n\t\t\t\t.replace(\"#ORDER_ID#\", orderData.ID)\n\t\t\t\t.replace(\"#DATE_TIME#\", orderData.ORDER_DATE)\n\t\t\t\t.replace(\"#HREF#\", orderData.SHOW_URL)\n\t\t\t\t.replace(\"#PRICE_WITH_CURRENCY#\", orderData.SUM)\n\t\t\t;\n\t\t}\n\n\t\tif (title !== \"\" || htmlTitle !== \"\")\n\t\t{\n\t\t\tconst nodes = [];\n\t\t\tif (showUrl === \"\" || (entityTypeId === this.getOwnerTypeId() && entityId === this.getOwnerId()))\n\t\t\t{\n\t\t\t\tconst spanAttrs = (htmlTitle !== \"\") ? {html: htmlTitle} : {text: title};\n\t\t\t\tnodes.push(BX.create(\"SPAN\", spanAttrs));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet linkAttrs = {attrs: {href: showUrl}, text: title};\n\t\t\t\tif (htmlTitle !== \"\")\n\t\t\t\t{\n\t\t\t\t\tlinkAttrs = {attrs: {href: showUrl}, html: htmlTitle};\n\t\t\t\t}\n\t\t\t\tnodes.push(BX.create(\"A\", linkAttrs));\n\t\t\t}\n\n\t\t\tconst legend = this.getTextDataParam(\"LEGEND\");\n\t\t\tif (legend !== \"\")\n\t\t\t{\n\t\t\t\tnodes.push(BX.create(\"BR\"));\n\t\t\t\tnodes.push(BX.create(\"SPAN\", {text: legend}));\n\t\t\t}\n\n\t\t\tconst baseEntityData = this.getObjectDataParam(\"BASE\");\n\t\t\tconst baseEntityInfo = BX.prop.getObject(baseEntityData, \"ENTITY_INFO\");\n\t\t\tif (baseEntityInfo)\n\t\t\t{\n\t\t\t\tnodes.push(BX.create(\"BR\"));\n\t\t\t\tnodes.push(BX.create(\"SPAN\", {text: BX.prop.getString(baseEntityData, \"CAPTION\") + \": \"}));\n\t\t\t\tnodes.push(\n\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: {href: BX.prop.getString(baseEntityInfo, \"SHOW_URL\", \"#\")},\n\t\t\t\t\t\t\ttext: BX.prop.getString(baseEntityInfo, \"TITLE\", \"\")\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn nodes;\n\t\t}\n\t\treturn [];\n\t}\n\n\tview()\n\t{\n\t\tconst entityTypeId = this.getAssociatedEntityTypeId();\n\t\tif (entityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityData = this.getAssociatedEntityData();\n\t\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\t\tif (id > 0)\n\t\t\t{\n\t\t\t\tthis._activityEditor.viewActivity(id);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Creation.messages;\n\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Restoration extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getTextDataParam(\"TITLE\");\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-restoreEntity\";\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst title = BX.prop.getString(entityData, \"TITLE\");\n\t\treturn title !== \"\" ?  [ BX.create(\"SPAN\", { text: title }) ] : [];\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Restoration.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Restoration();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Relation extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getMessage('title');\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-createEntity\";\n\t}\n\n\tprepareContentDetails()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\tlet link = BX.prop.getString(entityData, \"SHOW_URL\", \"\");\n\t\tif (link.indexOf('/') !== 0)\n\t\t{\n\t\t\tlink = '#';\n\t\t}\n\n\t\tconst content =\n\t\t\tthis.getMessage('contentTemplate')\n\t\t\t\t.replace('#ENTITY_TYPE_CAPTION#', BX.Text.encode(BX.prop.getString(entityData, 'ENTITY_TYPE_CAPTION', '')))\n\t\t\t\t.replace('#LEGEND#', '')\n\t\t\t\t.replace('#LINK#', BX.Text.encode(link))\n\t\t\t\t.replace('#LINK_TITLE#', BX.Text.encode(BX.prop.getString(entityData, \"TITLE\", '')))\n\t\t;\n\n\t\tconst nodes = [];\n\t\tnodes.push(\n\t\t\tBX.create('SPAN', { html: content })\n\t\t);\n\n\t\treturn nodes;\n\t}\n}\n","import Relation from \"./relation\"\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Link extends Relation\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-link\";\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Link.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Link();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import Relation from \"./relation\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Unlink extends Relation\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-unlink\";\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Unlink.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Unlink();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import History from \"./history\";\nimport {Mark as MarkType} from \"../types\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Mark extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tdoInitialize()\n\t{\n\t\tsuper.doInitialize();\n\t\tif(!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t{\n\t\t\tthrow \"Mark. The field 'activityEditor' is not assigned.\";\n\t\t}\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Mark.messages;\n\t\tif (m.hasOwnProperty(name))\n\t\t{\n\t\t\treturn m[name];\n\t\t}\n\n\t\treturn super.getMessage(name);\n\t}\n\n\tgetTitle()\n\t{\n\t\tlet title = \"\";\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\t\tconst typeCategoryId = this.getTypeCategoryId();\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityTypeId = BX.prop.getInteger(entityData, \"TYPE_ID\", 0);\n\t\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\t\t\tconst activityProviderId = BX.prop.getString(entityData, \"PROVIDER_ID\", '');\n\n\t\t\tif(entityTypeId === BX.CrmActivityType.email)\n\t\t\t{\n\t\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\n\t\t\t\t\t\t(direction === BX.CrmActivityDirection.incoming ? \"incomingEmail\" : \"outgoingEmail\") +\n\t\t\t\t\t\t\"SuccessMark\"\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(typeCategoryId === MarkType.renew)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\n\t\t\t\t\t\t(direction === BX.CrmActivityDirection.incoming ? \"incomingEmail\" : \"outgoingEmail\") +\n\t\t\t\t\t\t\"RenewMark\"\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.call)\n\t\t\t{\n\t\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\n\t\t\t\t\t\t(direction === BX.CrmActivityDirection.incoming ? \"incomingCall\" : \"outgoingCall\") +\n\t\t\t\t\t\t\"SuccessMark\"\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(typeCategoryId === MarkType.renew)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\n\t\t\t\t\t\t(direction === BX.CrmActivityDirection.incoming ? \"incomingCall\" : \"outgoingCall\") +\n\t\t\t\t\t\t\"RenewMark\"\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.meeting)\n\t\t\t{\n\t\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\"meetingSuccessMark\");\n\t\t\t\t}\n\t\t\t\telse if(typeCategoryId === MarkType.renew)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\"meetingRenewMark\");\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.task)\n\t\t\t{\n\t\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\"taskSuccessMark\");\n\t\t\t\t}\n\t\t\t\telse if(typeCategoryId === MarkType.renew)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\"taskRenewMark\");\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.provider)\n\t\t\t{\n\t\t\t\tif (activityProviderId === 'CRM_REQUEST')\n\t\t\t\t{\n\t\t\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle = this.getMessage(\"requestSuccessMark\");\n\t\t\t\t\t}\n\t\t\t\t\telse if(typeCategoryId === MarkType.renew)\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle = this.getMessage(\"requestRenewMark\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if(typeCategoryId === MarkType.success)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\"webformSuccessMark\");\n\t\t\t\t}\n\t\t\t\telse if(typeCategoryId === MarkType.renew)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage(\"webformRenewMark\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if(associatedEntityTypeId === BX.CrmEntityType.enumeration.deal)\n\t\t{\n\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t{\n\t\t\t\ttitle = this.getMessage(\"dealSuccessMark\");\n\t\t\t}\n\t\t\telse if(typeCategoryId === MarkType.failed)\n\t\t\t{\n\t\t\t\ttitle = this.getMessage(\"dealFailedMark\");\n\t\t\t}\n\t\t}\n\t\telse if(associatedEntityTypeId === BX.CrmEntityType.enumeration.order)\n\t\t{\n\t\t\tif(typeCategoryId === MarkType.success)\n\t\t\t{\n\t\t\t\ttitle = this.getMessage(\"orderSuccessMark\");\n\t\t\t}\n\t\t\telse if(typeCategoryId === MarkType.failed)\n\t\t\t{\n\t\t\t\ttitle = this.getMessage(\"orderFailedMark\");\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (BX.CrmEntityType.isDefined(associatedEntityTypeId))\n\t\t\t{\n\t\t\t\tif (typeCategoryId === MarkType.success)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage('entitySuccessMark');\n\t\t\t\t}\n\t\t\t\telse if (typeCategoryId === MarkType.failed)\n\t\t\t\t{\n\t\t\t\t\ttitle = this.getMessage('entityFailedMark');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn title;\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.order)\n\t\t{\n\t\t\treturn BX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-title\" },\n\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn BX.create(\"A\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { href: \"#\", className: \"crm-entity-stream-content-event-title\" },\n\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\n\t\tconst wrapper = BX.create(\n\t\t\t\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-completed\"}}\n\t\t);\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst header = this.prepareHeaderLayout();\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityTypeId = BX.prop.getInteger(entityData, \"TYPE_ID\", 0);\n\t\t\tlet iconClassName = \"crm-entity-stream-section-icon\";\n\t\t\tif(entityTypeId === BX.CrmActivityType.email)\n\t\t\t{\n\t\t\t\ticonClassName += \" crm-entity-stream-section-icon-email\";\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.call)\n\t\t\t{\n\t\t\t\ticonClassName += \" crm-entity-stream-section-icon-call\";\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.meeting)\n\t\t\t{\n\t\t\t\ticonClassName += \" crm-entity-stream-section-icon-meeting\";\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.task)\n\t\t\t{\n\t\t\t\ticonClassName += \" crm-entity-stream-section-icon-task\";\n\t\t\t}\n\t\t\telse if(entityTypeId === BX.CrmActivityType.provider)\n\t\t\t{\n\t\t\t\tconst providerId = BX.prop.getString(entityData, \"PROVIDER_ID\", \"\");\n\t\t\t\tif(providerId === \"CRM_WEBFORM\")\n\t\t\t\t{\n\t\t\t\t\ticonClassName += \" crm-entity-stream-section-icon-crmForm\";\n\t\t\t\t}\n\t\t\t}\n\n\t\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: iconClassName } }));\n\t\t\tcontent.appendChild(header);\n\n\n\t\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t\t{attrs: {className: \"crm-entity-stream-content-detail\"}}\n\t\t\t);\n\t\t\tcontent.appendChild(detailWrapper);\n\n\t\t\tdetailWrapper.appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-title\" },\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\t\ttext: this.cutOffText(BX.prop.getString(entityData, \"SUBJECT\", \"\"), 128)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tconst summary = this.getTextDataParam(\"SUMMARY\");\n\t\t\tif(summary !== \"\")\n\t\t\t{\n\t\t\t\tdetailWrapper.appendChild(\n\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\t\t\ttext: summary\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\telse if(associatedEntityTypeId === BX.CrmEntityType.enumeration.order)\n\t\t{\n\t\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\" } }));\n\t\t\tcontent.appendChild(header);\n\t\t\tcontent.appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\t\ttext: this.cutOffText(this.getTextDataParam(\"MESSAGE\"), 128)\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\" } }));\n\t\t\tcontent.appendChild(header);\n\n\t\t\tconst innerWrapper = BX.create(\n\t\t\t\t\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"}\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tconst associatedEntityTitle = this.cutOffText(BX.prop.getString(entityData, \"TITLE\", \"\"), 128);\n\n\t\t\tif (BX.CrmEntityType.isDefined(associatedEntityTypeId))\n\t\t\t{\n\t\t\t\tlet link = BX.prop.getString(entityData, 'SHOW_URL', '');\n\t\t\t\tif (link.indexOf('/') !== 0)\n\t\t\t\t{\n\t\t\t\t\tlink = '#';\n\t\t\t\t}\n\n\t\t\t\tconst contentTemplate =\n\t\t\t\t\tthis.getMessage('entityContentTemplate')\n\t\t\t\t\t\t.replace('#ENTITY_TYPE_CAPTION#', BX.Text.encode(BX.prop.getString(entityData, 'ENTITY_TYPE_CAPTION', '')))\n\t\t\t\t\t\t.replace('#LINK#', BX.Text.encode(link))\n\t\t\t\t\t\t.replace('#LINK_TITLE#', BX.Text.encode(associatedEntityTitle))\n\t\t\t\t;\n\n\t\t\t\tinnerWrapper.appendChild(\n\t\t\t\t\tBX.create(\n\t\t\t\t\t\t'SPAN',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thtml: contentTemplate\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tinnerWrapper.innerText = associatedEntityTitle;\n\t\t\t}\n\n\t\t\tcontent.appendChild(innerWrapper);\n\t\t}\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\tif (!this.isReadOnly())\n\t\t\twrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\treturn wrapper;\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tconst menuItems = [];\n\n\t\tif (!this.isReadOnly())\n\t\t{\n\t\t\tif (this.isFixed() || this._fixedHistory.findItemById(this._id))\n\t\t\t\tmenuItems.push({ id: \"unfasten\", text: this.getMessage(\"menuUnfasten\"), onclick: BX.delegate(this.unfasten, this)});\n\t\t\telse\n\t\t\t\tmenuItems.push({ id: \"fasten\", text: this.getMessage(\"menuFasten\"), onclick: BX.delegate(this.fasten, this)});\n\t\t}\n\n\t\treturn menuItems;\n\t}\n\n\tview()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\t\tif(id > 0)\n\t\t\t{\n\t\t\t\tthis._activityEditor.viewActivity(id);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst showUrl = BX.prop.getString(entityData, \"SHOW_URL\", \"\");\n\t\t\tif(showUrl !== \"\")\n\t\t\t{\n\t\t\t\tBX.Crm.Page.open(showUrl);\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Mark();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import History from \"./history\";\nimport {EditorMode} from \"../types\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Comment extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._isCollapsed = false;\n\t\tthis._isMenuShown = false;\n\t\tthis._isFixed = false;\n\t\tthis._hasFiles = false;\n\t\tthis._postForm = null;\n\t\tthis._editor = null;\n\t\tthis._commentMessage = '';\n\t\tthis._mode = EditorMode.view;\n\t\tthis._streamContentEventBlock = '';\n\t\tthis._playerWrappers = {};\n\t\tBX.Event.EventEmitter.subscribe(\n\t\t\t\"BX.Disk.Files:onShowFiles\",\n\t\t\tBX.delegate(this.addPlayer, this)\n\t\t);\n\t}\n\n\tdoInitialize()\n\t{\n\t\tsuper.doInitialize();\n\t\tthis._hasFiles = (this.getTextDataParam(\"HAS_FILES\") === 'Y');\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getMessage(\"comment\");\n\t}\n\n\tonPlayerDummyClick(file)\n\t{\n\t\tconst playerWrapper = this._playerWrappers[file.id];\n\t\tconst stubNode = playerWrapper.querySelector(\".crm-audio-cap-wrap\");\n\t\tif (stubNode)\n\t\t{\n\t\t\tBX.addClass(stubNode, \"crm-audio-cap-wrap-loader\");\n\t\t}\n\t\tthis._history.getManager().getAudioPlaybackRateSelector().addPlayer(\n\t\t\tthis._history.getManager().loadMediaPlayer(\n\t\t\t\t\"history_\" + this.getId() + '_' + file.id,\n\t\t\t\tfile.url,\n\t\t\t\t'audio/mp3',\n\t\t\t\tplayerWrapper,\n\t\t\t\tnull,\n\t\t\t\t{\n\t\t\t\t\tplaybackRate: this._history.getManager().getAudioPlaybackRateSelector().getRate()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\taddPlayer(event)\n\t{\n\t\tif (event.data.entityValueId === parseInt(this.getId(), 10))\n\t\t{\n\t\t\tthis.files = event.data.files;\n\t\t\tevent.data.files.forEach(function(file){\n\t\t\t\tif (file.extension === 'mp3')\n\t\t\t\t{\n\t\t\t\t\tif (this._playerWrappers[file.id])\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst callInfoWrapper = BX.create(\"DIV\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-detail-call crm-entity-stream-content-detail-call-inline\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\tthis._streamContentEventBlock.appendChild(callInfoWrapper);\n\t\t\t\t\tthis._playerWrappers[file.id] = this._history.getManager().renderAudioDummy(\n\t\t\t\t\t\tnull,\n\t\t\t\t\t\tthis.onPlayerDummyClick.bind(this, file)\n\t\t\t\t\t);\n\n\t\t\t\t\tthis._playerWrappers[file.id].firstElementChild.classList.add(\"crm-audio-cap-wrap-without-duration-text\");\n\n\t\t\t\t\tcallInfoWrapper.appendChild(\n\t\t\t\t\t\tthis._playerWrappers[file.id]\n\t\t\t\t\t);\n\t\t\t\t\tcallInfoWrapper.appendChild(\n\t\t\t\t\t\tthis._history.getManager().getAudioPlaybackRateSelector().render()\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}.bind(this));\n\t\t}\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-comment\"}\n\t\t\t}\n\t\t);\n\n\t\tif (this.isReadOnly())\n\t\t{\n\t\t\tBX.addClass(wrapper, \"crm-entity-stream-section-comment-read-only\");\n\t\t}\n\n\t\tif (this.isFixed())\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{ attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-comment\" } }\n\t\t\t)\n\t\t);\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\tthis._streamContentEventBlock = BX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-content-event\" } });\n\t\tconst header = this.prepareHeaderLayout();\n\n\t\tthis._streamContentEventBlock.appendChild(header);\n\n\t\tif (!this.isReadOnly())\n\t\t\twrapper.appendChild(this.prepareFixedSwitcherLayout());\n\n\t\tconst detailChildren = [];\n\t\tif (this._mode !== EditorMode.edit)\n\t\t{\n\t\t\tthis._commentWrapper = BX.create(\"DIV\", {\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" }\n\t\t\t\t}\n\t\t\t);\n\t\t\tBX.html(this._commentWrapper, this.getTextDataParam(\"COMMENT\", \"\"));\n\t\t\tdetailChildren.push(this._commentWrapper);\n\n\t\t\tif (!this.isReadOnly())\n\t\t\t{\n\t\t\t\tBX.bind(this._commentWrapper, \"click\", BX.delegate(this.switchToEditMode, this));\n\t\t\t\tBX.bind(header, \"click\", BX.delegate(this.switchToEditMode, this));\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (!BX.type.isDomNode(this._editorContainer))\n\t\t\t\tthis._editorContainer = BX.create(\"div\", {attrs: {className: \"crm-entity-stream-section-comment-editor\"}});\n\n\t\t\tdetailChildren.push(this._editorContainer);\n\n\t\t\tconst buttons = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-comment-edit-btn-container\"},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"button\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: {className: \"ui-btn ui-btn-xs ui-btn-primary\"},\n\t\t\t\t\t\t\t\t\thtml: this.getMessage(\"send\"),\n\t\t\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\t\t\tclick: BX.delegate(this.save, this)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tBX.create(\"a\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: {className: \"ui-btn ui-btn-xs ui-btn-link\"},\n\t\t\t\t\t\t\t\t\thtml: this.getMessage(\"cancel\"),\n\t\t\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\t\t\tclick: BX.delegate(this.switchToViewMode, this)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tdetailChildren.push(buttons);\n\t\t}\n\n\t\tthis._streamContentEventBlock.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren: detailChildren\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tthis._streamContentEventBlock.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\t\tconst cleanText = this.getTextDataParam(\"TEXT\", \"\");\n\t\tconst _hasInlineAttachment = (this.getTextDataParam(\"HAS_INLINE_ATTACHMENT\", \"\") === 'Y');\n\t\tif ((cleanText.length <= 128 && !_hasInlineAttachment) || this._mode === EditorMode.edit)\n\t\t{\n\t\t\tthis._isCollapsed = false;\n\n\t\t\twrapper.appendChild(\n\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: \"crm-entity-stream-section-content\"\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tthis._streamContentEventBlock\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._isCollapsed = true;\n\n\t\t\twrapper.appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content crm-entity-stream-section-content-collapsed\" },\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tthis._streamContentEventBlock\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\n\t\t\twrapper.querySelector(\".crm-entity-stream-content-event\").appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content-expand-btn-container\" },\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-section-content-expand-btn\",\n\t\t\t\t\t\t\t\t\t\t\t\thref: \"#\"\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tevents:\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tclick: BX.delegate(this.onExpandButtonClick, this)\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\ttext: this.getMessage(\"expand\")\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tif (this._mode === EditorMode.view && this._hasFiles)\n\t\t{\n\t\t\tthis._textLoaded = false;\n\t\t\tthis._fileBlock = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-files-inner\" },\n\t\t\t\t\tchildren: [BX.create(\"DIV\", { attrs: { className: \"crm-timeline-wait\" }})]\n\t\t\t\t});\n\t\t\twrapper.querySelector(\".crm-entity-stream-section-content\").appendChild(\n\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-files\" },\n\t\t\t\t\t\tchildren: [this._fileBlock]\n\t\t\t\t\t})\n\t\t\t);\n\t\t\tBX.ready(BX.delegate(function() {\n\t\t\t\twindow.setTimeout(BX.delegate(function(){\n\t\t\t\t\tthis.loadContent(this._fileBlock, \"GET_FILE_BLOCK\")\n\t\t\t\t} ,this), 100);\n\t\t\t},this));\n\t\t}\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t\tif (this._mode === EditorMode.view && BX.type.isDomNode(this._commentWrapper))\n\t\t{\n\t\t\tthis.registerImages(this._commentWrapper);\n\t\t\tif (!BX.getClass('BX.Disk.apiVersion'))\n\t\t\t{\n\t\t\t\tBX.viewElementBind(\n\t\t\t\t\tthis._commentWrapper,\n\t\t\t\t\t{showTitle: true},\n\t\t\t\t\tfunction(node){\n\t\t\t\t\t\treturn BX.type.isElementNode(node) && (node.getAttribute('data-bx-viewer') || node.getAttribute('data-bx-image'));\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tloadContent(node, type)\n\t{\n\t\tif (!BX.type.isDomNode(node))\n\t\t\treturn;\n\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._history._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"GET_COMMENT_CONTENT\",\n\t\t\t\t\t\t\"ID\": this.getId(),\n\t\t\t\t\t\t\"ENTITY_TYPE_ID\": this.getOwnerTypeId(),\n\t\t\t\t\t\t\"ENTITY_ID\": this.getOwnerId(),\n\t\t\t\t\t\t\"TYPE\": type\n\t\t\t\t\t},\n\t\t\t\tonsuccess: BX.delegate(function(result)\n\t\t\t\t{\n\t\t\t\t\tif (BX.type.isNotEmptyString(result.ERROR) && type === 'GET_FILE_BLOCK')\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.remove(node);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (BX.type.isNotEmptyString(result.BLOCK))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst promise = BX.html(node, result.BLOCK);\n\t\t\t\t\t\tpromise.then(\n\t\t\t\t\t\t\tBX.delegate(function(){\n\t\t\t\t\t\t\t\tthis.registerImages(node);\n\t\t\t\t\t\t\t\tBX.LazyLoad.showImages();\n\t\t\t\t\t\t\t}, this)\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}, this)\n\t\t\t}\n\t\t);\n\t}\n\n\tloadEditor()\n\t{\n\t\tthis._editorName = 'CrmTimeLineComment'+this._id + BX.util.getRandomString(4);\n\t\tif (this._postForm)\n\t\t{\n\t\t\tthis._postForm.oEditor.SetContent(this._commentMessage);\n\t\t\tthis._editor.ReInitIframe();\n\t\t\treturn;\n\t\t}\n\n\t\tconst actionData = {\n\t\t\tdata: {\n\t\t\t\tid: this._id,\n\t\t\t\tname: this._editorName\n\t\t\t}\n\t\t};\n\t\tBX.ajax.runAction(\"crm.api.timeline.loadEditor\", actionData)\n\t\t\t.then(this.onLoadEditorSuccess.bind(this))\n\t\t\t.catch(\tthis.switchToViewMode.bind(this));\n\t}\n\n\tonLoadEditorSuccess(result)\n\t{\n\t\tif (!BX.type.isDomNode(this._editorContainer))\n\t\t\tthis._editorContainer = BX.create(\"div\", {attrs: {className: \"crm-entity-stream-section-comment-editor\"}});\n\n\t\tconst html = BX.prop.getString(BX.prop.getObject(result, \"data\", {}), \"html\", '');\n\t\tBX.html(this._editorContainer, html).then(BX.delegate(this.showEditor,this));\n\t}\n\n\tshowEditor()\n\t{\n\t\tif (LHEPostForm)\n\t\t{\n\t\t\twindow.setTimeout(BX.delegate(function(){\n\t\t\t\tthis._postForm = LHEPostForm.getHandler(this._editorName);\n\t\t\t\tthis._editor = BXHtmlEditor.Get(this._editorName);\n\t\t\t\tBX.onCustomEvent(this._postForm.eventNode, 'OnShowLHE', [true]);\n\t\t\t\tthis._commentMessage = this._postForm.oEditor.GetContent();\n\t\t\t} ,this), 0);\n\t\t}\n\t}\n\n\tregisterImages(node)\n\t{\n\t\tconst commentImages = node.querySelectorAll('[data-bx-viewer=\"image\"]');\n\t\tconst commentImagesLength = commentImages.length;\n\t\tconst idsList = [];\n\t\tif (commentImagesLength > 0)\n\t\t{\n\t\t\tfor (let i = 0; i < commentImagesLength; ++i)\n\t\t\t{\n\t\t\t\tif (BX.type.isDomNode(commentImages[i]))\n\t\t\t\t{\n\t\t\t\t\tcommentImages[i].id += BX.util.getRandomString(4);\n\t\t\t\t\tidsList.push(commentImages[i].id);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (idsList.length > 0)\n\t\t\t{\n\t\t\t\tBX.LazyLoad.registerImages(idsList);\n\t\t\t}\n\t\t}\n\t\tBX.LazyLoad.registerImages(idsList);\n\t}\n\n\ttoggleMode(type)\n\t{\n\t\tthis._mode = parseInt(type);\n\t\tthis._hasFiles = (this.getTextDataParam(\"HAS_FILES\") === 'Y');\n\t\tthis.refreshLayout();\n\t\tthis.closeContextMenu();\n\t}\n\n\tswitchToViewMode(e)\n\t{\n\t\t// if (LHEPostForm)\n\t\t// \tLHEPostForm.unsetHandler(this._editorName);\n\t\tthis.toggleMode(EditorMode.view);\n\t}\n\n\tswitchToEditMode(e)\n\t{\n\t\tconst tagName = e.target.tagName.toLowerCase();\n\t\tif (tagName === 'a'\n\t\t\t|| tagName === 'img'\n\t\t\t|| BX.hasClass(e.target, \"feed-con-file-changes-link-more\")\n\t\t\t|| BX.hasClass(e.target, \"feed-com-file-inline\")\n\t\t\t|| BX.type.isNotEmptyString(document.getSelection().toString())\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleMode(EditorMode.edit);\n\t\twindow.setTimeout(BX.delegate(function(){\n\t\t\tthis.loadEditor();\n\t\t} ,this), 100);\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tif(this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst menuItems = [];\n\n\t\tif (!this.isReadOnly())\n\t\t{\n\t\t\tif (this._mode !== EditorMode.edit)\n\t\t\t{\n\t\t\t\tmenuItems.push({ id: \"edit\", text: this.getMessage(\"menuEdit\"), onclick: BX.delegate(this.switchToEditMode, this)});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmenuItems.push({ id: \"cancel\", text: this.getMessage(\"menuCancel\"), onclick: BX.delegate(this.switchToViewMode, this)});\n\t\t\t}\n\n\t\t\tmenuItems.push({ id: \"remove\", text: this.getMessage(\"menuDelete\"), onclick: BX.delegate(this.processRemoval, this)});\n\n\t\t\tif (this.isFixed() || this._fixedHistory.findItemById(this._id))\n\t\t\t\tmenuItems.push({ id: \"unfasten\", text: this.getMessage(\"menuUnfasten\"), onclick: BX.delegate(this.unfasten, this)});\n\t\t\telse\n\t\t\t\tmenuItems.push({ id: \"fasten\", text: this.getMessage(\"menuFasten\"), onclick: BX.delegate(this.fasten, this)});\n\t\t}\n\n\t\treturn menuItems;\n\t}\n\n\tsave(e)\n\t{\n\t\tconst attachmentList = [];\n\t\tlet text = \"\";\n\t\tif (this._postForm)\n\t\t{\n\t\t\ttext = this._postForm.oEditor.GetContent();\n\t\t\tthis._commentMessage = text;\n\t\t\tthis._postForm.eventNode\n\t\t\t\t.querySelectorAll('input[name=\"UF_CRM_COMMENT_FILES[]\"]')\n\t\t\t\t.forEach(function(input) {\n\t\t\t\t\tattachmentList.push(input.value)\n\t\t\t\t});\n\t\t}\n\n\t\tif (!BX.type.isNotEmptyString(text))\n\t\t{\n\t\t\tif (!this.emptyCommentMessage)\n\t\t\t{\n\t\t\t\tthis.emptyCommentMessage = new BX.PopupWindow(\n\t\t\t\t\t'timeline_empty_comment_' + this._id,\n\t\t\t\t\te.target,\n\t\t\t\t\t{\n\t\t\t\t\t\tcontent: BX.message('CRM_TIMELINE_EMPTY_COMMENT_MESSAGE'),\n\t\t\t\t\t\tdarkMode: true,\n\t\t\t\t\t\tautoHide: true,\n\t\t\t\t\t\tzIndex: 990,\n\t\t\t\t\t\tangle: {position: 'top', offset: 77},\n\t\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\t\tbindOptions: { forceBindPosition: true}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.emptyCommentMessage.show();\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._isRequestRunning && BX.type.isNotEmptyString(text))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._isRequestRunning = true;\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._history._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"UPDATE_COMMENT\",\n\t\t\t\t\t\t\"ID\": this.getId(),\n\t\t\t\t\t\t\"TEXT\": text,\n\t\t\t\t\t\t\"OWNER_TYPE_ID\":  this.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this.getOwnerId(),\n\t\t\t\t\t\t\"ATTACHMENTS\": attachmentList\n\t\t\t\t\t},\n\t\t\t\tonsuccess: BX.delegate(this.onSaveSuccess, this),\n\t\t\t\tonfailure: BX.delegate(this.onRequestFailure, this)\n\t\t\t}\n\t\t);\n\t}\n\n\tprocessRemoval()\n\t{\n\t\tthis.closeContextMenu();\n\t\tthis._detetionConfirmDlgId = \"entity_timeline_deletion_\" + this.getId() + \"_confirm\";\n\t\tlet dlg = BX.Crm.ConfirmationDialog.get(this._detetionConfirmDlgId);\n\t\tif(!dlg)\n\t\t{\n\t\t\tdlg = BX.Crm.ConfirmationDialog.create(\n\t\t\t\tthis._detetionConfirmDlgId,\n\t\t\t\t{\n\t\t\t\t\ttitle: this.getMessage(\"removeConfirmTitle\"),\n\t\t\t\t\tcontent: this.getMessage('commentRemove')\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tdlg.open().then(BX.delegate(this.onRemovalConfirm, this), BX.delegate(this.onRemovalCancel, this));\n\t}\n\n\tonRemovalConfirm(result)\n\t{\n\t\tif(BX.prop.getBoolean(result, \"cancel\", true))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.remove();\n\t}\n\n\tonRemovalCancel()\n\t{\n\t}\n\n\tremove(e)\n\t{\n\t\tif(this._isRequestRunning)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst history = this._history._manager.getHistory();\n\t\tconst deleteItem = history.findItemById(this._id);\n\t\tif (deleteItem instanceof Comment)\n\t\t\tdeleteItem.clearAnimate();\n\n\t\tconst fixedHistory = this._history._manager.getFixedHistory();\n\t\tconst deleteFixedItem = fixedHistory.findItemById(this._id);\n\t\tif (deleteFixedItem instanceof Comment)\n\t\t\tdeleteFixedItem.clearAnimate();\n\n\t\tthis._isRequestRunning = true;\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._history._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"DELETE_COMMENT\",\n\t\t\t\t\t\t\"OWNER_TYPE_ID\":  this.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this.getOwnerId(),\n\t\t\t\t\t\t\"ID\": this.getId()\n\t\t\t\t\t},\n\t\t\t\tonsuccess: BX.delegate(this.onRemoveSuccess, this),\n\t\t\t\tonfailure: BX.delegate(this.onRequestFailure, this)\n\t\t\t}\n\t\t);\n\t}\n\n\trefreshLayout()\n\t{\n\t\tthis._playerWrappers = {};\n\t\tsuper.refreshLayout();\n\t}\n\n\tonSaveSuccess(data)\n\t{\n\t\tthis._isRequestRunning = false;\n\t\tconst itemData = BX.prop.getObject(data, \"HISTORY_ITEM\");\n\n\t\tconst updateFixedItem = this._fixedHistory.findItemById(this._id);\n\t\tif (updateFixedItem instanceof Comment)\n\t\t{\n\t\t\tif (!BX.type.isNotEmptyString(itemData['IS_FIXED']))\n\t\t\t\titemData['IS_FIXED'] = 'Y';\n\n\t\t\tupdateFixedItem.setData(itemData);\n\t\t\tupdateFixedItem._id = BX.prop.getString(itemData, \"ID\");\n\t\t\tupdateFixedItem.switchToViewMode();\n\t\t}\n\n\t\tconst updateItem = this._history.findItemById(this._id);\n\t\tif (updateItem instanceof Comment)\n\t\t{\n\t\t\tupdateItem.setData(itemData);\n\t\t\tupdateItem._id = BX.prop.getString(itemData, \"ID\");\n\t\t\tupdateItem.switchToViewMode();\n\t\t}\n\n\t\tthis._postForm = null;\n\t}\n\n\tonRemoveSuccess(data)\n\t{\n\t}\n\n\tonRequestFailure(data)\n\t{\n\t\tthis._isRequestRunning = this._isLocked = false;\n\t}\n\n\tonExpandButtonClick(e)\n\t{\n\t\tif(!this._wrapper)\n\t\t{\n\t\t\treturn BX.PreventDefault(e);\n\t\t}\n\n\t\tconst contentWrapper = this._wrapper.querySelector(\"div.crm-entity-stream-section-content\");\n\t\tif(!contentWrapper)\n\t\t{\n\t\t\treturn BX.PreventDefault(e);\n\t\t}\n\n\t\tif (this._hasFiles && BX.type.isDomNode(this._commentWrapper) && !this._textLoaded)\n\t\t{\n\t\t\tthis._textLoaded = true;\n\t\t\tthis.loadContent(this._commentWrapper, \"GET_TEXT\")\n\t\t}\n\t\tconst eventWrapper = contentWrapper.querySelector(\".crm-entity-stream-content-event\");\n\t\tif(this._isCollapsed)\n\t\t{\n\t\t\teventWrapper.style.maxHeight = eventWrapper.scrollHeight + 130 + \"px\";\n\t\t\tBX.removeClass(contentWrapper, \"crm-entity-stream-section-content-collapsed\");\n\t\t\tBX.addClass(contentWrapper, \"crm-entity-stream-section-content-expand\");\n\t\t\tsetTimeout(\n\t\t\t\tBX.delegate(function() {\n\t\t\t\t\teventWrapper.style.maxHeight = \"\";\n\t\t\t\t}, this),\n\t\t\t\t300\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\teventWrapper.style.maxHeight = eventWrapper.clientHeight + \"px\";\n\t\t\tBX.removeClass(contentWrapper, \"crm-entity-stream-section-content-expand\");\n\t\t\tBX.addClass(contentWrapper, \"crm-entity-stream-section-content-collapsed\");\n\t\t\tsetTimeout(\n\t\t\t\tBX.delegate(function() {\n\t\t\t\t\teventWrapper.style.maxHeight = \"\";\n\t\t\t\t}, this),\n\t\t\t\t0\n\t\t\t);\n\t\t}\n\n\t\tthis._isCollapsed = !this._isCollapsed;\n\n\t\tconst button = contentWrapper.querySelector(\"a.crm-entity-stream-section-content-expand-btn\");\n\t\tif(button)\n\t\t{\n\t\t\tbutton.innerHTML = this.getMessage(this._isCollapsed ? \"expand\" : \"collapse\");\n\t\t}\n\t\treturn BX.PreventDefault(e);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Comment();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Wait extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getMessage(\"wait\");\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\treturn BX.create(\"SPAN\", {\n\t\t\tattrs:{ className: \"crm-entity-stream-content-event-title\"},\n\t\t\tchildren: [\n\t\t\t\tBX.create(\"A\", {\n\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\n\t}\n\n\tprepareTimeLayout()\n\t{\n\t\treturn BX.create(\"SPAN\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t}\n\t\t);\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\t\tif(description !== \"\")\n\t\t{\n\t\t\tdescription = BX.util.trim(description);\n\t\t\tdescription = BX.util.strip_tags(description);\n\t\t\tdescription = BX.util.nl2br(description);\n\t\t}\n\n\t\tconst wrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-wait\"}\n\t\t\t}\n\t\t);\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-complete\" }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"},\n\t\t\t\thtml: description\n\t\t\t}\n\t\t);\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Wait();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Document extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetTitle()\n\t{\n\t\tconst typeCategoryId = BX.prop.getInteger(this._data, \"TYPE_CATEGORY_ID\", 0);\n\t\tif(typeCategoryId === 3)\n\t\t{\n\t\t\treturn BX.Loc.getMessage('CRM_TIMELINE_DOCUMENT_VIEWED');\n\t\t}\n\n\t\treturn this.getMessage(\"document\");\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\treturn BX.create(\"SPAN\", {\n\t\t\tattrs:{ className: \"crm-entity-stream-content-event-title\"},\n\t\t\tchildren: [\n\t\t\t\tBX.create(\"A\", {\n\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\tevents: { \"click\": BX.delegate(this.editDocument, this) },\n\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\t}\n\n\tprepareTitleStatusLayout()\n\t{\n\t\tconst typeCategoryId = BX.prop.getInteger(this._data, \"TYPE_CATEGORY_ID\", 0);\n\t\tif(typeCategoryId === 3)\n\t\t{\n\t\t\treturn BX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-done\" },\n\t\t\t\t\ttext: BX.Loc.getMessage('CRM_TIMELINE_DOCUMENT_VIEWED_STATUS')\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\tif(typeCategoryId === 2)\n\t\t{\n\t\t\treturn BX.create(\"SPAN\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-sent\" },\n\t\t\t\t\ttext: BX.Loc.getMessage('CRM_TIMELINE_DOCUMENT_CREATED_STATUS')\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tprepareTimeLayout()\n\t{\n\t\treturn BX.create(\"SPAN\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t}\n\t\t);\n\t}\n\n\tisContextMenuEnabled()\n\t{\n\t\tconst typeCategoryId = BX.prop.getInteger(this._data, \"TYPE_CATEGORY_ID\", 0);\n\n\t\treturn typeCategoryId !== 3;\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\tconst statusLayout = this.prepareTitleStatusLayout();\n\t\tif(statusLayout)\n\t\t{\n\t\t\theader.appendChild(statusLayout);\n\t\t}\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst text = this.getTextDataParam(\"COMMENT\", \"\");\n\n\t\tconst wrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-document\"}\n\t\t\t}\n\t\t);\n\n\t\tif(this.isFixed())\n\t\t{\n\t\t\tBX.addClass(wrapper, 'crm-entity-stream-section-top-fixed');\n\t\t}\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-document\" }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\n\t\tif(!this.isReadOnly())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareFixedSwitcherLayout());\n\t\t}\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"},\n\t\t\t\thtml: text\n\t\t\t}\n\t\t);\n\t\tconst title = BX.findChildByClassName(detailWrapper, 'document-title-link');\n\t\tif(title)\n\t\t{\n\t\t\tBX.bind(title, 'click', BX.proxy(this.editDocument, this));\n\t\t}\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"SPAN\", { attrs: { className: \"crm-entity-stream-content-detail-action\" } });\n\t\tcontentWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tshowActions(show)\n\t{\n\t\tif(this._actionContainer)\n\t\t{\n\t\t\tthis._actionContainer.style.display = show ? \"\" : \"none\";\n\t\t}\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tconst menuItems = [];\n\n\t\tif(!this.isReadOnly())\n\t\t{\n\t\t\tmenuItems.push({ id: \"edit\", text: this.getMessage(\"menuEdit\"), onclick: BX.delegate(this.editDocument, this)});\n\t\t\tmenuItems.push({ id: \"remove\", text: this.getMessage(\"menuDelete\"), onclick: BX.delegate(this.confirmDelete, this)});\n\n\t\t\tif (this.isFixed() || this._fixedHistory.findItemById(this._id))\n\t\t\t{\n\t\t\t\tmenuItems.push({ id: \"unfasten\", text: this.getMessage(\"menuUnfasten\"), onclick: BX.delegate(this.unfasten, this)});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmenuItems.push({ id: \"fasten\", text: this.getMessage(\"menuFasten\"), onclick: BX.delegate(this.fasten, this)});\n\t\t\t}\n\t\t}\n\n\t\treturn menuItems;\n\t}\n\n\tconfirmDelete()\n\t{\n\t\tthis.closeContextMenu();\n\t\tthis._detetionConfirmDlgId = \"entity_timeline_deletion_\" + this.getId() + \"_confirm\";\n\t\tlet dlg = BX.Crm.ConfirmationDialog.get(this._detetionConfirmDlgId);\n\t\tif(!dlg)\n\t\t{\n\t\t\tdlg = BX.Crm.ConfirmationDialog.create(\n\t\t\t\tthis._detetionConfirmDlgId,\n\t\t\t\t{\n\t\t\t\t\ttitle: this.getMessage(\"removeConfirmTitle\"),\n\t\t\t\t\tcontent: this.getMessage('documentRemove')\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tdlg.open().then(BX.delegate(this.onConfirmDelete, this), BX.DoNothing);\n\t}\n\n\tonConfirmDelete(result)\n\t{\n\t\tif(BX.prop.getBoolean(result, \"cancel\", true))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.deleteDocument();\n\t}\n\n\tdeleteDocument()\n\t{\n\t\tif(this._isRequestRunning)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis._isRequestRunning = true;\n\t\tBX.ajax(\n\t\t\t{\n\t\t\t\turl: this._history._serviceUrl,\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdataType: \"json\",\n\t\t\t\tdata:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"ACTION\": \"DELETE_DOCUMENT\",\n\t\t\t\t\t\t\"OWNER_TYPE_ID\":  this.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this.getOwnerId(),\n\t\t\t\t\t\t\"ID\": this.getId()\n\t\t\t\t\t},\n\t\t\t\tonsuccess: BX.delegate(function(result)\n\t\t\t\t{\n\t\t\t\t\tthis._isRequestRunning = false;\n\t\t\t\t\tif(BX.type.isNotEmptyString(result.ERROR))\n\t\t\t\t\t{\n\t\t\t\t\t\talert(result.ERROR);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tconst deleteItem = this._history.findItemById(this._id);\n\t\t\t\t\t\tif (deleteItem instanceof Document)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdeleteItem.clearAnimate();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst deleteFixedItem = this._fixedHistory.findItemById(this._id);\n\t\t\t\t\t\tif (deleteFixedItem instanceof Document)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdeleteFixedItem.clearAnimate();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, this),\n\t\t\t\tonfailure: BX.delegate(function()\n\t\t\t\t{\n\t\t\t\t\tthis._isRequestRunning = false;\n\t\t\t\t}, this)\n\t\t\t}\n\t\t);\n\t}\n\n\teditDocument()\n\t{\n\t\tconst documentId = this.getData().DOCUMENT_ID || 0;\n\t\tif(documentId > 0)\n\t\t{\n\t\t\tlet url = '/bitrix/components/bitrix/crm.document.view/slider.php';\n\t\t\turl = BX.util.add_url_param(url, {documentId: documentId});\n\t\t\tif(BX.SidePanel)\n\t\t\t{\n\t\t\t\tBX.SidePanel.Instance.open(url, {width: 1060});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttop.location.href = url;\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateWrapper()\n\t{\n\t\tconst wrapper = this.getWrapper();\n\t\tif(wrapper)\n\t\t{\n\t\t\tconst detailWrapper = BX.findChildByClassName(wrapper, 'crm-entity-stream-content-detail');\n\t\t\tif(detailWrapper)\n\t\t\t{\n\t\t\t\tBX.adjust(detailWrapper, {html: this.getTextDataParam(\"COMMENT\", \"\")});\n\t\t\t\tconst title = BX.findChildByClassName(detailWrapper, 'document-title-link');\n\t\t\t\tif(title)\n\t\t\t\t{\n\t\t\t\t\tBX.bind(title, 'click', BX.proxy(this.editDocument, this));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Document();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import HistoryActivity from \"./history-activity\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Sender extends HistoryActivity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetDataSetting(name)\n\t{\n\t\tconst settings = this.getObjectDataParam('SETTINGS') || {};\n\t\treturn settings[name] || null;\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Sender.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getDataSetting('messageName');\n\t}\n\n\tprepareTitleLayout()\n\t{\n\t\tconst self = this;\n\t\treturn BX.create(\"SPAN\", {\n\t\t\tattrs:{ className: \"crm-entity-stream-content-event-title\"},\n\t\t\tchildren: [\n\t\t\t\tthis.isRemoved()\n\t\t\t\t\t?\n\t\t\t\t\tBX.create(\"SPAN\", {text: this.getTitle()})\n\t\t\t\t\t:\n\t\t\t\t\tBX.create(\"A\", {\n\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\thref: \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\"click\": function (e)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (BX.SidePanel)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tBX.SidePanel.Instance.open(self.getDataSetting('path'));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttop.location.href = self.getDataSetting('path');\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttext: this.getTitle()\n\t\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\n\t}\n\n\tprepareTimeLayout()\n\t{\n\t\treturn BX.create(\"SPAN\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-event-time\" },\n\t\t\t\ttext: this.formatTime(this.getCreatedTime())\n\t\t\t}\n\t\t);\n\t}\n\n\tprepareStatusLayout()\n\t{\n\t\tlet layoutClassName, textCaption;\n\t\tif (this.getDataSetting('isError'))\n\t\t{\n\t\t\ttextCaption = this.getMessage('error');\n\t\t\tlayoutClassName = \"crm-entity-stream-content-event-missing\";\n\t\t}\n\t\telse if (this.getDataSetting('isUnsub'))\n\t\t{\n\t\t\ttextCaption = this.getMessage('unsub');\n\t\t\tlayoutClassName = \"crm-entity-stream-content-event-missing\";\n\t\t}\n\t\telse if (this.getDataSetting('isClick'))\n\t\t{\n\t\t\ttextCaption = this.getMessage('click');\n\t\t\tlayoutClassName = \"crm-entity-stream-content-event-successful\";\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttextCaption = this.getMessage('read');\n\t\t\tlayoutClassName = \"crm-entity-stream-content-event-skipped\";\n\t\t}\n\n\t\treturn BX.create(\"SPAN\", {attrs: {className: layoutClassName}, text: textCaption});\n\t}\n\n\tprepareHeaderLayout()\n\t{\n\t\tconst header = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}});\n\t\theader.appendChild(this.prepareTitleLayout());\n\t\tif (this.getDataSetting('isError') || this.getDataSetting('isRead') || this.getDataSetting('isUnsub'))\n\t\t{\n\t\t\theader.appendChild(this.prepareStatusLayout());\n\t\t}\n\t\theader.appendChild(this.prepareTimeLayout());\n\n\t\treturn header;\n\t}\n\n\tisRemoved()\n\t{\n\t\treturn !this.getDataSetting('letterTitle');\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst description = this.isRemoved() ? this.getMessage('removed') : this.getMessage('title') + ': ' + this.getDataSetting('letterTitle');\n\n\t\tconst wrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-wait\"}\n\t\t\t}\n\t\t);\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-complete\" }\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst contentWrapper = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [contentWrapper]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst header = this.prepareHeaderLayout();\n\t\tcontentWrapper.appendChild(header);\n\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"},\n\t\t\t\thtml: description\n\t\t\t}\n\t\t);\n\t\tcontentWrapper.appendChild(detailWrapper);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Sender();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import History from \"./history\";\n\n/** @memberof BX.Crm.Timeline.Items */\nexport default class Bizproc extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetTitle()\n\t{\n\t\tconst type = this.getTextDataParam(\"TYPE\");\n\t\tif (type === 'AUTOMATION_DEBUG_INFORMATION')\n\t\t{\n\t\t\treturn this.getMessage('automationDebugger');\n\t\t}\n\n\t\treturn this.getMessage(\"bizproc\");\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-bp\"}\n\t\t\t}\n\t\t);\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{ attrs: { className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-bp\" } }\n\t\t\t)\n\t\t);\n\n\t\tconst content = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-event\"}});\n\t\tconst header = this.prepareHeaderLayout();\n\n\t\tcontent.appendChild(header);\n\t\tcontent.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\t\t\t\t\thtml: this.prepareContentTextHtml()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontent.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\twrapper.appendChild(\n\t\t\tBX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section-content\" }, children: [ content ] })\n\t\t);\n\n\t\treturn wrapper;\n\t}\n\n\tprepareContentTextHtml()\n\t{\n\t\tconst type = this.getTextDataParam(\"TYPE\");\n\t\tif (type === 'ACTIVITY_ERROR')\n\t\t{\n\t\t\treturn '<strong>#TITLE#</strong>: #ERROR_TEXT#'\n\t\t\t\t.replace('#TITLE#', BX.util.htmlspecialchars(this.getTextDataParam(\"ACTIVITY_TITLE\")))\n\t\t\t\t.replace('#ERROR_TEXT#', BX.util.htmlspecialchars(this.getTextDataParam(\"ERROR_TEXT\")))\n\t\t}\n\t\telse if (type === 'AUTOMATION_DEBUG_INFORMATION')\n\t\t{\n\t\t\treturn BX.Text.encode(this.getTextDataParam('AUTOMATION_DEBUG_TEXT'));\n\t\t}\n\n\t\tconst workflowName = this.getTextDataParam(\"WORKFLOW_TEMPLATE_NAME\");\n\t\tconst workflowStatus = this.getTextDataParam(\"WORKFLOW_STATUS_NAME\");\n\t\tif (!workflowName\n\t\t\t|| workflowStatus !== 'Created' && workflowStatus !== 'Completed' && workflowStatus !== 'Terminated'\n\t\t)\n\t\t{\n\t\t\treturn BX.util.htmlspecialchars(this.getTextDataParam(\"COMMENT\"));\n\t\t}\n\n\t\tlet label = BX.message('CRM_TIMELINE_BIZPROC_CREATED');\n\t\tif (workflowStatus === 'Completed')\n\t\t{\n\t\t\tlabel = BX.message('CRM_TIMELINE_BIZPROC_COMPLETED');\n\t\t}\n\t\telse if (workflowStatus === 'Terminated')\n\t\t{\n\t\t\tlabel = BX.message('CRM_TIMELINE_BIZPROC_TERMINATED');\n\t\t}\n\n\t\treturn BX.util.htmlspecialchars(label)\n\t\t\t.replace('#NAME#', '<strong>' + BX.util.htmlspecialchars(workflowName) + '</strong>');\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Bizproc();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import History from './history';\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class Scoring extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst isScoringAvailable = BX.prop.getBoolean(this._data, 'SCORING_IS_AVAILABLE', true);\n\n\t\tconst outerWrapper = BX.create('DIV', {\n\t\t\tattrs: {\n\t\t\t\tclassName: 'crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-scoring',\n\t\t\t},\n\t\t\tevents: isScoringAvailable\n\t\t\t\t? {\n\t\t\t\t\tclick: function() {\n\t\t\t\t\t\tlet url = '/crm/ml/#entity#/#id#/detail';\n\t\t\t\t\t\tconst ownerTypeId = this.getOwnerTypeId();\n\t\t\t\t\t\tconst ownerId = this.getOwnerId();\n\n\t\t\t\t\t\tlet ownerType = '';\n\t\t\t\t\t\tif (ownerTypeId === 1)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\townerType = 'lead';\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (ownerTypeId === 2)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\townerType = 'deal';\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\turl = url.replace('#entity#', ownerType);\n\t\t\t\t\t\turl = url.replace('#id#', ownerId);\n\n\t\t\t\t\t\tif (BX.SidePanel)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tBX.SidePanel.Instance.open(url, {width: 840});\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttop.location.href = url;\n\t\t\t\t\t\t}\n\t\t\t\t\t}.bind(this),\n\t\t\t\t}\n\t\t\t\t: null,\n\t\t});\n\n\t\tconst scoringInfo = BX.prop.getObject(this._data, \"SCORING_INFO\", null);\n\t\tif(!scoringInfo)\n\t\t{\n\t\t\treturn outerWrapper;\n\t\t}\n\n\t\tlet score = BX.prop.getNumber(scoringInfo, \"SCORE\", 0);\n\t\tlet scoreDelta = BX.prop.getNumber(scoringInfo, \"SCORE_DELTA\", 0);\n\t\tscore = Math.round(score * 100);\n\t\tscoreDelta = Math.round(scoreDelta * 100);\n\n\t\tconst result = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-scoring-total-result\"},\n\t\t\t\ttext: score + \"%\"\n\t\t\t});\n\n\t\tlet iconClass = \"crm-entity-stream-content-scoring-total-icon\";\n\t\tif (score < 50)\n\t\t{\n\t\t\ticonClass += \" crm-entity-stream-content-scoring-total-icon-fail\";\n\t\t}\n\t\telse if (score < 75)\n\t\t{\n\t\t\ticonClass += \" crm-entity-stream-content-scoring-total-icon-middle\";\n\t\t}\n\t\telse\n\t\t{\n\t\t\ticonClass += \" crm-entity-stream-content-scoring-total-icon-success\";\n\t\t}\n\n\t\tconst icon = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: iconClass}\n\t\t\t}\n\t\t);\n\n\t\touterWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-scoring-total\" },\n\t\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-scoring-total-text\" },\n\t\t\t\t\t\t\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_SCORING_TITLE_2\")\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\tresult,\n\t\t\t\t\t\t\t\t\ticon\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t),\n\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-scoring-event\" },\n\t\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\t\t\tscoreDelta !== 0 ?\n\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-scoring-event-offset\" },\n\t\t\t\t\t\t\t\t\t\t\t\t\ttext: (scoreDelta > 0 ? \"+\" : \"\") + scoreDelta + \"%\"\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t\t\t\t\tnull\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t/*BX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-scoring-event-detail\" },\n\t\t\t\t\t\t\t\t\t\t\ttext: \"<activity subject>\"\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t)*/\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\treturn outerWrapper;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Scoring();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Stream from \"../stream\";\nimport {Item as ItemType, Order as OrderType} from \"../types\";\nimport HistoryItem from \"../items/history\";\nimport Modification from \"../items/modification\";\nimport Conversion from \"../items/conversion\";\nimport HistoryActivity from \"../items/history-activity\";\nimport Email from \"../items/email\";\nimport Call from \"../items/call\";\nimport Meeting from \"../items/meeting\";\nimport Task from \"../items/task\";\nimport WebForm from \"../items/webform\";\nimport Request from \"../items/request\";\nimport OpenLine from \"../items/openline\";\nimport Rest from \"../items/rest\";\nimport Visit from \"../items/visit\";\nimport Zoom from \"../items/zoom\";\nimport ExternalNoticeStatusModification from \"../items/external-notice-status-modification\";\nimport ExternalNoticeModification from \"../items/external-notice-modification\";\nimport Creation from \"../items/creation\";\nimport Restoration from \"../items/restoration\";\nimport Link from \"../items/link\";\nimport Unlink from \"../items/unlink\";\nimport Mark from \"../items/mark\";\nimport Comment from \"../items/comment\";\nimport Wait from \"../items/wait\";\nimport Document from \"../items/document\";\nimport Sender from \"../items/sender\";\nimport Bizproc from \"../items/bizproc\";\nimport Scoring from \"../items/scoring\";\nimport {ConfigurableItem, StreamType} from \"crm.timeline.item\";\nimport Expand from \"../animations/expand\";\n\n/** @memberof BX.Crm.Timeline.Streams */\nexport default class History extends Stream\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._items = [];\n\t\tthis._wrapper = null;\n\t\tthis._fixedHistory = null;\n\t\tthis._emptySection = null;\n\t\tthis._currentDaySection = null;\n\t\tthis._lastDaySection = null;\n\t\tthis._lastDate = null;\n\t\tthis._anchor = null;\n\t\tthis._history = this;\n\t\tthis._enableLoading = false;\n\t\tthis._navigation = null;\n\t\tthis._scrollHandler = null;\n\t\tthis._loadingWaiter = null;\n\n\t\tthis._filterId = \"\";\n\t\tthis._isFilterApplied = false;\n\t\tthis._isFilterShown = false;\n\n\t\tthis._isRequestRunning = false;\n\n\t\tthis._filterButton = null;\n\t\tthis._filterWrapper = null;\n\t\tthis._filterResultStub = null;\n\t}\n\n\tdoInitialize()\n\t{\n\t\tthis._fixedHistory = this.getSetting(\"fixedHistory\");\n\t\tthis._ownerTypeId = this.getSetting(\"ownerTypeId\");\n\t\tthis._ownerId = this.getSetting(\"ownerId\");\n\t\tthis._serviceUrl = this.getSetting(\"serviceUrl\", \"\");\n\t\tif (!this.isStubMode())\n\t\t{\n\t\t\tlet itemData = this.getSetting(\"itemData\");\n\t\t\tif (!BX.type.isArray(itemData))\n\t\t\t{\n\t\t\t\titemData = [];\n\t\t\t}\n\n\t\t\tlet i, length, item;\n\t\t\tfor (i = 0, length = itemData.length; i < length; i++)\n\t\t\t{\n\t\t\t\titem = this.createItem(itemData[i]);\n\t\t\t\tif (item)\n\t\t\t\t{\n\t\t\t\t\tthis._items.push(item);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._navigation = this.getSetting(\"navigation\", {});\n\n\t\t\tthis._filterWrapper = BX(\"timeline-filter\");\n\t\t\tthis._filterId = BX.prop.getString(this._settings, \"filterId\", this._id);\n\t\t\tthis._isFilterShown = this._filterWrapper\n\t\t\t\t&& BX.hasClass(this._filterWrapper, \"crm-entity-stream-section-filter-show\");\n\t\t\tthis._isFilterApplied = BX.prop.getBoolean(this._settings, \"isFilterApplied\", false);\n\n\t\t\tBX.addCustomEvent(\"BX.Main.Filter:apply\", this.onFilterApply.bind(this));\n\t\t}\n\t}\n\n\tlayout()\n\t{\n\t\tthis._wrapper = BX.create(\"DIV\", {});\n\t\tthis._container.appendChild(this._wrapper);\n\n\t\tconst now = BX.prop.extractDate(new Date());\n\t\tlet i, length, item;\n\n\t\tif (!this.isStubMode())\n\t\t{\n\t\t\tif (this._filterWrapper)\n\t\t\t{\n\t\t\t\tconst closeFilterButton = this._filterWrapper.querySelector(\".crm-entity-stream-filter-close\");\n\t\t\t\tif (closeFilterButton)\n\t\t\t\t{\n\t\t\t\t\tBX.bind(closeFilterButton, \"click\", this.onFilterClose.bind(this));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (i = 0, length = this._items.length; i < length; i++)\n\t\t\t{\n\t\t\t\titem = this._items[i];\n\t\t\t\titem.setContainer(this._wrapper);\n\n\t\t\t\tconst created = item.getCreatedDate();\n\t\t\t\tif (this._lastDate === null || this._lastDate.getTime() !== created.getTime())\n\t\t\t\t{\n\t\t\t\t\tthis._lastDate = created;\n\t\t\t\t\tif (now.getTime() === created.getTime())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._currentDaySection = this._lastDaySection = this.createCurrentDaySection();\n\t\t\t\t\t\tthis._wrapper.appendChild(this._currentDaySection);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._lastDaySection = this.createDaySection(this._lastDate);\n\t\t\t\t\t\tthis._wrapper.appendChild(this._lastDaySection);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\titem._lastDate = this._lastDate;\n\n\t\t\t\titem.layout();\n\t\t\t}\n\n\t\t\tthis.enableLoading(this._items.length > 0);\n\t\t\tthis.refreshLayout();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._currentDaySection = this._lastDaySection = this.createCurrentDaySection();\n\t\t\tthis._wrapper.appendChild(this._currentDaySection);\n\n\t\t\tthis._wrapper.appendChild(\n\t\t\t\tBX.create(\n\t\t\t\t\t\"DIV\",\n\t\t\t\t\t{\n\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-createEntity crm-entity-stream-section-last\"},\n\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tBX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\"}}),\n\t\t\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\t\t\"DIV\",\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-section-content\"},\n\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event\"},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-content-header\"}}),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: BX.message(\"CRM_TIMELINE_HISTORY_STUB\")\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tthis._manager.processHistoryLayoutChange();\n\t}\n\n\trefreshLayout()\n\t{\n\t\tif (this._filterWrapper)\n\t\t{\n\t\t\tif (this._wrapper.firstChild && this._filterWrapper !== this._wrapper.firstChild)\n\t\t\t{\n\t\t\t\tthis._wrapper.insertBefore(this._filterWrapper, this._wrapper.firstChild);\n\t\t\t}\n\t\t\telse if (!this._wrapper.firstChild && this._filterWrapper.parentNode !== this._wrapper)\n\t\t\t{\n\t\t\t\tthis._wrapper.appendChild(this._filterWrapper);\n\t\t\t}\n\t\t}\n\n\t\tthis.adjustFilterButton();\n\n\t\tconst length = this._items.length;\n\t\tif (length === 0 && this._isFilterApplied)\n\t\t{\n\t\t\tif (!this._filterEmptyResultSection)\n\t\t\t{\n\t\t\t\tthis._filterEmptyResultSection = this.createFilterEmptyResultSection();\n\t\t\t}\n\t\t\tthis._wrapper.appendChild(this._filterEmptyResultSection);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._filterEmptyResultSection)\n\t\t{\n\t\t\tthis._filterEmptyResultSection = BX.remove(this._filterEmptyResultSection);\n\t\t}\n\n\t\tif (length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfor (let i = 0; i < (length - 1); i++)\n\t\t{\n\t\t\tconst item = this._items[i];\n\t\t\tif (item.isTerminated())\n\t\t\t{\n\t\t\t\titem.markAsTerminated(false);\n\t\t\t}\n\t\t}\n\n\t\tthis._items[length - 1].markAsTerminated(true);\n\t}\n\n\tcalculateItemIndex(item)\n\t{\n\t\treturn 0;\n\t}\n\n\tcheckItemForTermination(item)\n\t{\n\t\treturn this.getLastItem() === item;\n\t}\n\n\thasContent()\n\t{\n\t\treturn (this._items.length > 0 || this._isFilterApplied || this._isStubMode);\n\t}\n\n\tgetItems(): Array\n\t{\n\t\treturn this._items;\n\t}\n\n\tsetItems(items: Array): void\n\t{\n\t\tthis._items = items;\n\t}\n\n\tgetItemByIndex(index)\n\t{\n\t\treturn index < this._items.length ? this._items[index] : null;\n\t}\n\n\tgetItemCount()\n\t{\n\t\treturn this._items.length;\n\t}\n\n\tgetItemsByAssociatedEntity($entityTypeId, entityId)\n\t{\n\t\tif (!BX.type.isNumber($entityTypeId))\n\t\t{\n\t\t\t$entityTypeId = parseInt($entityTypeId);\n\t\t}\n\n\t\tif (!BX.type.isNumber(entityId))\n\t\t{\n\t\t\tentityId = parseInt(entityId);\n\t\t}\n\n\t\tif (isNaN($entityTypeId) || $entityTypeId <= 0 || isNaN(entityId) || entityId <= 0)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tconst results = [];\n\t\tfor (let i = 0, l = this._items.length; i < l; i++)\n\t\t{\n\t\t\tconst item = this._items[i];\n\t\t\tif (item.getAssociatedEntityTypeId() === $entityTypeId && item.getAssociatedEntityId() === entityId)\n\t\t\t{\n\t\t\t\tresults.push(item);\n\t\t\t}\n\t\t}\n\t\treturn results;\n\t}\n\n\tcreateFilterEmptyResultSection()\n\t{\n\t\treturn BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-filter-empty\"},\n\t\t\t\tchildren:\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-section-content\"},\n\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-filter-empty\"},\n\t\t\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-filter-empty-img\"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-filter-empty-text\"},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: this.getMessage(\"filterEmptyResultStub\")\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\t}\n\n\tadjustFilterButton()\n\t{\n\t\tif (!this._filterWrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._isFilterShown && this._items.length === 0)\n\t\t{\n\t\t\tif (!this._emptySection)\n\t\t\t{\n\t\t\t\tthis._emptySection = this.createEmptySection();\n\t\t\t}\n\t\t\tthis._wrapper.insertBefore(this._emptySection, this._filterWrapper);\n\t\t}\n\t\telse if (this._emptySection)\n\t\t{\n\t\t\tthis._emptySection = BX.remove(this._emptySection);\n\t\t}\n\n\t\tif (!this._filterButton)\n\t\t{\n\t\t\tthis._filterButton = BX.create(\"BUTTON\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-filter-label\"},\n\t\t\t\t\ttext: this.getMessage(\"filterButtonCaption\")\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tBX.bind(this._filterButton, \"click\", function (e) {\n\t\t\t\tthis.showFilter();\n\t\t\t}.bind(this));\n\t\t}\n\n\t\tconst section = this._wrapper.querySelector(\".crm-entity-stream-section-today-label, .crm-entity-stream-section-planned-label, .crm-entity-stream-section-history-label\");\n\t\tif (section)\n\t\t{\n\t\t\tconst sectionWrapper = section.querySelector(\".crm-entity-stream-section-content\");\n\t\t\tif (sectionWrapper)\n\t\t\t{\n\t\t\t\tif (this._filterButton.parentNode !== sectionWrapper)\n\t\t\t\t{\n\t\t\t\t\tsectionWrapper.appendChild(this._filterButton);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (this._isFilterApplied)\n\t\t{\n\t\t\tBX.addClass(this._filterButton, \"crm-entity-stream-filter-label-active\");\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.removeClass(this._filterButton, \"crm-entity-stream-filter-label-active\");\n\t\t}\n\t}\n\n\tshowFilter(params)\n\t{\n\t\tif (!this._filterWrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.removeClass(this._filterWrapper, \"crm-entity-stream-section-filter-hide\");\n\t\tBX.addClass(this._filterWrapper, \"crm-entity-stream-section-filter-show\");\n\n\t\tthis._isFilterShown = true;\n\n\t\tif (BX.prop.getBoolean(params, \"enableAdjust\", true))\n\t\t{\n\t\t\tthis.adjustFilterButton();\n\t\t}\n\t}\n\n\thideFilter(params)\n\t{\n\t\tif (!this._filterWrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.removeClass(this._filterWrapper, \"crm-entity-stream-section-filter-show\");\n\t\tBX.addClass(this._filterWrapper, \"crm-entity-stream-section-filter-hide\");\n\n\t\tthis._isFilterShown = false;\n\n\t\tif (BX.prop.getBoolean(params, \"enableAdjust\", true))\n\t\t{\n\t\t\tthis.adjustFilterButton();\n\t\t}\n\t}\n\n\tonFilterClose(e)\n\t{\n\t\tthis.hideFilter();\n\n\t\twindow.setTimeout(\n\t\t\tfunction () {\n\t\t\t\tconst filter = BX.Main.filterManager.getById(this._filterId);\n\t\t\t\tif (filter)\n\t\t\t\t{\n\t\t\t\t\tfilter.resetFilter();\n\t\t\t\t}\n\t\t\t}.bind(this),\n\t\t\t500\n\t\t);\n\t}\n\n\tcreateEmptySection()\n\t{\n\t\treturn BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-planned-label\"},\n\t\t\t\tchildren: [BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section-content\"}})]\n\t\t\t}\n\t\t);\n\t}\n\n\tcreateCurrentDaySection()\n\t{\n\t\tlet formattedDate = this.formatDate(BX.prop.extractDate(new Date()));\n\t\tformattedDate = formattedDate[0].toUpperCase() + formattedDate.substring(1);\n\n\t\treturn BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-today-label\"},\n\t\t\t\tchildren:\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-section-content\"},\n\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-today-label\"},\n\t\t\t\t\t\t\t\t\t\t\t\ttext: formattedDate\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\t}\n\n\tcreateDaySection(date)\n\t{\n\t\tlet formattedDate = this.formatDate(date);\n\t\tformattedDate = formattedDate[0].toUpperCase() + formattedDate.substring(1);\n\n\t\treturn BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-section crm-entity-stream-section-history-label\"},\n\t\t\t\tchildren:\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-section-content\"},\n\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-history-label\"},\n\t\t\t\t\t\t\t\t\t\t\t\ttext: formattedDate\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\t}\n\n\tcreateAnchor(index)\n\t{\n\t\tif (this._emptySection)\n\t\t{\n\t\t\tthis._emptySection = BX.remove(this._emptySection);\n\t\t}\n\n\t\tif (this._currentDaySection === null)\n\t\t{\n\t\t\tthis._currentDaySection = this.createCurrentDaySection();\n\t\t\tif (this._wrapper.firstChild)\n\t\t\t{\n\t\t\t\tthis._wrapper.insertBefore(this._currentDaySection, this._wrapper.firstChild);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis._wrapper.appendChild(this._currentDaySection);\n\t\t\t}\n\t\t}\n\n\t\tif (this._anchor === null)\n\t\t{\n\t\t\tthis._anchor = BX.create(\"DIV\", {attrs: {className: \"crm-entity-stream-section crm-entity-stream-section-shadow\"}});\n\t\t\tif (this._currentDaySection.nextSibling)\n\t\t\t{\n\t\t\t\tthis._wrapper.insertBefore(this._anchor, this._currentDaySection.nextSibling);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis._wrapper.appendChild(this._anchor);\n\t\t\t}\n\t\t}\n\t\treturn this._anchor;\n\t}\n\n\tcreateActivityItem(data)\n\t{\n\t\tconst typeId = BX.prop.getInteger(data, \"TYPE_ID\", ItemType.undefined);\n\t\tconst typeCategoryId = BX.prop.getInteger(data, \"TYPE_CATEGORY_ID\", 0);\n\t\tconst providerId = BX.prop.getString(\n\t\t\tBX.prop.getObject(data, \"ASSOCIATED_ENTITY\", {}),\n\t\t\t\"PROVIDER_ID\",\n\t\t\t\"\"\n\t\t);\n\n\t\tif (typeId !== ItemType.activity)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (typeCategoryId === BX.CrmActivityType.email)\n\t\t{\n\t\t\treturn Email.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\tif (typeCategoryId === BX.CrmActivityType.call)\n\t\t{\n\t\t\treturn Call.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeCategoryId === BX.CrmActivityType.meeting)\n\t\t{\n\t\t\treturn Meeting.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeCategoryId === BX.CrmActivityType.task)\n\t\t{\n\t\t\treturn Task.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeCategoryId === BX.CrmActivityType.provider)\n\t\t{\n\t\t\tif (providerId === \"CRM_WEBFORM\")\n\t\t\t{\n\t\t\t\treturn WebForm.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this._history,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === 'CRM_REQUEST')\n\t\t\t{\n\t\t\t\treturn Request.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this._history,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === \"IMOPENLINES_SESSION\")\n\t\t\t{\n\t\t\t\treturn OpenLine.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this._history,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === 'REST_APP')\n\t\t\t{\n\t\t\t\treturn Rest.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this._history,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === 'VISIT_TRACKER')\n\t\t\t{\n\t\t\t\treturn Visit.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === 'ZOOM')\n\t\t\t{\n\t\t\t\treturn Zoom.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (providerId === 'CRM_CALL_TRACKER')\n\t\t\t{\n\t\t\t\treturn Call.create(\n\t\t\t\t\tdata[\"ID\"],\n\t\t\t\t\t{\n\t\t\t\t\t\thistory: this,\n\t\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\treturn HistoryActivity.create(\n\t\t\tdata[\"ID\"],\n\t\t\t{\n\t\t\t\thistory: this._history,\n\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\tcontainer: this._wrapper,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\tdata: data,\n\t\t\t}\n\t\t);\n\t}\n\n\tcreateExternalNotificationItem(data)\n\t{\n\t\tconst typeId = BX.prop.getInteger(data, \"TYPE_CATEGORY_ID\", 0);\n\t\tconst changedFieldName = BX.prop.getString(data, 'CHANGED_FIELD_NAME', '');\n\n\t\tif (typeId === ItemType.modification && changedFieldName === 'STATUS_ID')\n\t\t{\n\t\t\treturn ExternalNoticeStatusModification.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\treturn ExternalNoticeModification.create(\n\t\t\tdata[\"ID\"],\n\t\t\t{\n\t\t\t\thistory: this._history,\n\t\t\t\tcontainer: this._wrapper,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\tdata: data\n\t\t\t}\n\t\t);\n\t}\n\n\tcreateItem(data)\n\t{\n\t\tif (data.hasOwnProperty('type'))\n\t\t{\n\t\t\treturn ConfigurableItem.create(data.id, {\n\t\t\t\ttimelineId: this.getId(),\n\t\t\t\tcontainer: this.getWrapper(),\n\t\t\t\titemClassName: this.getItemClassName(),\n\t\t\t\tuseShortTimeFormat: this.getStreamType() === StreamType.history,\n\t\t\t\tisReadOnly: this.isReadOnly(),\n\t\t\t\tcurrentUser: this._manager.getCurrentUser(),\n\t\t\t\townerTypeId: this._manager.getOwnerTypeId(),\n\t\t\t\townerId: this._manager.getOwnerId(),\n\t\t\t\tstreamType: this.getStreamType(),\n\t\t\t\tdata: data,\n\t\t\t})\n\t\t}\n\n\t\tconst typeId = BX.prop.getInteger(data, \"TYPE_ID\", ItemType.undefined);\n\t\tconst typeCategoryId = BX.prop.getInteger(data, \"TYPE_CATEGORY_ID\", 0);\n\n\t\tif (typeId === ItemType.activity)\n\t\t{\n\t\t\treturn this.createActivityItem(data);\n\t\t}\n\t\telse if (typeId === ItemType.externalNotification)\n\t\t{\n\t\t\treturn this.createExternalNotificationItem(data);\n\t\t}\n\t\telse if (typeId === ItemType.creation)\n\t\t{\n\t\t\treturn Creation.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.restoration)\n\t\t{\n\t\t\treturn Restoration.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.link)\n\t\t{\n\t\t\treturn Link.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.unlink)\n\t\t{\n\t\t\treturn Unlink.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.mark)\n\t\t{\n\t\t\treturn Mark.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.comment)\n\t\t{\n\t\t\treturn Comment.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.wait)\n\t\t{\n\t\t\treturn Wait.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.document)\n\t\t{\n\t\t\treturn Document.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.sender)\n\t\t{\n\t\t\treturn Sender.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.modification)\n\t\t{\n\t\t\treturn Modification.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.conversion)\n\t\t{\n\t\t\treturn Conversion.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.bizproc)\n\t\t{\n\t\t\treturn Bizproc.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse if (typeId === ItemType.scoring)\n\t\t{\n\t\t\treturn Scoring.create(\n\t\t\t\tdata[\"ID\"],\n\t\t\t\t{\n\t\t\t\t\thistory: this._history,\n\t\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\treturn HistoryItem.create(\n\t\t\tdata[\"ID\"],\n\t\t\t{\n\t\t\t\thistory: this._history,\n\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\tcontainer: this._wrapper,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\tdata: data\n\t\t\t}\n\t\t);\n\t}\n\n\tgetWrapper()\n\t{\n\t\treturn this._wrapper;\n\t}\n\n\tgetItemClassName()\n\t{\n\t\treturn 'crm-entity-stream-section crm-entity-stream-section-history';\n\t}\n\n\taddItem(item, index)\n\t{\n\t\tif (!BX.type.isNumber(index) || index < 0)\n\t\t{\n\t\t\tindex = this.calculateItemIndex(item);\n\t\t}\n\n\t\tif (index < this._items.length)\n\t\t{\n\t\t\tthis._items.splice(index, 0, item);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._items.push(item);\n\t\t}\n\n\t\tthis.refreshLayout();\n\t\tthis._manager.processHistoryLayoutChange();\n\t}\n\n\tdeleteItem(item)\n\t{\n\t\tconst index = this.getItemIndex(item);\n\t\tif (index < 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\titem.clearLayout();\n\t\tthis.removeItemByIndex(index);\n\n\t\tthis.refreshLayout();\n\t\tthis._manager.processHistoryLayoutChange();\n\t}\n\n\tresetLayout()\n\t{\n\t\tlet i;\n\n\t\tfor (i = (this._items.length - 1); i >= 0; i--)\n\t\t{\n\t\t\tthis._items[i].clearLayout();\n\t\t}\n\n\t\tthis._items = [];\n\n\t\tthis._currentDaySection = this._lastDaySection = this._emptySection = this._filterEmptyResultSection = null;\n\t\tthis._anchor = null;\n\t\tthis._lastDate = null;\n\n\t\t//Clean wrapper. Skip filter for prevent trembling.\n\t\tconst children = [];\n\t\tlet child;\n\t\tfor (i = 0; child = this._wrapper.children[i]; i++)\n\t\t{\n\t\t\tif (child !== this._filterWrapper)\n\t\t\t{\n\t\t\t\tchildren.push(child);\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0; child = children[i]; i++)\n\t\t{\n\t\t\tthis._wrapper.removeChild(child);\n\t\t}\n\t}\n\n\tonWindowScroll(e)\n\t{\n\t\tif (!this._loadingWaiter || !this._enableLoading || this._isRequestRunning)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst pos = this._loadingWaiter.getBoundingClientRect();\n\t\tif (pos.top <= document.documentElement.clientHeight)\n\t\t{\n\t\t\tthis.loadItems();\n\t\t}\n\t}\n\n\tonFilterApply(id, data, ctx, promise, params)\n\t{\n\t\tif (id !== this._filterId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tparams.autoResolve = false;\n\t\tthis._isFilterApplied = BX.prop.getString(data, \"action\", \"\") === \"apply\";\n\t\tthis._isRequestRunning = true;\n\n\t\tBX.CrmDataLoader.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tserviceUrl: this.getSetting(\"serviceUrl\", \"\"),\n\t\t\t\taction: \"GET_HISTORY_ITEMS\",\n\t\t\t\tparams:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"GUID\": this._id,\n\t\t\t\t\t\t\"OWNER_TYPE_ID\": this._manager.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this._manager.getOwnerId()\n\t\t\t\t\t}\n\t\t\t}\n\t\t).load(\n\t\t\tfunction (sender, result) {\n\t\t\t\tthis.resetLayout();\n\t\t\t\tthis.bulkCreateItems(BX.prop.getArray(result, \"HISTORY_ITEMS\", []));\n\t\t\t\tthis.setNavigation(BX.prop.getObject(result, \"HISTORY_NAVIGATION\", {}));\n\n\t\t\t\tthis.refreshLayout();\n\t\t\t\tif (this._items.length > 0)\n\t\t\t\t{\n\t\t\t\t\tthis._manager.processHistoryLayoutChange();\n\t\t\t\t}\n\n\t\t\t\tpromise.fulfill();\n\t\t\t\tthis._isRequestRunning = false;\n\t\t\t}.bind(this)\n\t\t);\n\t}\n\n\tbulkCreateItems(itemData)\n\t{\n\t\tconst length = itemData.length;\n\t\tif (length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._filterEmptyResultSection)\n\t\t{\n\t\t\tthis._filterEmptyResultSection = BX.remove(this._filterEmptyResultSection);\n\t\t}\n\n\t\tconst now = BX.prop.extractDate(new Date());\n\t\tlet i, item;\n\t\tfor (i = 0; i < length; i++)\n\t\t{\n\t\t\tconst itemId = BX.prop.getInteger(\n\t\t\t\titemData[i],\n\t\t\t\t'id',\n\t\t\t\tBX.prop.getInteger(itemData[i], 'ID', 0)\n\t\t\t);\n\n\t\t\tif (itemId <= 0)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (this.findItemById(itemId) !== null)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\titem = this.createItem(itemData[i]);\n\t\t\tthis._items.push(item);\n\n\t\t\tconst created = item.getCreatedDate();\n\t\t\tif (this._lastDate === null || this._lastDate.getTime() !== created.getTime())\n\t\t\t{\n\t\t\t\tthis._lastDate = created;\n\t\t\t\tif (now.getTime() === created.getTime())\n\t\t\t\t{\n\t\t\t\t\tthis._currentDaySection = this._lastDaySection = this.createCurrentDaySection();\n\t\t\t\t\tthis._wrapper.appendChild(this._currentDaySection);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis._lastDaySection = this.createDaySection(this._lastDate);\n\t\t\t\t\tthis._wrapper.appendChild(this._lastDaySection);\n\t\t\t\t}\n\t\t\t}\n\t\t\titem.layout();\n\t\t}\n\t}\n\n\tloadItems()\n\t{\n\t\tthis._isRequestRunning = true;\n\t\tBX.CrmDataLoader.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tserviceUrl: this.getSetting(\"serviceUrl\", \"\"),\n\t\t\t\taction: \"GET_HISTORY_ITEMS\",\n\t\t\t\tparams:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"GUID\": this._id,\n\t\t\t\t\t\t\"OWNER_TYPE_ID\": this._manager.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this._manager.getOwnerId(),\n\t\t\t\t\t\t\"NAVIGATION\": this._navigation\n\t\t\t\t\t}\n\t\t\t}\n\t\t).load(\n\t\t\tfunction (sender, result) {\n\t\t\t\tthis.bulkCreateItems(BX.prop.getArray(result, \"HISTORY_ITEMS\", []));\n\t\t\t\tthis.setNavigation(BX.prop.getObject(result, \"HISTORY_NAVIGATION\", {}));\n\n\t\t\t\tthis.refreshLayout();\n\t\t\t\tif (this._items.length > 0)\n\t\t\t\t{\n\t\t\t\t\tthis._manager.processHistoryLayoutChange();\n\t\t\t\t}\n\n\t\t\t\tthis._isRequestRunning = false;\n\t\t\t}.bind(this)\n\t\t);\n\t}\n\n\tgetNavigation()\n\t{\n\t\treturn this._navigation;\n\t}\n\n\tsetNavigation(navigation)\n\t{\n\t\tif (!BX.type.isPlainObject(navigation))\n\t\t{\n\t\t\tnavigation = {};\n\t\t}\n\n\t\tthis._navigation = navigation;\n\t\tthis.enableLoading(\n\t\t\tBX.prop.getString(this._navigation, \"OFFSET_TIMESTAMP\", \"\") !== \"\"\n\t\t);\n\t}\n\n\tisLoadingEnabled()\n\t{\n\t\treturn this._enableLoading;\n\t}\n\n\tenableLoading(enable)\n\t{\n\t\tenable = !!enable;\n\n\t\tif (this._enableLoading === enable)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._enableLoading = enable;\n\n\t\tif (this._enableLoading)\n\t\t{\n\t\t\tif (this._items.length > 0)\n\t\t\t{\n\t\t\t\tthis._loadingWaiter = this._items[this._items.length - 1].getWrapper();\n\t\t\t}\n\n\t\t\tif (!this._scrollHandler)\n\t\t\t{\n\t\t\t\tthis._scrollHandler = BX.delegate(this.onWindowScroll, this);\n\t\t\t\tBX.bind(window, \"scroll\", this._scrollHandler);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._loadingWaiter = null;\n\n\t\t\tif (this._scrollHandler)\n\t\t\t{\n\t\t\t\tBX.unbind(window, \"scroll\", this._scrollHandler);\n\t\t\t\tthis._scrollHandler = null;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = History.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tanimateItemAdding(item): Promise\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tExpand.create(item.getWrapper(), resolve).run();\n\t\t});\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new History();\n\t\tself.initialize(id, settings);\n\t\tHistory.instances[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n\tstatic instances = {};\n}\n","import History from \"./history\";\nimport {Item} from 'crm.timeline.item';\nimport CompatibleItem from \"../items/compatible-item\";\nimport {StreamType} from 'crm.timeline.item';\n\n/** @memberof BX.Crm.Timeline.Streams */\nexport default class FixedHistory extends History\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._items = [];\n\t\tthis._wrapper = null;\n\t\tthis._fixedHistory = this;\n\t\tthis._history = this;\n\t\tthis._isRequestRunning = false;\n\t}\n\n\tdoInitialize()\n\t{\n\t\tconst datetimeFormat = BX.message(\"FORMAT_DATETIME\").replace(/:SS/, \"\");\n\t\tthis._timeFormat = BX.date.convertBitrixFormat(datetimeFormat);\n\n\t\tlet itemData = this.getSetting(\"itemData\");\n\t\tif(!BX.type.isArray(itemData))\n\t\t{\n\t\t\titemData = [];\n\t\t}\n\n\t\tlet i, length, item;\n\t\tfor(i = 0, length = itemData.length; i < length; i++)\n\t\t{\n\t\t\titem = this.createItem(itemData[i]);\n\t\t\titem._isFixed = true;\n\t\t\tthis._items.push(item);\n\t\t}\n\t}\n\n\tsetHistory(history)\n\t{\n\t\tthis._history = history;\n\t}\n\n\tcheckItemForTermination(item)\n\t{\n\t\treturn false;\n\t}\n\n\tlayout()\n\t{\n\t\tthis._wrapper = BX.create(\"DIV\", {});\n\t\tthis.createAnchor();\n\t\tthis._container.insertBefore(this._wrapper,  this._editorContainer.nextElementSibling);\n\n\t\tfor (let i = 0; i < this._items.length; i++)\n\t\t{\n\t\t\tthis._items[i].setContainer(this._wrapper);\n\t\t\tthis._items[i].layout();\n\t\t}\n\n\t\tthis.refreshLayout();\n\n\t\tthis._manager.processHistoryLayoutChange();\n\t}\n\n\trefreshLayout()\n\t{\n\t}\n\n\tformatDate(date)\n\t{\n\t}\n\n\tcreateCurrentDaySection()\n\t{\n\t}\n\n\tcreateDaySection(date)\n\t{\n\t}\n\n\tcreateAnchor(index)\n\t{\n\t\tthis._anchor = BX.create(\"DIV\", { attrs:{className: \"crm-entity-stream-section-fixed-anchor\"} });\n\t\tthis._wrapper.appendChild(this._anchor);\n\t}\n\n\tonWindowScroll(e)\n\t{\n\t}\n\n\tonItemsLoad(sender, result)\n\t{\n\t}\n\n\tloadItems()\n\t{\n\t\tthis._isRequestRunning = true;\n\n\t\tBX.CrmDataLoader.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tserviceUrl: this.getSetting(\"serviceUrl\", \"\"),\n\t\t\t\taction: \"GET_FIXED_HISTORY_ITEMS\",\n\t\t\t\tparams:\n\t\t\t\t\t{\n\t\t\t\t\t\t\"OWNER_TYPE_ID\" : this._manager.getOwnerTypeId(),\n\t\t\t\t\t\t\"OWNER_ID\": this._manager.getOwnerId(),\n\t\t\t\t\t}\n\t\t\t}\n\t\t).load(BX.delegate(this.onItemsLoad, this));\n\t}\n\n\taddItem(item: Item, index): void\n\t{\n\t\tsuper.addItem(item, index);\n\n\t\tif (item instanceof CompatibleItem)\n\t\t{\n\t\t\titem._isFixed = true;\n\t\t}\n\t}\n\n\tgetItemClassName()\n\t{\n\t\treturn 'crm-entity-stream-section crm-entity-stream-section-history crm-entity-stream-section-top-fixed';\n\t}\n\n\tgetStreamType(): number\n\t{\n\t\treturn StreamType.pinned;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tlet self = new FixedHistory();\n\t\tself.initialize(id, settings);\n\t\tthis.instances[self.getId()] = self;\n\t\treturn self;\n\t}\n}\n\nFixedHistory.instances = {};\n","/** @memberof BX.Crm.Timeline.Tools */\nexport default class SchedulePostponeController\n{\n\tconstructor()\n\t{\n\t\tthis._item = null;\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\t\tthis._item = BX.prop.get(this._settings, \"item\", null);\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.getMessage(\"title\");\n\t}\n\n\tgetCommandList()\n\t{\n\t\treturn(\n\t\t\t[\n\t\t\t\t{ name: \"postpone_hour_1\", title: this.getMessage(\"forOneHour\") },\n\t\t\t\t{ name: \"postpone_hour_2\", title: this.getMessage(\"forTwoHours\") },\n\t\t\t\t{ name: \"postpone_hour_3\", title: this.getMessage(\"forThreeHours\") },\n\t\t\t\t{ name: \"postpone_day_1\", title: this.getMessage(\"forOneDay\") },\n\t\t\t\t{ name: \"postpone_day_2\", title: this.getMessage(\"forTwoDays\") },\n\t\t\t\t{ name: \"postpone_day_3\", title: this.getMessage(\"forThreeDays\") }\n\t\t\t]\n\t\t);\n\t}\n\n\tprocessCommand(command)\n\t{\n\t\tif(command.indexOf(\"postpone\") !== 0)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet offset = 0;\n\t\tif(command === \"postpone_hour_1\")\n\t\t{\n\t\t\toffset = 3600;\n\t\t}\n\t\telse if(command === \"postpone_hour_2\")\n\t\t{\n\t\t\toffset = 7200;\n\t\t}\n\t\telse if(command === \"postpone_hour_3\")\n\t\t{\n\t\t\toffset = 10800;\n\t\t}\n\t\telse if(command === \"postpone_day_1\")\n\t\t{\n\t\t\toffset = 86400;\n\t\t}\n\t\telse if(command === \"postpone_day_2\")\n\t\t{\n\t\t\toffset = 172800;\n\t\t}\n\t\telse if(command === \"postpone_day_3\")\n\t\t{\n\t\t\toffset = 259200;\n\t\t}\n\n\t\tif(offset > 0 && this._item)\n\t\t{\n\t\t\tthis._item.postpone(offset);\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = SchedulePostponeController.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new SchedulePostponeController();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import Scheduled from \"../scheduled\";\nimport {Item as ItemType} from \"../../types\";\nimport SchedulePostponeController from \"../../tools/schedule-postpone-controller\";\nimport {DatetimeConverter} from \"crm.timeline.tools\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Activity extends Scheduled\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._postponeController = null;\n\t}\n\n\tgetTypeId()\n\t{\n\t\treturn ItemType.activity;\n\t}\n\n\tisDone()\n\t{\n\t\tconst status = BX.prop.getInteger(this.getAssociatedEntityData(), \"STATUS\");\n\t\treturn (status ===  BX.CrmActivityStatus.completed || status ===  BX.CrmActivityStatus.autoCompleted);\n\t}\n\n\tsetAsDone(isDone)\n\t{\n\t\tisDone = !!isDone;\n\t\tif(this.isDone() === isDone)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst id = BX.prop.getInteger(this.getAssociatedEntityData(), \"ID\", 0);\n\t\tif(id > 0)\n\t\t{\n\t\t\tthis._activityEditor.setActivityCompleted(\n\t\t\t\tid,\n\t\t\t\tisDone,\n\t\t\t\tBX.delegate(this.onSetAsDoneCompleted, this)\n\t\t\t);\n\t\t}\n\t}\n\n\tpostpone(offset)\n\t{\n\t\tconst id = this.getSourceId();\n\t\tif(id > 0 && offset > 0)\n\t\t{\n\t\t\tthis._activityEditor.postponeActivity(\n\t\t\t\tid,\n\t\t\t\toffset,\n\t\t\t\tBX.delegate(this.onPosponeCompleted, this)\n\t\t\t);\n\t\t}\n\t}\n\n\tview()\n\t{\n\t\tconst id = BX.prop.getInteger(this.getAssociatedEntityData(), \"ID\", 0);\n\t\tif(id > 0)\n\t\t{\n\t\t\tthis._activityEditor.viewActivity(id);\n\t\t}\n\t}\n\n\tedit()\n\t{\n\t\tthis.closeContextMenu();\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityData = this.getAssociatedEntityData();\n\t\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\t\tif(id > 0)\n\t\t\t{\n\t\t\t\tthis._activityEditor.editActivity(id);\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessRemoval()\n\t{\n\t\tthis.closeContextMenu();\n\t\tthis._detetionConfirmDlgId = \"entity_timeline_deletion_\" + this.getId() + \"_confirm\";\n\t\tlet dlg = BX.Crm.ConfirmationDialog.get(this._detetionConfirmDlgId);\n\t\tif(!dlg)\n\t\t{\n\t\t\tdlg = BX.Crm.ConfirmationDialog.create(\n\t\t\t\tthis._detetionConfirmDlgId,\n\t\t\t\t{\n\t\t\t\t\ttitle: this.getMessage(\"removeConfirmTitle\"),\n\t\t\t\t\tcontent: this.getRemoveMessage()\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tdlg.open().then(BX.delegate(this.onRemovalConfirm, this), BX.delegate(this.onRemovalCancel, this));\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\treturn this.getMessage('removeConfirm');\n\t}\n\n\tonRemovalConfirm(result)\n\t{\n\t\tif(BX.prop.getBoolean(result, \"cancel\", true))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.remove();\n\t}\n\n\tonRemovalCancel()\n\t{\n\t}\n\n\tremove()\n\t{\n\t\tconst associatedEntityTypeId = this.getAssociatedEntityTypeId();\n\n\t\tif(associatedEntityTypeId === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\t\tconst id = BX.prop.getInteger(entityData, \"ID\", 0);\n\n\t\t\tif(id > 0)\n\t\t\t{\n\t\t\t\tconst activityEditor = this._activityEditor;\n\t\t\t\tconst item = activityEditor.getItemById(id);\n\t\t\t\tif (item)\n\t\t\t\t{\n\t\t\t\t\tactivityEditor.deleteActivity(id, true);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst activityType = activityEditor.getSetting('ownerType', '');\n\t\t\t\t\tconst activityId = activityEditor.getSetting('ownerID', '');\n\n\t\t\t\t\tconst serviceUrl = BX.util.add_url_param(activityEditor.getSetting('serviceUrl', ''),\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: id,\n\t\t\t\t\t\t\taction: 'get_activity',\n\t\t\t\t\t\t\townertype: activityType,\n\t\t\t\t\t\t\townerid: activityId\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\tBX.ajax({\n\t\t\t\t\t\t'url': serviceUrl,\n\t\t\t\t\t\t'method': 'POST',\n\t\t\t\t\t\t'dataType': 'json',\n\t\t\t\t\t\t'data':\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t'ACTION' : 'GET_ACTIVITY',\n\t\t\t\t\t\t\t\t'ID': id,\n\t\t\t\t\t\t\t\t'OWNER_TYPE': activityType,\n\t\t\t\t\t\t\t\t'OWNER_ID': activityId\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\tonsuccess: BX.delegate(\n\t\t\t\t\t\t\tfunction(data)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif(typeof(data['ACTIVITY']) !== 'undefined')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tactivityEditor._handleActivityChange(data['ACTIVITY']);\n\t\t\t\t\t\t\t\t\twindow.setTimeout(BX.delegate(this.remove ,this), 500);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tthis\n\t\t\t\t\t\t),\n\t\t\t\t\t\tonfailure: function(data){}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetDeadline()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst time = BX.parseDate(\n\t\t\tentityData[\"DEADLINE_SERVER\"],\n\t\t\tfalse,\n\t\t\t\"YYYY-MM-DD\",\n\t\t\t\"YYYY-MM-DD HH:MI:SS\"\n\t\t);\n\n\t\tif(!time)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn (new DatetimeConverter(time)).toUserTime().getValue();\n\t}\n\n\tgetLightTime()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst time = BX.parseDate(\n\t\t\tentityData[\"LIGHT_TIME_SERVER\"],\n\t\t\tfalse,\n\t\t\t\"YYYY-MM-DD\",\n\t\t\t\"YYYY-MM-DD HH:MI:SS\"\n\t\t);\n\n\t\tif(!time)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn (new DatetimeConverter(time)).toUserTime().getValue();\n\t}\n\n\tgetCreatedDate()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst time = BX.parseDate(\n\t\t\tentityData[\"CREATED_SERVER\"],\n\t\t\tfalse,\n\t\t\t\"YYYY-MM-DD\",\n\t\t\t\"YYYY-MM-DD HH:MI:SS\"\n\t\t);\n\n\t\tif(!time)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn (new DatetimeConverter(time)).toUserTime().getValue();\n\t}\n\n\tisIncomingChannel()\n\t{\n\t\tif (this.isDone())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\tconst entityData = this.getAssociatedEntityData();\n\n\t\treturn entityData.hasOwnProperty('IS_INCOMING_CHANNEL') && entityData.IS_INCOMING_CHANNEL === 'Y';\n\t}\n\n\tmarkAsDone(isDone)\n\t{\n\t\tisDone = !!isDone;\n\t\tthis.getAssociatedEntityData()[\"STATUS\"] = isDone ? BX.CrmActivityStatus.completed : BX.CrmActivityStatus.waiting;\n\t}\n\n\tgetPrepositionText(direction)\n\t{\n\t\treturn this.getMessage(direction === BX.CrmActivityDirection.incoming ? \"from\" : \"to\");\n\t}\n\n\tgetTypeDescription(direction)\n\t{\n\t\treturn \"\";\n\t}\n\n\tisContextMenuEnabled()\n\t{\n\t\treturn ((!!this.getDeadline() && this.canPostpone()) || this.canComplete());\n\t}\n\n\tprepareContent(options)\n\t{\n\t\tlet timeText = '';\n\t\tconst isIncomingChannel = this.isIncomingChannel();\n\t\tif (isIncomingChannel)\n\t\t{\n\t\t\ttimeText = this.formatDateTime(this.getCreatedDate());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst deadline = this.getDeadline();\n\t\t\ttimeText = deadline ? this.formatDateTime(deadline) : this.getMessage(\"termless\");\n\t\t}\n\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\t\tconst isDone = this.isDone();\n\t\tconst subject = BX.prop.getString(entityData, \"SUBJECT\", \"\");\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst title = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst showUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\t\tconst communicationValue = BX.prop.getString(communication, \"TYPE\", \"\") !== \"\"\n\t\t\t? BX.prop.getString(communication, \"VALUE\", \"\") : \"\";\n\n\t\tlet wrapperClassName = this.getWrapperClassName();\n\t\tif(wrapperClassName !== \"\")\n\t\t{\n\t\t\twrapperClassName = this._schedule.getItemClassName() + \" \" + wrapperClassName;\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapperClassName = this._schedule.getItemClassName();\n\t\t}\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: wrapperClassName}});\n\n\t\tlet iconClassName = this.getIconClassName();\n\t\tif(this.isCounterEnabled())\n\t\t{\n\t\t\ticonClassName += \" crm-entity-stream-section-counter\";\n\t\t}\n\t\tif(isIncomingChannel)\n\t\t{\n\t\t\ticonClassName += \" crm-entity-stream-section-counter --incoming-counter\";\n\t\t}\n\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: iconClassName } }));\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\tconst contentWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-section-content\"}}\n\t\t);\n\t\twrapper.appendChild(contentWrapper);\n\n\t\t//region Details\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst contentInnerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-event\"}\n\t\t\t}\n\t\t);\n\t\tcontentWrapper.appendChild(contentInnerWrapper);\n\n\t\tthis._deadlineNode = BX.create(\"SPAN\",\n\t\t\t{ attrs: { className: \"crm-entity-stream-content-event-time\" }, text: timeText }\n\t\t);\n\n\t\tconst headerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"}\n\t\t\t}\n\t\t);\n\t\theaderWrapper.appendChild(BX.create(\"SPAN\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\tclassName: \"crm-entity-stream-content-event-title\"\n\t\t\t\t\t},\n\t\t\t\ttext: this.getTypeDescription(direction)\n\t\t\t}\n\t\t));\n\n\t\tconst statusNode = this.getStatusNode();\n\t\tif (statusNode)\n\t\t{\n\t\t\theaderWrapper.appendChild(statusNode);\n\t\t}\n\t\theaderWrapper.appendChild(this._deadlineNode);\n\n\t\tcontentInnerWrapper.appendChild(headerWrapper);\n\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"}\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-title\"},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { href: \"#\" },\n\t\t\t\t\t\t\t\t\tevents: { \"click\": this._headerClickHandler },\n\t\t\t\t\t\t\t\t\ttext: subject\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\ttext: this.cutOffText(description, 128)\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst additionalDetails = this.prepareDetailNodes();\n\t\tif(BX.type.isArray(additionalDetails))\n\t\t{\n\t\t\tlet i = 0;\n\t\t\tconst length = additionalDetails.length;\n\t\t\tfor(; i < length; i++)\n\t\t\t{\n\t\t\t\tdetailWrapper.appendChild(additionalDetails[i]);\n\t\t\t}\n\t\t}\n\n\t\tconst members = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-contact-info\"}}\n\t\t);\n\n\t\tif(title !== '')\n\t\t{\n\t\t\tmembers.appendChild(\n\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t{ text: this.getPrepositionText(direction) + \": \" }\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tif(showUrl !== '')\n\t\t\t{\n\t\t\t\tmembers.appendChild(\n\t\t\t\t\tBX.create(\"A\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs: { href: showUrl },\n\t\t\t\t\t\t\ttext: title\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmembers.appendChild(BX.create(\"SPAN\", { text: title }));\n\t\t\t}\n\t\t}\n\n\t\tif(communicationValue !== '')\n\t\t{\n\t\t\tconst communicationNode = this.prepareCommunicationNode(communicationValue);\n\t\t\tif(communicationNode)\n\t\t\t{\n\t\t\t\tmembers.appendChild(communicationNode);\n\t\t\t}\n\t\t}\n\n\t\tdetailWrapper.appendChild(members);\n\t\t//endregion\n\t\t//region Set as Done Button\n\t\tconst setAsDoneButton = BX.create(\"INPUT\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\t\tclassName: \"crm-entity-stream-planned-apply-btn\",\n\t\t\t\t\t\tchecked: isDone\n\t\t\t\t\t},\n\t\t\t\tevents: {change: this._setAsDoneButtonHandler}\n\t\t\t}\n\t\t);\n\n\t\tif(!this.canComplete())\n\t\t{\n\t\t\tsetAsDoneButton.disabled = true;\n\t\t}\n\n\t\tconst buttonContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-planned-action\"},\n\t\t\t\tchildren: [setAsDoneButton]\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(buttonContainer);\n\t\t//endregion\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentInnerWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-action\" }\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tgetStatusNode()\n\t{\n\t\treturn null;\n\t}\n\n\tprepareCommunicationNode(communicationValue)\n\t{\n\t\treturn BX.create(\"SPAN\", { text: \" \" + communicationValue });\n\t}\n\n\tprepareDetailNodes()\n\t{\n\t\treturn [];\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tconst menuItems = [];\n\n\t\tif (!this.isReadOnly())\n\t\t{\n\t\t\tif (this.isEditable())\n\t\t\t{\n\t\t\t\tmenuItems.push({ id: \"edit\", text: this.getMessage(\"menuEdit\"), onclick: BX.delegate(this.edit, this)});\n\t\t\t}\n\n\t\t\tmenuItems.push({ id: \"remove\", text: this.getMessage(\"menuDelete\"), onclick: BX.delegate(this.processRemoval, this)});\n\t\t}\n\n\t\tif (this.canPostpone())\n\t\t{\n\t\t\tconst handler = BX.delegate(this.onContextMenuItemSelect, this);\n\n\t\t\tif(!this._postponeController)\n\t\t\t{\n\t\t\t\tthis._postponeController = SchedulePostponeController.create(\"\", { item: this });\n\t\t\t}\n\n\t\t\tconst postponeMenu =\n\t\t\t\t{\n\t\t\t\t\tid: \"postpone\",\n\t\t\t\t\ttext: this._postponeController.getTitle(),\n\t\t\t\t\titems: []\n\t\t\t\t};\n\n\t\t\tconst commands = this._postponeController.getCommandList();\n\t\t\tlet i = 0;\n\t\t\tconst length = commands.length;\n\t\t\tfor(; i < length; i++)\n\t\t\t{\n\t\t\t\tconst command = commands[i];\n\t\t\t\tpostponeMenu.items.push(\n\t\t\t\t\t{\n\t\t\t\t\t\tid: command[\"name\"],\n\t\t\t\t\t\ttext: command[\"title\"],\n\t\t\t\t\t\tonclick: handler\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\tmenuItems.push(postponeMenu);\n\t\t}\n\n\t\treturn menuItems;\n\t}\n\n\tonContextMenuItemSelect(e, item)\n\t{\n\t\tthis.closeContextMenu();\n\t\tif(this._postponeController)\n\t\t{\n\t\t\tthis._postponeController.processCommand(item.id);\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Activity();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Call extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn 'crm-entity-stream-section-call';\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-call\";\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._actions.push(\n\t\t\tBX.CrmScheduleCallAction.create(\n\t\t\t\t\"call\",\n\t\t\t\t{\n\t\t\t\t\titem: this,\n\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\townerInfo: this._schedule.getOwnerInfo()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tgetTypeDescription(direction)\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst callInfo = BX.prop.getObject(entityData, \"CALL_INFO\", null);\n\t\tconst callTypeText = callInfo !== null ? BX.prop.getString(callInfo, \"CALL_TYPE_TEXT\", \"\") : \"\";\n\t\tif(callTypeText !== \"\")\n\t\t{\n\t\t\treturn callTypeText;\n\t\t}\n\n\t\treturn this.getMessage(direction === BX.CrmActivityDirection.incoming ? \"incomingCall\" : \"outgoingCall\");\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\t\tlet title = BX.prop.getString(entityData, \"SUBJECT\", \"\");\n\t\tconst messageName = (direction === BX.CrmActivityDirection.incoming) ? 'incomingCallRemove' : 'outgoingCallRemove';\n\t\ttitle = BX.util.htmlspecialchars(title);\n\t\treturn this.getMessage(messageName).replace(\"#TITLE#\", title);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Call();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Call from \"./call\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class CallTracker extends Call\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetStatusNode()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst callInfo = BX.prop.getObject(entityData, \"CALL_INFO\", null);\n\n\t\tif (!callInfo)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\tif (!BX.prop.getBoolean(callInfo, \"HAS_STATUS\", false))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst isSuccessfull = BX.prop.getBoolean(callInfo, \"SUCCESSFUL\", false);\n\t\tconst statusText = BX.prop.getString(callInfo, \"STATUS_TEXT\", \"\");\n\n\t\treturn BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\tclassName: isSuccessfull\n\t\t\t\t\t\t\t? \"crm-entity-stream-content-event-successful\"\n\t\t\t\t\t\t\t: \"crm-entity-stream-content-event-missing\"\n\t\t\t\t\t},\n\t\t\t\ttext: statusText\n\t\t\t}\n\t\t)\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new CallTracker();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Email extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-email\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-email\";\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._actions.push(\n\t\t\tBX.CrmScheduleEmailAction.create(\n\t\t\t\t\"email\",\n\t\t\t\t{\n\t\t\t\t\titem: this,\n\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\tactivityEditor: this._activityEditor\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tgetTypeDescription(direction)\n\t{\n\t\treturn this.getMessage(direction === BX.CrmActivityDirection.incoming ? \"incomingEmail\" : \"outgoingEmail\");\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tlet title = BX.prop.getString(entityData, \"SUBJECT\", \"\");\n\t\ttitle = BX.util.htmlspecialchars(title);\n\t\treturn this.getMessage('emailRemove').replace(\"#TITLE#\", title);\n\t}\n\n\tisEditable()\n\t{\n\t\treturn false;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Email();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Meeting extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-meeting\";\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tgetPrepositionText()\n\t{\n\t\treturn this.getMessage(\"reciprocal\");\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tlet title = BX.prop.getString(entityData, \"SUBJECT\", \"\");\n\t\ttitle = BX.util.htmlspecialchars(title);\n\t\treturn this.getMessage('meetingRemove').replace(\"#TITLE#\", title);\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"meeting\");\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Meeting();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\nimport {OpenLine as OpenLineAction} from \"../../actions/openline\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class OpenLine extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-IM\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-IM\";\n\t}\n\n\tprepareActions()\n\t{\n\t\tif(this.isReadOnly())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._actions.push(\n\t\t\tOpenLineAction.create(\n\t\t\t\t\"openline\",\n\t\t\t\t{\n\t\t\t\t\titem: this,\n\t\t\t\t\tcontainer: this._actionContainer,\n\t\t\t\t\tentityData: this.getAssociatedEntityData(),\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\townerInfo: this._schedule.getOwnerInfo()\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"openLine\");\n\t}\n\n\tgetPrepositionText(direction)\n\t{\n\t\treturn this.getMessage(\"reciprocal\");\n\t}\n\n\tprepareCommunicationNode(communicationValue)\n\t{\n\t\treturn null;\n\t}\n\n\tprepareDetailNodes()\n\t{\n\t\tconst wrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-IM\"}}\n\t\t);\n\n\t\tconst messageWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-IM-messages\"}}\n\t\t);\n\t\twrapper.appendChild(messageWrapper);\n\n\t\tconst openLineData = BX.prop.getObject(this.getAssociatedEntityData(), \"OPENLINE_INFO\", null);\n\t\tif(openLineData)\n\t\t{\n\t\t\tconst messages = BX.prop.getArray(openLineData, \"MESSAGES\", []);\n\t\t\tlet i = 0;\n\t\t\tconst length = messages.length;\n\t\t\tfor(; i < length; i++)\n\t\t\t{\n\t\t\t\tconst message = messages[i];\n\t\t\t\tconst isExternal = BX.prop.getBoolean(message, \"IS_EXTERNAL\", true);\n\n\t\t\t\tmessageWrapper.appendChild(\n\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tclassName: isExternal\n\t\t\t\t\t\t\t\t\t\t? \"crm-entity-stream-content-detail-IM-message-incoming\"\n\t\t\t\t\t\t\t\t\t\t: \"crm-entity-stream-content-detail-IM-message-outgoing\"\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\thtml: BX.prop.getString(message, \"MESSAGE\", \"\")\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\treturn [ wrapper ];\n\t}\n\n\tview()\n\t{\n\t\tif(typeof(window.top['BXIM']) === 'undefined')\n\t\t{\n\t\t\twindow.alert(this.getMessage(\"openLineNotSupported\"));\n\t\t\treturn;\n\t\t}\n\n\t\tlet slug = \"\";\n\t\tconst communication = BX.prop.getObject(this.getAssociatedEntityData(), \"COMMUNICATION\", null);\n\t\tif(communication)\n\t\t{\n\t\t\tif(BX.prop.getString(communication, \"TYPE\") === \"IM\")\n\t\t\t{\n\t\t\t\tslug = BX.prop.getString(communication, \"VALUE\");\n\t\t\t}\n\t\t}\n\n\t\tif(slug !== \"\")\n\t\t{\n\t\t\twindow.top['BXIM'].openMessengerSlider(slug, {RECENT: 'N', MENU: 'N'});\n\t\t}\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new OpenLine();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Request extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-robot\";\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"activityRequest\");\n\t}\n\n\tisEditable()\n\t{\n\t\treturn false;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Request();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Rest extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-rest\";\n\t}\n\n\tprepareContent(options)\n\t{\n\t\tconst wrapper = super.prepareContent(options);\n\t\tconst data = this.getAssociatedEntityData();\n\n\t\tif (data['APP_TYPE'] && data['APP_TYPE']['ICON_SRC'])\n\t\t{\n\t\t\tconst iconNode = wrapper.querySelector('.' + this.getIconClassName().replace(/\\s+/g, '.'));\n\t\t\tif (iconNode)\n\t\t\t{\n\t\t\t\ticonNode.style.backgroundImage = \"url('\" +  data['APP_TYPE']['ICON_SRC'] + \"')\";\n\t\t\t\ticonNode.style.backgroundPosition = \"center center\";\n\t\t\t\ticonNode.style.backgroundSize = \"cover\";\n\t\t\t\ticonNode.style.backgroundColor = \"transparent\";\n\t\t\t}\n\t\t}\n\n\t\treturn wrapper;\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tif (entityData['APP_TYPE'] && entityData['APP_TYPE']['NAME'])\n\t\t{\n\t\t\treturn entityData['APP_TYPE']['NAME'];\n\t\t}\n\n\t\treturn this.getMessage(\"restApplication\");\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Rest();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Task extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-planned-task\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-task\";\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"task\");\n\t}\n\n\tgetPrepositionText(direction)\n\t{\n\t\treturn this.getMessage(\"reciprocal\");\n\t}\n\n\tgetRemoveMessage()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tlet title = BX.prop.getString(entityData, \"SUBJECT\", \"\");\n\t\ttitle = BX.util.htmlspecialchars(title);\n\t\treturn this.getMessage('taskRemove').replace(\"#TITLE#\", title);\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Task();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Scheduled from \"../scheduled\";\nimport {Item as ItemType} from \"../../types\";\nimport SchedulePostponeController from \"../../tools/schedule-postpone-controller\";\nimport {DatetimeConverter} from \"crm.timeline.tools\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Wait extends Scheduled\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._postponeController = null;\n\t}\n\n\tgetTypeId()\n\t{\n\t\treturn ItemType.wait;\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-wait\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-wait\";\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tisCounterEnabled()\n\t{\n\t\treturn false;\n\t}\n\n\tgetDeadline()\n\t{\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst time = BX.parseDate(\n\t\t\tentityData[\"DEADLINE_SERVER\"],\n\t\t\tfalse,\n\t\t\t\"YYYY-MM-DD\",\n\t\t\t\"YYYY-MM-DD HH:MI:SS\"\n\t\t);\n\n\t\tif(!time)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn (new DatetimeConverter(time)).toUserTime().getValue();\n\t}\n\n\tisDone()\n\t{\n\t\treturn (BX.prop.getString(this.getAssociatedEntityData(), \"COMPLETED\", \"N\") ===  \"Y\");\n\t}\n\n\tsetAsDone(isDone)\n\t{\n\t\tisDone = !!isDone;\n\t\tif(this.isDone() === isDone)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst id = this.getAssociatedEntityId();\n\t\tif(id > 0)\n\t\t{\n\t\t\tconst editor = BX.Crm.Timeline?.MenuBar?.getDefault()?.getItemById('wait');\n\t\t\tif(editor)\n\t\t\t{\n\t\t\t\teditor.complete(\n\t\t\t\t\tid,\n\t\t\t\t\tisDone,\n\t\t\t\t\tBX.delegate(this.onSetAsDoneCompleted, this)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tpostpone(offset)\n\t{\n\t\tconst id = this.getAssociatedEntityId();\n\t\tif(id > 0 && offset > 0)\n\t\t{\n\t\t\tconst editor = BX.Crm.Timeline?.MenuBar?.getDefault()?.getItemById('wait');\n\t\t\tif(editor)\n\t\t\t{\n\t\t\t\teditor.postpone(\n\t\t\t\t\tid,\n\t\t\t\t\toffset,\n\t\t\t\t\tBX.delegate(this.onPosponeCompleted, this)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tisContextMenuEnabled()\n\t{\n\t\treturn !!this.getDeadline() && this.canPostpone();\n\t}\n\n\tprepareContent()\n\t{\n\t\tconst deadline = this.getDeadline();\n\t\tconst timeText = deadline ? this.formatDateTime(deadline) : this.getMessage(\"termless\");\n\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst isDone = this.isDone();\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\n\t\tlet wrapperClassName = this.getWrapperClassName();\n\t\tif(wrapperClassName !== \"\")\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-planned\" + \" \" + wrapperClassName;\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-planned\";\n\t\t}\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: wrapperClassName}});\n\n\t\tlet iconClassName = this.getIconClassName();\n\t\tif(this.isCounterEnabled())\n\t\t{\n\t\t\ticonClassName += \" crm-entity-stream-section-counter\";\n\t\t}\n\n\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: iconClassName } }));\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\tconst contentWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-section-content\"}}\n\t\t);\n\t\twrapper.appendChild(contentWrapper);\n\n\t\t//region Details\n\t\tif(description !== \"\")\n\t\t{\n\t\t\tdescription = BX.util.trim(description);\n\t\t\tdescription = BX.util.strip_tags(description);\n\t\t\tdescription = this.cutOffText(description, 512);\n\t\t\tdescription = BX.util.nl2br(description);\n\t\t}\n\n\t\tconst contentInnerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-event\"}\n\t\t\t}\n\t\t);\n\t\tcontentWrapper.appendChild(contentInnerWrapper);\n\n\t\tthis._deadlineNode = BX.create(\"SPAN\",\n\t\t\t{ attrs: { className: \"crm-entity-stream-content-event-time\" }, text: timeText }\n\t\t);\n\n\t\tconst headerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\t\tchildren:\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-event-title\"},\n\t\t\t\t\t\t\t\ttext: this.getMessage(\"wait\")\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t),\n\t\t\t\t\t\tthis._deadlineNode\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(headerWrapper);\n\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"}\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(detailWrapper);\n\n\t\tdetailWrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-description\" },\n\t\t\t\t\thtml: description\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst members = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-content-detail-contact-info\"}}\n\t\t);\n\n\t\tdetailWrapper.appendChild(members);\n\t\t//endregion\n\n\t\t//region Set as Done Button\n\t\tconst setAsDoneButton = BX.create(\"INPUT\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\t\tclassName: \"crm-entity-stream-planned-apply-btn\",\n\t\t\t\t\t\tchecked: isDone\n\t\t\t\t\t},\n\t\t\t\tevents: {change: this._setAsDoneButtonHandler}\n\t\t\t}\n\t\t);\n\n\t\tif(!this.canComplete())\n\t\t{\n\t\t\tsetAsDoneButton.disabled = true;\n\t\t}\n\n\t\tconst buttonContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-planned-action\"},\n\t\t\t\tchildren: [setAsDoneButton]\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(buttonContainer);\n\t\t//endregion\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentInnerWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-action\" }\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tprepareContextMenuItems()\n\t{\n\t\tconst menuItems = [];\n\t\tconst handler = BX.delegate(this.onContextMenuItemSelect, this);\n\n\t\tif(!this._postponeController)\n\t\t{\n\t\t\tthis._postponeController = SchedulePostponeController.create(\"\", { item: this });\n\t\t}\n\n\t\tconst postponeMenu =\n\t\t\t{\n\t\t\t\tid: \"postpone\",\n\t\t\t\ttext: this._postponeController.getTitle(),\n\t\t\t\titems: []\n\t\t\t};\n\n\t\tconst commands = this._postponeController.getCommandList();\n\t\tlet i = 0;\n\t\tconst length = commands.length;\n\t\tfor(; i < length; i++)\n\t\t{\n\t\t\tconst command = commands[i];\n\t\t\tpostponeMenu.items.push(\n\t\t\t\t{\n\t\t\t\t\tid: command[\"name\"],\n\t\t\t\t\ttext: command[\"title\"],\n\t\t\t\t\tonclick: handler\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\tmenuItems.push(postponeMenu);\n\t\treturn menuItems;\n\t}\n\n\tonContextMenuItemSelect(e, item)\n\t{\n\t\tthis.closeContextMenu();\n\t\tif(this._postponeController)\n\t\t{\n\t\t\tthis._postponeController.processCommand(item.id);\n\t\t}\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"wait\");\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Wait();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class WebForm extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-crmForm\";\n\t}\n\n\tprepareActions()\n\t{\n\t}\n\n\tgetPrepositionText()\n\t{\n\t\treturn this.getMessage(\"from\");\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"webform\");\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new WebForm();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import Activity from \"./activity\";\nimport {DatetimeConverter} from \"crm.timeline.tools\";\n\n/** @memberof BX.Crm.Timeline.Items.Scheduled */\nexport default class Zoom extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tgetWrapperClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-zoom\";\n\t}\n\n\tgetIconClassName()\n\t{\n\t\treturn \"crm-entity-stream-section-icon crm-entity-stream-section-icon-zoom\";\n\t}\n\n\tgetTypeDescription()\n\t{\n\t\treturn this.getMessage(\"zoom\");\n\t}\n\n\tgetPrepositionText(direction)\n\t{\n\t}\n\n\tprepareCommunicationNode(communicationValue)\n\t{\n\t\treturn null;\n\t}\n\n\tprepareContent(options)\n\t{\n\t\tconst deadline = this.getDeadline();\n\t\tconst timeText = deadline ? this.formatDateTime(deadline) : this.getMessage(\"termless\");\n\n\t\tconst entityData = this.getAssociatedEntityData();\n\t\tconst direction = BX.prop.getInteger(entityData, \"DIRECTION\", 0);\n\t\tconst isDone = this.isDone();\n\t\tconst subject = BX.prop.getString(entityData, \"SUBJECT\", \"\");\n\t\tlet description = BX.prop.getString(entityData, \"DESCRIPTION_RAW\", \"\");\n\n\t\tconst communication = BX.prop.getObject(entityData, \"COMMUNICATION\", {});\n\t\tconst title = BX.prop.getString(communication, \"TITLE\", \"\");\n\t\tconst showUrl = BX.prop.getString(communication, \"SHOW_URL\", \"\");\n\t\tconst communicationValue = BX.prop.getString(communication, \"TYPE\", \"\") !== \"\"\n\t\t\t? BX.prop.getString(communication, \"VALUE\", \"\") : \"\";\n\n\t\tlet wrapperClassName = this.getWrapperClassName();\n\t\tif(wrapperClassName !== \"\")\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-planned\" + \" \" + wrapperClassName;\n\t\t}\n\t\telse\n\t\t{\n\t\t\twrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-planned\";\n\t\t}\n\n\t\tconst wrapper = BX.create(\"DIV\", {attrs: {className: wrapperClassName}});\n\n\t\tlet iconClassName = this.getIconClassName();\n\t\tif(this.isCounterEnabled())\n\t\t{\n\t\t\ticonClassName += \" crm-entity-stream-section-counter\";\n\t\t}\n\t\twrapper.appendChild(BX.create(\"DIV\", { attrs: { className: iconClassName } }));\n\n\t\t//region Context Menu\n\t\tif(this.isContextMenuEnabled())\n\t\t{\n\t\t\twrapper.appendChild(this.prepareContextMenuButton());\n\t\t}\n\t\t//endregion\n\n\t\tconst contentWrapper = BX.create(\"DIV\",\n\t\t\t{attrs: {className: \"crm-entity-stream-section-content\"}}\n\t\t);\n\t\twrapper.appendChild(contentWrapper);\n\n\t\t//region Details\n\t\tif(description !== \"\")\n\t\t{\n\t\t\t//trim leading spaces\n\t\t\tdescription = description.replace(/^\\s+/,'');\n\t\t}\n\n\t\tconst contentInnerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-event\"}\n\t\t\t}\n\t\t);\n\t\tcontentWrapper.appendChild(contentInnerWrapper);\n\n\t\tthis._deadlineNode = BX.create(\"SPAN\",\n\t\t\t{ attrs: { className: \"crm-entity-stream-content-event-time\" }, text: timeText }\n\t\t);\n\n\t\tconst headerWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-header\"},\n\t\t\t\tchildren:\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"SPAN\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs:\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tclassName: \"crm-entity-stream-content-event-title\"\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ttext: this.getTypeDescription(direction)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t),\n\t\t\t\t\t\tthis._deadlineNode\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(headerWrapper);\n\n\t\tconst detailWrapper = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail\"}\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(detailWrapper);\n\n\t\tif (entityData['ZOOM_INFO'])\n\t\t{\n\t\t\tconst topic = entityData['ZOOM_INFO']['TOPIC'];\n\t\t\tconst duration = entityData['ZOOM_INFO']['DURATION'];\n\t\t\tconst startTime = BX.parseDate(\n\t\t\t\tentityData['ZOOM_INFO']['CONF_START_TIME'],\n\t\t\t\tfalse,\n\t\t\t\t\"YYYY-MM-DD\",\n\t\t\t\t\"YYYY-MM-DD HH:MI:SS\"\n\t\t\t);\n\t\t\tconst date = (new DatetimeConverter(startTime)).toUserTime().toDatetimeString({delimiter: ', '});\n\t\t\tconst detailZoomMessage = BX.create(\"span\",\n\t\t\t\t{\n\t\t\t\t\ttext: this.getMessage(\"zoomCreatedMessage\")\n\t\t\t\t\t\t.replace(\"#CONFERENCE_TITLE#\", topic)\n\t\t\t\t\t\t.replace(\"#DATE_TIME#\", date)\n\t\t\t\t\t\t.replace(\"#DURATION#\", duration)\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tconst detailZoomInfoLink = BX.create(\"A\",\n\t\t\t\t{\n\t\t\t\t\tattrs:\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thref: entityData['ZOOM_INFO']['CONF_URL'],\n\t\t\t\t\t\t\ttarget: \"_blank\",\n\t\t\t\t\t\t},\n\t\t\t\t\ttext: entityData['ZOOM_INFO']['CONF_URL']\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tconst detailZoomInfo = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-zoom-info\"},\n\t\t\t\t\tchildren: [detailZoomMessage, detailZoomInfoLink]\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tdetailWrapper.appendChild(detailZoomInfo);\n\n\t\t\tconst detailZoomCopyInviteLink = BX.create(\"A\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'ui-link ui-link-dashed',\n\t\t\t\t\t\t\"data-url\": entityData['ZOOM_INFO']['CONF_URL']\n\t\t\t\t\t},\n\t\t\t\t\ttext: this.getMessage(\"zoomCreatedCopyInviteLink\"),\n\t\t\t\t}\n\t\t\t);\n\t\t\tBX.clipboard.bindCopyClick(detailZoomCopyInviteLink, {\n\t\t\t\ttext: entityData['ZOOM_INFO']['CONF_URL'],\n\t\t\t});\n\n\t\t\tconst detailZoomStartConferenceButton = BX.create(\"BUTTON\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: 'ui-btn ui-btn-sm ui-btn-primary'},\n\t\t\t\t\ttext: this.getMessage(\"zoomCreatedStartConference\"),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t\"click\": function () {\n\t\t\t\t\t\t\twindow.open(entityData['ZOOM_INFO']['CONF_URL']);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tconst detailZoomCopyInviteLinkWrapper = BX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-zoom-link-wrapper\"},\n\t\t\t\t\tchildren: [detailZoomCopyInviteLink]\n\t\t\t\t}\n\t\t\t);\n\t\t\tdetailWrapper.appendChild(detailZoomCopyInviteLinkWrapper);\n\t\t\tdetailWrapper.appendChild(detailZoomStartConferenceButton);\n\t\t}\n\n\t\tconst additionalDetails = this.prepareDetailNodes();\n\t\tif(BX.type.isArray(additionalDetails))\n\t\t{\n\t\t\tlet i = 0;\n\t\t\tconst length = additionalDetails.length;\n\t\t\tfor(; i < length; i++)\n\t\t\t{\n\t\t\t\tdetailWrapper.appendChild(additionalDetails[i]);\n\t\t\t}\n\t\t}\n\n\t\t//endregion\n\t\t//region Set as Done Button\n\t\tconst setAsDoneButton = BX.create(\"INPUT\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: \"checkbox\",\n\t\t\t\t\t\tclassName: \"crm-entity-stream-planned-apply-btn\",\n\t\t\t\t\t\tchecked: isDone\n\t\t\t\t\t},\n\t\t\t\tevents: {change: this._setAsDoneButtonHandler}\n\t\t\t}\n\t\t);\n\n\t\tif(!this.canComplete())\n\t\t{\n\t\t\tsetAsDoneButton.disabled = true;\n\t\t}\n\n\t\tconst buttonContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-content-detail-planned-action\"},\n\t\t\t\tchildren: [setAsDoneButton]\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(buttonContainer);\n\t\t//endregion\n\n\t\t//region Author\n\t\tconst authorNode = this.prepareAuthorLayout();\n\t\tif(authorNode)\n\t\t{\n\t\t\tcontentInnerWrapper.appendChild(authorNode);\n\t\t}\n\t\t//endregion\n\n\t\t//region  Actions\n\t\tthis._actionContainer = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail-action\" }\n\t\t\t}\n\t\t);\n\t\tcontentInnerWrapper.appendChild(this._actionContainer);\n\t\t//endregion\n\n\t\treturn wrapper;\n\t}\n\n\tprepareDetailNodes()\n\t{\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Zoom();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import { ConfigurableItem, StreamType } from 'crm.timeline.item';\nimport { DatetimeConverter } from 'crm.timeline.tools';\nimport { bindOnce, Dom, Tag } from 'main.core';\nimport Expand from '../animations/expand';\nimport ItemNew from '../animations/item-new';\nimport Call from '../items/scheduled/call';\nimport CallTracker from '../items/scheduled/call-tracker';\nimport Email from '../items/scheduled/email';\nimport Meeting from '../items/scheduled/meeting';\nimport OpenLine from '../items/scheduled/openline';\nimport Request from '../items/scheduled/request';\nimport Rest from '../items/scheduled/rest';\nimport Task from '../items/scheduled/task';\nimport Wait from '../items/scheduled/wait';\nimport WebForm from '../items/scheduled/webform';\nimport Zoom from '../items/scheduled/zoom';\nimport Stream from '../stream';\n\n/** @memberof BX.Crm.Timeline.Streams */\nexport default class Schedule extends Stream\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._items = [];\n\t\tthis._history = null;\n\t\tthis._wrapper = null;\n\t\tthis._anchor = null;\n\t\tthis._stub = null;\n\t}\n\n\tdoInitialize()\n\t{\n\t\tif(!this.isStubMode())\n\t\t{\n\t\t\tlet itemData = this.getSetting(\"itemData\");\n\t\t\tif(!BX.type.isArray(itemData))\n\t\t\t{\n\t\t\t\titemData = [];\n\t\t\t}\n\n\t\t\tlet i, length, item;\n\t\t\tfor(i = 0, length = itemData.length; i < length; i++)\n\t\t\t{\n\t\t\t\titem = this.createItem(itemData[i]);\n\t\t\t\tif(item)\n\t\t\t\t{\n\t\t\t\t\tthis._items.push(item);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tlayout()\n\t{\n\t\tthis._wrapper = BX.create(\"DIV\", {});\n\t\tthis._container.appendChild(this._wrapper);\n\n\t\tconst label = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: {className: \"crm-entity-stream-planned-label\"},\n\t\t\t\ttext: this.getMessage(\"planned\")\n\t\t\t}\n\t\t);\n\n\t\tconst wrapperClassName = \"crm-entity-stream-section crm-entity-stream-section-planned-label\";\n\t\tthis._wrapper.appendChild(\n\t\t\tBX.create(\"DIV\",\n\t\t\t\t{\n\t\t\t\t\tattrs: { className: wrapperClassName },\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\t\t\t\t\tchildren: [ label ]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tif(this.isStubMode())\n\t\t{\n\t\t\tthis.addStub();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst length = this._items.length;\n\t\t\tif(length === 0)\n\t\t\t{\n\t\t\t\tthis.addStub();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfor(let i = 0; i < length; i++)\n\t\t\t\t{\n\t\t\t\t\tconst item = this._items[i];\n\t\t\t\t\titem.setContainer(this._wrapper);\n\t\t\t\t\titem.layout();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.refreshLayout();\n\t\tthis._manager.processSheduleLayoutChange();\n\t}\n\n\trefreshLayout()\n\t{\n\t\tBX.onCustomEvent('Schedule:onBeforeRefreshLayout', [this]);\n\t\tconst length = this._items.length;\n\t\tif(length === 0)\n\t\t{\n\t\t\tthis.addStub();\n\t\t\tif(this._history && this._history.hasContent())\n\t\t\t{\n\t\t\t\tBX.removeClass(this._stub, \"crm-entity-stream-section-last\");\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBX.addClass(this._stub, \"crm-entity-stream-section-last\");\n\t\t\t}\n\n\t\t\tconst stubIcon = this._stub.querySelector(\".crm-entity-stream-section-icon\");\n\t\t\tif(stubIcon)\n\t\t\t{\n\t\t\t\tif(this._manager.isStubCounterEnabled())\n\t\t\t\t{\n\t\t\t\t\tBX.addClass(stubIcon, \"crm-entity-stream-section-counter\");\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tBX.removeClass(stubIcon, \"crm-entity-stream-section-counter\");\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tlet i, item;\n\t\tif(this._history && this._history.hasContent())\n\t\t{\n\t\t\tfor(i = 0;  i < length; i++)\n\t\t\t{\n\t\t\t\titem = this._items[i];\n\t\t\t\tif(item.isTerminated())\n\t\t\t\t{\n\t\t\t\t\titem.markAsTerminated(false);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(length > 1)\n\t\t\t{\n\t\t\t\tfor(i = 0;  i < (length - 1); i++)\n\t\t\t\t{\n\t\t\t\t\titem = this._items[i];\n\t\t\t\t\tif(item.isTerminated())\n\t\t\t\t\t{\n\t\t\t\t\t\titem.markAsTerminated(false);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._items[length - 1].markAsTerminated(true);\n\t\t}\n\t}\n\n\tformatDateTime(time)\n\t{\n\t\treturn (new DatetimeConverter(time)).toDatetimeString({delimiter: ', '});\n\t}\n\n\tcheckItemForTermination(item)\n\t{\n\t\tif(this._history && this._history.getItemCount() > 0)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\treturn this.getLastItem() === item;\n\t}\n\n\tgetItems(): Array\n\t{\n\t\treturn this._items;\n\t}\n\n\tsetItems(items: Array): void\n\t{\n\t\tthis._items = items;\n\t}\n\n\tcalculateItemIndex(item)\n\t{\n\t\tconst sort = item.getSort();\n\n\t\tfor(let i =0; i < this._items.length; i++)\n\t\t{\n\t\t\tconst curSort = this._items[i].getSort();\n\t\t\tfor (let j = 0; j < curSort.length; j++)\n\t\t\t{\n\t\t\t\tif (sort.length <= j || sort[j] !== curSort[j])\n\t\t\t\t{\n\t\t\t\t\tif (sort[j] < curSort[j])\n\t\t\t\t\t{\n\t\t\t\t\t\treturn i;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this._items.length;\n\t}\n\n\tgetItemCount()\n\t{\n\t\treturn this._items.length;\n\t}\n\n\tgetItemByAssociatedEntity($entityTypeId, entityId)\n\t{\n\t\tif(!BX.type.isNumber($entityTypeId))\n\t\t{\n\t\t\t$entityTypeId = parseInt($entityTypeId);\n\t\t}\n\n\t\tif(!BX.type.isNumber(entityId))\n\t\t{\n\t\t\tentityId = parseInt(entityId);\n\t\t}\n\n\t\tif(isNaN($entityTypeId) || $entityTypeId <= 0 || isNaN(entityId) || entityId <= 0)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tfor(let i = 0, length = this._items.length; i < length; i++)\n\t\t{\n\t\t\tconst item = this._items[i];\n\t\t\tif(item.getAssociatedEntityTypeId() === $entityTypeId && item.getAssociatedEntityId() === entityId)\n\t\t\t{\n\t\t\t\treturn item;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tgetItemByData(itemData)\n\t{\n\t\tif(!BX.type.isPlainObject(itemData))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this.getItemByAssociatedEntity(\n\t\t\tBX.prop.getInteger(itemData, \"ASSOCIATED_ENTITY_TYPE_ID\", 0),\n\t\t\tBX.prop.getInteger(itemData, \"ASSOCIATED_ENTITY_ID\", 0)\n\t\t);\n\t}\n\n\n\tgetItemByIndex(index)\n\t{\n\t\treturn index < this._items.length ? this._items[index] : null;\n\t}\n\n\tcreateItem(data)\n\t{\n\t\tconst entityTypeID = BX.prop.getInteger(data, \"ASSOCIATED_ENTITY_TYPE_ID\", 0);\n\t\tconst entityID = BX.prop.getInteger(data, \"ASSOCIATED_ENTITY_ID\", 0);\n\t\tconst entityData = BX.prop.getObject(data, \"ASSOCIATED_ENTITY\", {});\n\t\tlet itemId = BX.CrmEntityType.resolveName(entityTypeID) + \"_\" + entityID.toString();\n\n\t\tif (data.hasOwnProperty('type'))\n\t\t{\n\t\t\titemId = data.id;\n\n\t\t\treturn ConfigurableItem.create(itemId, {\n\t\t\t\ttimelineId: this.getId(),\n\t\t\t\tcontainer: this.getWrapper(),\n\t\t\t\titemClassName: this.getItemClassName(),\n\t\t\t\tisReadOnly: this.isReadOnly(),\n\t\t\t\tcurrentUser: this._manager.getCurrentUser(),\n\t\t\t\townerTypeId: this._manager.getOwnerTypeId(),\n\t\t\t\townerId: this._manager.getOwnerId(),\n\t\t\t\tstreamType: this.getStreamType(),\n\t\t\t\tdata: data,\n\t\t\t})\n\t\t}\n\n\t\tif(entityTypeID === BX.CrmEntityType.enumeration.wait)\n\t\t{\n\t\t\treturn Wait.create(\n\t\t\t\titemId,\n\t\t\t\t{\n\t\t\t\t\tschedule: this,\n\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\tdata: data\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\telse// if(entityTypeID === BX.CrmEntityType.enumeration.activity)\n\t\t{\n\t\t\tconst typeId = BX.prop.getInteger(entityData, \"TYPE_ID\", 0);\n\t\t\tconst providerId = BX.prop.getString(entityData, \"PROVIDER_ID\", \"\");\n\n\t\t\tif(typeId === BX.CrmActivityType.email)\n\t\t\t{\n\t\t\t\treturn Email.create(\n\t\t\t\t\titemId,\n\t\t\t\t\t{\n\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if(typeId === BX.CrmActivityType.call)\n\t\t\t{\n\t\t\t\treturn Call.create(\n\t\t\t\t\titemId,\n\t\t\t\t\t{\n\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if(typeId === BX.CrmActivityType.meeting)\n\t\t\t{\n\t\t\t\treturn Meeting.create(\n\t\t\t\t\titemId,\n\t\t\t\t\t{\n\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if(typeId === BX.CrmActivityType.task)\n\t\t\t{\n\t\t\t\treturn Task.create(\n\t\t\t\t\titemId,\n\t\t\t\t\t{\n\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if(typeId === BX.CrmActivityType.provider)\n\t\t\t{\n\t\t\t\tif(providerId === \"CRM_WEBFORM\")\n\t\t\t\t{\n\t\t\t\t\treturn WebForm.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(providerId === \"CRM_REQUEST\")\n\t\t\t\t{\n\t\t\t\t\treturn Request.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(providerId === \"IMOPENLINES_SESSION\")\n\t\t\t\t{\n\t\t\t\t\treturn OpenLine.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(providerId === \"ZOOM\")\n\t\t\t\t{\n\t\t\t\t\treturn Zoom.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(providerId === \"REST_APP\")\n\t\t\t\t{\n\t\t\t\t\treturn Rest.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if(providerId === 'CRM_CALL_TRACKER')\n\t\t\t\t{\n\t\t\t\t\treturn CallTracker.create(\n\t\t\t\t\t\titemId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tschedule: this,\n\t\t\t\t\t\t\tcontainer: this._wrapper,\n\t\t\t\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\t\t\t\tdata: data,\n\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetWrapper()\n\t{\n\t\treturn this._wrapper;\n\t}\n\n\tgetItemClassName()\n\t{\n\t\treturn 'crm-entity-stream-section crm-entity-stream-section-planned';\n\t}\n\n\tgetStreamType(): number\n\t{\n\t\treturn StreamType.scheduled;\n\t}\n\n\tasync addItem(item, index)\n\t{\n\t\tif(!BX.type.isNumber(index) || index < 0)\n\t\t{\n\t\t\tindex = this.calculateItemIndex(item);\n\t\t}\n\n\t\tif(index < this._items.length)\n\t\t{\n\t\t\tthis._items.splice(index, 0, item);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._items.push(item);\n\t\t}\n\n\t\tawait this.removeStub();\n\t\tthis.refreshLayout();\n\t\tthis._manager.processSheduleLayoutChange();\n\t}\n\n\tgetHistory()\n\t{\n\t\treturn this._history;\n\t}\n\n\tsetHistory(history)\n\t{\n\t\tthis._history = history;\n\t}\n\n\tcreateAnchor(index)\n\t{\n\t\tthis._anchor = BX.create(\"DIV\", { attrs: { className: \"crm-entity-stream-section crm-entity-stream-section-shadow\" } });\n\t\tif(index >= 0 && index < this._items.length)\n\t\t{\n\t\t\tthis._wrapper.insertBefore(this._anchor, this._items[index].getWrapper());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._wrapper.appendChild(this._anchor);\n\t\t}\n\t\treturn this._anchor;\n\t}\n\n\tdeleteItem(item)\n\t{\n\t\tconst index = this.getItemIndex(item);\n\t\tif(index < 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\titem.clearLayout();\n\t\tthis.removeItemByIndex(index);\n\n\t\tthis.refreshLayout();\n\t\tthis._manager.processSheduleLayoutChange();\n\t}\n\n\ttransferItemToHistory(item, historyItemData)\n\t{\n\t\tconst index = this.getItemIndex(item);\n\t\tif(index < 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.removeItemByIndex(index);\n\n\t\tthis.refreshLayout();\n\t\tthis._manager.processSheduleLayoutChange();\n\n\t\tconst historyItem = this._history.createItem(historyItemData);\n\t\tthis._history.addItem(historyItem, 0);\n\t\thistoryItem.layout({ add: false });\n\n\t\tconst animation = ItemNew.create(\n\t\t\t\"\",\n\t\t\t{\n\t\t\t\tinitialItem: item,\n\t\t\t\tfinalItem: historyItem,\n\t\t\t\tanchor: this._history.createAnchor(),\n\t\t\t\tevents: {complete: BX.delegate(this.onTransferComplete, this)}\n\t\t\t}\n\t\t);\n\t\tanimation.run();\n\t}\n\n\tonTransferComplete()\n\t{\n\t\tthis._history.refreshLayout();\n\n\t\tif(this._items.length === 0)\n\t\t{\n\t\t\tthis.addStub();\n\t\t}\n\t}\n\n\tonItemMarkedAsDone(item, params)\n\t{\n\t}\n\n\taddStub()\n\t{\n\t\tif(!this._stub)\n\t\t{\n\t\t\tconst canAddTodo = !!BX.Crm.Timeline?.MenuBar?.getDefault()?.getItemById('todo');\n\n\t\t\tthis.createStub();\n\t\t\tif (canAddTodo && !this.isReadOnly())\n\t\t\t{\n\t\t\t\tBX.bind(this._stub, \"click\", BX.delegate(this.focusOnTodoEditor, this));\n\t\t\t}\n\n\t\t\tconst label = this._wrapper.querySelector('.crm-entity-stream-section.crm-entity-stream-section-planned-label');\n\n\t\t\tDom.style(this._stub, {\n\t\t\t\topacity: 0,\n\t\t\t\toverflow: 'hidden',\n\t\t\t});\n\n\t\t\tDom.insertAfter(this._stub, label);\n\n\t\t\tconst height = Dom.getPosition(this._stub).height;\n\n\t\t\tDom.style(this._stub, {\n\t\t\t\theight: 0,\n\t\t\t\tmarginBottom: 0,\n\t\t\t});\n\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tDom.style(this._stub, {\n\t\t\t\t\topacity: 1,\n\t\t\t\t\theight: height ? `${height}px` : null,\n\t\t\t\t\tmarginBottom: '15px',\n\t\t\t\t\toverflow: null,\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tif(this._history && this._history.getItemCount() > 0)\n\t\t{\n\t\t\tBX.removeClass(this._stub, \"crm-entity-stream-section-last\");\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.addClass(this._stub, \"crm-entity-stream-section-last\");\n\t\t}\n\t}\n\n\tcreateStub(): HTMLELement\n\t{\n\t\tlet stubClassName = \"crm-entity-stream-section crm-entity-stream-section-planned crm-entity-stream-section-notTask\";\n\t\tlet stubIconClassName = \"crm-entity-stream-section-icon crm-entity-stream-section-icon-info\";\n\t\tconst canAddTodo = !!BX.Crm.Timeline?.MenuBar?.getDefault()?.getItemById('todo');\n\t\tif (canAddTodo && !this.isReadOnly())\n\t\t{\n\t\t\tstubClassName += ' --active';\n\t\t}\n\n\t\tlet stubMessage = this.getMessage(\"stub\");\n\n\t\tconst ownerTypeId = this._manager.getOwnerTypeId();\n\t\tif(ownerTypeId === BX.CrmEntityType.enumeration.lead)\n\t\t{\n\t\t\tstubMessage = this.getMessage(\"leadStub\");\n\t\t}\n\t\telse if(ownerTypeId === BX.CrmEntityType.enumeration.deal)\n\t\t{\n\t\t\tstubMessage = this.getMessage(\"dealStub\");\n\t\t}\n\n\t\tif(this._manager.isStubCounterEnabled())\n\t\t{\n\t\t\tstubIconClassName += \" crm-entity-stream-section-counter\";\n\t\t}\n\n\t\tthis._stub = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs: { className: stubClassName },\n\t\t\t\tchildren:\n\t\t\t\t\t[\n\t\t\t\t\t\tBX.create(\"DIV\", { attrs: { className: stubIconClassName } }),\n\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-section-content\" },\n\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-event\" },\n\t\t\t\t\t\t\t\t\t\t\t\tchildren:\n\t\t\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-title\" },\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: this.getMessage(\"stubTitle\"),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tBX.create(\"DIV\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: { className: \"crm-entity-stream-content-detail\" },\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext: stubMessage\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t}\n\t\t);\n\t}\n\n\tremoveStub(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst isStubVisible = Dom.getPosition(this._stub).height !== 0;\n\n\t\t\tif (this._stub && isStubVisible)\n\t\t\t{\n\t\t\t\tconst overlay = Tag.render`<div class=\"crm-entity-stream-section-content-overlay\"></div>`;\n\n\t\t\t\tDom.style(overlay, 'opacity', 0);\n\n\t\t\t\tbindOnce(overlay, 'transitionend', () => {\n\t\t\t\t\tDom.style(this._stub, 'position', 'absolute');\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tDom.remove(this._stub);\n\t\t\t\t\t\tthis._stub = null;\n\t\t\t\t\t}, 200);\n\t\t\t\t\tresolve(true);\n\t\t\t\t});\n\n\t\t\t\tconst stubContent = this._stub.querySelector('.crm-entity-stream-section-content');\n\n\t\t\t\tDom.append(overlay, stubContent);\n\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tDom.style(overlay, 'opacity', 1);\n\t\t\t\t}, 50);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.remove(this._stub);\n\t\t\t\tthis._stub = null;\n\t\t\t\tresolve(true);\n\t\t\t}\n\t\t});\n\t}\n\n\tfocusOnTodoEditor()\n\t{\n\t\tconst menuBar = BX.Crm.Timeline.MenuBar.getDefault();\n\t\tif (menuBar)\n\t\t{\n\t\t\tmenuBar.setActiveItemById('todo');\n\n\t\t\tconst todoEditor = menuBar.getItemById('todo');\n\t\t\ttodoEditor?.focus();\n\t\t}\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = Schedule.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tanimateItemAdding(item): Promise\n\t{\n\t\tif (this._stub)\n\t\t{\n\t\t\tconst newBLockStartHeight = this._stub ? this._stub.offsetHeight : 73;\n\n\t\t\tconst wrapper = item instanceof ConfigurableItem\n\t\t\t\t? item.getLayoutComponent().$refs.timelineCard\n\t\t\t\t: item.getWrapper();\n\n\t\t\treturn new Promise((resolve) => {\n\t\t\t\tExpand.create(\n\t\t\t\t\twrapper,\n\t\t\t\t\tresolve,\n\t\t\t\t\t{ startHeight: newBLockStartHeight },\n\t\t\t\t).run();\n\t\t\t});\n\t\t}\n\n\t\treturn new Promise((resolve) => {\n\t\t\tExpand.create(item.getWrapper(), resolve, {}).run();\n\t\t});\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Schedule();\n\t\tself.initialize(id, settings);\n\t\tSchedule.items[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic items = {};\n\tstatic messages = {};\n}\n","/** @memberof BX.Crm.Timeline.Tools */\nexport default class AudioPlaybackRateSelector\n{\n\tconstructor(params)\n\t{\n\t\tthis.name = params.name || 'crm-timeline-audio-playback-rate-selector';\n\t\tthis.menuId = this.name + '-menu';\n\t\tif(BX.Type.isArray(params.availableRates))\n\t\t{\n\t\t\tthis.availableRates = params.availableRates;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.availableRates = [1, 1.5, 2, 3];\n\t\t}\n\t\tthis.currentRate = this.normalizeRate(params.currentRate);\n\t\tthis.textMessageCode = params.textMessageCode;\n\t\tthis.renderedItems = [];\n\t\tthis.players = [];\n\t}\n\n\tisRateCurrent(rateDescription, rate)\n\t{\n\t\treturn ((rateDescription.rate && rate === rateDescription.rate) || rate === rateDescription);\n\t}\n\n\tnormalizeRate(rate)\n\t{\n\t\trate = parseFloat(rate);\n\t\tlet i = 0;\n\t\tconst length = this.availableRates.length;\n\t\tfor(; i < length; i++)\n\t\t{\n\t\t\tif(this.isRateCurrent(this.availableRates[i], rate))\n\t\t\t{\n\t\t\t\treturn rate;\n\t\t\t}\n\t\t}\n\n\t\treturn (this.availableRates[0].rate || this.availableRates[0]);\n\t}\n\n\tgetMenuItems()\n\t{\n\t\tconst selectedRate = this.getRate();\n\n\t\treturn this.availableRates.map(function(item) {\n\t\t\treturn {\n\t\t\t\ttext: (item.text || item) + '',\n\t\t\t\thtml: (item.html || item) + '',\n\t\t\t\tclassName: (this.isRateCurrent(item, selectedRate)) ? 'menu-popup-item-text-active' : null,\n\t\t\t\tonclick: function() {\n\t\t\t\t\tthis.setRate(item.rate || item)\n\t\t\t\t}.bind(this)\n\t\t\t}\n\t\t}.bind(this))\n\t}\n\n\tgetPopup(node)\n\t{\n\t\tlet popupMenu = BX.Main.MenuManager.getMenuById(this.menuId);\n\t\tif(popupMenu)\n\t\t{\n\t\t\tconst popupWindow = popupMenu.getPopupWindow();\n\t\t\tif (popupWindow)\n\t\t\t{\n\t\t\t\tpopupWindow.setBindElement(node);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tpopupMenu = BX.Main.MenuManager.create({\n\t\t\t\tid: this.menuId,\n\t\t\t\tbindElement: node,\n\t\t\t\titems: this.getMenuItems(),\n\t\t\t\tclassName: 'crm-audio-cap-speed-popup'\n\t\t\t});\n\t\t}\n\n\t\treturn popupMenu;\n\t}\n\n\tgetRate()\n\t{\n\t\treturn this.normalizeRate(this.currentRate);\n\t}\n\n\tsetRate(rate)\n\t{\n\t\tthis.getPopup().destroy();\n\n\t\trate = this.normalizeRate(rate);\n\t\tif(this.currentRate === rate)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.currentRate = rate;\n\t\tBX.userOptions.save(\"crm\", this.name, 'rate', rate);\n\n\t\tfor(let i = 0, length = this.renderedItems.length; i < length; i++)\n\t\t{\n\t\t\tconst textNode = this.renderedItems[i].querySelector('.crm-audio-cap-speed-text');\n\t\t\tif(textNode)\n\t\t\t{\n\t\t\t\ttextNode.innerHTML = this.getText();\n\t\t\t}\n\t\t}\n\n\t\tfor(let i = 0, length = this.players.length; i < length; i++)\n\t\t{\n\t\t\tthis.players[i].vjsPlayer.playbackRate(this.getRate());\n\t\t}\n\t}\n\n\tgetText()\n\t{\n\t\tlet text;\n\n\t\tif(this.textMessageCode)\n\t\t{\n\t\t\ttext = BX.Loc.getMessage(this.textMessageCode);\n\t\t}\n\t\tif(!text)\n\t\t{\n\t\t\ttext = '#RATE#';\n\t\t}\n\n\t\treturn text.replace('#RATE#', '<span>' + this.getRate() + 'x</span>');\n\t}\n\n\trender()\n\t{\n\t\tconst item = BX.Dom.create('div', {\n\t\t\tattrs: {\n\t\t\t\tclassName: 'crm-audio-cap-speed-wrapper'\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tBX.Dom.create('div', {\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tclassName: 'crm-audio-cap-speed',\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.Dom.create('div', {\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\tclassName: 'crm-audio-cap-speed-text'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\thtml: this.getText()\n\t\t\t\t\t\t})\n\t\t\t\t\t],\n\t\t\t\t})\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\tclick: function (event) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tthis.getPopup(event.target).show()\n\t\t\t\t}.bind(this)\n\t\t\t}\n\t\t});\n\t\tthis.renderedItems.push(item);\n\n\t\treturn item;\n\t}\n\n\taddPlayer(player)\n\t{\n\t\tif(BX.Fileman.Player && player instanceof BX.Fileman.Player)\n\t\t{\n\t\t\tthis.players.push(player);\n\t\t}\n\t}\n}\n","/* eslint-disable */\n\nimport { Item } from 'crm.timeline.item';\nimport Expand from './animations/expand';\nimport Scheduled from './items/scheduled';\nimport PullActionProcessor from './pull-action-processor';\nimport EntityChat from './streams/entitychat';\nimport FixedHistory from './streams/fixedhistory';\nimport History from './streams/history';\nimport Schedule from './streams/schedule';\nimport AudioPlaybackRateSelector from './tools/audio-playback-rate-selector';\n\n/** @memberof BX.Crm.Timeline */\nexport default class Manager\n{\n\t#itemPullActionProcessor: PullActionProcessor = null;\n\n\tconstructor()\n\t{\n\t\tthis._id = \"\";\n\t\tthis._settings = {};\n\t\tthis._container = null;\n\t\tthis._ownerTypeId = 0;\n\t\tthis._ownerId = 0;\n\t\tthis._ownerInfo = null;\n\t\tthis._progressSemantics = \"\";\n\n\t\tthis._chat = null;\n\t\tthis._schedule = null;\n\t\tthis._history = null;\n\t\tthis._fixedHistory = null;\n\t\tthis._activityEditor = null;\n\n\t\tthis._userId = 0;\n\t\tthis._readOnly = false;\n\t\tthis._currentUser = null;\n\t\tthis._pingSettings = null;\n\t\tthis._calendarSettings = null;\n\t\tthis._colorSettings = null;\n\t\tthis._pullTagName = \"\";\n\t}\n\n\tinitialize(id, settings)\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t\tthis._settings = settings ? settings : {};\n\n\t\tthis._ownerTypeId = parseInt(this.getSetting(\"ownerTypeId\"));\n\t\tthis._ownerId = parseInt(this.getSetting(\"ownerId\"));\n\t\tthis._ownerInfo = this.getSetting(\"ownerInfo\");\n\t\tthis._progressSemantics = BX.prop.getString(this._settings, \"progressSemantics\", \"\");\n\t\tthis._spotlightFastenShowed = this.getSetting(\"spotlightFastenShowed\", true);\n\t\tthis._audioPlaybackRate = parseFloat(this.getSetting(\"audioPlaybackRate\", 1));\n\t\tconst containerId = this.getSetting(\"containerId\");\n\t\tif (!BX.type.isNotEmptyString(containerId))\n\t\t{\n\t\t\tthrow \"Manager. A required parameter 'containerId' is missing.\";\n\t\t}\n\n\t\tthis._container = BX(containerId);\n\t\tif (!BX.type.isElementNode(this._container))\n\t\t{\n\t\t\tthrow \"Manager. Container node is not found.\";\n\t\t}\n\t\tthis._editorContainer = BX(this.getSetting(\"editorContainer\"));\n\n\t\tthis._userId = BX.prop.getInteger(this._settings, \"userId\", 0);\n\t\tthis._readOnly = BX.prop.getBoolean(this._settings, \"readOnly\", false);\n\t\tthis._currentUser = BX.prop.getObject(this._settings, \"currentUser\", null);\n\t\tthis._pingSettings = BX.prop.getObject(this._settings, \"pingSettings\", null);\n\t\tthis._calendarSettings = BX.prop.getObject(this._settings, \"calendarSettings\", null);\n\t\tthis._colorSettings = BX.prop.getObject(this._settings, \"colorSettings\", null);\n\n\t\tconst activityEditorId = this.getSetting(\"activityEditorId\");\n\t\tif (BX.type.isNotEmptyString(activityEditorId))\n\t\t{\n\t\t\tthis._activityEditor = BX.CrmActivityEditor.items[activityEditorId];\n\t\t\tif (!(this._activityEditor instanceof BX.CrmActivityEditor))\n\t\t\t{\n\t\t\t\tthrow \"BX.CrmTimeline. Activity editor instance is not found.\";\n\t\t\t}\n\t\t}\n\n\t\tconst ajaxId = this.getSetting(\"ajaxId\");\n\t\tconst currentUrl = this.getSetting(\"currentUrl\");\n\t\tconst serviceUrl = this.getSetting(\"serviceUrl\");\n\n\t\tthis._chat = EntityChat.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tmanager: this,\n\t\t\t\tcontainer: this._container,\n\t\t\t\tdata: this.getSetting(\"chatData\"),\n\t\t\t\tisStubMode: this._ownerId <= 0,\n\t\t\t\treadOnly: this._readOnly\n\t\t\t}\n\t\t);\n\n\t\tthis._schedule = Schedule.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tmanager: this,\n\t\t\t\tcontainer: this._container,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\titemData: this.getSetting(\"scheduleData\"),\n\t\t\t\ttemplates: this.getSetting(\"templates\"),\n\t\t\t\tisStubMode: this._ownerId <= 0,\n\t\t\t\tajaxId: ajaxId,\n\t\t\t\tserviceUrl: serviceUrl,\n\t\t\t\tcurrentUrl: currentUrl,\n\t\t\t\tuserId: this._userId,\n\t\t\t\treadOnly: this._readOnly\n\t\t\t}\n\t\t);\n\n\t\tthis._fixedHistory = FixedHistory.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tmanager: this,\n\t\t\t\tcontainer: this._container,\n\t\t\t\teditorContainer: this._editorContainer,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\titemData: this.getSetting(\"fixedData\"),\n\t\t\t\ttemplates: this.getSetting(\"templates\"),\n\t\t\t\tisStubMode: this._ownerId <= 0,\n\t\t\t\tajaxId: ajaxId,\n\t\t\t\tserviceUrl: serviceUrl,\n\t\t\t\tcurrentUrl: currentUrl,\n\t\t\t\tuserId: this._userId,\n\t\t\t\treadOnly: this._readOnly\n\t\t\t}\n\t\t);\n\n\t\tthis._history = History.create(\n\t\t\tthis._id,\n\t\t\t{\n\t\t\t\tmanager: this,\n\t\t\t\tcontainer: this._container,\n\t\t\t\tfixedHistory: this._fixedHistory,\n\t\t\t\tactivityEditor: this._activityEditor,\n\t\t\t\titemData: this.getSetting(\"historyData\"),\n\t\t\t\ttemplates: this.getSetting(\"templates\"),\n\t\t\t\tnavigation: this.getSetting(\"historyNavigation\", {}),\n\t\t\t\tfilterId: BX.prop.getString(this._settings, \"historyFilterId\", this._id),\n\t\t\t\tisFilterApplied: BX.prop.getBoolean(this._settings, \"isHistoryFilterApplied\", false),\n\t\t\t\tisStubMode: this._ownerId <= 0,\n\t\t\t\tajaxId: ajaxId,\n\t\t\t\tserviceUrl: serviceUrl,\n\t\t\t\tcurrentUrl: currentUrl,\n\t\t\t\tuserId: this._userId,\n\t\t\t\treadOnly: this._readOnly\n\t\t\t}\n\t\t);\n\t\tthis._schedule.setHistory(this._history);\n\t\tthis._fixedHistory.setHistory(this._history);\n\n\t\tthis._chat.layout();\n\t\tthis._schedule.layout();\n\t\tthis._fixedHistory.layout();\n\t\tthis._history.layout();\n\n\t\tthis._pullTagName = BX.prop.getString(this._settings, \"pullTagName\", \"\");\n\t\tif (this._pullTagName !== \"\")\n\t\t{\n\t\t\tBX.addCustomEvent(\"onPullEvent-crm\", BX.delegate(this.onPullEvent, this));\n\t\t\tthis.extendWatch();\n\t\t\tthis.#itemPullActionProcessor = new PullActionProcessor({\n\t\t\t\tscheduleStream: this._schedule,\n\t\t\t\tfixedHistoryStream: this._fixedHistory,\n\t\t\t\thistoryStream: this._history,\n\t\t\t\townerTypeId: this._ownerTypeId,\n\t\t\t\townerId: this._ownerId,\n\t\t\t\tuserId: this._userId,\n\t\t\t});\n\t\t}\n\n\t\tBX.addCustomEvent(window, \"Crm.EntityProgress.Change\", BX.delegate(this.onEntityProgressChange, this));\n\t\tBX.ready(function () {\n\t\t\twindow.addEventListener(\"scroll\", BX.throttle(function () {\n\t\t\t\tBX.LazyLoad.onScroll();\n\t\t\t}, 80));\n\t\t});\n\t}\n\n\textendWatch()\n\t{\n\t\tif (BX.type.isFunction(BX.PULL) && this._pullTagName !== \"\")\n\t\t{\n\t\t\tBX.PULL.extendWatch(this._pullTagName);\n\t\t\twindow.setTimeout(BX.delegate(this.extendWatch, this), 60000);\n\t\t}\n\t}\n\n\tonPullEvent(command, params)\n\t{\n\t\tif (this._pullTagName !== BX.prop.getString(params, \"TAG\", \"\"))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (command === 'timeline_item_action')\n\t\t{\n\t\t\tthis.#itemPullActionProcessor.processAction(params);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (command === \"timeline_chat_create\")\n\t\t{\n\t\t\tthis.processChatCreate(params);\n\t\t}\n\t\telse if (command === \"timeline_activity_add\")\n\t\t{\n\t\t\tthis.processActivityExternalAdd(params);\n\t\t}\n\t\telse if (command === \"timeline_activity_update\")\n\t\t{\n\t\t\tthis.processActivityExternalUpdate(params);\n\t\t}\n\t\telse if (command === \"timeline_activity_delete\")\n\t\t{\n\t\t\tthis.processActivityExternalDelete(params);\n\t\t}\n\t\telse if (command === \"timeline_comment_add\")\n\t\t{\n\t\t\tthis.processCommentExternalAdd(params);\n\t\t}\n\t\telse if (command === \"timeline_comment_update\")\n\t\t{\n\t\t\tthis.processCommentExternalUpdate(params);\n\t\t}\n\t\telse if (command === \"timeline_comment_delete\")\n\t\t{\n\t\t\tthis.processCommentExternalDelete(params);\n\t\t}\n\t\telse if (command === \"timeline_changed_binding\")\n\t\t{\n\t\t\tthis.processChangeBinding(params);\n\t\t}\n\t\telse if (command === \"timeline_item_update\")\n\t\t{\n\t\t\tthis.processItemExternalUpdate(params);\n\t\t}\n\t\telse if (command === \"timeline_wait_add\")\n\t\t{\n\t\t\tthis.processWaitExternalAdd(params);\n\t\t}\n\t\telse if (command === \"timeline_wait_update\")\n\t\t{\n\t\t\tthis.processWaitExternalUpdate(params);\n\t\t}\n\t\telse if (command === \"timeline_wait_delete\")\n\t\t{\n\t\t\tthis.processWaitExternalDelete(params);\n\t\t}\n\t\telse if (command === \"timeline_bizproc_status\")\n\t\t{\n\t\t\tthis.processBizprocStatus(params);\n\t\t}\n\t\telse if (command === \"timeline_scoring_add\")\n\t\t{\n\t\t\tthis.processScoringExternalAdd(params);\n\t\t}\n\t}\n\n\tprocessChatCreate(params)\n\t{\n\t\tif (this._chat)\n\t\t{\n\t\t\tthis._chat.setData(BX.prop.getObject(params, \"CHAT_DATA\", {}));\n\t\t\tthis._chat.refreshLayout();\n\t\t}\n\t}\n\n\tprocessActivityExternalAdd(params)\n\t{\n\t\tlet entityData, scheduleItemData, historyItemData, scheduleItem, historyItem;\n\n\t\tentityData = BX.prop.getObject(params, \"ENTITY\", null);\n\t\tscheduleItemData = BX.prop.getObject(params, \"SCHEDULE_ITEM\", null);\n\t\thistoryItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\n\n\t\tif (entityData && historyItemData && !BX.type.isPlainObject(historyItemData[\"ASSOCIATED_ENTITY\"]))\n\t\t{\n\t\t\thistoryItemData[\"ASSOCIATED_ENTITY\"] = entityData;\n\t\t}\n\n\t\tif (scheduleItemData !== null && this._schedule.getItemByData(scheduleItemData) === null)\n\t\t{\n\t\t\tscheduleItem = this.addScheduleItem(scheduleItemData);\n\t\t\tscheduleItem.addWrapperClass(\"crm-entity-stream-section-updated\", 1000);\n\t\t}\n\n\t\tif (historyItemData !== null)\n\t\t{\n\t\t\thistoryItem = this._history.findItemById(BX.prop.getString(historyItemData, \"ID\"));\n\t\t\tif (!historyItem)\n\t\t\t{\n\t\t\t\thistoryItem = this.addHistoryItem(historyItemData);\n\t\t\t\tExpand.create(historyItem.getWrapper(), null).run();\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessActivityExternalUpdate(params)\n\t{\n\t\tlet entityData, scheduleItemData, scheduleItem, historyItemData, historyItem, fixedHistoryItem;\n\n\t\tentityData = BX.prop.getObject(params, \"ENTITY\", null);\n\t\tscheduleItemData = BX.prop.getObject(params, \"SCHEDULE_ITEM\", null);\n\t\thistoryItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\n\t\tif (entityData)\n\t\t{\n\t\t\tif (historyItemData && !BX.type.isPlainObject(historyItemData[\"ASSOCIATED_ENTITY\"]))\n\t\t\t{\n\t\t\t\thistoryItemData[\"ASSOCIATED_ENTITY\"] = entityData;\n\t\t\t}\n\n\t\t\tconst entityId = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\t\tconst historyItems = this._history.getItemsByAssociatedEntity(BX.CrmEntityType.enumeration.activity, entityId);\n\t\t\tfor (let i = 0, length = historyItems.length; i < length; i++)\n\t\t\t{\n\t\t\t\thistoryItem = historyItems[i];\n\t\t\t\thistoryItem.setAssociatedEntityData(entityData);\n\t\t\t\thistoryItem.refreshLayout();\n\t\t\t}\n\t\t\tconst fixedHistoryItems = this._fixedHistory.getItemsByAssociatedEntity(BX.CrmEntityType.enumeration.activity, entityId);\n\t\t\tfor (let i = 0, length = fixedHistoryItems.length; i < length; i++)\n\t\t\t{\n\t\t\t\tfixedHistoryItem = fixedHistoryItems[i];\n\t\t\t\tfixedHistoryItem.setAssociatedEntityData(entityData);\n\t\t\t\tfixedHistoryItem.refreshLayout();\n\t\t\t}\n\t\t}\n\n\t\tif (scheduleItemData !== null)\n\t\t{\n\t\t\tscheduleItem = this._schedule.getItemByAssociatedEntity(\n\t\t\t\tBX.CrmEntityType.enumeration.activity,\n\t\t\t\tBX.prop.getInteger(scheduleItemData, \"ASSOCIATED_ENTITY_ID\")\n\t\t\t);\n\n\t\t\tif (scheduleItem)\n\t\t\t{\n\t\t\t\tscheduleItem.setData(scheduleItemData);\n\t\t\t\tif (!scheduleItem.isDone())\n\t\t\t\t{\n\t\t\t\t\tthis._schedule.refreshItem(scheduleItem);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (historyItemData)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._schedule.transferItemToHistory(\n\t\t\t\t\t\t\tscheduleItem,\n\t\t\t\t\t\t\thistoryItemData\n\t\t\t\t\t\t);\n\t\t\t\t\t\t//History data are already processed\n\t\t\t\t\t\thistoryItemData = null;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._schedule.deleteItem(scheduleItem);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (!Scheduled.isDone(scheduleItemData))\n\t\t\t{\n\t\t\t\tscheduleItem = this.addScheduleItem(scheduleItemData);\n\t\t\t\tscheduleItem.addWrapperClass(\"crm-entity-stream-section-updated\", 1000);\n\t\t\t}\n\t\t}\n\n\t\tif (historyItemData !== null)\n\t\t{\n\t\t\thistoryItem = this._history.findItemById(BX.prop.getString(historyItemData, \"ID\"));\n\t\t\tif (!historyItem)\n\t\t\t{\n\t\t\t\thistoryItem = this.addHistoryItem(historyItemData);\n\t\t\t\tExpand.create(historyItem.getWrapper(), null).run();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\thistoryItem.setData(historyItemData);\n\t\t\t\thistoryItem.refreshLayout();\n\t\t\t\tfixedHistoryItem = this._fixedHistory.findItemById(BX.prop.getString(historyItemData, \"ID\"));\n\t\t\t\tif (fixedHistoryItem)\n\t\t\t\t{\n\t\t\t\t\tfixedHistoryItem.setData(historyItemData);\n\t\t\t\t\tfixedHistoryItem.refreshLayout()\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessActivityExternalDelete(params)\n\t{\n\t\tconst entityId = BX.prop.getInteger(params, \"ENTITY_ID\", 0);\n\t\tconst historyItems = this._history.getItemsByAssociatedEntity(BX.CrmEntityType.enumeration.activity, entityId);\n\t\tfor (let i = 0, length = historyItems.length; i < length; i++)\n\t\t{\n\t\t\tthis._history.deleteItem(historyItems[i]);\n\t\t}\n\n\t\tconst fixedHistoryItems = this._fixedHistory.getItemsByAssociatedEntity(BX.CrmEntityType.enumeration.activity, entityId);\n\t\tfor (let i = 0, length = fixedHistoryItems.length; i < length; i++)\n\t\t{\n\t\t\tthis._fixedHistory.deleteItem(fixedHistoryItems[i]);\n\t\t}\n\n\t\tconst scheduleItem = this._schedule.getItemByAssociatedEntity(BX.CrmEntityType.enumeration.activity, entityId);\n\t\tif (scheduleItem)\n\t\t{\n\t\t\tthis._schedule.deleteItem(scheduleItem);\n\t\t}\n\t}\n\n\tprocessCommentExternalAdd(params)\n\t{\n\t\tlet historyItemData, historyItem;\n\t\thistoryItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\t\tif (historyItemData !== null)\n\t\t{\n\t\t\twindow.setTimeout(\n\t\t\t\tBX.delegate(function () {\n\t\t\t\t\tif (!this._history.findItemById(historyItemData['ID']))\n\t\t\t\t\t{\n\t\t\t\t\t\thistoryItem = this.addHistoryItem(historyItemData);\n\t\t\t\t\t\tExpand.create(historyItem.getWrapper(), null).run();\n\t\t\t\t\t}\n\t\t\t\t}, this),\n\t\t\t\t1500\n\t\t\t);\n\t\t}\n\t}\n\n\tprocessCommentExternalUpdate(params)\n\t{\n\t\tconst entityId = BX.prop.getInteger(params, \"ENTITY_ID\", 0);\n\t\tconst historyItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\t\tconst updateItem = this._history.findItemById(entityId);\n\t\tif (updateItem instanceof Comment && historyItemData !== null)\n\t\t{\n\t\t\tupdateItem.setData(historyItemData);\n\t\t\tupdateItem.switchToViewMode();\n\t\t}\n\t\tconst updateFixedItem = this._fixedHistory.findItemById(entityId);\n\t\tif (updateFixedItem instanceof Comment && historyItemData !== null)\n\t\t{\n\t\t\tupdateFixedItem.setData(historyItemData);\n\t\t\tupdateFixedItem.switchToViewMode();\n\t\t}\n\t}\n\n\tprocessCommentExternalDelete(params)\n\t{\n\t\tconst entityId = BX.prop.getInteger(params, \"ENTITY_ID\", 0);\n\t\twindow.setTimeout(\n\t\t\tBX.delegate(function () {\n\t\t\t\tconst deleteItem = this._history.findItemById(entityId);\n\t\t\t\tif (deleteItem instanceof Comment)\n\t\t\t\t{\n\t\t\t\t\tthis._history.deleteItem(deleteItem);\n\t\t\t\t}\n\t\t\t\tconst deleteFixedItem = this._fixedHistory.findItemById(entityId);\n\t\t\t\tif (deleteFixedItem instanceof Comment)\n\t\t\t\t{\n\t\t\t\t\tthis._fixedHistory.deleteItem(deleteFixedItem);\n\t\t\t\t}\n\t\t\t}, this),\n\t\t\t1200\n\t\t);\n\t}\n\n\tprocessChangeBinding(params)\n\t{\n\t\tconst entityId = BX.prop.getString(params, \"OLD_ID\", 0);\n\t\tconst entityNewId = BX.prop.getString(params, \"NEW_ID\", 0);\n\t\tconst item = this._history.findItemById(entityId);\n\t\tif (item instanceof Item)\n\t\t{\n\t\t\titem._id = entityNewId;\n\t\t\tconst itemData = item.getData();\n\t\t\titemData.ID = entityNewId;\n\t\t\titem.setData(itemData);\n\t\t}\n\n\t\tconst fixedItem = this._fixedHistory.findItemById(entityId);\n\t\tif (fixedItem instanceof Item)\n\t\t{\n\t\t\tfixedItem._id = entityNewId;\n\t\t\tconst fixedItemData = fixedItem.getData();\n\t\t\tfixedItemData.ID = entityNewId;\n\t\t\tfixedItem.setData(fixedItemData);\n\t\t}\n\t}\n\n\tprocessItemExternalUpdate(params)\n\t{\n\t\tconst entityId = BX.prop.getInteger(params, \"ENTITY_ID\", 0);\n\t\tconst historyItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\t\tconst historyItem = this._history.findItemById(entityId);\n\t\tif (historyItem && historyItemData !== null)\n\t\t{\n\t\t\thistoryItem.setData(historyItemData);\n\t\t\thistoryItem.markAsTerminated(this._history.checkItemForTermination(historyItem));\n\t\t\thistoryItem.refreshLayout();\n\t\t\tif (historyItem.isTerminated())\n\t\t\t{\n\t\t\t\tBX.addClass(historyItem._wrapper, \"crm-entity-stream-section-last\");\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessWaitExternalAdd(params)\n\t{\n\t\tconst scheduleItemData = BX.prop.getObject(params, \"SCHEDULE_ITEM\", null);\n\t\tif (scheduleItemData !== null)\n\t\t{\n\t\t\tthis.addScheduleItem(scheduleItemData);\n\t\t}\n\t}\n\n\tprocessWaitExternalUpdate(params)\n\t{\n\t\tlet entityData, scheduleItemData, scheduleItem, historyItemData, historyItem;\n\n\t\tentityData = BX.prop.getObject(params, \"ENTITY\", null);\n\t\tscheduleItemData = BX.prop.getObject(params, \"SCHEDULE_ITEM\", null);\n\t\thistoryItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\n\t\tif (entityData)\n\t\t{\n\t\t\tif (historyItemData && !BX.type.isPlainObject(historyItemData[\"ASSOCIATED_ENTITY\"]))\n\t\t\t{\n\t\t\t\thistoryItemData[\"ASSOCIATED_ENTITY\"] = entityData;\n\t\t\t}\n\n\t\t\tconst entityId = BX.prop.getInteger(entityData, \"ID\", 0);\n\t\t\tconst historyItems = this._history.getItemsByAssociatedEntity(BX.CrmEntityType.enumeration.wait, entityId);\n\t\t\tlet i = 0;\n\t\t\tconst length = historyItems.length;\n\t\t\tfor (; i < length; i++)\n\t\t\t{\n\t\t\t\thistoryItem = historyItems[i];\n\t\t\t\thistoryItem.setAssociatedEntityData(entityData);\n\t\t\t\thistoryItem.refreshLayout();\n\t\t\t}\n\t\t}\n\n\t\tif (scheduleItemData !== null)\n\t\t{\n\t\t\tscheduleItem = this._schedule.getItemByAssociatedEntity(\n\t\t\t\tBX.CrmEntityType.enumeration.wait,\n\t\t\t\tBX.prop.getInteger(scheduleItemData, \"ASSOCIATED_ENTITY_ID\")\n\t\t\t);\n\t\t\tif (!scheduleItem)\n\t\t\t{\n\t\t\t\tthis.addScheduleItem(scheduleItemData);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tscheduleItem.setData(scheduleItemData);\n\t\t\t\tif (!scheduleItem.isDone())\n\t\t\t\t{\n\t\t\t\t\tthis._schedule.refreshItem(scheduleItem);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (historyItemData)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._schedule.transferItemToHistory(\n\t\t\t\t\t\t\tscheduleItem,\n\t\t\t\t\t\t\thistoryItemData\n\t\t\t\t\t\t);\n\t\t\t\t\t\t//History data are already processed\n\t\t\t\t\t\thistoryItemData = null;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._schedule.deleteItem(scheduleItem);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (historyItemData !== null)\n\t\t{\n\t\t\thistoryItem = this._history.findItemById(BX.prop.getString(historyItemData, \"ID\"));\n\t\t\tif (!historyItem)\n\t\t\t{\n\t\t\t\thistoryItem = this.addHistoryItem(historyItemData);\n\t\t\t\tExpand.create(historyItem.getWrapper(), null).run();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\thistoryItem.setData(historyItemData);\n\t\t\t\thistoryItem.refreshLayout();\n\t\t\t}\n\t\t}\n\t}\n\n\tprocessWaitExternalDelete(params)\n\t{\n\t\tconst entityId = BX.prop.getInteger(params, \"ENTITY_ID\", 0);\n\t\tconst historyItems = this._history.getItemsByAssociatedEntity(BX.CrmEntityType.enumeration.wait, entityId);\n\t\tlet i = 0;\n\t\tconst length = historyItems.length;\n\t\tfor (; i < length; i++)\n\t\t{\n\t\t\tthis._history.deleteItem(historyItems[i]);\n\t\t}\n\n\t\tconst scheduleItem = this._schedule.getItemByAssociatedEntity(BX.CrmEntityType.enumeration.wait, entityId);\n\t\tif (scheduleItem)\n\t\t{\n\t\t\tthis._schedule.deleteItem(scheduleItem);\n\t\t}\n\t}\n\n\tprocessBizprocStatus(params)\n\t{\n\t\tlet historyItemData, historyItem;\n\n\t\thistoryItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\n\t\tif (historyItemData !== null)\n\t\t{\n\t\t\thistoryItem = this.addHistoryItem(historyItemData);\n\t\t\tExpand.create(historyItem.getWrapper(), null).run();\n\t\t}\n\t}\n\n\tprocessScoringExternalAdd(params)\n\t{\n\t\tlet historyItemData, historyItem;\n\t\thistoryItemData = BX.prop.getObject(params, \"HISTORY_ITEM\", null);\n\t\tif (historyItemData !== null)\n\t\t{\n\t\t\thistoryItem = this.addHistoryItem(historyItemData);\n\t\t\tExpand.create(historyItem.getWrapper(), null).run();\n\t\t}\n\t}\n\n\tonEntityProgressChange(sender, eventArgs)\n\t{\n\t\tif (BX.prop.getInteger(eventArgs, \"entityTypeId\", 0) !== this._ownerTypeId\n\t\t\t|| BX.prop.getInteger(eventArgs, \"entityId\", 0) !== this._ownerId\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst semantics = BX.prop.getString(eventArgs, \"semantics\", \"\");\n\t\tif (semantics === this._progressSemantics)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._progressSemantics = semantics;\n\t\tthis._schedule.refreshLayout();\n\t}\n\n\tgetId()\n\t{\n\t\treturn this._id;\n\t}\n\n\tgetSetting(name, defaultval)\n\t{\n\t\treturn this._settings.hasOwnProperty(name) ? this._settings[name] : defaultval;\n\t}\n\n\tgetOwnerTypeId()\n\t{\n\t\treturn this._ownerTypeId;\n\t}\n\n\tgetOwnerId()\n\t{\n\t\treturn this._ownerId;\n\t}\n\n\tgetOwnerInfo()\n\t{\n\t\treturn this._ownerInfo;\n\t}\n\n\tisStubCounterEnabled()\n\t{\n\t\treturn false;\n\t}\n\n\tgetSchedule()\n\t{\n\t\treturn this._schedule;\n\t}\n\n\tgetHistory()\n\t{\n\t\treturn this._history;\n\t}\n\n\tgetFixedHistory()\n\t{\n\t\treturn this._fixedHistory;\n\t}\n\n\tprocessSheduleLayoutChange()\n\t{\n\t}\n\n\tprocessHistoryLayoutChange()\n\t{\n\t\tthis._schedule.refreshLayout();\n\t}\n\n\taddScheduleItem(data)\n\t{\n\t\tconst item = this._schedule.createItem(data);\n\t\tconst index = this._schedule.calculateItemIndex(item);\n\t\tconst anchor = this._schedule.createAnchor(index);\n\t\tthis._schedule.addItem(item, index);\n\t\titem.layout({anchor: anchor});\n\n\t\treturn item;\n\t}\n\n\taddHistoryItem(data)\n\t{\n\t\tconst item = this._history.createItem(data);\n\t\tconst index = this._history.calculateItemIndex(item);\n\t\tconst historyAnchor = this._history.createAnchor(index);\n\t\tthis._history.addItem(item, index);\n\t\titem.layout({anchor: historyAnchor});\n\n\t\treturn item;\n\t}\n\n\trenderAudioDummy(durationText, onClick)\n\t{\n\t\treturn BX.create(\"DIV\", {\n\t\t\tattrs: {className: \"crm-audio-cap-wrap-container\"},\n\t\t\tchildren: [\n\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\tattrs: {className: \"crm-audio-cap-wrap\"},\n\t\t\t\t\tchildren:\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tBX.create(\"DIV\", {\n\t\t\t\t\t\t\t\tattrs: {className: \"crm-audio-cap-time\"},\n\t\t\t\t\t\t\t\ttext: durationText\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t],\n\t\t\t\t\tevents: {click: onClick}\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\t}\n\n\tloadMediaPlayer(id, filePath, mediaType, node, duration, options)\n\t{\n\t\tif (!duration)\n\t\t{\n\t\t\tduration = 0;\n\t\t}\n\t\tif (!options)\n\t\t{\n\t\t\toptions = {};\n\t\t}\n\t\tconst player = new BX.Fileman.Player(id, {\n\t\t\tsources: [\n\t\t\t\t{\n\t\t\t\t\tsrc: filePath,\n\t\t\t\t\ttype: mediaType\n\t\t\t\t}\n\t\t\t],\n\t\t\tisAudio: !options.video,\n\t\t\tskin: options.hasOwnProperty('skin') ? options.skin : 'vjs-timeline_player-skin',\n\t\t\twidth: options.width || 350,\n\t\t\theight: options.height || 30,\n\t\t\tduration: duration,\n\t\t\tplaybackRate: options.playbackRate || null,\n\t\t\tonInit: function (player) {\n\t\t\t\tplayer.vjsPlayer.controlBar.removeChild('timeDivider');\n\t\t\t\tplayer.vjsPlayer.controlBar.removeChild('durationDisplay');\n\t\t\t\tplayer.vjsPlayer.controlBar.removeChild('fullscreenToggle');\n\t\t\t\tplayer.vjsPlayer.controlBar.addChild('timeDivider');\n\t\t\t\tplayer.vjsPlayer.controlBar.addChild('durationDisplay');\n\t\t\t\tif (!player.isPlaying())\n\t\t\t\t{\n\t\t\t\t\tplayer.play();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tBX.cleanNode(node, false);\n\t\tnode.appendChild(player.createElement());\n\t\tplayer.init();\n\t\t// todo remove this after player will be able to get float playbackRate\n\t\tif (options.playbackRate > 1)\n\t\t{\n\t\t\tplayer.vjsPlayer.playbackRate(options.playbackRate);\n\t\t}\n\t\treturn player;\n\t}\n\n\tonActivityCreated(activity, data)\n\t{\n\t\t//Already processed in onPullEvent\n\t}\n\n\tisSpotlightShowed()\n\t{\n\t\treturn this._spotlightFastenShowed;\n\t}\n\n\tsetSpotlightShowed()\n\t{\n\t\tthis._spotlightFastenShowed = true;\n\t}\n\n\tgetCurrentUser(): ?Object\n\t{\n\t\tif (BX.type.isObjectLike(this._currentUser) && this._userId > 0)\n\t\t{\n\t\t\tthis._currentUser.userId = this._userId;\n\t\t}\n\n\t\treturn this._currentUser;\n\t}\n\n\tgetPingSettings(): ?Object\n\t{\n\t\tif (BX.type.isObjectLike(this._pingSettings) && Object.keys(this._pingSettings).length > 0)\n\t\t{\n\t\t\treturn this._pingSettings;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetCalendarSettings(): ?Object\n\t{\n\t\tif (BX.type.isObjectLike(this._calendarSettings) && Object.keys(this._calendarSettings).length > 0)\n\t\t{\n\t\t\treturn this._calendarSettings;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetColorSettings(): ?Object\n\t{\n\t\tif (BX.type.isObjectLike(this._colorSettings) && Object.keys(this._colorSettings).length > 0)\n\t\t{\n\t\t\treturn this._colorSettings;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetAudioPlaybackRateSelector()\n\t{\n\t\tif (!this.audioPlaybackRateSelector)\n\t\t{\n\t\t\tthis.audioPlaybackRateSelector = new AudioPlaybackRateSelector({\n\t\t\t\tname: 'timeline_audio_playback',\n\t\t\t\tcurrentRate: this._audioPlaybackRate,\n\t\t\t\tavailableRates: [\n\t\t\t\t\t{\n\t\t\t\t\t\trate: 1,\n\t\t\t\t\t\thtml: BX.Loc.getMessage('CRM_TIMELINE_PLAYBACK_RATE_SELECTOR_RATE_1')\n\t\t\t\t\t\t\t.replace('#RATE#', '<span class=\"crm-audio-cap-speed-param\">1x</span>')\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\trate: 1.5,\n\t\t\t\t\t\thtml: BX.Loc.getMessage('CRM_TIMELINE_PLAYBACK_RATE_SELECTOR_RATE_1.5')\n\t\t\t\t\t\t\t.replace('#RATE#', '<span class=\"crm-audio-cap-speed-param\">1.5x</span>')\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\trate: 2,\n\t\t\t\t\t\thtml: BX.Loc.getMessage('CRM_TIMELINE_PLAYBACK_RATE_SELECTOR_RATE_2')\n\t\t\t\t\t\t\t.replace('#RATE#', '<span class=\"crm-audio-cap-speed-param\">2x</span>')\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\trate: 3,\n\t\t\t\t\t\thtml: BX.Loc.getMessage('CRM_TIMELINE_PLAYBACK_RATE_SELECTOR_RATE_3')\n\t\t\t\t\t\t\t.replace('#RATE#', '<span class=\"crm-audio-cap-speed-param\">3x</span>')\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\ttextMessageCode: 'CRM_TIMELINE_PLAYBACK_RATE_SELECTOR_TEXT'\n\t\t\t});\n\t\t}\n\n\t\treturn this.audioPlaybackRateSelector;\n\t}\n\n\thasScheduledItems(): boolean\n\t{\n\t\treturn this._schedule.getItems().length > 0;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new Manager();\n\t\tself.initialize(id, settings);\n\t\tManager.instances[self.getId()] = self;\n\t\treturn self;\n\t}\n\n\tstatic getDefault(): ?Manager\n\t{\n\t\treturn Manager.#defaultInstance;\n\t}\n\tstatic setDefault(instance): void\n\t{\n\t\tManager.#defaultInstance = instance;\n\t}\n\n\tstatic getById(id): ?Manager\n\t{\n\t\treturn Manager.instances[id] || null;\n\t}\n\n\tstatic #defaultInstance = null;\n\tstatic instances = {};\n}\n","import { EventEmitter } from 'main.core.events';\n\n/** @memberof BX.Crm.Timeline.Tools */\nexport default class WorkflowEventManager\n{\n\tconstructor(settings)\n\t{\n\t\tthis.hasRunningWorkflow = settings.hasRunningWorkflow;\n\t\tthis.hasWaitingWorkflowTask = settings.hasWaitingWorkflowTask;\n\t\tthis.workflowTaskActivityId = settings.workflowTaskActivityId;\n\t\tthis.workflowFirstTourClosed = settings.workflowFirstTourClosed;\n\t\tthis.workflowTaskStatusTitle = settings.workflowTaskStatusTitle;\n\n\t\tthis.init();\n\t}\n\n\tinit(): void\n\t{\n\t\tthis.handleRunningWorkflow();\n\t\tthis.handleWaitingWorkflowTask();\n\t\tthis.subscribeToTimelineEvents();\n\t\tthis.subscribeToPullEvents();\n\t}\n\n\thandleRunningWorkflow(): void\n\t{\n\t\tif (!this.hasRunningWorkflow)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.runFirstAutomationTour();\n\t}\n\n\trunFirstAutomationTour(): void\n\t{\n\t\tif (!document.querySelector('.bp_starter'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tEventEmitter.emit(\n\t\t\t'BX.Crm.Timeline.Bizproc::onAfterWorkflowStarted',\n\t\t\t{\n\t\t\t\tstepId: 'on-after-started-workflow',\n\t\t\t\ttarget: '#crm_entity_bp_starter',\n\t\t\t},\n\t\t);\n\t}\n\n\thandleWaitingWorkflowTask(): void\n\t{\n\t\tif (!this.hasWaitingWorkflowTask)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.workflowFirstTourClosed)\n\t\t{\n\t\t\tthis.runSecondAutomationTour(`ACTIVITY_${this.workflowTaskActivityId}`);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tEventEmitter.subscribe('UI.Tour.Guide:onFinish', (event) => {\n\t\t\t\tconst eventData = event.data;\n\t\t\t\tconst stepId = eventData?.guide?.steps?.[0]?.id;\n\t\t\t\tif (stepId === 'on-after-started-workflow')\n\t\t\t\t{\n\t\t\t\t\tthis.runSecondAutomationTour(`ACTIVITY_${this.workflowTaskActivityId}`);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\trunSecondAutomationTour(activityId = null): void\n\t{\n\t\tif (!activityId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst task = document.querySelector(`div[data-id=\"${activityId}\"]`);\n\t\tif (task && this.isElementInViewport(task))\n\t\t{\n\t\t\tEventEmitter.emit(\n\t\t\t\t'BX.Crm.Timeline.Bizproc::onAfterCreatedTask',\n\t\t\t\t{\n\t\t\t\t\tstepId: 'on-after-created-task',\n\t\t\t\t\ttarget: task.querySelector('.crm-timeline__card-status'),\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\t}\n\n\tsubscribeToTimelineEvents(): void\n\t{\n\t\tEventEmitter.subscribe('BX.Crm.Timeline.Items.Bizproc:onAfterItemLayout', (event) => {\n\t\t\tconst eventData = event.data;\n\n\t\t\tif (eventData?.options?.add === false)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst isWorkflowStarted = eventData?.type === 'BizprocWorkflowStarted';\n\t\t\tif (isWorkflowStarted)\n\t\t\t{\n\t\t\t\tthis.runFirstAutomationTour();\n\t\t\t}\n\n\t\t\tconst isBizprocTask = eventData?.type === 'Activity:BizprocTask';\n\t\t\tif (eventData?.target && this.isElementInViewport(eventData?.target) && isBizprocTask)\n\t\t\t{\n\t\t\t\tEventEmitter.subscribe('UI.Tour.Guide:onFinish', (params) => {\n\t\t\t\t\tconst paramsData = params.data;\n\t\t\t\t\tconst stepId = paramsData?.guide?.steps?.[0]?.id;\n\t\t\t\t\tconst card = eventData?.target.querySelector('.crm-timeline__card');\n\t\t\t\t\tconst activityId = card.getAttribute('data-id');\n\t\t\t\t\tif (stepId === 'on-after-started-workflow' && activityId)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.runSecondAutomationTour(activityId);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tsubscribeToPullEvents(): void\n\t{\n\t\tEventEmitter.subscribe('onPullEvent-crm', (event) => {\n\t\t\tconst eventData = event.data?.[1];\n\t\t\tconst isUpdateAction = eventData?.action === 'update';\n\t\t\tconst itemLayout = eventData?.item?.layout;\n\t\t\tconst itemTypeTask = eventData?.item?.type === 'Activity:BizprocTask';\n\t\t\tconst itemId = eventData?.id;\n\n\t\t\tif (isUpdateAction && itemLayout && itemId && itemTypeTask)\n\t\t\t{\n\t\t\t\tconst card = document.querySelector(`div[data-id=\"${itemId}\"]`);\n\t\t\t\tconst isSecondaryStatus = itemLayout?.header?.tags?.status?.title === this.workflowTaskStatusTitle;\n\n\t\t\t\tif (isSecondaryStatus && card)\n\t\t\t\t{\n\t\t\t\t\tEventEmitter.emit(\n\t\t\t\t\t\t'BX.Crm.Timeline.Bizproc::onAfterCompletedTask',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstepId: 'on-after-completed-task',\n\t\t\t\t\t\t\ttarget: card.querySelector('.crm-timeline__card-top_checkbox'),\n\t\t\t\t\t\t},\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tisElementInViewport(element: HTMLElement): boolean\n\t{\n\t\tconst rect = element.getBoundingClientRect();\n\n\t\treturn rect.bottom > 0 && rect.top < (window.innerHeight || document.documentElement.clientHeight);\n\t}\n}\n","import Activity from \"./activity\";\n\n/** @memberof BX.Crm.Timeline.Actions */\nexport default class SchedulePostpone extends Activity\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._button = null;\n\t\tthis._clickHandler = BX.delegate(this.onClick, this);\n\t\tthis._isMenuShown = false;\n\n\t\tthis._menu = false;\n\t}\n\n\tdoLayout()\n\t{\n\t\tthis._button = BX.create(\"DIV\",\n\t\t\t{\n\t\t\t\tattrs:\n\t\t\t\t\t{\n\t\t\t\t\t\tclassName: this._isEnabled\n\t\t\t\t\t\t\t? \"crm-entity-stream-planned-action-aside\"\n\t\t\t\t\t\t\t: \"crm-entity-stream-planned-action-aside-disabled\"\n\t\t\t\t\t},\n\t\t\t\ttext: this.getMessage(\"postpone\")\n\t\t\t}\n\t\t);\n\n\t\tif(this._isEnabled)\n\t\t{\n\t\t\tBX.bind(this._button, \"click\", this._clickHandler)\n\t\t}\n\n\t\tthis._container.appendChild(this._button);\n\t}\n\n\topenMenu()\n\t{\n\t\tif(this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst handler = BX.delegate(this.onMenuItemClick, this);\n\t\tconst menuItems =\n\t\t\t[\n\t\t\t\t{id: \"hour_1\", text: this.getMessage(\"forOneHour\"), onclick: handler},\n\t\t\t\t{id: \"hour_2\", text: this.getMessage(\"forTwoHours\"), onclick: handler},\n\t\t\t\t{id: \"hour_3\", text: this.getMessage(\"forThreeHours\"), onclick: handler},\n\t\t\t\t{id: \"day_1\", text: this.getMessage(\"forOneDay\"), onclick: handler},\n\t\t\t\t{id: \"day_2\", text: this.getMessage(\"forTwoDays\"), onclick: handler},\n\t\t\t\t{id: \"day_3\", text: this.getMessage(\"forThreeDays\"), onclick: handler}\n\t\t\t];\n\n\t\tBX.PopupMenu.show(\n\t\t\tthis._id,\n\t\t\tthis._button,\n\t\t\tmenuItems,\n\t\t\t{\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 16,\n\t\t\t\tevents:\n\t\t\t\t\t{\n\t\t\t\t\t\tonPopupShow: BX.delegate(this.onMenuShow, this),\n\t\t\t\t\t\tonPopupClose: BX.delegate(this.onMenuClose, this),\n\t\t\t\t\t\tonPopupDestroy: BX.delegate(this.onMenuDestroy, this)\n\t\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tthis._menu = BX.PopupMenu.currentItem;\n\t}\n\n\tcloseMenu()\n\t{\n\t\tif(!this._isMenuShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._menu)\n\t\t{\n\t\t\tthis._menu.close();\n\t\t}\n\t}\n\n\tonClick()\n\t{\n\t\tif(!this._isEnabled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._isMenuShown)\n\t\t{\n\t\t\tthis.closeMenu();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.openMenu();\n\t\t}\n\t}\n\n\tonMenuItemClick(e, item)\n\t{\n\t\tthis.closeMenu();\n\n\t\tlet offset = 0;\n\t\tif(item.id === \"hour_1\")\n\t\t{\n\t\t\toffset = 3600;\n\t\t}\n\t\telse if(item.id === \"hour_2\")\n\t\t{\n\t\t\toffset = 7200;\n\t\t}\n\t\telse if(item.id === \"hour_3\")\n\t\t{\n\t\t\toffset = 10800;\n\t\t}\n\t\telse if(item.id === \"day_1\")\n\t\t{\n\t\t\toffset = 86400;\n\t\t}\n\t\telse if(item.id === \"day_2\")\n\t\t{\n\t\t\toffset = 172800;\n\t\t}\n\t\telse if(item.id === \"day_3\")\n\t\t{\n\t\t\toffset = 259200;\n\t\t}\n\n\t\tif(offset > 0 && this._item)\n\t\t{\n\t\t\tthis._item.postpone(offset);\n\t\t}\n\t}\n\n\tonMenuShow()\n\t{\n\t\tthis._isMenuShown = true;\n\t}\n\n\tonMenuClose()\n\t{\n\t\tif(this._menu && this._menu.popupWindow)\n\t\t{\n\t\t\tthis._menu.popupWindow.destroy();\n\t\t}\n\t}\n\n\tonMenuDestroy()\n\t{\n\t\tthis._isMenuShown = false;\n\t\tthis._menu = null;\n\n\t\tif(typeof(BX.PopupMenu.Data[this._id]) !== \"undefined\")\n\t\t{\n\t\t\tdelete(BX.PopupMenu.Data[this._id]);\n\t\t}\n\t}\n\n\tgetMessage(name)\n\t{\n\t\tconst m = SchedulePostpone.messages;\n\t\treturn m.hasOwnProperty(name) ? m[name] : name;\n\t}\n\n\tstatic create(id, settings)\n\t{\n\t\tconst self = new SchedulePostpone();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n\n\tstatic messages = {};\n}\n","import Shift from \"./shift\";\n\n/** @memberof BX.Crm.Timeline.Animation */\nexport default class Comment\n{\n\tconstructor()\n\t{\n\t\tthis._node = null;\n\t\tthis._anchor = null;\n\t\tthis._nodeParent  = null;\n\t\tthis._startPosition = null;\n\t\tthis._events = null;\n\t}\n\n\tinitialize(node, anchor, startPosition, events)\n\t{\n\t\tthis._node = node;\n\t\tthis._anchor = anchor;\n\t\tthis._nodeParent  = node.parentNode;\n\t\tthis._startPosition = startPosition;\n\t\tthis._events = BX.type.isPlainObject(events) ? events : {};\n\n\t}\n\n\trun()\n\t{\n\t\tBX.addClass(this._node, 'crm-entity-stream-section-animate-start');\n\n\t\tthis._node.style.position = \"absolute\";\n\t\tthis._node.style.width = this._startPosition.width + \"px\";\n\t\tthis._node.style.height = this._startPosition.height + \"px\";\n\t\tthis._node.style.top = this._startPosition.top - 30 + \"px\";\n\t\tthis._node.style.left = this._startPosition.left + \"px\";\n\t\tthis._node.style.opacity = 0;\n\t\tthis._node.style.zIndex = 960;\n\n\t\tdocument.body.appendChild(this._node);\n\n\t\tconst nodeOpacityAnim = new BX.easing({\n\t\t\tduration: 350,\n\t\t\tstart: {opacity: 0},\n\t\t\tfinish: {opacity: 100},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: BX.proxy(function (state) {\n\t\t\t\tthis._node.style.opacity = state.opacity / 100;\n\t\t\t}, this),\n\t\t\tcomplete: BX.proxy(function () {\n\t\t\t\tif (BX.type.isFunction(this._events[\"start\"]))\n\t\t\t\t{\n\t\t\t\t\tthis._events[\"start\"]();\n\t\t\t\t}\n\t\t\t\tconst shift = Shift.create(\n\t\t\t\t\tthis._node,\n\t\t\t\t\tthis._anchor,\n\t\t\t\t\tthis._startPosition,\n\t\t\t\t\tfalse,\n\t\t\t\t\t{complete: BX.delegate(this.finish, this)}\n\t\t\t\t);\n\t\t\t\tshift.run();\n\t\t\t}, this)\n\t\t});\n\t\tnodeOpacityAnim.animate();\n\n\n\t\tif(BX.type.isFunction(this._events[\"complete\"]))\n\t\t{\n\t\t\tthis._events[\"complete\"]();\n\t\t}\n\t}\n\n\tfinish()\n\t{\n\t\tthis._node.style.position = \"\";\n\t\tthis._node.style.width = \"\";\n\t\tthis._node.style.height = \"\";\n\t\tthis._node.style.top = \"\";\n\t\tthis._node.style.left = \"\";\n\t\tthis._node.style.opacity = \"\";\n\t\tthis._node.style.zIndex = \"\";\n\t\tthis._anchor.style.height = \"\";\n\t\tthis._anchor.parentNode.insertBefore(this._node, this._anchor.nextSibling);\n\t\tsetTimeout(\n\t\t\tBX.delegate(function() {\n\t\t\t\tBX.removeClass(this._node, 'crm-entity-stream-section-animate-start');\n\t\t\t\tBX.remove(this._anchor);\n\t\t\t}, this),\n\t\t\t0\n\t\t);\n\t}\n\n\tstatic create(node, anchor, startPosition, events)\n\t{\n\t\tconst self = new Comment();\n\t\tself.initialize(node, anchor, startPosition, events);\n\t\treturn self;\n\t}\n}\n","import Manager from \"./manager\";\nimport Stream from \"./stream\";\nimport History from \"./streams/history\";\nimport FixedHistory from \"./streams/fixedhistory\";\nimport EntityChat from \"./streams/entitychat\";\nimport Schedule from \"./streams/schedule\";\nimport SchedulePostponeController from \"./tools/schedule-postpone-controller\";\nimport AudioPlaybackRateSelector from \"./tools/audio-playback-rate-selector\";\nimport WorkflowEventManager from \"./tools/workflow-event-manager\";\nimport * as Types from \"./types\";\nimport Action from \"./action\";\nimport Activity from \"./actions/activity\";\nimport {Call, HistoryCall, ScheduleCall} from \"./actions/call\";\nimport {Email, HistoryEmail, ScheduleEmail} from \"./actions/email\";\nimport {OpenLine} from \"./actions/openline\";\nimport SchedulePostpone from \"./actions/schedule-postpone\";\nimport CompatibleItem from \"./items/compatible-item\";\nimport HistoryItem from \"./items/history\";\nimport HistoryActivity from \"./items/history-activity\";\nimport CommentItem from \"./items/comment\";\nimport Modification from \"./items/modification\";\nimport Mark from \"./items/mark\";\nimport Creation from \"./items/creation\";\nimport Restoration from \"./items/restoration\";\nimport Relation from \"./items/relation\";\nimport Link from \"./items/link\";\nimport Unlink from \"./items/unlink\";\nimport EmailItem from \"./items/email\";\nimport CallItem from \"./items/call\";\nimport Meeting from \"./items/meeting\";\nimport Task from \"./items/task\";\nimport WebForm from \"./items/webform\";\nimport WaitItem from \"./items/wait\";\nimport Document from \"./items/document\";\nimport Sender from \"./items/sender\";\nimport Bizproc from \"./items/bizproc\";\nimport Request from \"./items/request\";\nimport RestItem from \"./items/rest\";\nimport OpenLineItem from \"./items/openline\";\nimport Zoom from \"./items/zoom\";\nimport Conversion from \"./items/conversion\";\nimport Visit from \"./items/visit\";\nimport Scoring from \"./items/scoring\";\nimport ExternalNoticeModification from \"./items/external-notice-modification\";\nimport ExternalNoticeStatusModification from \"./items/external-notice-status-modification\";\nimport Scheduled from \"./items/scheduled\";\nimport ScheduledActivity from \"./items/scheduled/activity\";\nimport ScheduledEmail from \"./items/scheduled/email\";\nimport ScheduledCall from \"./items/scheduled/call\";\nimport CallTracker from \"./items/scheduled/call-tracker\";\nimport ScheduledMeeting from \"./items/scheduled/meeting\";\nimport ScheduledTask from \"./items/scheduled/task\";\nimport ScheduledWebForm from \"./items/scheduled/webform\";\nimport ScheduledWait from \"./items/scheduled/wait\";\nimport ScheduledRequest from \"./items/scheduled/request\";\nimport ScheduledRest from \"./items/scheduled/rest\";\nimport ScheduledOpenLine from \"./items/scheduled/openline\";\nimport ScheduledZoom from \"./items/scheduled/zoom\";\nimport AnimationItem from \"./animations/item\";\nimport ItemNew from \"./animations/item-new\";\nimport Expand from \"./animations/expand\";\nimport Shift from \"./animations/shift\";\nimport AnimationComment from \"./animations/comment\";\nimport Fasten from \"./animations/fasten\";\n\nconst Streams = {\n\tHistory,\n\tFixedHistory,\n\tEntityChat,\n\tSchedule,\n}\n\nconst Tools = {\n\tSchedulePostponeController,\n\tAudioPlaybackRateSelector,\n\tWorkflowEventManager,\n}\n\nconst Actions = {\n\tActivity,\n\tCall,\n\tHistoryCall,\n\tScheduleCall,\n\tEmail,\n\tHistoryEmail,\n\tScheduleEmail,\n\tOpenLine,\n\tSchedulePostpone,\n}\n\nconst ScheduledItems = {\n\tActivity: ScheduledActivity,\n\tEmail: ScheduledEmail,\n\tCall: ScheduledCall,\n\tCallTracker,\n\tMeeting: ScheduledMeeting,\n\tTask: ScheduledTask,\n\tWebForm: ScheduledWebForm,\n\tWait: ScheduledWait,\n\tRequest: ScheduledRequest,\n\tRest: ScheduledRest,\n\tOpenLine: ScheduledOpenLine,\n\tZoom: ScheduledZoom,\n}\n\nconst Items = {\n\tHistory: HistoryItem,\n\tHistoryActivity,\n\tComment: CommentItem,\n\tModification,\n\tMark,\n\tCreation,\n\tRestoration,\n\tRelation,\n\tLink,\n\tUnlink,\n\tEmail: EmailItem,\n\tCall: CallItem,\n\tMeeting,\n\tTask,\n\tWebForm,\n\tWait: WaitItem,\n\tDocument,\n\tSender,\n\tBizproc,\n\tRequest,\n\tRest: RestItem,\n\tOpenLine: OpenLineItem,\n\tZoom,\n\tConversion,\n\tVisit,\n\tScoring,\n\tExternalNoticeModification,\n\tExternalNoticeStatusModification,\n\tScheduledBase: Scheduled,\n\tScheduled: ScheduledItems,\n}\n\nconst Animations = {\n\tItem: AnimationItem,\n\tItemNew,\n\tExpand,\n\tShift,\n\tComment: AnimationComment,\n\tFasten,\n};\n\nexport {\n\tManager,\n\tStream,\n\tStreams,\n\tTools,\n\tTypes,\n\tAction,\n\tActions,\n\tItems,\n\tAnimations,\n\tCompatibleItem,\n};\n"],"names":["Expand","node","callback","options","BX","type","isFunction","startHeight","requestAnimationFrame","position","Dom","getPosition","elemStyle","getComputedStyle","paddingTop","parseInt","getPropertyValue","paddingBottom","marginBottom","style","height","overflowY","padding","Tag","render","append","setTimeout","easing","duration","start","overlayOpacity","finish","transition","makeEaseOut","transitions","quart","step","onNodeHeightStep","bind","complete","onNodeHeightComplete","animate","state","bindOnce","remove","color","Type","isStringFilled","self","initialize","width","Item","undefined","activity","creation","modification","link","unlink","mark","comment","wait","bizproc","conversion","sender","document","restoration","order","orderCheck","scoring","externalNotification","finalSummary","delivery","finalSummaryDocuments","storeDocument","productCompilation","signDocument","Mark","waiting","success","renew","ignored","failed","Order","encourageBuyProducts","EditorMode","view","edit","CompatibleItem","_id","_settings","_data","_container","_typeCategoryId","_associatedEntityData","_associatedEntityTypeId","_associatedEntityId","_isContextMenuShown","_contextMenuButton","_activityEditor","_actions","_actionContainer","_existedStreamItemDeadLine","id","settings","_setId","getSetting","isPlainObject","doInitialize","name","defaultval","hasOwnProperty","data","clearCachedData","prop","getInteger","associatedEntityData","ASSOCIATED_ENTITY","setData","entityData","getAssociatedEntityData","getObject","permissions","PERMISSIONS","getString","getArray","ItemType","container","isElementNode","prepareLayout","prepareActions","actionQty","length","i","layout","showActions","show","isDone","text","isNumber","offset","whilespaceOffset","substring","search","clickHandler","util","htmlspecialchars","replace","create","attrs","className","href","events","click","getMessage","authorInfo","getObjectDataParam","showUrl","target","title","children","imageUrl","backgroundImage","encodeURI","backgroundSize","delegate","onContextMenuButtonClick","e","openContextMenu","closeContextMenu","menuItems","prepareContextMenuItems","IntranetExtensions","push","PopupMenu","offsetTop","offsetLeft","angle","onPopupShow","onContextMenuShow","onPopupClose","onContextMenuClose","onPopupDestroy","onContextMenuDestroy","_contextMenu","currentItem","close","addClass","popupWindow","destroy","removeClass","Data","m","messages","Timezone","Offset","USER_TO_SERVER","Fasten","_initialItem","_finalItem","_events","isNotEmptyString","getRandomString","_anchor","defaultValue","getWrapper","parentNode","insertBefore","nextSibling","_clone","cloneNode","_startPosition","pos","_cloneHeight","_minHeight","_sumPaddingContent","top","left","zIndex","body","appendChild","proxy","_anchorPosition","opacity","_difference","bottom","_deepHistoryLimit","clientHeight","_duration","Math","abs","movingEvent","addFixedHistoryItem","History","_history","_fixedHistory","_typeId","_createdTime","_isFixed","_headerClickHandler","onHeaderClick","isReadOnly","getTextDataParam","time","parseDate","getCreatedTimestamp","DatetimeConverter","toUserTime","getValue","extractDate","Date","getCreatedTime","getTime","getOwnerInfo","CrmEntityType","enumeration","typeId","getTypeId","CrmActivityStatus","isFinal","_items","fastenLimitPopup","PopupWindow","_switcher","content","message","darkMode","autoHide","closeByEsc","bindOptions","forceBindPosition","ajax","url","_serviceUrl","method","dataType","getOwnerTypeId","getOwnerId","result","ERROR","isFixed","IS_FIXED","fixedItem","createItem","addItem","add","refreshLayout","animation","initialItem","finalItem","anchor","run","item","historyItem","findItemById","index","getItemIndex","clearAnimate","removeItemByIndex","LazyLoad","showImages","isDomNode","_wrapper","wrapperPosition","hideEvent","clearLayout","wrapperClassName","getWrapperClassName","wrapper","getIconClassName","isContextMenuEnabled","prepareContextMenuButton","contentWrapper","header","getTitle","formatTime","prepareContentDetails","authorNode","prepareAuthorLayout","prepareContent","enableAdd","getBoolean","markAsTerminated","checkItemForTermination","preventDefault","returnValue","unfasten","fasten","manager","getManager","isSpotlightShowed","setSpotlightShowed","spotlight","SpotLight","targetElement","targetVertex","lightMode","autoSave","prepareTitleLayout","statusNode","getStatusNode","onActivityCreated","deadline","isDate","setHours","setMinutes","setSeconds","setMilliseconds","end","lightTime","now","Scheduled","_schedule","_deadlineNode","_setAsDoneButtonHandler","onSetAsDoneButtonClick","CrmActivityEditor","hasPermissions","verifyPermissions","loadPermissions","userId","getPermissions","getUserId","getServiceUrl","getAssociatedEntityId","onsuccess","onPermissionsLoad","setPermissions","window","getDeadline","isCounterEnabledByLightTime","getLightTime","markAsDone","onItemMarkedAsDone","innerHTML","formatDateTime","isIncomingChannel","perms","canComplete","setAsDone","_node","originalPosition","_initialYPosition","_initialXPosition","_initialWidth","offsetWidth","_initialHeight","offsetHeight","_anchorYPosition","createStub","createGhost","moveGhost","_stub","props","_ghostNode","boxShadow","placeEventAnim","addHistoryItem","removeGhost","_finalItemHeight","ghostNode","finalNode","overflow","hideCasperItem","collapseStub","removePlannedEvent","inited","Shift","_nodeParent","startPosition","shadowNode","additionalShift","_shadowNode","nodeHeight","nodeMarginBottom","parseFloat","nodeMarginTop","marginTop","nodeHeightWithMargin","expandPlaceEvent","StreamType","history","scheduled","pinned","Menu","vueComponent","menuOptions","_classPrivateFieldInitSpec","cacheable","items","createMenuItem","MenuManager","Object","prototype","call","delimiter","value","icon","menu","subItem","values","action","onclick","onMenuItemClick","getCurrentMenu","Action","execute","AnimationTarget","block","AnimationType","disable","loader","ActionType","JS_EVENT","AJAX_ACTION","STARTED","FINISHED","FAILED","isJsEvent","isAjaxAction","freeze","params","_classPrivateMethodInitSpec","actionParams","analytics","Promise","resolve","reject","$Bitrix","eventEmitter","emit","actionType","actionData","animationCallbacks","onStart","_classPrivateMethodGet","onStop","isJsCode","eval","isAjaxJsonAction","ajaxConfig","Ajax","runAction","then","response","UI","Notification","Center","notify","errors","autoHideDelay","isCallRestBatch","Rest","callBatch","restResult","answer","error","error_description","isRedirect","linkAttrs","display","isShowMenu","showMenu","bindElement","$el","minWidth","isShowInfoHelper","InfoHelper","param","isUndefined","paramName","paramValue","DateTimeFormat","format","getSiteDateTimeFormat","filter","scope","hideIfReadonly","sort","a","b","$root","setFaded","showLoader","setDisabled","setLoading","force","forever","hit","clonedAnalytics","sendData","Logo","String","addIcon","addIconType","iconType","backgroundUrl","Number","inCircle","Boolean","required","default","currentIcon","computed","iconClassname","addIconClassname","iconInteriorStyle","Text","encode","watch","newIcon","methods","executeAction","setIcon","template","CalendarIcon","timestamp","calendarEventId","date","formatUserTime","month","dayWeek","getDateTimeConverter","toTimeString","userTime","hasCalendarEventId","createFromServerTimestamp","LogoCalendar","BitrixVue","cloneComponent","components","backgroundColor","logoStyle","Body","logo","blocks","blockRefs","mounted","$refs","visibleBlocks","forEach","setAttribute","Error","rendererName","beforeUpdate","keys","map","aSort","bSort","contentContainerClassname","getContentBlockById","blockId","getLogo","saveRef","ref","ButtonScope","ButtonState","ButtonType","BaseButton","tooltip","DEFAULT","currentState","itemStateToButtonStateDict","LOADING","UIButton","State","WAITING","DISABLED","AI_LOADING","AI_WAITING","disabled","setButtonState","loading","onLayoutUpdated","created","subscribe","beforeUnmount","unsubscribe","ButtonMenu","AI_SUCCESS","LOCKED","isObject","getMenuItems","emptyClassItems","Button","SECONDARY","iconName","size","popup","uiButton","timerSecondsRemaining","hintText","itemTypeToButtonColorDict","PRIMARY","Color","LIGHT_BORDER","LIGHT","ICON","LINK","AI","buttonContainerRef","buttonContainer","getButtonOptions","upperCaseIconName","isString","toUpperCase","upperCaseButtonSize","btnColor","titleText","round","dependOnTheme","Size","Icon","getUiButton","disableWithTimer","sec","btn","remainingSeconds","setText","formatSeconds","timer","setInterval","clearInterval","minutes","floor","seconds","formatMinutes","formatNumber","num","parentSetButtonState","setState","createSplitButton","key","querySelector","menuButton","element","event","stopPropagation","UIButtonState","mainButton","UISplitButton","renderButton","button","renderTo","setTooltip","showTooltip","Hint","hideTooltip","hide","isInViewport","rect","getBoundingClientRect","innerHeight","documentElement","right","innerWidth","clientWidth","isPropEqual","propName","newValue","updated","AdditionalButtonIcon","NOTE","SCRIPT","PRINT","DOTS","AdditionalButtonColor","AdditionalButton","validator","indexOf","loaderHtml","Loader","mode","outerHTML","Buttons","Array","getButtonById","buttonId","buttons","reduce","found","MenuId","inject","isMenuFilled","itemsArray","buttonProps","getMenuById","LayoutMenu","Footer","additionalButtons","maxBaseButtonsCount","containerClassname","baseButtons","visibleAndSortedButtons","slice","moreButtons","visibleButtons","buttonsSorter","visibleAndSortedAdditionalButtons","visibleAdditionalButtons","visibleButtonsFilter","additionalButtonsArray","entries","hasMenu","buttonItem","HIDDEN","MOBILE","buttonA","buttonB","foundButton","getMenu","ChangeStreamButton","disableIfReadonly","isReadonlyMode","isComplete","isShowPinButton","isShowUnpinButton","catch","onClick","isReadonly","markCheckboxUnchecked","ColorSelector","directives","hint","valuesList","selectedValueId","readOnlyMode","currentValueId","setValue","itemSelector","onItemSelectorValueChange","valueId","emitEvent","colorId","eventName","$nextTick","ColorSelectorPopup","itemSelectorRef","colorList","selectedColorId","EventEmitter","ColorSelectorEvents","EVENT_COLORSELECTOR_VALUE_CHANGE","Loc","popupOptions","FormatDate","datePlaceholder","useShortTimeFormat","class","formattedDate","converter","toDatetimeString","isMouseOnHintArea","hintPopup","textBlocks","hintContentIcon","iconElement","classname","hintContentIconClassname","hintContentText","hintContentTextBlocks","getContentBlockNode","baseClassname","hintIconClassname","hasContent","getHintContent","getPopupOptions","maxWidth","getPopupPosition","hintElem","defaultAngleLeftOffset","Popup","getOption","hintWidth","hintLeftOffset","hintTopOffset","popupWidth","getPopupContainer","getPopupAngleOffset","popupContainer","angleWidth","onMouseEnterToPopup","onHintAreaMouseLeave","hideHintPopup","onMouseEnterToHint","showHintPopupWithDebounce","showHintPopup","isShown","Event","setBindElement","setAngle","adjustPosition","Runtime","debounce","unbind","hideHintPopupWithDebounce","contentBlock","getTextNode","getLinkNode","textOptions","linkOptions","actionObj","TagType","tagTypeToLabelColorDict","Label","LIGHT_BLUE","LAVENDER","SUCCESS","LIGHT_GREEN","WARNING","LIGHT_YELLOW","FAILURE","LIGHT_RED","tagContainerRef","tag","getLabelColorFromTagType","tagType","lowerCaseTagType","toLowerCase","labelColor","renderTag","tagOptions","uppercaseTitle","label","fill","clean","Title","isLogMessage","User","detailUrl","styles","Header","titleAction","changeStreamButton","tags","user","infoHelper","colorSettings","visibleTags","isVisibleTagFilter","visibleAndAscSortedTags","tagsCopy","clone","tagsAscSorter","isShowDate","tagA","tagB","getChangeStreamButton","$watch","newColorSettings","colorSelector","deep","IconBackgroundColor","code","counterType","backgroundColorToken","backgroundUri","counterNodeContainer","counter","iconStyle","renderCounter","Counter","border","newCounterType","MarketPanel","detailsText","detailsTextAction","needShowDetailsText","UserPick","initialLayout","currentUser","onAction","Function","initialColor","streamType","isFaded","provide","onActionEvent","eventData","getData","setLayout","newLayout","setColor","newColor","faded","getHeaderChangeStreamButton","getFooterButtonById","footer","getFooterMenu","highlightContentBlockById","isHighlighted","timelineCardClassname","timelineCardStyle","itemBackground","ControllerManager","foundControllers","controller","getRegisteredControllers","isItemSupported","controllerInstance","onInitialize","timelineId","Base","recordId","ownerTypeId","ownerId","getDeleteActionMethod","getDeleteActionCfg","activityId","scheduleDate","menuBar","Crm","Timeline","MenuBar","getDefault","setActiveItemById","scrollIntoView","todoEditor","getItemById","focus","setParentActivityId","setDeadLine","_isTerminated","previousSibling","timeout","removeWrapperClass","addWrapperClass","terminated","Layout","menuItem","ConfigurableItem","setContainer","itemClassName","getInstance","getItemControllers","payload","setWrapper","initLayoutApp","needBindToContainer","bindTo","getBindToNode","onAfterItemLayout","getColor","getLayout","asPlainObject","onAfterItemRefreshLayout","useAnchorNextSibling","onBeforeItemClearLayout","unmount","getId","isInteger","toInteger","getContainer","forceRefreshLayout","historyIds","activityIds","err","console","TimelineItem","isBoolean","createApp","contentBlockComponents","componentName","component","mount","getCurrentUser","onItemAction","assign","getContentBlockComponents","ItemNew","hasOwn","initWrapper","shiftAndReplaceInitialWithFinal","margin","shift","heightDiff","newNodeShift","addStubForInitialItem","nodePosition","offsetParent","Steam","_manager","_timeFormat","_year","_isStubMode","_userId","_readOnly","_streamType","_editorContainer","Manager","datetimeFormat","dateFormat","convertBitrixFormat","trim","getFullYear","getStreamType","currentUrl","ajaxId","insertToNode","add_url_param","bxajaxid","location","SERVER_TO_UTC","utc","getFormat","whitespaceOffset","getItems","toString","find","findIndex","splice","setItems","animateUpdate","animateMove","itemPositionChanged","newIndex","newItem","isScheduleStream","createItemCopy","calculateItemIndex","animateItemAdding","createAnchor","ItemAnimation","deleteItem","hasClass","destinationStream","destinationItem","PullActionProcessor","scheduleStream","fixedHistoryStream","historyStream","canBeReloaded","appLanguage","languageId","targetUsersList","includes","stream","promises","isHistoryStream","sourceStream","fromStream","fromId","all","itemData","existedStreamItem","streamItem","refreshItem","deleteItemAnimated","sourceId","destinationId","destinationItemData","sourceItem","existedDestinationItem","moveItemToStream","onSuccessFasten","historyCommentBlock","getLayoutContentBlockById","setIsFilesBlockDisplayed","setIsMoving","fixedHistoryItem","getAnchor","fixedHistoryCommentBlock","onSuccessUnfasten","streamName","EntityChat","_layoutType","LayoutType","none","_contentWrapper","_messageWrapper","_messageDateNode","_messageTexWrapper","_messageTextNode","_userWrapper","_extraUserCounter","isLoading","_openChatHandler","onOpenChat","lockScript","isNaN","getUserInfoData","userInfos","isEnabled","isStubMode","getChatId","renderSummary","renderInvitation","addCustomEvent","onChatEvent","cleanNode","invitation","refreshUsers","summary","_messageTexWraper","_messageCounterNode","refreshSummary","infos","list","count","info","getMessageData","isoDate","remoteDate","getServerTimezoneOffset","getUserTimezoneOffset","localTime","ATTACH","FILE_ID","MessengerCommon","Reflection","getClass","MessengerParser","purifyText","purify","attach","files","innerText","classList","Messenger","Public","isRestricted","applyLockScript","ownerInfo","entityId","entityTypeId","successCallback","chatId","openChat","errorCallback","errorMessage","command","extras","setUserInfoData","mergeEx","refreshUsersAnimated","removeUserInfo","setMessageData","setUnreadMessageCounter","refreshSummaryAnimated","Stream","Modification","prepareHeaderLayout","contentChildren","Conversion","entityNodes","entityInfos","getArrayDataParam","entityInfo","entityNode","getNotFoundMessage","doLayout","Activity","_entityData","_item","_isEnabled","getActivityCommunications","getActivityId","communications","Email","_clickHandler","_saveHandler","onSave","resolveName","CrmActivityProvider","Bitrix24","Slider","addEmail","addOnSave","loadActivityCommunications","isArray","CrmActivityEmail","prepareReply","PreventDefault","onActivityCreate","HistoryEmail","ScheduleEmail","HistoryActivity","direction","typeCategoryId","getTypeCategoryId","CrmActivityType","email","CrmActivityDirection","incoming","meeting","task","provider","providerId","getTypeDescription","markTypeId","messageName","markText","activityEditor","_isMenuShown","isEditable","processRemoval","viewActivity","associatedEntityTypeId","getAssociatedEntityTypeId","editActivity","_detetionConfirmDlgId","dlg","ConfirmationDialog","get","getRemoveMessage","open","onRemovalConfirm","onRemovalCancel","deleteActivity","serviceUrl","ownertype","ownerid","_handleActivityChange","onfailure","emailInfo","statusText","markNode","prepareMarkLayout","prepareTimeLayout","description","communication","communicationTitle","communicationShowUrl","communicationValue","outerWrapper","detailWrapper","communicationWrapper","prepareCutOffElements","prepareFixedSwitcherLayout","Call","_menu","_menuItems","alert","phone","getItemData","phones","addCall","prepareMenuItems","PopupMenuWindow","onMenuShow","onMenuClose","onMenuDestroy","handler","l","formattedValue","complexName","itemText","closeMenu","phoneTo","HistoryCall","_button","ScheduleCall","_playerDummyClickHandler","onPlayerDummyClick","_playerWrapper","_transcriptWrapper","_mediaFileInfo","callInfo","callTypeText","hasCallInfo","isSuccessfull","communicationValueFormatted","durationText","hasTranscript","isTranscriptPending","callId","callComment","prepareMultilineCutOffElements","callInfoWrapper","renderAudioDummy","getAudioPlaybackRateSelector","Voximplant","Transcript","html","stubNode","addPlayer","loadMediaPlayer","playbackRate","getRate","Meeting","Task","WebForm","Request","OpenLine","slug","openMessengerSlider","RECENT","MENU","entityDetailWrapper","messageWrapper","openLineData","isExternal","OpenLineAction","iconNode","backgroundPosition","Visit","visitInfo","recordLength","recordLengthFormatted","vkProfile","createTextNode","getVkProfileUrl","profile","Restriction","getHandler","Zoom","_videoDummy","_audioDummy","_videoPlayer","_audioPlayer","_audioLengthElement","_recordings","_currentRecordingIndex","zoomActivitySubject","_downloadWrapper","_downloadSubject","_downloadSubjectDetail","_downloadVideoLink","_downloadSeparator","_downloadAudioLink","_playVideoLink","detailZoomCopyVideoLink","prepareSuccessfulLayout","zoomData","subject","tabs","recording","active","tabsComponent","TabsComponent","_onTabChange","_onVideoDummyClick","dataset","init","_onAudioDummyClick","videoLinkExpireTS","videoLinkContainer","_detailZoomCopyVideoLink","zoomAudioDetailWrapper","setCurrentRecording","video","skin","tabId","recordingIndex","videoRecording","audioRecording","hidden","pause","setSource","lengthHuman","lastElementChild","clipboard","bindCopyClick","config","elements","_renderTab","tabDescription","setActiveTab","OrderModification","statusInfo","classCode","fieldName","fields","names","orderpayment","psStatusCode","ordershipment","getStatusInfo","isNotEmptyObject","htmlTitle","nodes","descriptionNode","legend","sublegend","destination","detailNode","sliderLinkNode","startSalescenterApplication","loadExt","deal","paymentId","shipmentId","orderId","Salescenter","openApplication","disableSendButton","context","templateMode","paySystemName","sum","currency","paymentDetail","logotip","isPaid","isClick","isManualContinuePay","isManualAddCheck","preparePaidPaymentContent","prepareClickedPaymentContent","prepareManualContinuePayContent","prepareManualAddCheck","prepareItemOrderContent","isViewed","isSent","getHeaderChildren","prepareViewedContentDetails","prepareSentContentDetails","prepareErrorPaymentContentDetails","headerWrap","preparePaidPaymentContentDetails","paySystemError","errorDetailNode","prepareClickedPaymentContentDetails","Helper","ExternalNoticeModification","ExternalNoticeStatusModification","Creation","cutOffText","docType","entityTypeName","msg","isMessageNotFound","TYPE_CATEGORY_ID","HTML_TITLE","createOrderEntityItem","orderData","ID","ORDER_DATE","SHOW_URL","SUM","spanAttrs","baseEntityData","baseEntityInfo","HistoryItem","Restoration","Relation","Link","Unlink","activityProviderId","MarkType","isDefined","iconClassName","innerWrapper","associatedEntityTitle","contentTemplate","Page","Comment","_isCollapsed","_hasFiles","_postForm","_editor","_commentMessage","_mode","_streamContentEventBlock","_playerWrappers","file","playerWrapper","entityValueId","extension","firstElementChild","detailChildren","_commentWrapper","switchToEditMode","save","switchToViewMode","cleanText","_hasInlineAttachment","onExpandButtonClick","_textLoaded","_fileBlock","ready","loadContent","registerImages","viewElementBind","showTitle","getAttribute","BLOCK","promise","_editorName","oEditor","SetContent","ReInitIframe","onLoadEditorSuccess","showEditor","LHEPostForm","BXHtmlEditor","Get","onCustomEvent","eventNode","GetContent","commentImages","querySelectorAll","commentImagesLength","idsList","toggleMode","tagName","getSelection","loadEditor","attachmentList","input","emptyCommentMessage","_isRequestRunning","onSaveSuccess","onRequestFailure","getHistory","fixedHistory","getFixedHistory","deleteFixedItem","onRemoveSuccess","updateFixedItem","updateItem","_isLocked","eventWrapper","maxHeight","scrollHeight","Wait","strip_tags","nl2br","Document","editDocument","statusLayout","prepareTitleStatusLayout","findChildByClassName","confirmDelete","onConfirmDelete","DoNothing","deleteDocument","documentId","DOCUMENT_ID","SidePanel","Instance","adjust","Sender","getDataSetting","isRemoved","layoutClassName","textCaption","prepareStatusLayout","Bizproc","prepareContentTextHtml","workflowName","workflowStatus","Scoring","isScoringAvailable","ownerType","scoringInfo","score","getNumber","scoreDelta","iconClass","_emptySection","_currentDaySection","_lastDaySection","_lastDate","_enableLoading","_navigation","_scrollHandler","_loadingWaiter","_filterId","_isFilterApplied","_isFilterShown","_filterButton","_filterWrapper","_filterResultStub","_ownerTypeId","_ownerId","onFilterApply","closeFilterButton","onFilterClose","getCreatedDate","createCurrentDaySection","createDaySection","enableLoading","processHistoryLayoutChange","firstChild","adjustFilterButton","_filterEmptyResultSection","createFilterEmptyResultSection","isTerminated","getLastItem","$entityTypeId","results","createEmptySection","showFilter","section","sectionWrapper","hideFilter","Main","filterManager","getById","resetFilter","formatDate","changedFieldName","getItemClassName","createActivityItem","createExternalNotificationItem","child","removeChild","loadItems","ctx","autoResolve","CrmDataLoader","load","resetLayout","bulkCreateItems","setNavigation","fulfill","itemId","navigation","enable","onWindowScroll","instances","FixedHistory","nextElementSibling","onItemsLoad","SchedulePostponeController","postpone","_postponeController","status","completed","autoCompleted","setActivityCompleted","onSetAsDoneCompleted","getSourceId","postponeActivity","onPosponeCompleted","activityType","IS_INCOMING_CHANNEL","canPostpone","timeText","isCounterEnabled","contentInnerWrapper","headerWrapper","additionalDetails","prepareDetailNodes","members","getPrepositionText","communicationNode","prepareCommunicationNode","setAsDoneButton","checked","change","onContextMenuItemSelect","postponeMenu","commands","getCommandList","processCommand","CrmScheduleCallAction","CallTracker","CrmScheduleEmailAction","editor","topic","startTime","detailZoomMessage","detailZoomInfoLink","detailZoomInfo","detailZoomCopyInviteLink","detailZoomStartConferenceButton","detailZoomCopyInviteLinkWrapper","Schedule","addStub","processSheduleLayoutChange","stubIcon","isStubCounterEnabled","getItemCount","getSort","curSort","j","getItemByAssociatedEntity","entityTypeID","entityID","schedule","removeStub","historyItemData","onTransferComplete","canAddTodo","focusOnTodoEditor","insertAfter","stubClassName","stubIconClassName","stubMessage","lead","isStubVisible","overlay","stubContent","newBLockStartHeight","getLayoutComponent","timelineCard","AudioPlaybackRateSelector","menuId","availableRates","currentRate","normalizeRate","textMessageCode","renderedItems","players","rateDescription","rate","isRateCurrent","selectedRate","setRate","popupMenu","getPopupWindow","getPopup","userOptions","textNode","getText","vjsPlayer","player","Fileman","Player","_ownerInfo","_progressSemantics","_chat","_currentUser","_pingSettings","_calendarSettings","_colorSettings","_pullTagName","_spotlightFastenShowed","_audioPlaybackRate","containerId","activityEditorId","readOnly","templates","editorContainer","filterId","isFilterApplied","setHistory","onPullEvent","extendWatch","onEntityProgressChange","addEventListener","throttle","onScroll","PULL","processAction","processChatCreate","processActivityExternalAdd","processActivityExternalUpdate","processActivityExternalDelete","processCommentExternalAdd","processCommentExternalUpdate","processCommentExternalDelete","processChangeBinding","processItemExternalUpdate","processWaitExternalAdd","processWaitExternalUpdate","processWaitExternalDelete","processBizprocStatus","processScoringExternalAdd","scheduleItemData","scheduleItem","getItemByData","addScheduleItem","historyItems","getItemsByAssociatedEntity","setAssociatedEntityData","fixedHistoryItems","transferItemToHistory","entityNewId","fixedItemData","eventArgs","semantics","historyAnchor","filePath","mediaType","sources","src","isAudio","onInit","controlBar","addChild","isPlaying","play","createElement","isObjectLike","audioPlaybackRateSelector","instance","WorkflowEventManager","hasRunningWorkflow","hasWaitingWorkflowTask","workflowTaskActivityId","workflowFirstTourClosed","workflowTaskStatusTitle","handleRunningWorkflow","handleWaitingWorkflowTask","subscribeToTimelineEvents","subscribeToPullEvents","runFirstAutomationTour","stepId","runSecondAutomationTour","guide","steps","isElementInViewport","isWorkflowStarted","isBizprocTask","paramsData","card","isUpdateAction","itemLayout","itemTypeTask","isSecondaryStatus","SchedulePostpone","openMenu","nodeOpacityAnim","Streams","Tools","Actions","ScheduledItems","ScheduledActivity","ScheduledEmail","ScheduledCall","ScheduledMeeting","ScheduledTask","ScheduledWebForm","ScheduledWait","ScheduledRequest","ScheduledRest","ScheduledOpenLine","ScheduledZoom","Items","CommentItem","EmailItem","CallItem","WaitItem","RestItem","OpenLineItem","ScheduledBase","Animations","AnimationItem","AnimationComment"],"mappings":"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"}