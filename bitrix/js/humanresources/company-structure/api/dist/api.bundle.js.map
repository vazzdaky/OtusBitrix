{"version":3,"file":"api.bundle.js","sources":["../src/analytics.js","../src/member-roles.js","../src/index.js"],"sourcesContent":["type Analytics = {\n\tevent: string,\n\ttool: string,\n\tcategory: string,\n\tc_element: string,\n};\n\nexport const AnalyticsSourceType = Object.freeze({\n\tHEADER: 'header',\n\tCARD: 'card',\n\tDETAIL: 'dept_menu',\n\tPLUS: 'plus',\n});\n\nexport type {\n\tAnalytics,\n};\n","import { EntityTypes } from 'humanresources.company-structure.utils';\n\nexport type MemberRolesType = {\n\temployee: string,\n\thead: string,\n\tdeputyHead: string,\n}\n\nexport const memberRolesKeys: Readonly<MemberRolesType> = Object.freeze({\n\temployee: 'employee',\n\thead: 'head',\n\tdeputyHead: 'deputyHead',\n});\n\nexport const memberRoles: Readonly<MemberRolesType> = Object.freeze({\n\temployee: 'MEMBER_EMPLOYEE',\n\thead: 'MEMBER_HEAD',\n\tdeputyHead: 'MEMBER_DEPUTY_HEAD',\n});\n\nexport const teamMemberRoles: Readonly<MemberRolesType> = Object.freeze({\n\temployee: 'MEMBER_TEAM_EMPLOYEE',\n\thead: 'MEMBER_TEAM_HEAD',\n\tdeputyHead: 'MEMBER_TEAM_DEPUTY_HEAD',\n});\n\nexport function getMemberRoles(entityType: $Values<typeof EntityTypes>): MemberRolesType\n{\n\treturn entityType === EntityTypes.team ? teamMemberRoles : memberRoles;\n}\n","import { ajax } from 'main.core';\nimport { Analytics as AnalyticsType, AnalyticsSourceType } from './analytics';\nimport { memberRoles, teamMemberRoles, memberRolesKeys, getMemberRoles, type MemberRolesType } from './member-roles';\nimport { UI } from 'ui.notification';\nimport { sendData as analyticsSendData } from 'ui.analytics';\n\nconst request = async (method: string, endPoint: string, data: Object = {}, analytics: AnalyticsType = {}) => {\n\tconst config = { method };\n\tif (method === 'POST')\n\t{\n\t\tObject.assign(config, { data }, {\n\t\t\theaders: [{\n\t\t\t\tname: 'Content-Type',\n\t\t\t\tvalue: 'application/json',\n\t\t\t}],\n\t\t});\n\t}\n\n\tlet response = null;\n\n\ttry\n\t{\n\t\tif (method === 'POST')\n\t\t{\n\t\t\tresponse = await ajax.runAction(endPoint, config);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst getConfig = { data };\n\n\t\t\tresponse = await ajax.runAction(endPoint, getConfig);\n\t\t}\n\t}\n\tcatch (ex)\n\t{\n\t\thandleResponseError(ex);\n\n\t\treturn null;\n\t}\n\n\tif (analytics?.event?.length > 0)\n\t{\n\t\tanalyticsSendData(analytics);\n\t}\n\n\treturn response.data;\n};\n\nconst reportedErrorTypes = new Set([\n\t'STRUCTURE_ACCESS_DENIED',\n\t'ERROR_TEAMS_DISABLED',\n]);\n\nconst handleResponseError = (response: Error) => {\n\tif (response.errors?.length > 0)\n\t{\n\t\tconst [error] = response.errors;\n\n\t\tif (reportedErrorTypes.has(error.code))\n\t\t{\n\t\t\tUI.Notification.Center.notify({\n\t\t\t\tcontent: error.message,\n\t\t\t\tautoHideDelay: 4000,\n\t\t\t});\n\t\t}\n\n\t\tthrow error;\n\t}\n};\n\nconst getData = (endPoint: string, data: ?Object, analytics: ?AnalyticsType) => request('GET', endPoint, data ?? {}, analytics ?? {});\n\nconst postData = (endPoint: string, data: Object, analytics: ?AnalyticsType) => request('POST', endPoint, data, analytics ?? {});\n\nexport {\n\tgetData,\n\tpostData,\n\tmemberRoles,\n\tteamMemberRoles,\n\tmemberRolesKeys,\n\tgetMemberRoles,\n\tAnalyticsSourceType,\n\treportedErrorTypes,\n};\nexport type { MemberRolesType };\n"],"names":["AnalyticsSourceType","Object","freeze","HEADER","CARD","DETAIL","PLUS","memberRolesKeys","employee","head","deputyHead","memberRoles","teamMemberRoles","getMemberRoles","entityType","EntityTypes","team","request","method","endPoint","data","analytics","config","assign","headers","name","value","response","ajax","runAction","getConfig","ex","handleResponseError","event","length","analyticsSendData","reportedErrorTypes","Set","errors","error","has","code","UI","Notification","Center","notify","content","message","autoHideDelay","getData","postData"],"mappings":";;;;;;OAOaA,mBAAmB,GAAGC,MAAM,CAACC,MAAM,CAAC;GAChDC,MAAM,EAAE,QAAQ;GAChBC,IAAI,EAAE,MAAM;GACZC,MAAM,EAAE,WAAW;GACnBC,IAAI,EAAE;CACP,CAAC,CAAC;;OCJWC,eAA0C,GAAGN,MAAM,CAACC,MAAM,CAAC;GACvEM,QAAQ,EAAE,UAAU;GACpBC,IAAI,EAAE,MAAM;GACZC,UAAU,EAAE;CACb,CAAC,CAAC;AAEF,OAAaC,WAAsC,GAAGV,MAAM,CAACC,MAAM,CAAC;GACnEM,QAAQ,EAAE,iBAAiB;GAC3BC,IAAI,EAAE,aAAa;GACnBC,UAAU,EAAE;CACb,CAAC,CAAC;AAEF,OAAaE,eAA0C,GAAGX,MAAM,CAACC,MAAM,CAAC;GACvEM,QAAQ,EAAE,sBAAsB;GAChCC,IAAI,EAAE,kBAAkB;GACxBC,UAAU,EAAE;CACb,CAAC,CAAC;AAEF,CAAO,SAASG,cAAc,CAACC,UAAuC,EACtE;GACC,OAAOA,UAAU,KAAKC,iDAAW,CAACC,IAAI,GAAGJ,eAAe,GAAGD,WAAW;CACvE;;CCvBA,MAAMM,OAAO,GAAG,OAAOC,MAAc,EAAEC,QAAgB,EAAEC,IAAY,GAAG,EAAE,EAAEC,SAAwB,GAAG,EAAE,KAAK;GAAA;GAC7G,MAAMC,MAAM,GAAG;KAAEJ;IAAQ;GACzB,IAAIA,MAAM,KAAK,MAAM,EACrB;KACCjB,MAAM,CAACsB,MAAM,CAACD,MAAM,EAAE;OAAEF;MAAM,EAAE;OAC/BI,OAAO,EAAE,CAAC;SACTC,IAAI,EAAE,cAAc;SACpBC,KAAK,EAAE;QACP;MACD,CAAC;;GAGH,IAAIC,QAAQ,GAAG,IAAI;GAEnB,IACA;KACC,IAAIT,MAAM,KAAK,MAAM,EACrB;OACCS,QAAQ,GAAG,MAAMC,cAAI,CAACC,SAAS,CAACV,QAAQ,EAAEG,MAAM,CAAC;MACjD,MAED;OACC,MAAMQ,SAAS,GAAG;SAAEV;QAAM;OAE1BO,QAAQ,GAAG,MAAMC,cAAI,CAACC,SAAS,CAACV,QAAQ,EAAEW,SAAS,CAAC;;IAErD,CACD,OAAOC,EAAE,EACT;KACCC,mBAAmB,CAACD,EAAE,CAAC;KAEvB,OAAO,IAAI;;GAGZ,IAAI,CAAAV,SAAS,wCAATA,SAAS,CAAEY,KAAK,qBAAhB,iBAAkBC,MAAM,IAAG,CAAC,EAChC;KACCC,qBAAiB,CAACd,SAAS,CAAC;;GAG7B,OAAOM,QAAQ,CAACP,IAAI;CACrB,CAAC;AAED,OAAMgB,kBAAkB,GAAG,IAAIC,GAAG,CAAC,CAClC,yBAAyB,EACzB,sBAAsB,CACtB,CAAC;CAEF,MAAML,mBAAmB,GAAIL,QAAe,IAAK;GAAA;GAChD,IAAI,qBAAAA,QAAQ,CAACW,MAAM,qBAAf,iBAAiBJ,MAAM,IAAG,CAAC,EAC/B;KACC,MAAM,CAACK,KAAK,CAAC,GAAGZ,QAAQ,CAACW,MAAM;KAE/B,IAAIF,kBAAkB,CAACI,GAAG,CAACD,KAAK,CAACE,IAAI,CAAC,EACtC;OACCC,kBAAE,CAACC,YAAY,CAACC,MAAM,CAACC,MAAM,CAAC;SAC7BC,OAAO,EAAEP,KAAK,CAACQ,OAAO;SACtBC,aAAa,EAAE;QACf,CAAC;;KAGH,MAAMT,KAAK;;CAEb,CAAC;AAED,OAAMU,OAAO,GAAG,CAAC9B,QAAgB,EAAEC,IAAa,EAAEC,SAAyB,KAAKJ,OAAO,CAAC,KAAK,EAAEE,QAAQ,EAAEC,IAAI,WAAJA,IAAI,GAAI,EAAE,EAAEC,SAAS,WAATA,SAAS,GAAI,EAAE,CAAC;AAErI,OAAM6B,QAAQ,GAAG,CAAC/B,QAAgB,EAAEC,IAAY,EAAEC,SAAyB,KAAKJ,OAAO,CAAC,MAAM,EAAEE,QAAQ,EAAEC,IAAI,EAAEC,SAAS,WAATA,SAAS,GAAI,EAAE,CAAC;;;;;;;;;;;;;;;"}