{"version":3,"file":"work-time-state-icon.bundle.js","sources":["../src/work-time-state-icon.js"],"sourcesContent":["import { Dom, Tag, Type } from 'main.core';\nimport { PULL } from 'pull.client';\n\nimport './work-time-state-icon.css';\n\nconst State = Object.freeze({\n\tClosed: 'CLOSED',\n\tOpened: 'OPENED',\n\tPaused: 'PAUSED',\n\tExpired: 'EXPIRED',\n});\n\nconst CommandType = Object.freeze({\n\tStart: 'start',\n\tPause: 'pause',\n\tContinue: 'continue',\n\tReopen: 'relaunch',\n\tStop: 'stop',\n});\n\ntype PullData = {\n\tcommand: string,\n\tparams: {\n\t\tinfo: {\n\t\t\tstate: string,\n\t\t\taction: string,\n\t\t}\n\t},\n};\n\ntype Params = {\n\tstate: string,\n\taction: string,\n};\n\nexport class WorkTimeStateIcon\n{\n\t#params: Params;\n\n\t#layout: {\n\t\tnode: ?HTMLElement,\n\t\ticonNode: ?HTMLElement,\n\t};\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#params = params;\n\n\t\tthis.#layout = {};\n\n\t\tthis.#subscribeToPull();\n\t}\n\n\trenderTo(container: HTMLElement): void\n\t{\n\t\tif (Type.isDomNode(container))\n\t\t{\n\t\t\tDom.append(this.render(), container);\n\t\t}\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst iconClass = this.#getIconClass();\n\t\tconst style = this.#getIconStyle();\n\n\t\tconst { node, icon } = Tag.render`\n\t\t\t<div ref=\"node\" class=\"work-time-state\" style=\"${style}\">\n\t\t\t\t<div ref=\"icon\" class=\"work-time-state-icon ${iconClass}\"></div>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#layout.node = node;\n\t\tthis.#layout.iconNode = icon;\n\n\t\treturn node;\n\t}\n\n\t#subscribeToPull(): void\n\t{\n\t\tPULL.subscribe({\n\t\t\tmoduleId: 'timeman',\n\t\t\tcallback: (data: PullData) => this.#handlePullEvent(data),\n\t\t});\n\t}\n\n\t#handlePullEvent(data: PullData): void\n\t{\n\t\tif (!this.#isValidCommand(data.command))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#params.state = data.params.info.state;\n\t\tthis.#params.action = data.params.info.action;\n\n\t\tthis.#updateIcon();\n\t}\n\n\t#isValidCommand(command: string): boolean\n\t{\n\t\treturn Object.values(CommandType).includes(command);\n\t}\n\n\t#updateIcon(): void\n\t{\n\t\tif (this.#layout.node === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst iconClass = this.#getIconClass();\n\t\tconst style = this.#getIconStyle();\n\n\t\tthis.#layout.iconNode.className = 'work-time-state-icon';\n\t\tif (iconClass)\n\t\t{\n\t\t\tDom.addClass(this.#layout.iconNode, iconClass);\n\t\t}\n\n\t\tDom.style(this.#layout.node, style);\n\t}\n\n\t#getIconClass(): string\n\t{\n\t\tconst { state, action } = this.#params;\n\n\t\tif (state === State.Opened)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tif (state === State.Closed && action === 'OPEN')\n\t\t{\n\t\t\treturn '--start';\n\t\t}\n\n\t\tif (state === State.Paused)\n\t\t{\n\t\t\treturn '--pause';\n\t\t}\n\n\t\tif (state === State.Closed && action === 'REOPEN')\n\t\t{\n\t\t\treturn '--check';\n\t\t}\n\n\t\tif (state === State.Expired)\n\t\t{\n\t\t\treturn '--warn';\n\t\t}\n\n\t\treturn '';\n\t}\n\n\t#getIconStyle(): ?string\n\t{\n\t\tconst { state } = this.#params;\n\n\t\tif (state === State.Opened)\n\t\t{\n\t\t\treturn 'display: none';\n\t\t}\n\n\t\treturn null;\n\t}\n}\n"],"names":["State","Object","freeze","Closed","Opened","Paused","Expired","CommandType","Start","Pause","Continue","Reopen","Stop","WorkTimeStateIcon","params","container","Type","isDomNode","Dom","append","render","iconClass","style","Tag","node","icon","iconNode","PULL","subscribe","moduleId","callback","data","command","state","info","action","values","includes","className","addClass"],"mappings":"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"}