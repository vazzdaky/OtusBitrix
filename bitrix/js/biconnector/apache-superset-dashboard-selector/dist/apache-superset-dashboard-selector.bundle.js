this.BX=this.BX||{},function(e,t,a,i){"use strict";function s(e,t){l(e,t),t.add(e)}function r(e,t,a){l(e,t),t.set(e,a)}function l(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function n(e,t,a){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return a}var o=new WeakMap,d=new WeakMap,c=new WeakMap,b=new WeakMap,h=new WeakMap,v=new WeakMap,p=new WeakMap,u=new WeakSet,m=new WeakSet,w=new WeakSet,S=new WeakSet,f=new WeakSet,P=new WeakSet;function H(e){return babelHelpers.classPrivateFieldGet(this,o)||babelHelpers.classPrivateFieldSet(this,o,new i.Dialog({id:"biconnector-superset-dashboard",multiple:!1,targetNode:e,offsetTop:14,context:"biconnector-superset-dashboard",entities:[{id:"biconnector-superset-dashboard",dynamicLoad:!0,dynamicSearch:!0}],enableSearch:!0,dropdownMode:!0,showAvatars:!0,compactView:!1,dynamicLoad:!0,clearUnavailableItems:!0,preselectedItems:[["biconnector-superset-dashboard",babelHelpers.classPrivateFieldGet(this,b)]],events:{"Item:onSelect":n(this,m,F).bind(this)}})),babelHelpers.classPrivateFieldGet(this,o)}function F(e){var i=this;return a.EventEmitter.emit("BiConnector:DashboardSelector.onSelect"),new Promise((function(s,r){n(i,w,B).call(i,e.data.item.id).then((function(t){t.data.dashboard&&(n(i,f,I).call(i,t.data.dashboard.title),a.EventEmitter.emit("BiConnector:DashboardSelector.onSelectDataLoaded",{item:e.data.item,dashboardId:e.data.item.id,credentials:t.data.dashboard})),s(t)})).catch((function(e){var a;e.errors&&t.Type.isStringFilled(null===(a=e.errors[0])||void 0===a?void 0:a.message)&&BX.UI.Notification.Center.notify({content:t.Text.encode(e.errors[0].message)}),r(e)}))}))}function B(e){return BX.ajax.runAction("biconnector.dashboard.getDashboardEmbeddedData",{data:{id:e,urlParams:babelHelpers.classPrivateFieldGet(this,p)}})}function k(){babelHelpers.classPrivateFieldGet(this,o).show()}function I(e){babelHelpers.classPrivateFieldGet(this,c).innerHTML=t.Text.encode(e)}function E(e){var t=this,i=e.data.dashboard;return new Promise((function(e){n(t,f,I).call(t,i.title),babelHelpers.classPrivateFieldSet(t,o,null),babelHelpers.classPrivateFieldSet(t,b,i.id),n(t,u,H).call(t,babelHelpers.classPrivateFieldGet(t,d)),a.EventEmitter.emit("BiConnector:DashboardSelector.onSelectDataLoaded",{item:i,dashboardId:i.id,credentials:i}),e()}))}t.Reflection.namespace("BX.BIConnector").SupersetDashboardSelector=function e(i){babelHelpers.classCallCheck(this,e),s(this,P),s(this,f),s(this,S),s(this,w),s(this,m),s(this,u),r(this,o,{writable:!0,value:void 0}),r(this,d,{writable:!0,value:void 0}),r(this,c,{writable:!0,value:void 0}),r(this,b,{writable:!0,value:void 0}),r(this,h,{writable:!0,value:void 0}),r(this,v,{writable:!0,value:void 0}),r(this,p,{writable:!0,value:void 0}),babelHelpers.classPrivateFieldSet(this,d,document.getElementById(i.containerId)),babelHelpers.classPrivateFieldSet(this,c,document.getElementById(i.textNodeId)),babelHelpers.classPrivateFieldSet(this,b,i.dashboardId),babelHelpers.classPrivateFieldSet(this,h,i.marketCollectionUrl),babelHelpers.classPrivateFieldSet(this,v,i.isMarketInstalled),babelHelpers.classPrivateFieldSet(this,p,i.dashboardUrlParams),n(this,u,H).call(this,babelHelpers.classPrivateFieldGet(this,d)),babelHelpers.classPrivateFieldGet(this,d)&&(t.Event.bind(babelHelpers.classPrivateFieldGet(this,d),"click",n(this,S,k).bind(this)),a.EventEmitter.subscribe("BIConnector.DashboardManager:onCopyDashboard",n(this,P,E).bind(this)))}}(this.BX.BIConnector=this.BX.BIConnector||{},BX,BX.Event,BX.UI.EntitySelector);
