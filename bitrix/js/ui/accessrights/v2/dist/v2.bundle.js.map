{"version":3,"file":"v2.bundle.js","sources":["../src/service/value/type/base.js","../src/service/value/type/dependent-variables.js","../src/service/value/type/multivariables.js","../src/service/value/type/toggler.js","../src/service/value/type/variables.js","../src/service/service-locator.js","../src/integration/entity-selector/dictionary.js","../src/components/header/members/selector.js","../src/components/header/members/single-member.js","../src/components/header/members.js","../src/components/header/role-heading.js","../src/integration/entity-selector/items-mapper.js","../src/components/layout/cell-layout.js","../src/components/layout/column-layout.js","../src/components/header/roles-control.js","../src/components/util/sync-horizontal-scroll.js","../src/components/header.js","../src/components/searchbox.js","../src/utils.js","../src/store/model/access-rights-model.js","../src/components/section/column/menu-cell.js","../src/components/section/icon.js","../src/components/section/value/popup-header/locator.js","../src/components/section/value/popup-header/master-switcher.js","../src/components/section/value/popup-header/master-switcher/single-role-title.js","../src/components/section/value/dependent-variables/popup-header.js","../src/components/section/value/dependent-variables/popup-content.js","../src/components/section/value/popup-header/master-switcher/all-roles-title.js","../src/components/section/value/value-popup.js","../src/components/section/title-column/value/dependent-variables.js","../src/integration/entity-selector/footer.js","../src/integration/entity-selector/header.js","../src/components/section/value/multivariables/selector.js","../src/components/section/title-column/value/multivariables.js","../src/components/section/title-column/value/variables.js","../src/components/util/selected-hint.js","../src/components/section/column/value/dependent-variables.js","../src/components/section/column/value/multivariables.js","../src/components/section/column/value/toggler.js","../src/components/section/column/value/variables.js","../src/components/section/value/registry.js","../src/components/section/column/value-cell.js","../src/components/section/column.js","../src/components/section/column-list.js","../src/components/util/hint.js","../src/components/section/header.js","../src/components/section/title-column/menu-cell.js","../src/components/section/title-column/row-value.js","../src/components/section/title-column/title-cell.js","../src/components/section/title-column.js","../src/components/section.js","../src/components/grid.js","../src/integration/analytics-manager.js","../src/store/model/application-model.js","../src/store/model/user-groups-model.js","../src/store/index.js","../src/store/model/transformation/backend-exporter/user-groups/base-user-groups-exporter.js","../src/store/model/transformation/backend-exporter/user-groups/all-user-groups-exporter.js","../src/store/model/transformation/backend-exporter/user-groups/only-changed-user-groups-exporter.js","../src/store/model/transformation/internalizer/access-rights-internalizer.js","../src/store/model/transformation/internalizer/application-internalizer.js","../src/store/model/transformation/internalizer/user-groups-internalizer.js","../src/store/model/transformation/shown-user-groups-copier.js","../src/app.js"],"sourcesContent":["import { Type } from 'main.core';\nimport type { AccessRightItem } from '../../../store/model/access-rights-model';\nimport { type ValueType } from './value-type';\n\n/**\n * @abstract\n */\nexport class Base implements ValueType\n{\n\t/*\n\t * @abstract\n\t */\n\tgetComponentName(): string\n\t{\n\t\tthrow new Error('not implemented');\n\t}\n\n\tgetEmptyValue(item: AccessRightItem): Set<string>\n\t{\n\t\treturn item.emptyValue ?? new Set();\n\t}\n\n\tgetMinValue(item: AccessRightItem): ?Set<string>\n\t{\n\t\tif (!Type.isNil(item.minValue))\n\t\t{\n\t\t\treturn item.minValue;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetMaxValue(item: AccessRightItem): ?Set<string>\n\t{\n\t\tif (!Type.isNil(item.maxValue))\n\t\t{\n\t\t\treturn item.maxValue;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tisRowValueConfigurable(): boolean\n\t{\n\t\treturn true;\n\t}\n}\n","import { Base } from './base';\n\nexport class DependentVariables extends Base\n{\n\tgetComponentName(): string\n\t{\n\t\treturn 'DependentVariables';\n\t}\n}\n","import { Base } from './base';\n\nexport class Multivariables extends Base\n{\n\tgetComponentName(): string\n\t{\n\t\treturn 'Multivariables';\n\t}\n}\n","import { Type } from 'main.core';\nimport type { AccessRightItem } from '../../../store/model/access-rights-model';\nimport { Base } from './base';\n\nexport class Toggler extends Base\n{\n\tgetComponentName(): string\n\t{\n\t\treturn 'Toggler';\n\t}\n\n\tgetEmptyValue(item: AccessRightItem): Set<string>\n\t{\n\t\tconst isFalsy = !item.emptyValue || !item.emptyValue[0];\n\t\tif (isFalsy)\n\t\t{\n\t\t\t// use explicit '0' for correctly identify modifications\n\t\t\treturn new Set(['0']);\n\t\t}\n\n\t\treturn super.getEmptyValue(item);\n\t}\n\n\tgetMinValue(item: AccessRightItem): ?Set<string>\n\t{\n\t\tconst explicit = super.getMinValue(item);\n\t\tif (!Type.isNull(explicit))\n\t\t{\n\t\t\treturn explicit;\n\t\t}\n\n\t\treturn new Set(['0']);\n\t}\n\n\tgetMaxValue(item: AccessRightItem): ?Set<string>\n\t{\n\t\tconst explicit = super.getMaxValue(item);\n\t\tif (!Type.isNull(explicit))\n\t\t{\n\t\t\treturn explicit;\n\t\t}\n\n\t\treturn new Set(['1']);\n\t}\n\n\tisRowValueConfigurable(): boolean\n\t{\n\t\treturn false;\n\t}\n}\n","import { Base } from './base';\n\nexport class Variables extends Base\n{\n\tgetComponentName(): string\n\t{\n\t\treturn 'Variables';\n\t}\n}\n","import { Cache } from 'main.core';\nimport type { AccessRightItem } from '../store/model/access-rights-model';\nimport { DependentVariables } from './value/type/dependent-variables';\nimport { Multivariables } from './value/type/multivariables';\nimport { Toggler } from './value/type/toggler';\nimport type { ValueType } from './value/type/value-type';\nimport { Variables } from './value/type/variables';\n\nexport class ServiceLocator\n{\n\tstatic #cache = new Cache.MemoryCache();\n\n\t/**\n\t * `BX.UI.Hint.createInstance` takes up to 30% of CPU time when multiple hints are mounted on page\n\t * (e.g. on a load, search), probably because of `Manager.initByClassName` call in `new Manager`.\n\t * therefore, we share a Manager instance across all hints in the app\n\t */\n\tstatic getHint(appGuid: string): BX.UI.Hint\n\t{\n\t\treturn this.#cache.remember(`hint-${appGuid}`, () => {\n\t\t\treturn BX.UI.Hint.createInstance({\n\t\t\t\tid: `ui-access-rights-v2-hint-${appGuid}`,\n\t\t\t\tpopupParameters: {\n\t\t\t\t\tclassName: 'ui-access-rights-v2-popup-pointer-events ui-hint-popup',\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\tdarkMode: true,\n\t\t\t\t\tmaxWidth: 280,\n\t\t\t\t\toffsetTop: 0,\n\t\t\t\t\toffsetLeft: 8,\n\t\t\t\t\tangle: true,\n\t\t\t\t\tanimation: 'fading-slide',\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic getValueTypeByRight(right: AccessRightItem): ?ValueType\n\t{\n\t\treturn this.getValueType(right.type);\n\t}\n\n\tstatic getValueType(type: string): ?ValueType\n\t{\n\t\tconst stringType = String(type);\n\n\t\treturn this.#cache.remember(stringType, () => {\n\t\t\tif (stringType === 'dependent_variables')\n\t\t\t{\n\t\t\t\treturn new DependentVariables();\n\t\t\t}\n\n\t\t\tif (stringType === 'multivariables')\n\t\t\t{\n\t\t\t\treturn new Multivariables();\n\t\t\t}\n\n\t\t\tif (stringType === 'toggler')\n\t\t\t{\n\t\t\t\treturn new Toggler();\n\t\t\t}\n\n\t\t\tif (stringType === 'variables')\n\t\t\t{\n\t\t\t\treturn new Variables();\n\t\t\t}\n\n\t\t\tconsole.warn('ui.accessrights.v2: Unknown access right type', type);\n\n\t\t\treturn null;\n\t\t});\n\t}\n}\n","export const EntitySelectorContext = Object.freeze({\n\tROLE: 'ui.accessrights.v2~role-selector',\n\tMEMBER: 'ui.accessrights.v2~member-selector',\n\tVARIABLE: 'ui.accessrights.v2~variable-selector',\n});\n\nexport const EntitySelectorEntities = Object.freeze({\n\tROLE: 'ui.accessrights.v2~role',\n\tVARIABLE: 'ui.accessrights.v2~variable',\n});\n","import { Type, Runtime } from 'main.core';\nimport { Dialog, type Item, type ItemId } from 'ui.entity-selector';\nimport { mapState } from 'ui.vue3.vuex';\nimport { EntitySelectorContext } from '../../../integration/entity-selector/dictionary';\n\nexport const Selector = {\n\tname: 'Selector',\n\temits: ['close'],\n\tprops: {\n\t\tuserGroup: {\n\t\t\t/** @type UserGroup */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tbindNode: {\n\t\t\ttype: HTMLElement,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tselectedItems(): ItemId[] {\n\t\t\tconst result = [];\n\t\t\tfor (const accessCode of this.userGroup.members.keys())\n\t\t\t{\n\t\t\t\tresult.push(this.getItemIdByAccessCode(accessCode));\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\t...mapState({\n\t\t\toptions: (state) => state.application.options,\n\t\t\taddUserGroupsProviderTab: (state) => state.application.options.additionalMembersParams.addUserGroupsProviderTab,\n\t\t\taddProjectsProviderTab: (state) => state.application.options.additionalMembersParams.addProjectsProviderTab,\n\t\t\taddStructureTeamsProviderTab: (state) => state.application.options.additionalMembersParams.addStructureTeamsProviderTab,\n\t\t}),\n\t},\n\tmounted()\n\t{\n\t\tconst entities = this.getEntities();\n\n\t\t(new Dialog({\n\t\t\tenableSearch: true,\n\t\t\tcontext: EntitySelectorContext.MEMBER,\n\t\t\talwaysShowLabels: true,\n\t\t\tentities,\n\t\t\ttargetNode: this.bindNode,\n\t\t\tpreselectedItems: this.selectedItems,\n\t\t\tcacheable: false,\n\t\t\tevents: {\n\t\t\t\t'Item:onSelect': this.onMemberAdd,\n\t\t\t\t'Item:onDeselect': this.onMemberRemove,\n\t\t\t\tonHide: () => {\n\t\t\t\t\tthis.$emit('close');\n\t\t\t\t},\n\t\t\t},\n\t\t})).show();\n\t},\n\tmethods: {\n\t\t// eslint-disable-next-line sonarjs/cognitive-complexity\n\t\tgetItemIdByAccessCode(accessCode: string): ItemId {\n\t\t\tif (/^I?U(\\d+)$/.test(accessCode))\n\t\t\t{\n\t\t\t\tconst match = accessCode.match(/^I?U(\\d+)$/) || null;\n\t\t\t\tconst userId = match ? match[1] : null;\n\n\t\t\t\treturn ['user', userId];\n\t\t\t}\n\n\t\t\tif (/^DR(\\d+)$/.test(accessCode))\n\t\t\t{\n\t\t\t\tconst match = accessCode.match(/^DR(\\d+)$/) || null;\n\t\t\t\tconst departmentId = match ? match[1] : null;\n\n\t\t\t\treturn ['department', departmentId];\n\t\t\t}\n\n\t\t\tif (/^D(\\d+)$/.test(accessCode))\n\t\t\t{\n\t\t\t\tconst match = accessCode.match(/^D(\\d+)$/) || null;\n\t\t\t\tconst departmentId = match ? match[1] : null;\n\n\t\t\t\treturn ['department', `${departmentId}:F`];\n\t\t\t}\n\n\t\t\tif (/^G(\\d+)$/.test(accessCode))\n\t\t\t{\n\t\t\t\tconst match = accessCode.match(/^G(\\d+)$/) || null;\n\t\t\t\tconst groupId = match ? match[1] : null;\n\n\t\t\t\treturn ['site-groups', groupId];\n\t\t\t}\n\n\t\t\tif (accessCode.at(0) === 'A')\n\t\t\t{\n\t\t\t\treturn ['user-groups', accessCode];\n\t\t\t}\n\n\t\t\tif (/^SG(\\d+)_([AEK])$/.test(accessCode))\n\t\t\t{\n\t\t\t\tconst match = accessCode.match(/^SG(\\d+)_([AEK])$/) || null;\n\n\t\t\t\tconst projectId = match ? match[1] : null;\n\t\t\t\tconst postfix = match ? match[2] : null;\n\n\t\t\t\treturn ['project', `${projectId}:${postfix}`];\n\t\t\t}\n\n\t\t\tif (/^SNT(\\d+)$/.test(accessCode))\n\t\t\t{\n\t\t\t\tconst match = accessCode.match(/^SNT(\\d+)$/) || null;\n\t\t\t\tconst structureNodeId = match ? match[1] : null;\n\n\t\t\t\treturn ['structure-node', `${structureNodeId}:F`];\n\t\t\t}\n\n\t\t\tif (/^SNTR(\\d+)$/.test(accessCode))\n\t\t\t{\n\t\t\t\tconst match = accessCode.match(/^SNTR(\\d+)$/) || null;\n\t\t\t\tconst structureNodeId = match ? match[1] : null;\n\n\t\t\t\treturn ['structure-node', structureNodeId];\n\t\t\t}\n\n\t\t\treturn ['unknown', accessCode];\n\t\t},\n\t\tonMemberAdd(event: BaseEvent): void {\n\t\t\tconst member = this.getMemberFromEvent(event);\n\n\t\t\tthis.$store.dispatch('userGroups/addMember', {\n\t\t\t\tuserGroupId: this.userGroup.id,\n\t\t\t\taccessCode: member.id,\n\t\t\t\tmember,\n\t\t\t});\n\t\t},\n\t\tonMemberRemove(event: BaseEvent): void {\n\t\t\tconst member = this.getMemberFromEvent(event);\n\n\t\t\tthis.$store.dispatch('userGroups/removeMember', {\n\t\t\t\tuserGroupId: this.userGroup.id,\n\t\t\t\taccessCode: member.id,\n\t\t\t});\n\t\t},\n\t\tgetMemberFromEvent(event: BaseEvent): ?Member {\n\t\t\tconst { item } = event.getData();\n\n\t\t\treturn {\n\t\t\t\tid: this.getAccessCodeByItem(item),\n\t\t\t\ttype: this.getMemberTypeByItem(item),\n\t\t\t\tname: item.title.text,\n\t\t\t\tavatar: Type.isStringFilled(item.avatar) ? item.avatar : null,\n\t\t\t};\n\t\t},\n\t\t// eslint-disable-next-line sonarjs/cognitive-complexity\n\t\tgetAccessCodeByItem(item: Item): string {\n\t\t\tconst entityId = item.entityId;\n\n\t\t\tif (entityId === 'user')\n\t\t\t{\n\t\t\t\treturn `U${item.id}`;\n\t\t\t}\n\n\t\t\tif (entityId === 'department')\n\t\t\t{\n\t\t\t\tif (Type.isString(item.id) && item.id.endsWith(':F'))\n\t\t\t\t{\n\t\t\t\t\tconst match = item.id.match(/^(\\d+):F$/);\n\t\t\t\t\tconst originalId = match ? match[1] : null;\n\n\t\t\t\t\t// only members of the department itself\n\t\t\t\t\treturn `D${originalId}`;\n\t\t\t\t}\n\n\t\t\t\t// whole department recursively\n\t\t\t\treturn `DR${item.id}`;\n\t\t\t}\n\n\t\t\tif (entityId === 'structure-node')\n\t\t\t{\n\t\t\t\tif (Type.isString(item.id) && item.id.endsWith(':F'))\n\t\t\t\t{\n\t\t\t\t\tconst match = item.id.match(/^(\\d+):F$/);\n\t\t\t\t\tconst originalId = match ? match[1] : null;\n\n\t\t\t\t\treturn `SNT${originalId}`;\n\t\t\t\t}\n\n\t\t\t\treturn `SNTR${item.id}`;\n\t\t\t}\n\n\t\t\tif (entityId === 'site-groups')\n\t\t\t{\n\t\t\t\treturn `G${item.id}`;\n\t\t\t}\n\n\t\t\tif (entityId === 'user-groups')\n\t\t\t{\n\t\t\t\treturn item.id;\n\t\t\t}\n\n\t\t\tif (entityId === 'project')\n\t\t\t{\n\t\t\t\tconst subType = item.customData.get('metauser');\n\t\t\t\tconst originalId = item.customData.get('projectId');\n\t\t\t\tif (subType === 'owner')\n\t\t\t\t{\n\t\t\t\t\treturn `SG${originalId}_A`;\n\t\t\t\t}\n\n\t\t\t\tif (subType === 'moderator')\n\t\t\t\t{\n\t\t\t\t\treturn `SG${originalId}_E`;\n\t\t\t\t}\n\n\t\t\t\tif (subType === 'all')\n\t\t\t\t{\n\t\t\t\t\treturn `SG${originalId}_K`;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn '';\n\t\t},\n\t\tgetMemberTypeByItem(item: Item): string {\n\t\t\tswitch (item.entityId)\n\t\t\t{\n\t\t\t\tcase 'user':\n\t\t\t\t\treturn 'users';\n\t\t\t\tcase 'intranet':\n\t\t\t\tcase 'department':\n\t\t\t\t\treturn 'departments';\n\t\t\t\tcase 'socnetgroup':\n\t\t\t\tcase 'project':\n\t\t\t\t\treturn 'sonetgroups';\n\t\t\t\tcase 'group':\n\t\t\t\t\treturn 'groups';\n\t\t\t\tcase 'structure-node':\n\t\t\t\t\treturn 'structureteams';\n\t\t\t\tcase 'site-groups':\n\t\t\t\tcase 'user-groups':\n\t\t\t\t\treturn 'usergroups';\n\t\t\t\tdefault:\n\t\t\t\t\treturn '';\n\t\t\t}\n\t\t},\n\t\tgetEntities(): Array {\n\t\t\tconst entities = [\n\t\t\t\t{\n\t\t\t\t\tid: 'user',\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tintranetUsersOnly: true,\n\t\t\t\t\t\temailUsers: false,\n\t\t\t\t\t\tinviteEmployeeLink: false,\n\t\t\t\t\t\tinviteGuestLink: false,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'department',\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tselectMode: 'usersAndDepartments',\n\t\t\t\t\t\tallowSelectRootDepartment: true,\n\t\t\t\t\t\tallowFlatDepartments: true,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'site-groups',\n\t\t\t\t\tdynamicLoad: true,\n\t\t\t\t\tdynamicSearch: true,\n\t\t\t\t},\n\t\t\t];\n\n\t\t\tif (this.addStructureTeamsProviderTab)\n\t\t\t{\n\t\t\t\tentities.push({\n\t\t\t\t\tid: 'structure-node',\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tselectMode: 'usersAndDepartments',\n\t\t\t\t\t\tallowSelectRootDepartment: true,\n\t\t\t\t\t\tallowFlatDepartments: true,\n\t\t\t\t\t\tincludedNodeEntityTypes: ['team'],\n\t\t\t\t\t\tuseMultipleTabs: true,\n\t\t\t\t\t\tvisual: {\n\t\t\t\t\t\t\tavatarMode: 'node',\n\t\t\t\t\t\t\ttagStyle: 'none',\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (this.addProjectsProviderTab)\n\t\t\t{\n\t\t\t\tentities.push({\n\t\t\t\t\tid: 'project',\n\t\t\t\t\tdynamicLoad: true,\n\t\t\t\t\toptions: {\n\t\t\t\t\t\taddProjectMetaUsers: true,\n\t\t\t\t\t},\n\t\t\t\t\titemOptions: {\n\t\t\t\t\t\tdefault: {\n\t\t\t\t\t\t\tlink: '',\n\t\t\t\t\t\t\tlinkTitle: '',\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (this.addUserGroupsProviderTab)\n\t\t\t{\n\t\t\t\tentities.push({\n\t\t\t\t\tid: 'user-groups',\n\t\t\t\t\tdynamicLoad: true,\n\t\t\t\t\toptions: {},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn entities;\n\t\t},\n\t},\n\t// just a template stub\n\ttemplate: '<div hidden></div>',\n};\n","import type { Member } from '../../../store/model/user-groups-model';\n\nexport const SingleMember = {\n\tname: 'SingleMember',\n\tprops: {\n\t\tmember: {\n\t\t\t/** @type Member */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tavatarBackgroundImage(): string {\n\t\t\treturn `url(${encodeURI(this.member.avatar)})`;\n\t\t},\n\t\tnoAvatarClass(): string {\n\t\t\tif (this.member.type === 'groups')\n\t\t\t{\n\t\t\t\treturn 'ui-icon-common-user-group';\n\t\t\t}\n\n\t\t\tif (this.member.type === 'sonetgroups' || this.member.type === 'departments')\n\t\t\t{\n\t\t\t\treturn 'ui-icon-common-company';\n\t\t\t}\n\n\t\t\tif (this.member.type === 'usergroups')\n\t\t\t{\n\t\t\t\treturn 'ui-icon-common-user-group';\n\t\t\t}\n\n\t\t\tif (this.member.type === 'structureteams')\n\t\t\t{\n\t\t\t\treturn 'ui-icon-common-my-plan';\n\t\t\t}\n\n\t\t\treturn 'ui-icon-common-user';\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class='ui-access-rights-v2-members-item'>\n\t\t\t<a v-if=\"member.avatar\" class='ui-access-rights-v2-members-item-avatar' :title=\"member.name\" :style=\"{\n\t\t\t\tbackgroundImage: avatarBackgroundImage,\n\t\t\t\tbackgroundSize: 'cover',\n\t\t\t}\"></a>\n\t\t\t<a v-else class='ui-icon ui-access-rights-v2-members-item-icon' :class=\"noAvatarClass\" :title=\"member.name\">\n\t\t\t\t<i></i>\n\t\t\t</a>\n\t\t</div>\n\t`,\n};\n","import type { MemberCollection } from '../../store/model/user-groups-model';\nimport { Selector } from './members/selector';\nimport { SingleMember } from './members/single-member';\n\nconst MAX_SHOWN_MEMBERS = 5;\n\nexport const Members = {\n\tname: 'Members',\n\tcomponents: { SingleMember, Selector },\n\tprops: {\n\t\tuserGroup: {\n\t\t\t/** @type UserGroup */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): Object {\n\t\treturn {\n\t\t\tisSelectorShown: false,\n\t\t\tisSelectedMembersPopupShown: false,\n\t\t};\n\t},\n\tpopup: null,\n\tcomputed: {\n\t\tshownMembers(): MemberCollection\n\t\t{\n\t\t\tif (this.userGroup.members.size <= MAX_SHOWN_MEMBERS)\n\t\t\t{\n\t\t\t\treturn this.userGroup.members;\n\t\t\t}\n\n\t\t\tconst shownKeyValuePairs = [...this.userGroup.members].slice(0, MAX_SHOWN_MEMBERS);\n\n\t\t\treturn new Map(shownKeyValuePairs);\n\t\t},\n\t\tnotShownMembersCount(): number\n\t\t{\n\t\t\tif (this.userGroup.members.size > MAX_SHOWN_MEMBERS)\n\t\t\t{\n\t\t\t\treturn this.userGroup.members.size - MAX_SHOWN_MEMBERS;\n\t\t\t}\n\n\t\t\treturn 0;\n\t\t},\n\t\tbindNode(): HTMLElement\n\t\t{\n\t\t\treturn this.$refs.container;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div ref=\"container\" class=\"ui-access-rights-v2-members-container\"  @click=\"isSelectorShown = true\">\n\t\t\t<div v-if=\"userGroup.members.size > 0\" class='ui-access-rights-v2-members'>\n\t\t\t\t<SingleMember v-for=\"[accessCode, member] in shownMembers\" :key=\"accessCode\" :member=\"member\"/>\n\t\t\t\t<span v-if=\"notShownMembersCount > 0\" class=\"ui-access-rights-v2-members-more\">\n\t\t\t\t\t+ {{ notShownMembersCount }}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tclass='ui-access-rights-v2-members-item ui-access-rights-v2-members-item-add'\n\t\t\t\t:class=\"{\n\t\t\t\t\t'--show-always': userGroup.members.size <= 0,\n\t\t\t\t\t'--has-siblings': userGroup.members.size > 0,\n\t\t\t\t}\"\n\t\t\t>\n\t\t\t\t<div class=\"ui-icon-set --plus-30\"></div>\n\t\t\t</div>\n\t\t\t<Selector\n\t\t\t\tv-if=\"isSelectorShown\"\n\t\t\t\t:user-group=\"userGroup\"\n\t\t\t\t:bind-node=\"bindNode\"\n\t\t\t\t@close=\"isSelectorShown = false\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Event } from 'main.core';\nimport { Popup } from 'main.popup';\nimport { Button, ButtonColor, ButtonSize, CancelButton } from 'ui.buttons';\nimport { RichMenuItem, RichMenuItemIcon, RichMenuPopup } from 'ui.vue3.components.rich-menu';\nimport { mapGetters, mapState } from 'ui.vue3.vuex';\n\nexport const RoleHeading = {\n\tname: 'RoleHeading',\n\tcomponents: { RichMenuPopup, RichMenuItem },\n\tprops: {\n\t\tuserGroup: {\n\t\t\t/** @type UserGroup */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): Object {\n\t\treturn {\n\t\t\tisEdit: false,\n\t\t\tisPopupShown: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tRichMenuItemIcon: () => RichMenuItemIcon,\n\t\t...mapState({\n\t\t\tisSaving: (state) => state.application.isSaving,\n\t\t\tguid: (state) => state.application.guid,\n\t\t\tmaxVisibleUserGroups: (state) => state.application.options.maxVisibleUserGroups,\n\t\t}),\n\t\t...mapGetters({\n\t\t\tisMaxVisibleUserGroupsReached: 'userGroups/isMaxVisibleUserGroupsReached',\n\t\t\tisMaxValueSetForAny: 'accessRights/isMaxValueSetForAny',\n\t\t\tisMinValueSetForAny: 'accessRights/isMinValueSetForAny',\n\t\t}),\n\t\ttitle: {\n\t\t\tget(): string {\n\t\t\t\treturn this.userGroup.title;\n\t\t\t},\n\t\t\tset(title: string): void {\n\t\t\t\tthis.$store.dispatch('userGroups/setRoleTitle', {\n\t\t\t\t\tuserGroupId: this.userGroup.id,\n\t\t\t\t\ttitle,\n\t\t\t\t});\n\t\t\t},\n\t\t},\n\t},\n\twatch: {\n\t\tisEdit(newValue): void {\n\t\t\tif (newValue === true)\n\t\t\t{\n\t\t\t\tthis.bindClickedOutsideHandler();\n\n\t\t\t\tvoid this.$nextTick(() => {\n\t\t\t\t\tthis.$refs.input.scrollIntoView({\n\t\t\t\t\t\tbehavior: 'smooth',\n\t\t\t\t\t\tblock: 'nearest',\n\t\t\t\t\t\tinline: 'nearest',\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.$refs.input.focus();\n\t\t\t\t\tthis.$refs.input.select();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.unbindClickedOutsideHandler();\n\t\t\t}\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\t// todo fix hide/show new role\n\t\tif (this.userGroup.isNew)\n\t\t{\n\t\t\t// start editing a newly created role right away\n\t\t\tthis.isEdit = true;\n\t\t}\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.unbindClickedOutsideHandler();\n\t},\n\tmethods: {\n\t\tbindClickedOutsideHandler(): void {\n\t\t\tEvent.bind(window, 'click', this.turnOffEditWhenClickedOutside, {\n\t\t\t\tcapture: true,\n\t\t\t});\n\t\t},\n\t\tunbindClickedOutsideHandler(): void {\n\t\t\tEvent.unbind(window, 'click', this.turnOffEditWhenClickedOutside, {\n\t\t\t\tcapture: true,\n\t\t\t});\n\t\t},\n\t\tturnOffEditWhenClickedOutside(event: PointerEvent): void {\n\t\t\tif (event.target !== this.$refs.input)\n\t\t\t{\n\t\t\t\tthis.isEdit = false;\n\t\t\t}\n\t\t},\n\t\tshowDeleteConfirmation(): void {\n\t\t\tconst popup = new Popup({\n\t\t\t\tbindElement: this.$refs.container,\n\t\t\t\twidth: 250,\n\t\t\t\toverlay: true,\n\t\t\t\tcontentPadding: 10,\n\t\t\t\tcontent: this.$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_POPUP_REMOVE_ROLE'),\n\t\t\t\tclassName: 'ui-access-rights-v2-text-center',\n\t\t\t\tanimation: 'fading-slide',\n\t\t\t\tcacheable: false,\n\t\t\t\tbuttons: [\n\t\t\t\t\tnew Button({\n\t\t\t\t\t\ttext: this.$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_POPUP_REMOVE_ROLE_YES'),\n\t\t\t\t\t\tsize: ButtonSize.SMALL,\n\t\t\t\t\t\tcolor: ButtonColor.PRIMARY,\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\t\tpopup.destroy();\n\t\t\t\t\t\t\t\tthis.$store.dispatch('userGroups/removeUserGroup', {\n\t\t\t\t\t\t\t\t\tuserGroupId: this.userGroup.id,\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t}),\n\t\t\t\t\tnew CancelButton({\n\t\t\t\t\t\tsize: ButtonSize.SMALL,\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\t\tpopup.destroy();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t}),\n\t\t\t\t],\n\t\t\t});\n\n\t\t\tpopup.show();\n\t\t},\n\t\tshowActionsMenu(): void {\n\t\t\tif (!this.isSaving)\n\t\t\t{\n\t\t\t\tthis.isPopupShown = true;\n\t\t\t}\n\t\t},\n\t\tonSetMaxValuesClick(): void {\n\t\t\tthis.isPopupShown = false;\n\n\t\t\tthis.$store.dispatch('userGroups/setMaxAccessRightValues', {\n\t\t\t\tuserGroupId: this.userGroup.id,\n\t\t\t});\n\t\t},\n\t\tonSetMinValuesClick(): void {\n\t\t\tthis.isPopupShown = false;\n\n\t\t\tthis.$store.dispatch('userGroups/setMinAccessRightValues', {\n\t\t\t\tuserGroupId: this.userGroup.id,\n\t\t\t});\n\t\t},\n\t\tonEnableEditClick(): void {\n\t\t\tthis.isPopupShown = false;\n\n\t\t\tthis.isEdit = true;\n\t\t},\n\t\tonCopyRoleClick(): void {\n\t\t\tif (this.isMaxVisibleUserGroupsReached)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isPopupShown = false;\n\n\t\t\tthis.$store.dispatch('userGroups/copyUserGroup', { userGroupId: this.userGroup.id });\n\t\t},\n\t\tonDeleteRoleClick(): void {\n\t\t\tthis.isPopupShown = false;\n\n\t\t\tthis.showDeleteConfirmation();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div ref=\"container\" class='ui-access-rights-v2-role'>\n\t\t\t<div class=\"ui-access-rights-v2-role-value-container\">\n\t\t\t\t<input\n\t\t\t\t\tv-if=\"isEdit && !isSaving\"\n\t\t\t\t\tref=\"input\"\n\t\t\t\t\ttype='text'\n\t\t\t\t\tclass='ui-access-rights-v2-role-input'\n\t\t\t\t\tv-model=\"title\"\n\t\t\t\t\t:placeholder=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_ROLE_NAME')\"\n\t\t\t\t\t@keydown.enter=\"isEdit = false\"\n\t\t\t\t/>\n\t\t\t\t<div v-else class='ui-access-rights-v2-role-value' :title=\"title\">{{ title }}</div>\n\t\t\t</div>\n\t\t\t<div \n\t\t\t\tref=\"menu\"\n\t\t\t\tclass=\"ui-icon-set --more ui-access-rights-v2-icon-more\" \n\t\t\t\t@click=\"showActionsMenu\"\n\t\t\t>\n\t\t\t\t<RichMenuPopup v-if=\"isPopupShown\" @close=\"isPopupShown = false\" :popup-options=\"{bindElement: $refs.menu}\">\n\t\t\t\t\t<RichMenuItem\n\t\t\t\t\t\tv-if=\"isMaxValueSetForAny\"\n\t\t\t\t\t\t:icon=\"RichMenuItemIcon.check\"\n\t\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_SET_MAX_ACCESS_RIGHTS')\"\n\t\t\t\t\t\t:subtitle=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_SET_MAX_ACCESS_RIGHTS_SUBTITLE')\"\n\t\t\t\t\t\t@click=\"onSetMaxValuesClick\"\n\t\t\t\t\t/>\n\t\t\t\t\t<RichMenuItem\n\t\t\t\t\t\tv-if=\"isMinValueSetForAny\"\n\t\t\t\t\t\t:icon=\"RichMenuItemIcon['red-lock']\"\n\t\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_SET_MIN_ACCESS_RIGHTS')\"\n\t\t\t\t\t\t:subtitle=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_SET_MIN_ACCESS_RIGHTS_SUBTITLE')\"\n\t\t\t\t\t\t@click=\"onSetMinValuesClick\"\n\t\t\t\t\t/>\n\t\t\t\t\t<RichMenuItem\n\t\t\t\t\t\t:icon=\"RichMenuItemIcon.pencil\"\n\t\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_RENAME')\"\n\t\t\t\t\t\t:subtitle=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_RENAME_SUBTITLE')\"\n\t\t\t\t\t\t@click=\"onEnableEditClick\"\n\t\t\t\t\t/>\n\t\t\t\t\t<RichMenuItem\n\t\t\t\t\t\t:icon=\"RichMenuItemIcon.copy\"\n\t\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_COPY')\"\n\t\t\t\t\t\t:subtitle=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_COPY_ROLE_SUBTITLE')\"\n\t\t\t\t\t\t:disabled=\"isMaxVisibleUserGroupsReached\"\n\t\t\t\t\t\t:hint=\"\n\t\t\t\t\t\t\tisMaxVisibleUserGroupsReached\n\t\t\t\t\t\t\t\t? $Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_ROLE_COPYING_DISABLED', {\n\t\t\t\t\t\t\t\t\t'#COUNT#': maxVisibleUserGroups,\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t: null\n\t\t\t\t\t\t\"\n\t\t\t\t\t\t@click=\"onCopyRoleClick\"\n\t\t\t\t\t/>\n\t\t\t\t\t<RichMenuItem\n\t\t\t\t\t\t:icon=\"RichMenuItemIcon['trash-bin']\"\n\t\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_REMOVE')\"\n\t\t\t\t\t\t:subtitle=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_REMOVE_SUBTITLE')\"\n\t\t\t\t\t\t@click=\"onDeleteRoleClick\"\n\t\t\t\t\t/>\n\t\t\t\t</RichMenuPopup>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Loc, Runtime } from 'main.core';\nimport { type ItemOptions } from 'ui.entity-selector';\nimport type { Variable, VariableCollection } from '../../store/model/access-rights-model';\nimport type { UserGroup, UserGroupsCollection } from '../../store/model/user-groups-model';\nimport { EntitySelectorEntities } from './dictionary';\n\nexport class ItemsMapper\n{\n\tstatic mapUserGroups(userGroups: UserGroupsCollection): ItemOptions[]\n\t{\n\t\tconst result: ItemOptions[] = [];\n\n\t\tfor (const userGroup: UserGroup of userGroups.values())\n\t\t{\n\t\t\tresult.push({\n\t\t\t\tid: userGroup.id,\n\t\t\t\tentityId: EntitySelectorEntities.ROLE,\n\t\t\t\ttitle: userGroup.title,\n\t\t\t\tsupertitle: Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_ROLE'),\n\t\t\t\tavatar: '/bitrix/js/ui/accessrights/v2/images/role-avatar.svg',\n\t\t\t\ttabs: [\n\t\t\t\t\t'recents',\n\t\t\t\t],\n\t\t\t});\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tstatic mapVariables(variables: VariableCollection): ItemOptions[]\n\t{\n\t\tconst items: ItemOptions[] = [];\n\n\t\tfor (const variable: Variable of variables.values())\n\t\t{\n\t\t\tconst item = Runtime.clone(variable);\n\t\t\titem.entityId = item.entityId || EntitySelectorEntities.VARIABLE;\n\t\t\titem.tabs = 'recents';\n\n\t\t\titems.push(item);\n\t\t}\n\n\t\treturn items;\n\t}\n}\n","export const CellLayout = {\n\ttemplate: `\n\t\t<div class='ui-access-rights-v2-column-item'>\n\t\t\t<slot/>\n\t\t</div>\n\t`,\n};\n","export const ColumnLayout = {\n\ttemplate: `\n\t\t<div class='ui-access-rights-v2-column'>\n\t\t\t<slot/>\n\t\t</div>\n\t`,\n};\n","import { type BaseEvent } from 'main.core.event';\nimport { Dialog, type ItemOptions } from 'ui.entity-selector';\nimport { RichMenuItem, RichMenuItemIcon, RichMenuPopup } from 'ui.vue3.components.rich-menu';\nimport { mapGetters, mapState } from 'ui.vue3.vuex';\nimport { EntitySelectorContext } from '../../integration/entity-selector/dictionary';\nimport { ItemsMapper } from '../../integration/entity-selector/items-mapper';\nimport { CellLayout } from '../layout/cell-layout';\nimport { ColumnLayout } from '../layout/column-layout';\nimport '../../css/header/roles-control.css';\n\nexport const RolesControl = {\n\tname: 'RolesControl',\n\tcomponents: { CellLayout, ColumnLayout, RichMenuPopup, RichMenuItem },\n\tprops: {\n\t\tuserGroups: {\n\t\t\ttype: Map,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tviewDialog: null,\n\tcomputed: {\n\t\tRichMenuItemIcon: () => RichMenuItemIcon,\n\t\t...mapState({\n\t\t\tallUserGroups: (state) => state.userGroups.collection,\n\t\t\tmaxVisibleUserGroups: (state) => state.application.options.maxVisibleUserGroups,\n\t\t\tguid: (state) => state.application.guid,\n\t\t}),\n\t\t...mapGetters({\n\t\t\tisMaxVisibleUserGroupsSet: 'application/isMaxVisibleUserGroupsSet',\n\t\t\tisMaxVisibleUserGroupsReached: 'userGroups/isMaxVisibleUserGroupsReached',\n\t\t}),\n\t\tshownGroupsCounter(): string {\n\t\t\treturn this.$Bitrix.Loc.getMessage(\n\t\t\t\t'JS_UI_ACCESSRIGHTS_V2_ROLE_COUNTER',\n\t\t\t\t{\n\t\t\t\t\t'#VISIBLE_ROLES#': this.userGroups.size,\n\t\t\t\t\t'#ALL_ROLES#': this.allUserGroups.size,\n\t\t\t\t\t'#GREY_START#': '<span style=\"opacity: var(--ui-opacity-30)\">',\n\t\t\t\t\t'#GREY_FINISH#': '</span>',\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\t\tcopyDialogItems(): ItemOptions[] {\n\t\t\treturn ItemsMapper.mapUserGroups(this.allUserGroups);\n\t\t},\n\t\tviewDialogItems(): ItemOptions[] {\n\t\t\tconst result: ItemOptions[] = [];\n\n\t\t\tfor (const copyDialogItem of this.copyDialogItems)\n\t\t\t{\n\t\t\t\tresult.push({\n\t\t\t\t\t...copyDialogItem,\n\t\t\t\t\tselected: this.userGroups.has(copyDialogItem.id),\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t},\n\tdata(): Object {\n\t\treturn {\n\t\t\tisPopupShown: false,\n\t\t};\n\t},\n\tmethods: {\n\t\tonCreateNewRoleClick(): void {\n\t\t\tif (this.isMaxVisibleUserGroupsReached)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isPopupShown = false;\n\n\t\t\tthis.$store.dispatch('userGroups/addUserGroup');\n\t\t},\n\t\tonRoleViewClick(): void {\n\t\t\tthis.isPopupShown = false;\n\n\t\t\tthis.showViewDialog(this.$refs.configure);\n\t\t},\n\t\tonCopyRoleClick(): void {\n\t\t\tif (this.isMaxVisibleUserGroupsReached)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isPopupShown = false;\n\n\t\t\tthis.showCopyDialog();\n\t\t},\n\t\tshowCopyDialog(): void {\n\t\t\tconst copyDialog = new Dialog({\n\t\t\t\tcontext: EntitySelectorContext.ROLE,\n\t\t\t\ttargetNode: this.$refs.configure,\n\t\t\t\tmultiple: false,\n\t\t\t\tdropdownMode: true,\n\t\t\t\tenableSearch: true,\n\t\t\t\tcacheable: false,\n\t\t\t\titems: this.copyDialogItems,\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (dialogEvent: BaseEvent) => {\n\t\t\t\t\t\tconst { item } = dialogEvent.getData();\n\n\t\t\t\t\t\tthis.$store.dispatch('userGroups/copyUserGroup', { userGroupId: item.getId() });\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tcopyDialog.show();\n\t\t},\n\t\tshowViewDialog(target: HTMLElement): void {\n\t\t\tthis.viewDialog = new Dialog({\n\t\t\t\tcontext: EntitySelectorContext.ROLE,\n\t\t\t\tfooter: this.isMaxVisibleUserGroupsSet ? this.$Bitrix.Loc.getMessage(\n\t\t\t\t\t'JS_UI_ACCESSRIGHTS_V2_ROLE_SELECTOR_MAX_VISIBLE_WARNING',\n\t\t\t\t\t{\n\t\t\t\t\t\t'#COUNT#': this.maxVisibleUserGroups,\n\t\t\t\t\t},\n\t\t\t\t) : null,\n\t\t\t\ttargetNode: target,\n\t\t\t\tmultiple: true,\n\t\t\t\tdropdownMode: true,\n\t\t\t\tenableSearch: true,\n\t\t\t\tcacheable: false,\n\t\t\t\titems: this.viewDialogItems,\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onBeforeSelect': (dialogEvent: BaseEvent) => {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tthis.isMaxVisibleUserGroupsSet\n\t\t\t\t\t\t\t&& this.viewDialog.getSelectedItems().length >= this.maxVisibleUserGroups\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdialogEvent.preventDefault();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t'Item:onSelect': (dialogEvent: BaseEvent) => {\n\t\t\t\t\t\tconst { item } = dialogEvent.getData();\n\n\t\t\t\t\t\tthis.$store.dispatch('userGroups/showUserGroup', { userGroupId: item.getId() });\n\t\t\t\t\t},\n\t\t\t\t\t'Item:onDeselect': (dialogEvent: BaseEvent) => {\n\t\t\t\t\t\tconst { item } = dialogEvent.getData();\n\n\t\t\t\t\t\tthis.$store.dispatch('userGroups/hideUserGroup', { userGroupId: item.getId() });\n\t\t\t\t\t},\n\t\t\t\t\tonHide: () => {\n\t\t\t\t\t\tthis.viewDialog = null;\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tthis.viewDialog.show();\n\t\t},\n\t\ttoggleViewDialog(target: HTMLElement): void {\n\t\t\tif (this.viewDialog)\n\t\t\t{\n\t\t\t\tthis.viewDialog.hide();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showViewDialog(target);\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<ColumnLayout>\n\t\t\t<CellLayout class=\"ui-access-rights-v2-header-roles-control\">\n\t\t\t\t<div class='ui-access-rights-v2-column-item-text ui-access-rights-v2-header-roles-control-header'>\n\t\t\t\t\t<div>{{ $Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_ROLES') }}</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tref=\"configure\"\n\t\t\t\t\t\tclass=\"ui-icon-set --more ui-access-rights-v2-icon-more\"\n\t\t\t\t\t\t@click=\"isPopupShown = true\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<RichMenuPopup v-if=\"isPopupShown\" @close=\"isPopupShown = false\" :popup-options=\"{bindElement: $refs.configure}\">\n\t\t\t\t\t\t\t<RichMenuItem\n\t\t\t\t\t\t\t\t:icon=\"RichMenuItemIcon.role\"\n\t\t\t\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_NEW_ROLE')\"\n\t\t\t\t\t\t\t\t:subtitle=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_NEW_ROLE_SUBTITLE')\"\n\t\t\t\t\t\t\t\t:disabled=\"isMaxVisibleUserGroupsReached\"\n\t\t\t\t\t\t\t\t:hint=\"\n\t\t\t\t\t\t\t\t\tisMaxVisibleUserGroupsReached\n\t\t\t\t\t\t\t\t\t\t? $Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_ROLE_ADDING_DISABLED', {\n\t\t\t\t\t\t\t\t\t\t\t'#COUNT#': maxVisibleUserGroups,\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t: null\n\t\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t\t\t@click=\"onCreateNewRoleClick\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<RichMenuItem\n\t\t\t\t\t\t\t\t:icon=\"RichMenuItemIcon.copy\"\n\t\t\t\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_COPY_ROLE')\"\n\t\t\t\t\t\t\t\t:subtitle=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_COPY_ROLE_SUBTITLE')\"\n\t\t\t\t\t\t\t\t:disabled=\"isMaxVisibleUserGroupsReached\"\n\t\t\t\t\t\t\t\t:hint=\"\n\t\t\t\t\t\t\t\t\tisMaxVisibleUserGroupsReached\n\t\t\t\t\t\t\t\t\t\t? $Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_ROLE_COPYING_DISABLED', {\n\t\t\t\t\t\t\t\t\t\t\t'#COUNT#': maxVisibleUserGroups,\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t: null\n\t\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t\t\t@click=\"onCopyRoleClick\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<RichMenuItem\n\t\t\t\t\t\t\t\t:icon=\"RichMenuItemIcon['opened-eye']\"\n\t\t\t\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_ROLE_VIEW')\"\n\t\t\t\t\t\t\t\t:subtitle=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_ROLE_VIEW_SUBTITLE_MSGVER_1')\"\n\t\t\t\t\t\t\t\t@click=\"onRoleViewClick\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</RichMenuPopup>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-access-rights-v2-header-roles-control-actions\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tref=\"counter\"\n\t\t\t\t\t\tclass=\"ui-access-rights-v2-header-roles-control-counter\"\n\t\t\t\t\t\t@click=\"toggleViewDialog($refs.counter)\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"ui-icon-set --opened-eye\" style=\"--ui-icon-set__icon-size: 15px;\"></div>\n\t\t\t\t\t\t<span v-html=\"shownGroupsCounter\"></span>\n\t\t\t\t\t\t<div class=\"ui-icon-set --chevron-down ui-access-rights-v2-header-roles-control-chevron\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ui-access-rights-v2-header-roles-control-expander\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"ui-icon-set --collapse\"\n\t\t\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_COLLAPSE_ALL_SECTIONS')\"\n\t\t\t\t\t\t\t@click=\"$store.dispatch('accessRights/collapseAllSections')\"\n\t\t\t\t\t\t></div>\n\t\t\t\t\t\t<div \n\t\t\t\t\t\t\tclass=\"ui-icon-set --expand-1\"\n\t\t\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_EXPAND_ALL_SECTIONS')\"\n\t\t\t\t\t\t\t@click=\"$store.dispatch('accessRights/expandAllSections')\"\n\t\t\t\t\t\t></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</CellLayout>\n\t\t</ColumnLayout>\n\t`,\n};\n","import { Text } from 'main.core';\nimport { type BaseEvent } from 'main.core.events';\nimport { mapState } from 'ui.vue3.vuex';\n\nconst isMaxListenersSet: Map<string, boolean> = new Map();\nconst lastScrollLeft: Map<string, number> = new Map();\n\n/**\n * A div without styling that synchronizes horizontal scroll of all elements wrapped in this component with other\n * wrapped elements in this Vue application.\n */\nexport const SyncHorizontalScroll = {\n\tname: 'SyncHorizontalScroll',\n\tdata(): Object {\n\t\treturn {\n\t\t\tcomponentGuid: Text.getRandom(16),\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapState({\n\t\t\tguid: (state) => state.application.guid,\n\t\t}),\n\t},\n\tthrottledEmitScrollEvent: null,\n\tcreated()\n\t{\n\t\tthis.throttledEmitScrollEvent = requestAnimationFrameThrottle(this.emitScrollEvent);\n\t},\n\tmounted(): void {\n\t\tif (!isMaxListenersSet.has(this.guid))\n\t\t{\n\t\t\t// + 1 for header\n\t\t\tconst sectionsNumber = this.$store.state.accessRights.collection.size + 1;\n\n\t\t\t// correctly notify about memory leak\n\t\t\tthis.$Bitrix.eventEmitter.incrementMaxListeners('ui:accessrights:v2:syncScroll', sectionsNumber);\n\n\t\t\tisMaxListenersSet.set(this.guid, true);\n\t\t}\n\n\t\tthis.$Bitrix.eventEmitter.subscribe('ui:accessrights:v2:syncScroll', this.handleScrollEvent);\n\n\t\tvoid this.$nextTick(() => {\n\t\t\tif (lastScrollLeft.has(this.guid))\n\t\t\t{\n\t\t\t\tthis.syncScroll(lastScrollLeft.get(this.guid));\n\t\t\t}\n\t\t});\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.$Bitrix.eventEmitter.unsubscribe('ui:accessrights:v2:syncScroll', this.handleScrollEvent);\n\t},\n\tmethods: {\n\t\temitScrollEvent(event): void {\n\t\t\t// this component instance is being scrolled, we need to notify other instances\n\t\t\tconst { scrollLeft } = event.target;\n\n\t\t\tlastScrollLeft.set(this.guid, scrollLeft);\n\n\t\t\t// emit global application event so other SyncHorizontalScroll instances receive it\n\t\t\tthis.$Bitrix.eventEmitter.emit('ui:accessrights:v2:syncScroll', {\n\t\t\t\tscrollLeft,\n\t\t\t\tcomponentGuid: this.componentGuid,\n\t\t\t});\n\t\t},\n\t\thandleScrollEvent(event: BaseEvent): void {\n\t\t\tconst { scrollLeft, componentGuid } = event.getData();\n\t\t\tif (this.componentGuid === componentGuid)\n\t\t\t{\n\t\t\t\t// this event was sent by this exact instance\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.syncScroll(scrollLeft);\n\t\t},\n\t\tsyncScroll(scrollLeft: number): void {\n\t\t\t// magic hack - don't update the element if value not changed.\n\t\t\t// I'm not sure whether this works, but why not\n\t\t\tif (this.$el.scrollLeft !== scrollLeft)\n\t\t\t{\n\t\t\t\tthis.$el.scrollLeft = scrollLeft;\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div @scroll=\"throttledEmitScrollEvent\">\n\t\t\t<slot/>\n\t\t</div>\n\t`,\n};\n\n/**\n * Same as `Runtime.throttle`, but uses `requestAnimationFrame` instead of setTimeout.\n * Why? To sync wait time with display refresh rate for smother animations.\n */\nfunction requestAnimationFrameThrottle(func: Function): Function\n{\n\tlet callbackSet = false;\n\tlet invoke = false;\n\n\treturn function wrapper(...args)\n\t{\n\t\tinvoke = true;\n\n\t\tif (!callbackSet)\n\t\t{\n\t\t\tconst q = function q()\n\t\t\t{\n\t\t\t\tif (invoke)\n\t\t\t\t{\n\t\t\t\t\tfunc(...args);\n\t\t\t\t\tinvoke = false;\n\t\t\t\t\trequestAnimationFrame(q);\n\t\t\t\t\tcallbackSet = true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tcallbackSet = false;\n\t\t\t\t}\n\t\t\t};\n\t\t\tq();\n\t\t}\n\t};\n}\n","import { mapGetters, mapState } from 'ui.vue3.vuex';\nimport { Members } from './header/members';\nimport { RoleHeading } from './header/role-heading';\nimport { RolesControl } from './header/roles-control';\nimport { CellLayout } from './layout/cell-layout';\nimport { ColumnLayout } from './layout/column-layout';\nimport { SyncHorizontalScroll } from './util/sync-horizontal-scroll';\nimport { hint } from 'ui.vue3.directives.hint';\nimport 'ui.buttons';\n\n/**\n * A special case of Section\n */\n// @vue/component\nexport const Header = {\n\tname: 'Header',\n\tcomponents: { RoleHeading, SyncHorizontalScroll, Members, RolesControl, ColumnLayout, CellLayout },\n\tdirectives: {\n\t\thint,\n\t},\n\tprops: {\n\t\tuserGroups: {\n\t\t\ttype: Map,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\t...mapState({\n\t\t\tmaxVisibleUserGroups: (state) => state.application.options.maxVisibleUserGroups,\n\t\t}),\n\t\t...mapGetters({\n\t\t\tisMaxVisibleUserGroupsReached: 'userGroups/isMaxVisibleUserGroupsReached',\n\t\t}),\n\t},\n\tmethods: {\n\t\tonCreateNewRoleClick(): void\n\t\t{\n\t\t\tif (this.isMaxVisibleUserGroupsReached)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$store.dispatch('userGroups/addUserGroup');\n\t\t},\n\t},\n\t// data attributes are needed for e2e automated tests\n\ttemplate: `\n\t\t<div class=\"ui-access-rights-v2-section ui-access-rights-v2--head-section\">\n\t\t\t<div class='ui-access-rights-v2-section-container'>\n\t\t\t\t<div class='ui-access-rights-v2-section-head'>\n\t\t\t\t\t<RolesControl :user-groups=\"userGroups\"/>\n\t\t\t\t</div>\n\t\t\t\t<div class='ui-access-rights-v2-section-content'>\n\t\t\t\t\t<SyncHorizontalScroll class='ui-access-rights-v2-section-wrapper'>\n\t\t\t\t\t\t<ColumnLayout\n\t\t\t\t\t\t\tv-for=\"[groupId, group] in userGroups\" \n\t\t\t\t\t\t\t:key=\"groupId\"\n\t\t\t\t\t\t\t:data-accessrights-user-group-id=\"groupId\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<CellLayout class=\"ui-access-rights-v2-header-role-cell\">\n\t\t\t\t\t\t\t\t<RoleHeading :user-group=\"group\"/>\n\t\t\t\t\t\t\t\t<Members :user-group=\"group\"/>\n\t\t\t\t\t\t\t</CellLayout>\n\t\t\t\t\t\t</ColumnLayout>\n\t\t\t\t\t\t<ColumnLayout>\n\t\t\t\t\t\t\t<div class=\"ui-access-rights-v2-header-role-add\">\n\t\t\t\t\t\t\t\t<button class=\"ui-btn ui-btn-light-border ui-btn-round ui-btn-disabled\"\n\t\t\t\t\t\t\t\t\t\tv-if=\"isMaxVisibleUserGroupsReached\"\n\t\t\t\t\t\t\t\t\t\tv-hint=\"$Bitrix.Loc.getMessage(\n\t\t\t\t\t\t\t\t\t 'JS_UI_ACCESSRIGHTS_V2_ROLE_ADDING_DISABLED', \n\t\t\t\t\t\t\t\t\t {'#COUNT#': maxVisibleUserGroups,})\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div class=\"ui-icon-set --plus-20\"/>\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t<button class=\"ui-btn ui-btn-light-border ui-btn-round\"\n\t\t\t\t\t\t\t\t\t\tv-else\n\t\t\t\t\t\t\t\t\t\t@click=\"onCreateNewRoleClick\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div class=\"ui-icon-set --plus-20\"/>\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</ColumnLayout>\n\t\t\t\t\t</SyncHorizontalScroll>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Runtime } from 'main.core';\n\nexport const SearchBox = {\n\tname: 'SearchBox',\n\tdebouncedSetSearchQuery: null,\n\tcreated()\n\t{\n\t\tconst setSearchQuery = (query) => {\n\t\t\tthis.$store.dispatch('accessRights/search', { query });\n\t\t};\n\n\t\tthis.debouncedSetSearchQuery = Runtime.debounce(setSearchQuery, 200);\n\t},\n\tcomputed: {\n\t\tsearchQuery: {\n\t\t\tget(): string {\n\t\t\t\treturn this.$store.state.accessRights.searchQuery;\n\t\t\t},\n\t\t\tset(query: string): void {\n\t\t\t\tthis.debouncedSetSearchQuery(query);\n\t\t\t},\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-w100 ui-access-rights-v2-search\">\n\t\t\t<input\n\t\t\t\ttype=\"text\"\n\t\t\t\tclass=\"ui-ctl-element ui-ctl-textbox ui-access-rights-v2-search-input\"\n\t\t\t\t:placeholder=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_SEARCH_PLACEHOLDER')\"\n\t\t\t\tv-model=\"searchQuery\"\n\t\t\t>\n\t\t\t<a class=\"ui-ctl-after ui-ctl-icon-search ui-access-rights-v2-search-icon\"></a>\n\t\t</div>\n\t`,\n};\n","import { Loc, Text, Type } from 'main.core';\nimport type { AccessRightItem, Variable, VariableCollection } from './store/model/access-rights-model';\n\nexport function shouldRowBeRendered(accessRightItem: AccessRightItem): boolean\n{\n\tif (!accessRightItem.isShown)\n\t{\n\t\treturn false;\n\t}\n\n\treturn !accessRightItem.group || accessRightItem.isGroupExpanded;\n}\n\nexport function getSelectedVariables(\n\tvariables: VariableCollection,\n\tselected: Set<string>,\n\tisAllSelected: boolean,\n): VariableCollection\n{\n\tif (isAllSelected)\n\t{\n\t\treturn variables;\n\t}\n\n\tconst selectedVariables = new Map();\n\n\tfor (const [variableId, variable] of variables)\n\t{\n\t\tif (selected.has(variableId))\n\t\t{\n\t\t\tselectedVariables.set(variableId, variable);\n\t\t}\n\t}\n\n\treturn selectedVariables;\n}\n\nexport function getMultipleSelectedVariablesTitle(selectedVariables: VariableCollection): string\n{\n\tconst lastVariable: Variable = [...selectedVariables.values()].pop();\n\n\tif (selectedVariables.size === 1)\n\t{\n\t\treturn lastVariable.title;\n\t}\n\n\treturn Loc.getMessage(\n\t\t'JS_UI_ACCESSRIGHTS_V2_HAS_SELECTED_ITEMS',\n\t\t{\n\t\t\t'#FIRST_ITEM_NAME#': cutLongTitle(lastVariable.title),\n\t\t\t'#COUNT_REST_ITEMS#': selectedVariables.size - 1,\n\t\t},\n\t);\n}\n\nfunction cutLongTitle(title: string): string\n{\n\tconst VARIABLE_TITLE_MAX_LENGTH = 15;\n\n\tif (title.length > VARIABLE_TITLE_MAX_LENGTH)\n\t{\n\t\treturn `${title.slice(0, VARIABLE_TITLE_MAX_LENGTH)}...`;\n\t}\n\n\treturn title;\n}\n\nexport function getMultipleSelectedVariablesHintHtml(\n\tselectedVariables: VariableCollection,\n\thintTitle: string,\n\tallVariables: VariableCollection,\n): string\n{\n\tif (selectedVariables.size < 2)\n\t{\n\t\treturn '';\n\t}\n\n\tlet listItems = '';\n\tfor (const value of makeSortedVariablesArray(selectedVariables, allVariables))\n\t{\n\t\tlistItems += `<li>${Text.encode(value.title)}</li>`;\n\t}\n\n\treturn `\n\t\t<p>${Text.encode(hintTitle)}</p>\n\t\t<ul>${listItems}</ul>\n\t`;\n}\n\nfunction makeSortedVariablesArray(toSort: VariableCollection, example: VariableCollection): Variable[]\n{\n\tconst orderMap = new Map();\n\n\tlet index = 0;\n\tfor (const [variableId] of example)\n\t{\n\t\torderMap.set(variableId, index);\n\n\t\tindex++;\n\t}\n\n\treturn [...toSort.values()].sort((a, b) => {\n\t\tconst indexA = orderMap.get(a.id);\n\t\tconst indexB = orderMap.get(b.id);\n\n\t\tif (Type.isNil(indexA))\n\t\t{\n\t\t\treturn 1;\n\t\t}\n\n\t\tif (Type.isNil(indexB))\n\t\t{\n\t\t\treturn -1;\n\t\t}\n\n\t\treturn indexA - indexB;\n\t});\n}\n\nexport const DEFAULT_ALIAS_SEPARATOR = '|';\n\nexport function parseAliasKey(key: string, separator = DEFAULT_ALIAS_SEPARATOR): Set<string>\n{\n\tconst parts = key.split(separator);\n\n\treturn new Set(parts);\n}\n\nexport function compileAliasKey(parts: Set<string>, separator = DEFAULT_ALIAS_SEPARATOR): string\n{\n\tconst sortedParts = [...parts].sort();\n\n\treturn sortedParts.join(separator);\n}\n\nexport function normalizeAliasKey(key: string, separator = DEFAULT_ALIAS_SEPARATOR): string\n{\n\tconst parsed = parseAliasKey(key, separator);\n\n\treturn compileAliasKey(parsed, separator);\n}\n","import { Runtime, Type } from 'main.core';\nimport { type ActionTree, BuilderModel, GetterTree, type MutationTree } from 'ui.vue3.vuex';\nimport { ServiceLocator } from '../../service/service-locator';\nimport { compileAliasKey } from '../../utils';\n\nexport type AccessRightsState = {\n\tcollection: AccessRightsCollection,\n\tsearchQuery: string,\n}\n\nexport type AccessRightsCollection = Map<string, AccessRightSection>;\n\nexport type AccessRightSection = {\n\tsectionTitle: string,\n\tsectionSubTitle: ?string,\n\tsectionCode: string, // not sent to backend, frontend uses it only for indexing\n\tsectionHint: ?string,\n\tsectionIcon?: AccessRightSectionIcon,\n\trights: Map<string, AccessRightItem>,\n\tisExpanded: boolean,\n\tisShown: boolean,\n};\n\nexport type AccessRightSectionIcon = {\n\ttype: string, // icon name from 'ui.icon-set'\n\tbgColor: string, // hex or --ui-color-palette-* variable name\n};\n\nexport type AccessRightItem = {\n\tid: string,\n\ttype: string,\n\ttitle: string,\n\thint: ?string, // hint for row title in the title column\n\tgroup: ?string, // id of parent item id\n\tgroupHead: boolean,\n\tisGroupExpanded: ?boolean, // only for group head and grouped items\n\tisShown: boolean,\n\tminValue?: Set<string>,\n\tmaxValue?: Set<string>,\n\tdefaultValue?: Set<string>,\n\temptyValue?: Set<string>,\n\tnothingSelectedValue?: Set<string>,\n\tsetEmptyOnSetMinMaxValueInColumn?: boolean,\n\n\tvariables: VariableCollection, // options to choose from in variable-like controls\n\n\t// only for multivariable\n\tallSelectedCode: ?string,\n\tselectedVariablesAliases: Map<string, string>,\n\tselectedVariablesAliasesSeparator: ?string,\n\tenableSearch?: boolean,\n\tshowAvatars?: boolean,\n\tcompactView?: boolean,\n\thintTitle: ?string, // title for 'already selected values' hint in multivariable and dependent-variables selector\n};\n\nexport type VariableCollection = Map<string, Variable>;\n\nexport type Variable = {\n\tid: string,\n\ttitle: string,\n\t// used only in multivariable selector\n\tentityId: ?string,\n\tsupertitle: ?string,\n\tavatar: ?string,\n\tavatarOptions: ?Object,\n\t// used only in dependent-variables\n\tconflictsWith?: Set<string>,\n\trequires?: Set<string>,\n\tsecondary: ?boolean, // switcher color and size for dependent-variables\n}\n\nexport class AccessRightsModel extends BuilderModel\n{\n\t#initialRights: AccessRightsCollection = new Map();\n\n\tgetName(): string\n\t{\n\t\treturn 'accessRights';\n\t}\n\n\tsetInitialAccessRights(rights: AccessRightsCollection): AccessRightsModel\n\t{\n\t\tthis.#initialRights = rights;\n\n\t\treturn this;\n\t}\n\n\tgetState(): AccessRightsState\n\t{\n\t\treturn {\n\t\t\tcollection: Runtime.clone(this.#initialRights),\n\t\t\tsearchQuery: '',\n\t\t};\n\t}\n\n\tgetElementState(params = {}): AccessRightSection\n\t{\n\t\tthrow new Error('Cant create AccessRightSection. You are doing something wrong');\n\t}\n\n\tgetGetters(): GetterTree<AccessRightsState>\n\t{\n\t\treturn {\n\t\t\tshown: (state): AccessRightsCollection => {\n\t\t\t\tconst result = new Map();\n\n\t\t\t\tfor (const [sectionCode, section] of state.collection)\n\t\t\t\t{\n\t\t\t\t\tif (section.isShown)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.set(sectionCode, section);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\tisMinValueSetForAny: (state, getters): boolean => {\n\t\t\t\tfor (const section of state.collection.values())\n\t\t\t\t{\n\t\t\t\t\tfor (const item of section.rights.values())\n\t\t\t\t\t{\n\t\t\t\t\t\tconst isSet = getters.isMinValueSet(section.sectionCode, item.id);\n\t\t\t\t\t\tif (isSet)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tisMinValueSet: (state) => (sectionCode: string, rightId: string): boolean => {\n\t\t\t\tconst item = state.collection.get(sectionCode)?.rights.get(rightId);\n\t\t\t\tif (!item)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn(\n\t\t\t\t\t\t'ui.accessrights.v2: attempt to check if min value set for unknown right',\n\t\t\t\t\t\t{ sectionCode, rightId },\n\t\t\t\t\t);\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn !Type.isNil(item.minValue);\n\t\t\t},\n\t\t\tisMaxValueSetForAny: (state, getters): boolean => {\n\t\t\t\tfor (const section of state.collection.values())\n\t\t\t\t{\n\t\t\t\t\tfor (const item of section.rights.values())\n\t\t\t\t\t{\n\t\t\t\t\t\tconst isSet = getters.isMaxValueSet(section.sectionCode, item.id);\n\t\t\t\t\t\tif (isSet)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tisMaxValueSet: (state) => (sectionCode: string, rightId: string): boolean => {\n\t\t\t\tconst item = state.collection.get(sectionCode)?.rights.get(rightId);\n\t\t\t\tif (!item)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn(\n\t\t\t\t\t\t'ui.accessrights.v2: attempt to check if max value set for unknown right',\n\t\t\t\t\t\t{ sectionCode, rightId },\n\t\t\t\t\t);\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn !Type.isNil(item.maxValue);\n\t\t\t},\n\t\t\tgetEmptyValue: (state) => (sectionCode: string, valueId: string): Set<string> => {\n\t\t\t\tconst item = state.collection.get(sectionCode)?.rights.get(valueId);\n\t\t\t\tif (!item)\n\t\t\t\t{\n\t\t\t\t\treturn new Set();\n\t\t\t\t}\n\n\t\t\t\treturn ServiceLocator.getValueTypeByRight(item)?.getEmptyValue(item) ?? new Set();\n\t\t\t},\n\t\t\tgetNothingSelectedValue: (state, getters) => (sectionCode: string, valueId: string): Set<string> => {\n\t\t\t\tconst item = state.collection.get(sectionCode)?.rights.get(valueId);\n\n\t\t\t\treturn item?.nothingSelectedValue ?? getters.getEmptyValue(sectionCode, valueId);\n\t\t\t},\n\t\t\tgetSelectedVariablesAlias: (state) => (sectionCode: string, valueId: string, values: Set<string>): ?string => {\n\t\t\t\tconst item = state.collection.get(sectionCode)?.rights.get(valueId);\n\t\t\t\tif (!item)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tconst key = compileAliasKey(values, item.selectedVariablesAliasesSeparator);\n\n\t\t\t\treturn item.selectedVariablesAliases.get(key);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree<AccessRightsState>\n\t{\n\t\treturn {\n\t\t\ttoggleSection: (store, { sectionCode }): void => {\n\t\t\t\tif (!store.state.collection.has(sectionCode))\n\t\t\t\t{\n\t\t\t\t\tconsole.warn('ui.accessrights.v2: Attempt to toggle section that dont exists', { sectionCode });\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('toggleSection', { sectionCode });\n\t\t\t},\n\t\t\texpandAllSections: (store): void => {\n\t\t\t\tfor (const sectionCode of store.state.collection.keys())\n\t\t\t\t{\n\t\t\t\t\tstore.commit('expandSection', { sectionCode });\n\t\t\t\t}\n\t\t\t},\n\t\t\tcollapseAllSections: (store): void => {\n\t\t\t\tfor (const sectionCode of store.state.collection.keys())\n\t\t\t\t{\n\t\t\t\t\tstore.commit('collapseSection', { sectionCode });\n\t\t\t\t}\n\t\t\t},\n\t\t\ttoggleGroup: (store, { sectionCode, groupId }): void => {\n\t\t\t\tconst item = store.state.collection.get(sectionCode)?.rights.get(groupId);\n\t\t\t\tif (!item)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn('ui.accessrights.v2: Attempt to toggle group that dont exists', { groupId });\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!item.groupHead)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn('ui.accessrights.v2: Attempt to toggle group that is not group head', { groupId });\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('toggleGroup', { sectionCode, groupId });\n\t\t\t},\n\t\t\tsearch: (store, payload): void => {\n\t\t\t\tthis.#searchAction(store, payload);\n\t\t\t},\n\t\t};\n\t}\n\n\t#searchAction(store, { query }): void\n\t{\n\t\tif (!Type.isString(query))\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: attempt to search with non-string search query');\n\n\t\t\treturn;\n\t\t}\n\n\t\tstore.commit('setSearchQuery', { query });\n\t\tif (query === '')\n\t\t{\n\t\t\tstore.commit('showAll');\n\n\t\t\treturn;\n\t\t}\n\n\t\tstore.commit('hideAll');\n\n\t\tconst lowerQuery = query.toLowerCase();\n\n\t\tfor (const section: AccessRightSection of store.state.collection.values())\n\t\t{\n\t\t\tif (\n\t\t\t\tsection.sectionTitle.toLowerCase().includes(lowerQuery)\n\t\t\t\t|| section.sectionSubTitle?.toLowerCase().includes(lowerQuery)\n\t\t\t)\n\t\t\t{\n\t\t\t\tstore.commit('showSection', { sectionCode: section.sectionCode });\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tfor (const item: AccessRightItem of section.rights.values())\n\t\t\t{\n\t\t\t\tif (!item.title.toLowerCase().includes(lowerQuery))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (item.groupHead)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('showGroup', { sectionCode: section.sectionCode, groupId: item.id });\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstore.commit('showItem', { sectionCode: section.sectionCode, itemId: item.id });\n\t\t\t\t\tif (item.group)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('expandGroup', { sectionCode: section.sectionCode, groupId: item.group });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetMutations(): MutationTree<AccessRightsState>\n\t{\n\t\treturn {\n\t\t\ttoggleSection: (state, { sectionCode }): void => {\n\t\t\t\tconst section = state.collection.get(sectionCode);\n\n\t\t\t\tsection.isExpanded = !section.isExpanded;\n\t\t\t},\n\t\t\texpandSection: (state, { sectionCode }): void => {\n\t\t\t\tconst section = state.collection.get(sectionCode);\n\n\t\t\t\tsection.isExpanded = true;\n\t\t\t},\n\t\t\tcollapseSection: (state, { sectionCode }): void => {\n\t\t\t\tconst section = state.collection.get(sectionCode);\n\n\t\t\t\tsection.isExpanded = false;\n\t\t\t},\n\t\t\ttoggleGroup: (state, { sectionCode, groupId }): void => {\n\t\t\t\tconst section = state.collection.get(sectionCode);\n\n\t\t\t\tfor (const item of section.rights.values())\n\t\t\t\t{\n\t\t\t\t\tif (\n\t\t\t\t\t\t(item.id === groupId && item.groupHead)\n\t\t\t\t\t\t|| item.group === groupId\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\titem.isGroupExpanded = !item.isGroupExpanded;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\texpandGroup: (state, { sectionCode, groupId }): void => {\n\t\t\t\tconst section = state.collection.get(sectionCode);\n\n\t\t\t\tsection.isExpanded = true;\n\n\t\t\t\tfor (const item of section.rights.values())\n\t\t\t\t{\n\t\t\t\t\tif (\n\t\t\t\t\t\t(item.id === groupId && item.groupHead)\n\t\t\t\t\t\t|| item.group === groupId\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\titem.isGroupExpanded = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tshowItem: (state, { sectionCode, itemId }): void => {\n\t\t\t\tconst section = state.collection.get(sectionCode);\n\t\t\t\tsection.isShown = true;\n\n\t\t\t\tconst item = section.rights.get(itemId);\n\t\t\t\titem.isShown = true;\n\t\t\t\tif (item.group)\n\t\t\t\t{\n\t\t\t\t\tsection.rights.get(item.group).isShown = true;\n\t\t\t\t}\n\t\t\t},\n\t\t\tshowGroup: (state, { sectionCode, groupId }): void => {\n\t\t\t\tconst section = state.collection.get(sectionCode);\n\n\t\t\t\tsection.isShown = true;\n\n\t\t\t\tfor (const item of section.rights.values())\n\t\t\t\t{\n\t\t\t\t\tif (\n\t\t\t\t\t\t(item.id === groupId && item.groupHead)\n\t\t\t\t\t\t|| item.group === groupId\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\titem.isShown = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tshowSection: (state, { sectionCode }): void => {\n\t\t\t\tconst section = state.collection.get(sectionCode);\n\t\t\t\tsection.isShown = true;\n\t\t\t\tfor (const item of section.rights.values())\n\t\t\t\t{\n\t\t\t\t\titem.isShown = true;\n\t\t\t\t}\n\t\t\t},\n\t\t\tshowAll: (state): void => {\n\t\t\t\tfor (const section of state.collection.values())\n\t\t\t\t{\n\t\t\t\t\tsection.isShown = true;\n\t\t\t\t\tfor (const item of section.rights.values())\n\t\t\t\t\t{\n\t\t\t\t\t\titem.isShown = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\thideAll: (state): void => {\n\t\t\t\tfor (const section of state.collection.values())\n\t\t\t\t{\n\t\t\t\t\tsection.isShown = false;\n\t\t\t\t\tfor (const item of section.rights.values())\n\t\t\t\t\t{\n\t\t\t\t\t\titem.isShown = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetSearchQuery: (state, { query }): void => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.searchQuery = String(query);\n\t\t\t},\n\t\t};\n\t}\n}\n","import { Runtime } from 'main.core';\nimport { type PopupOptions } from 'main.popup';\nimport { Dialog, type ItemOptions } from 'ui.entity-selector';\nimport { RichMenuItem, RichMenuItemIcon, RichMenuPopup } from 'ui.vue3.components.rich-menu';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { EntitySelectorContext } from '../../../integration/entity-selector/dictionary';\nimport { ItemsMapper } from '../../../integration/entity-selector/items-mapper';\nimport type { UserGroupsCollection } from '../../../store/model/user-groups-model';\nimport { CellLayout } from '../../layout/cell-layout';\nimport '../../../css/section/menu-cell.css';\n\nexport const MenuCell = {\n\tname: 'MenuCell',\n\tcomponents: {\n\t\tCellLayout,\n\t\tRichMenuPopup,\n\t\tRichMenuItem,\n\t},\n\tinject: ['section', 'userGroup'],\n\tdata(): Object {\n\t\treturn {\n\t\t\tisMenuShown: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tRichMenuItemIcon: () => RichMenuItemIcon,\n\t\t...mapGetters({\n\t\t\tisMaxValueSetForAny: 'accessRights/isMaxValueSetForAny',\n\t\t\tisMinValueSetForAny: 'accessRights/isMinValueSetForAny',\n\t\t}),\n\t\tmenuPopupOptions(): PopupOptions {\n\t\t\tconst width = 290;\n\n\t\t\treturn {\n\t\t\t\tbindElement: this.$refs.icon,\n\t\t\t\twidth,\n\t\t\t\t// by default popup is positioned so that the left top angle is below the bind element.\n\t\t\t\t// we need to position it in the center of the column\n\t\t\t\toffsetLeft: -Math.floor(width / 2) + 9,\n\t\t\t};\n\t\t},\n\t\tshownUserGroupsWithoutCurrent(): UserGroupsCollection {\n\t\t\tconst shown: UserGroupsCollection = this.$store.getters['userGroups/shown'];\n\n\t\t\tconst shownWithoutCurrent: UserGroupsCollection = Runtime.clone(shown);\n\t\t\tshownWithoutCurrent.delete(this.userGroup.id);\n\n\t\t\treturn shownWithoutCurrent;\n\t\t},\n\t\tapplyDialogItems(): ItemOptions[] {\n\t\t\treturn ItemsMapper.mapUserGroups(this.shownUserGroupsWithoutCurrent);\n\t\t},\n\t},\n\tmethods: {\n\t\ttoggleMenu(): void\n\t\t{\n\t\t\tthis.isMenuShown = !this.isMenuShown;\n\t\t},\n\t\tshowApplyDialog(): void\n\t\t{\n\t\t\tthis.isMenuShown = false;\n\n\t\t\tconst applyDialog = new Dialog({\n\t\t\t\tcontext: EntitySelectorContext.ROLE,\n\t\t\t\ttargetNode: this.$refs.icon,\n\t\t\t\tmultiple: false,\n\t\t\t\tdropdownMode: true,\n\t\t\t\tenableSearch: true,\n\t\t\t\tcacheable: false,\n\t\t\t\titems: this.applyDialogItems,\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (dialogEvent: BaseEvent) => {\n\t\t\t\t\t\tconst { item } = dialogEvent.getData();\n\n\t\t\t\t\t\tthis.$store.dispatch('userGroups/copySectionValues', {\n\t\t\t\t\t\t\tsrcUserGroupId: this.userGroup.id,\n\t\t\t\t\t\t\tdstUserGroupId: item.getId(),\n\t\t\t\t\t\t\tsectionCode: this.section.sectionCode,\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tapplyDialog.show();\n\t\t},\n\t\tsetMaxValuesInSection(): void\n\t\t{\n\t\t\tthis.isMenuShown = false;\n\n\t\t\tthis.$store.dispatch('userGroups/setMaxAccessRightValuesInSection', {\n\t\t\t\tuserGroupId: this.userGroup.id,\n\t\t\t\tsectionCode: this.section.sectionCode,\n\t\t\t});\n\t\t},\n\t\tsetMinValuesInSection(): void\n\t\t{\n\t\t\tthis.isMenuShown = false;\n\n\t\t\tthis.$store.dispatch('userGroups/setMinAccessRightValuesInSection', {\n\t\t\t\tuserGroupId: this.userGroup.id,\n\t\t\t\tsectionCode: this.section.sectionCode,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<CellLayout class=\"ui-access-rights-v2-menu-cell\" style=\"cursor: pointer\" @click=\"toggleMenu\">\n\t\t\t<div\n\t\t\t\tref=\"icon\"\n\t\t\t\tclass=\"ui-icon-set --more ui-access-rights-v2-icon-more\"\n\t\t\t>\n\t\t\t\t<RichMenuPopup\n\t\t\t\t\tv-if=\"isMenuShown\"\n\t\t\t\t\t@close=\"isMenuShown = false\"\n\t\t\t\t\t:popup-options=\"menuPopupOptions\"\n\t\t\t\t>\n\t\t\t\t\t<RichMenuItem\n\t\t\t\t\t\tv-if=\"isMaxValueSetForAny\"\n\t\t\t\t\t\t:icon=\"RichMenuItemIcon.check\"\n\t\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_SET_MAX_ACCESS_RIGHTS')\"\n\t\t\t\t\t\t:subtitle=\"$Bitrix.Loc.getMessage(\n\t\t\t\t\t\t\t'JS_UI_ACCESSRIGHTS_V2_SET_MAX_ACCESS_RIGHTS_SUBTITLE_SECTION',\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t'#SECTION#': section.sectionTitle + (section.sectionSubTitle ? (' ' + section.sectionSubTitle) : ''),\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\"\n\t\t\t\t\t\t@click=\"setMaxValuesInSection\"\n\t\t\t\t\t/>\n\t\t\t\t\t<RichMenuItem\n\t\t\t\t\t\tv-if=\"isMinValueSetForAny\"\n\t\t\t\t\t\t:icon=\"RichMenuItemIcon['red-lock']\"\n\t\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_SET_MIN_ACCESS_RIGHTS')\"\n\t\t\t\t\t\t:subtitle=\"$Bitrix.Loc.getMessage(\n\t\t\t\t\t\t\t'JS_UI_ACCESSRIGHTS_V2_SET_MIN_ACCESS_RIGHTS_SUBTITLE_SECTION',\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t'#SECTION#': section.sectionTitle + (section.sectionSubTitle ? (' ' + section.sectionSubTitle) : ''),\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\"\n\t\t\t\t\t\t@click=\"setMinValuesInSection\"\n\t\t\t\t\t/>\n\t\t\t\t\t<RichMenuItem\n\t\t\t\t\t\t:icon=\"RichMenuItemIcon.copy\"\n\t\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_APPLY_TO_ROLE')\"\n\t\t\t\t\t\t:subtitle=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_APPLY_TO_ROLE_SUBTITLE')\"\n\t\t\t\t\t\t@click=\"showApplyDialog\"\n\t\t\t\t\t/>\n\t\t\t\t</RichMenuPopup>\n\t\t\t</div>\n\t\t</CellLayout>\n\t`,\n};\n","export const Icon = {\n\tname: 'Icon',\n\tinject: ['section'],\n\tcomputed: {\n\t\ticonBgColor(): string {\n\t\t\tif (this.section.sectionIcon.bgColor.startsWith('--'))\n\t\t\t{\n\t\t\t\t// css variable\n\t\t\t\treturn `var(${this.section.sectionIcon.bgColor})`;\n\t\t\t}\n\n\t\t\t// we assume its hex\n\t\t\treturn this.section.sectionIcon.bgColor;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-if=\"section.sectionIcon\" class=\"ui-access-rights-v2-section-header-icon\" :style=\"{\n\t\t\tbackgroundColor: iconBgColor,\n\t\t}\">\n\t\t\t<div class=\"ui-icon-set\" :class=\"'--' + section.sectionIcon.type\"></div>\n\t\t</div>\n\t`,\n};\n","import { Icon as SectionIcon } from '../../icon';\nimport '../../../../css/value/popup-header/locator.css';\n\nexport const Locator = {\n\tname: 'Locator',\n\tcomponents: { SectionIcon },\n\tprops: {\n\t\tmaxWidth: {\n\t\t\ttype: Number,\n\t\t\t// same as value popup width\n\t\t\tdefault: 430,\n\t\t},\n\t},\n\tinject: ['section', 'right'],\n\tcomputed: {\n\t\trightOrGroupTitle(): string {\n\t\t\tif (!this.right.group)\n\t\t\t{\n\t\t\t\treturn this.right.title;\n\t\t\t}\n\n\t\t\tconst groupHead = this.section.rights.get(this.right.group);\n\n\t\t\treturn groupHead?.title;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ui-access-rights-v2-cell-popup-header-locator\" :style=\"{\n\t\t\tmaxWidth: maxWidth + 'px',\n\t\t}\">\n\t\t\t<SectionIcon/>\n\t\t\t<span\n\t\t\t\tclass=\"ui-access-rights-v2-text-ellipsis\"\n\t\t\t\t:title=\"section.sectionTitle\"\n\t\t\t>{{ section.sectionTitle }}</span>\n\t\t\t<span\n\t\t\t\tv-if=\"section.sectionSubTitle\" \n\t\t\t\tclass=\"ui-access-rights-v2-text-ellipsis\"\n\t\t\t\t:title=\"section.sectionSubTitle\"\n\t\t\t\tstyle=\"margin-left: 5px; color: var(--ui-color-palette-gray-70);\"\n\t\t\t>{{ section.sectionSubTitle }}</span>\n\t\t\t<div class=\"ui-icon-set --chevron-right ui-access-rights-v2-cell-popup-header-chevron\"></div>\n\t\t\t<template v-if=\"rightOrGroupTitle !== right.title\">\n\t\t\t\t<span class=\"ui-access-rights-v2-text-ellipsis\" :title=\"right.title\">{{ right.title }}</span>\n\t\t\t\t<div class=\"ui-icon-set --chevron-right ui-access-rights-v2-cell-popup-header-chevron\"></div>\n\t\t\t</template>\n\t\t\t<span class=\"ui-access-rights-v2-text-ellipsis\" :title=\"rightOrGroupTitle\">{{ rightOrGroupTitle }}</span>\n\t\t</div>\n\t`,\n};\n","import { Switcher } from 'ui.vue3.components.switcher';\nimport '../../../../css/value/popup-header/master-switcher.css';\n\nexport const MasterSwitcher = {\n\tname: 'MasterSwitcher',\n\tcomponents: { Switcher },\n\temits: ['check', 'uncheck'],\n\tprops: {\n\t\tisChecked: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tinject: ['section', 'right'],\n\tcomputed: {\n\t\tswitcherOptions(): Object {\n\t\t\treturn {\n\t\t\t\tsize: 'small',\n\t\t\t\tcolor: 'green',\n\t\t\t};\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ui-access-rights-v2-cell-popup-header-master-switcher\" :class=\"{\n\t\t\t'--checked': isChecked,\n\t\t}\">\n\t\t\t<slot/>\n\t\t\t<div class=\"ui-access-rights-v2-cell-popup-header-toggle-container\">\n\t\t\t\t<span class=\"ui-access-rights-v2-cell-popup-header-toggle-caption\">{{\n\t\t\t\t\t$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_ACCESS')\n\t\t\t\t}}</span>\n\t\t\t\t<Switcher\n\t\t\t\t\t:is-checked=\"isChecked\"\n\t\t\t\t\t@check=\"$emit('check')\"\n\t\t\t\t\t@uncheck=\"$emit('uncheck')\"\n\t\t\t\t\t:options=\"switcherOptions\"\n\t\t\t\t\tdata-accessrights-min-max\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import '../../../../../css/value/popup-header/master-switcher/single-role-title.css';\n\nexport const SingleRoleTitle = {\n\tname: 'SingleRoleTitle',\n\tprops: {\n\t\tuserGroupTitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ui-access-rights-v2-cell-popup-header-role-container\">\n\t\t\t<div>\n\t\t\t\t<div class=\"ui-access-rights-v2-cell-popup-header-role-caption\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_ROLE') }}\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"ui-access-rights-v2-cell-popup-header-role-title ui-access-rights-v2-text-ellipsis\"\n\t\t\t\t\t:title=\"userGroupTitle\"\n\t\t\t\t>\n\t\t\t\t\t{{ userGroupTitle }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Type } from 'main.core';\nimport { Locator } from '../popup-header/locator';\nimport { MasterSwitcher } from '../popup-header/master-switcher';\nimport { SingleRoleTitle } from '../popup-header/master-switcher/single-role-title';\n\nexport const PopupHeader = {\n\tname: 'DependentVariablesPopupHeader',\n\tcomponents: { Locator, MasterSwitcher, SingleRoleTitle },\n\temits: ['setMax', 'setMin'],\n\tprops: {\n\t\tvalues: {\n\t\t\t/** @type Set<string> */\n\t\t\ttype: Set,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tinject: ['right'],\n\tcomputed: {\n\t\tisChecked(): boolean {\n\t\t\tif (!this.isMinMaxValuesSet)\n\t\t\t{\n\t\t\t\treturn this.values.size > 0;\n\t\t\t}\n\n\t\t\treturn this.isSelectedAnythingBesidesMin;\n\t\t},\n\t\tisMinMaxValuesSet(): boolean {\n\t\t\treturn !Type.isNil(this.right.minValue) && !Type.isNil(this.right.maxValue);\n\t\t},\n\t\tisSelectedAnythingBesidesMin(): boolean {\n\t\t\tif (this.values.size <= 0)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tfor (const variableId of this.values)\n\t\t\t{\n\t\t\t\tif (!this.right.minValue.has(variableId))\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t},\n\tmethods: {\n\t\tsetMin(): void\n\t\t{\n\t\t\tif (this.isMinMaxValuesSet)\n\t\t\t{\n\t\t\t\tthis.$emit('setMin');\n\t\t\t}\n\t\t},\n\t\tsetMax(): void\n\t\t{\n\t\t\tif (this.isMinMaxValuesSet)\n\t\t\t{\n\t\t\t\tthis.$emit('setMax');\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div>\n\t\t\t<Locator/>\n\t\t\t<MasterSwitcher\n\t\t\t\t:is-checked=\"isChecked\"\n\t\t\t\t@check=\"setMax\"\n\t\t\t\t@uncheck=\"setMin\"\n\t\t\t>\n\t\t\t\t<slot/>\n\t\t\t</MasterSwitcher>\n\t\t</div>\n\t`,\n};\n","import { Runtime, Type } from 'main.core';\nimport '../../../../css/value/dependent-variables/popup-content.css';\nimport 'ui.icon';\nimport 'ui.icon-set.actions';\nimport { Switcher } from 'ui.vue3.components.switcher';\nimport type { Variable, VariableCollection } from '../../../../store/model/access-rights-model';\nimport { PopupHeader } from './popup-header';\n\nexport const PopupContent = {\n\tname: 'DependentVariablesPopupContent',\n\temits: ['apply'],\n\tcomponents: { Switcher, PopupHeader },\n\tprops: {\n\t\t// value for selector is id of a selected variable\n\t\tinitialValues: {\n\t\t\ttype: Set,\n\t\t\tdefault: new Set(),\n\t\t},\n\t},\n\tdata(): Object {\n\t\treturn {\n\t\t\t// values modified during popup lifetime and not yet dispatched to store\n\t\t\tnotSavedValues: this.getNotSavedValues(),\n\t\t};\n\t},\n\tinject: ['section', 'right', 'redefineApply'],\n\tcomputed: {\n\t\tisMinMaxValuesSet(): boolean {\n\t\t\treturn !Type.isNil(this.right.minValue) && !Type.isNil(this.right.maxValue);\n\t\t},\n\t\tvariablesShownInList(): VariableCollection {\n\t\t\tif (!this.isMinMaxValuesSet)\n\t\t\t{\n\t\t\t\treturn this.right.variables;\n\t\t\t}\n\n\t\t\tconst variablesWithoutMinAndSecondary: VariableCollection = Runtime.clone(this.right.variables);\n\t\t\tfor (const variableId of this.right.minValue)\n\t\t\t{\n\t\t\t\tvariablesWithoutMinAndSecondary.delete(variableId);\n\t\t\t}\n\n\t\t\tfor (const [variableId: string, variable: Variable] of variablesWithoutMinAndSecondary)\n\t\t\t{\n\t\t\t\tif (variable.secondary)\n\t\t\t\t{\n\t\t\t\t\tvariablesWithoutMinAndSecondary.delete(variableId);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn variablesWithoutMinAndSecondary;\n\t\t},\n\t\tsecondaryVariables(): VariableCollection {\n\t\t\tconst result: VariableCollection = new Map();\n\n\t\t\tfor (const [variableId, variable] of this.right.variables)\n\t\t\t{\n\t\t\t\tif (variable.secondary)\n\t\t\t\t{\n\t\t\t\t\tresult.set(variableId, variable);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\tnothingSelectedValues(): ?Set<string> {\n\t\t\treturn this.$store.getters['accessRights/getNothingSelectedValue'](this.section.sectionCode, this.right.id);\n\t\t},\n\t\tswitcherOptions(): Object {\n\t\t\treturn {\n\t\t\t\tsize: 'small',\n\t\t\t\tcolor: 'primary',\n\t\t\t};\n\t\t},\n\t\tsecondarySwitcherOptions(): Object {\n\t\t\treturn {\n\t\t\t\tsize: 'extra-small',\n\t\t\t\tcolor: 'green',\n\t\t\t};\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tthis.redefineApply(() => {\n\t\t\tthis.apply();\n\t\t});\n\t},\n\tmethods: {\n\t\taddValue(variableId: string): void {\n\t\t\tconst variable: ?Variable = this.right.variables.get(variableId);\n\t\t\tif (!variable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.notSavedValues.add(variableId);\n\n\t\t\tif (!Type.isNil(variable.requires))\n\t\t\t{\n\t\t\t\tfor (const requiredId of variable.requires)\n\t\t\t\t{\n\t\t\t\t\tthis.notSavedValues.add(requiredId);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!Type.isNil(variable.conflictsWith))\n\t\t\t{\n\t\t\t\t// remove old variables that conflict with variable we want to add\n\t\t\t\tfor (const conflictId of variable.conflictsWith)\n\t\t\t\t{\n\t\t\t\t\tthis.notSavedValues.delete(conflictId);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (const otherVariable of this.right.variables.values())\n\t\t\t{\n\t\t\t\tif (otherVariable.id === variableId)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// if one of the current variables conflicts with newly added variables, we remove old variable\n\t\t\t\tif (this.notSavedValues.has(otherVariable.id) && !Type.isNil(otherVariable.conflictsWith))\n\t\t\t\t{\n\t\t\t\t\tfor (const conflictId of otherVariable.conflictsWith)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.notSavedValues.has(conflictId))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.notSavedValues.delete(otherVariable.id);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tremoveValue(variableId: string): void {\n\t\t\tthis.notSavedValues.delete(variableId);\n\n\t\t\tfor (const otherVariableId of this.notSavedValues)\n\t\t\t{\n\t\t\t\tif (otherVariableId === variableId)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst otherVariable: ?Variable = this.right.variables.get(otherVariableId);\n\t\t\t\tif (!otherVariable)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (!Type.isNil(otherVariable.requires) && otherVariable.requires.has(variableId))\n\t\t\t\t{\n\t\t\t\t\tthis.notSavedValues.delete(otherVariableId);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tsetMaxValue(): void {\n\t\t\tfor (const variableId of this.right.maxValue)\n\t\t\t{\n\t\t\t\tthis.addValue(variableId);\n\t\t\t}\n\t\t},\n\t\tsetMinValue(): void {\n\t\t\tfor (const variableId of this.right.minValue)\n\t\t\t{\n\t\t\t\tthis.addValue(variableId);\n\t\t\t}\n\t\t},\n\t\tapply(): void {\n\t\t\tlet values = this.notSavedValues;\n\t\t\tif (values.size <= 0)\n\t\t\t{\n\t\t\t\tvalues = this.nothingSelectedValues;\n\t\t\t}\n\n\t\t\tthis.$emit('apply', {\n\t\t\t\tvalues,\n\t\t\t});\n\t\t},\n\t\tgetNotSavedValues(): Set {\n\t\t\tconst result = new Set();\n\t\t\tthis.initialValues.forEach((value) => {\n\t\t\t\tif (this.right.variables.has(value))\n\t\t\t\t{\n\t\t\t\t\tresult.add(value);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn result;\n\t\t},\n\t},\n\t// data attributes are needed for e2e automated tests\n\ttemplate: `\n\t\t<div>\n\t\t\t<PopupHeader\n\t\t\t\t:values=\"notSavedValues\"\n\t\t\t\t@set-max=\"setMaxValue\"\n\t\t\t\t@set-min=\"setMinValue\"\n\t\t\t>\n\t\t\t\t<slot name=\"role-title\"/>\n\t\t\t</PopupHeader>\n\t\t\t<div class=\"ui-access-rights-v2-dv-popup--line-container\">\n\t\t\t\t<div\n\t\t\t\t\tv-for=\"[variableId, variable] in variablesShownInList\"\n\t\t\t\t\t:key=\"variableId\"\n\t\t\t\t\tclass=\"ui-access-rights-v2-dv-popup--line\"\n\t\t\t\t>\n\t\t\t\t\t<span class=\"ui-access-rights-v2-text-ellipsis\" :title=\"variable.title\">{{ variable.title }}</span>\n\t\t\t\t\t<Switcher\n\t\t\t\t\t\t:is-checked=\"notSavedValues.has(variable.id)\"\n\t\t\t\t\t\t@check=\"addValue(variable.id)\"\n\t\t\t\t\t\t@uncheck=\"removeValue(variable.id)\"\n\t\t\t\t\t\t:options=\"switcherOptions\"\n\t\t\t\t\t\t:data-accessrights-variable-id=\"variable.id\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tv-for=\"[variableId, variable] in secondaryVariables\"\n\t\t\t\t\t:key=\"variableId\"\n\t\t\t\t\tclass=\"ui-access-rights-v2-dv-popup--line --secondary\"\n\t\t\t\t>\n\t\t\t\t\t<Switcher\n\t\t\t\t\t\t:is-checked=\"notSavedValues.has(variable.id)\"\n\t\t\t\t\t\t@check=\"addValue(variable.id)\"\n\t\t\t\t\t\t@uncheck=\"removeValue(variable.id)\"\n\t\t\t\t\t\t:options=\"secondarySwitcherOptions\"\n\t\t\t\t\t\tstyle=\"padding-right: 5px;\"\n\t\t\t\t\t\t:data-accessrights-variable-id=\"variable.id\"\n\t\t\t\t\t/>\n\t\t\t\t\t<span class=\"ui-access-rights-v2-text-ellipsis\">{{ variable.title }}</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import '../../../../../css/value/popup-header/master-switcher/all-roles-title.css';\n\nexport const AllRolesTitle = {\n\tname: 'AllRolesTitle',\n\ttemplate: `\n\t\t<div class=\"ui-access-rights-v2-cell-popup-header-all-role-container\">\n\t\t\t<div class=\"ui-icon-set --persons-3\" style=\"margin-right: 4px;\"></div>\n\t\t\t<div class=\"ui-access-rights-v2-cell-popup-header-all-roles-caption\">{{ \n\t\t\t\t$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_ALL_ROLES')\n\t\t\t}}</div>\n\t\t</div>\n\t`,\n};\n","import { ApplyButton, ButtonColor, CancelButton } from 'ui.buttons';\nimport { Popup } from 'ui.vue3.components.popup';\nimport '../../../css/value/value-popup.css';\n\nexport const ValuePopup = {\n\tname: 'ValuePopup',\n\tcomponents: { Popup },\n\temits: ['close', 'apply'],\n\tprovide(): Object {\n\t\treturn {\n\t\t\tredefineApply: (func: Function) => {\n\t\t\t\tthis.onApply = func;\n\t\t\t},\n\t\t};\n\t},\n\tdata(): Object {\n\t\treturn {\n\t\t\tonApply: () => {\n\t\t\t\tthis.$emit('apply');\n\t\t\t},\n\t\t};\n\t},\n\tcomputed: {\n\t\tpopupOptions(): PopupOptions {\n\t\t\treturn {\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseEsc: true,\n\t\t\t\tcacheable: false,\n\t\t\t\tminWidth: 466,\n\t\t\t\tpadding: 18,\n\t\t\t};\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tvoid this.$nextTick(() => {\n\t\t\tconst applyButton = new ApplyButton({\n\t\t\t\tcolor: ButtonColor.PRIMARY,\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.apply();\n\t\t\t\t\tthis.$emit('close');\n\t\t\t\t},\n\t\t\t});\n\t\t\tapplyButton.renderTo(this.$refs['button-container']);\n\n\t\t\tconst cancelButton = new CancelButton({\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.$emit('close');\n\t\t\t\t},\n\t\t\t});\n\t\t\tcancelButton.renderTo(this.$refs['button-container']);\n\t\t});\n\t},\n\tmethods: {\n\t\tapply(): void\n\t\t{\n\t\t\tthis.onApply();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Popup @close=\"$emit('close')\" :options=\"popupOptions\">\n\t\t\t<slot/>\n\t\t\t<div ref=\"button-container\" class=\"ui-access-rights-v2-value-popup-buttons\"></div>\n\t\t</Popup>\n\t`,\n};\n","import { PopupContent } from '../../value/dependent-variables/popup-content';\nimport { AllRolesTitle } from '../../value/popup-header/master-switcher/all-roles-title';\nimport { ValuePopup } from '../../value/value-popup';\n\nexport const DependentVariables = {\n\tname: 'DependentVariables',\n\tcomponents: { PopupContent, AllRolesTitle, ValuePopup },\n\temits: ['close'],\n\tinject: ['section', 'right'],\n\tmethods: {\n\t\tapply({ values }): void\n\t\t{\n\t\t\tthis.$store.dispatch('userGroups/setAccessRightValuesForShown', {\n\t\t\t\tsectionCode: this.section.sectionCode,\n\t\t\t\tvalueId: this.right.id,\n\t\t\t\tvalues,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<ValuePopup @close=\"$emit('close')\">\n\t\t\t<PopupContent @apply=\"apply\">\n\t\t\t\t<template #role-title>\n\t\t\t\t\t<AllRolesTitle/>\n\t\t\t\t</template>\n\t\t\t</PopupContent>\n\t\t</ValuePopup>\n\t`,\n};\n","import { Dom, Event, Loc, Tag } from 'main.core';\nimport { DefaultFooter, Dialog, Item } from 'ui.entity-selector';\n\nexport class Footer extends DefaultFooter\n{\n\tconstructor(dialog: Dialog, options: { [option: string]: any })\n\t{\n\t\tsuper(dialog, options);\n\n\t\tthis.selectAllButton = Tag.render`<div class=\"ui-selector-footer-link\">${\n\t\t\tLoc.getMessage('JS_UI_ACCESSRIGHTS_V2_ALL_SELECT_LABEL')\n\t\t}</div>`;\n\t\tDom.hide(this.selectAllButton);\n\t\tEvent.bind(this.selectAllButton, 'click', this.#selectAll.bind(this));\n\n\t\tthis.deselectAllButton = Tag.render`<div class=\"ui-selector-footer-link\">${\n\t\t\tLoc.getMessage('JS_UI_ACCESSRIGHTS_V2_ALL_DESELECT_LABEL')\n\t\t}</div>`;\n\t\tDom.hide(this.deselectAllButton);\n\t\tEvent.bind(this.deselectAllButton, 'click', this.#deselectAll.bind(this));\n\n\t\tthis.getDialog().subscribe('Item:onSelect', this.#onItemStatusChange.bind(this));\n\t\tthis.getDialog().subscribe('Item:onDeselect', this.#onItemStatusChange.bind(this));\n\t}\n\n\tgetContent(): HTMLElement | HTMLElement[] | string | null\n\t{\n\t\tthis.#toggleSelectButtons();\n\n\t\treturn [this.selectAllButton, this.deselectAllButton];\n\t}\n\n\t#toggleSelectButtons(): void\n\t{\n\t\tif (this.getDialog().getSelectedItems().length === this.getDialog().getItems().length)\n\t\t{\n\t\t\tDom.hide(this.selectAllButton);\n\t\t\tDom.show(this.deselectAllButton);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.show(this.selectAllButton);\n\t\t\tDom.hide(this.deselectAllButton);\n\t\t}\n\t}\n\n\t#selectAll(): void\n\t{\n\t\tthis\n\t\t\t.getDialog()\n\t\t\t.getItems()\n\t\t\t.forEach((item: Item) => {\n\t\t\t\titem.select();\n\t\t\t})\n\t\t;\n\t}\n\n\t#deselectAll(): void\n\t{\n\t\tthis\n\t\t\t.getDialog()\n\t\t\t.getSelectedItems()\n\t\t\t.forEach((item: Item) => {\n\t\t\t\titem.deselect();\n\t\t\t})\n\t\t;\n\t}\n\n\t#onItemStatusChange(): void\n\t{\n\t\tthis.#toggleSelectButtons();\n\t}\n}\n","import { Tag } from 'main.core';\nimport { BaseHeader } from 'ui.entity-selector';\nimport { BitrixVue } from 'ui.vue3';\nimport { Locator } from '../../components/section/value/popup-header/locator';\n\nexport class Header extends BaseHeader\n{\n\trender(): HTMLElement\n\t{\n\t\treturn this.#renderVueApp();\n\t}\n\n\t#renderVueApp(): HTMLElement\n\t{\n\t\tconst container = Tag.render`<div style=\"padding: 20px 20px 0;\"></div>`;\n\n\t\tconst app = BitrixVue.createApp(Locator, {\n\t\t\tmaxWidth: this.getDialog().getWidth(),\n\t\t});\n\t\tapp.provide('section', this.getOption('section'));\n\t\tapp.provide('right', this.getOption('right'));\n\n\t\tapp.mount(container);\n\n\t\treturn container;\n\t}\n}\n","import { Runtime } from 'main.core';\nimport type { BaseEvent } from 'main.core.events';\nimport { Dialog, type Item, type ItemOptions } from 'ui.entity-selector';\nimport { EntitySelectorContext, EntitySelectorEntities } from '../../../../integration/entity-selector/dictionary';\nimport { Footer } from '../../../../integration/entity-selector/footer';\nimport { Header } from '../../../../integration/entity-selector/header';\nimport { ItemsMapper } from '../../../../integration/entity-selector/items-mapper';\nimport type { Variable, VariableCollection } from '../../../../store/model/access-rights-model';\nimport { getSelectedVariables } from '../../../../utils';\n\nexport const Selector = {\n\tname: 'Selector',\n\temits: ['apply', 'close'],\n\tprops: {\n\t\t// value for selector is id of a selected variable\n\t\tinitialValues: {\n\t\t\ttype: Set,\n\t\t\tdefault: new Set(),\n\t\t},\n\t},\n\tinject: ['section', 'right'],\n\tdata(): Object {\n\t\treturn {\n\t\t\t// values modified during popup lifetime and not yet dispatched to store\n\t\t\tvalues: this.initialValues,\n\t\t};\n\t},\n\tdialog: null,\n\tcomputed: {\n\t\tisAllSelected(): boolean {\n\t\t\treturn this.values.has(this.right.allSelectedCode);\n\t\t},\n\t\tselectedVariables(): VariableCollection {\n\t\t\treturn getSelectedVariables(this.right.variables, this.values, this.isAllSelected);\n\t\t},\n\t\tdialogItems(): ItemOptions[] {\n\t\t\treturn ItemsMapper.mapVariables(this.right.variables);\n\t\t},\n\t\tselectedDialogItems(): ItemOptions[] {\n\t\t\treturn this.dialogItems.filter((item) => this.selectedVariables.has(item.id));\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tthis.showSelector();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.dialog?.hide();\n\t},\n\tmethods: {\n\t\tshowSelector(): void {\n\t\t\tthis.dialog = new Dialog({\n\t\t\t\theight: 400,\n\t\t\t\tcontext: EntitySelectorContext.VARIABLE,\n\t\t\t\tenableSearch: this.right.enableSearch,\n\t\t\t\tmultiple: true,\n\t\t\t\tautoHide: true,\n\t\t\t\thideByEsc: true,\n\t\t\t\tdropdownMode: true,\n\t\t\t\tcompactView: this.right.compactView,\n\t\t\t\tshowAvatars: this.right.showAvatars,\n\t\t\t\tselectedItems: this.selectedDialogItems,\n\t\t\t\tsearchOptions: {\n\t\t\t\t\tallowCreateItem: false,\n\t\t\t\t},\n\t\t\t\tcacheable: false,\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': this.onItemSelect,\n\t\t\t\t\t'Item:onDeselect': this.onItemDeselect,\n\t\t\t\t\tonHide: this.apply,\n\t\t\t\t\tonDestroy: () => {\n\t\t\t\t\t\tthis.dialog = null;\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: EntitySelectorEntities.VARIABLE,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\titems: this.dialogItems,\n\t\t\t\theader: Header,\n\t\t\t\theaderOptions: {\n\t\t\t\t\tsection: this.section,\n\t\t\t\t\tright: this.right,\n\t\t\t\t},\n\t\t\t\tfooter: Footer,\n\t\t\t});\n\n\t\t\tthis.dialog.show();\n\t\t},\n\t\tonItemSelect(event: BaseEvent): void {\n\t\t\tconst addedItem: Item = event.getData().item;\n\n\t\t\tthis.addValue(String(addedItem.getId()));\n\t\t},\n\t\tonItemDeselect(event: BaseEvent): void {\n\t\t\tconst removedItem: Item = event.getData().item;\n\n\t\t\tthis.removeValue(String(removedItem.getId()));\n\t\t},\n\t\taddValue(value: string): void {\n\t\t\tconst newValues = Runtime.clone(this.values);\n\n\t\t\tnewValues.add(value);\n\n\t\t\tif (newValues.size >= this.right.variables.size)\n\t\t\t{\n\t\t\t\tthis.setValues(new Set([this.right.allSelectedCode]));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.setValues(newValues);\n\t\t\t}\n\t\t},\n\t\tremoveValue(value: string): void {\n\t\t\tif (this.values.has(this.right.allSelectedCode))\n\t\t\t{\n\t\t\t\tconst allVariablesIds = [...this.right.variables.values()].map((variable: Variable) => variable.id);\n\n\t\t\t\tconst allVariablesIdsWithoutRemoved = new Set(allVariablesIds);\n\t\t\t\tallVariablesIdsWithoutRemoved.delete(value);\n\n\t\t\t\tthis.setValues(allVariablesIdsWithoutRemoved);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst newValues = [...this.values].filter((candidate) => candidate !== value);\n\n\t\t\t\tthis.setValues(new Set(newValues));\n\t\t\t}\n\t\t},\n\t\tsetValues(newValues: Set<string>): void {\n\t\t\tthis.values = newValues;\n\t\t},\n\t\tapply(): void {\n\t\t\tthis.setNothingSelectedValueIfNeeded();\n\n\t\t\tthis.$emit('apply', {\n\t\t\t\tvalues: this.values,\n\t\t\t});\n\n\t\t\tthis.$emit('close');\n\t\t},\n\t\tsetNothingSelectedValueIfNeeded(): void {\n\t\t\tif (this.values.size <= 0)\n\t\t\t{\n\t\t\t\tconst nothingSelected = this.$store.getters['accessRights/getNothingSelectedValue'](\n\t\t\t\t\tthis.section.sectionCode,\n\t\t\t\t\tthis.right.id,\n\t\t\t\t);\n\n\t\t\t\tfor (const nothing of nothingSelected)\n\t\t\t\t{\n\t\t\t\t\tthis.addValue(nothing);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div></div>\n\t`,\n};\n","import { Selector } from '../../value/multivariables/selector';\n\nexport const Multivariables = {\n\tname: 'Multivariables',\n\temits: ['close'],\n\tcomponents: {\n\t\tSelector,\n\t},\n\tinject: ['section', 'right'],\n\tmethods: {\n\t\tapply({ values }): void\n\t\t{\n\t\t\tthis.$store.dispatch('userGroups/setAccessRightValuesForShown', {\n\t\t\t\tsectionCode: this.section.sectionCode,\n\t\t\t\tvalueId: this.right.id,\n\t\t\t\tvalues,\n\t\t\t});\n\t\t},\n\t\tclose(): void\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Selector @apply=\"apply\" @close=\"close\"/>\n\t`,\n};\n","import { MenuManager } from 'main.popup';\n\nconst POPUP_ID = 'ui-access-rights-v2-row-value-variables';\n\nexport const Variables = {\n\tname: 'Variables',\n\temits: ['close'],\n\tinject: ['section', 'right'],\n\tmounted()\n\t{\n\t\tthis.showSelector();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.closeSelector();\n\t},\n\tmethods: {\n\t\tshowSelector(): void {\n\t\t\tconst menuItems = [];\n\t\t\tfor (const variable of this.right.variables.values())\n\t\t\t{\n\t\t\t\tmenuItems.push({\n\t\t\t\t\tid: variable.id,\n\t\t\t\t\ttext: variable.title,\n\t\t\t\t\tonclick: (innerEvent, item) => {\n\t\t\t\t\t\titem\n\t\t\t\t\t\t\t.getMenuWindow()\n\t\t\t\t\t\t\t?.close()\n\t\t\t\t\t\t;\n\n\t\t\t\t\t\tthis.setValue(variable.id);\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tMenuManager.show({\n\t\t\t\tid: POPUP_ID,\n\t\t\t\tbindElement: this.$el,\n\t\t\t\titems: menuItems,\n\t\t\t\tautoHide: true,\n\t\t\t\tcacheable: false,\n\t\t\t\tevents: {\n\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\tthis.$emit('close');\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\tsetValue(value): void {\n\t\t\tthis.$store.dispatch('userGroups/setAccessRightValuesForShown', {\n\t\t\t\tsectionCode: this.section.sectionCode,\n\t\t\t\tvalueId: this.right.id,\n\t\t\t\tvalues: new Set([value]),\n\t\t\t});\n\t\t},\n\t\tcloseSelector(): void {\n\t\t\tMenuManager.getMenuById(POPUP_ID)?.close();\n\t\t},\n\t},\n\t// invisible div for binding selector to it\n\ttemplate: `\n\t\t<div></div>\n\t`,\n};\n","import { hint } from 'ui.vue3.directives.hint';\n\n/**\n * A special case of Hint. We don't need interactivity here, but we do need to wrap slot with a hint.\n * Combine these properties in a single vue hint wrapper is impossible.\n */\nexport const SelectedHint = {\n\tname: 'SelectedHint',\n\tprops: {\n\t\thtml: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): Object {\n\t\treturn {\n\t\t\tisRendered: true,\n\t\t};\n\t},\n\twatch: {\n\t\thtml(): void {\n\t\t\t// force hint directive to re-render\n\t\t\tthis.isRendered = false;\n\t\t\tvoid this.$nextTick(() => {\n\t\t\t\tthis.isRendered = true;\n\t\t\t});\n\t\t},\n\t},\n\tdirectives: {\n\t\thint,\n\t},\n\t// offsetTop is needed to fix infinite mouseenter/mouseleave loop in chromium. issue 204272\n\ttemplate: `\n\t\t<div v-if=\"isRendered\" v-hint=\"{\n\t\t\thtml,\n\t\t\tpopupOptions: {\n\t\t\t\toffsetTop: 3,\n\t\t\t},\n\t\t}\" data-hint-init=\"vue\">\n\t\t\t<slot/>\n\t\t</div>\n\t`,\n};\n","import { Type } from 'main.core';\nimport type { VariableCollection } from '../../../../store/model/access-rights-model';\nimport {\n\tgetMultipleSelectedVariablesHintHtml,\n\tgetMultipleSelectedVariablesTitle,\n\tgetSelectedVariables,\n} from '../../../../utils';\nimport { PopupContent } from '../../value/dependent-variables/popup-content';\nimport { SingleRoleTitle } from '../../value/popup-header/master-switcher/single-role-title';\nimport { ValuePopup } from '../../value/value-popup';\nimport { SelectedHint } from './../../../util/selected-hint';\n\nexport const DependentVariables = {\n\tname: 'DependentVariables',\n\tcomponents: { ValuePopup, PopupContent, SelectedHint, SingleRoleTitle },\n\tprops: {\n\t\t// value for selector is id of a selected variable\n\t\tvalue: {\n\t\t\t/** @type AccessRightValue */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): Object {\n\t\treturn {\n\t\t\tisPopupShown: false,\n\t\t};\n\t},\n\tinject: ['section', 'userGroup', 'right'],\n\tcomputed: {\n\t\tselectedVariables(): VariableCollection {\n\t\t\treturn getSelectedVariables(this.right.variables, this.value.values, false);\n\t\t},\n\t\tcurrentAlias(): ?string {\n\t\t\treturn this.$store.getters['accessRights/getSelectedVariablesAlias'](this.section.sectionCode, this.value.id, this.value.values);\n\t\t},\n\t\ttitle(): string {\n\t\t\tif (Type.isString(this.currentAlias))\n\t\t\t{\n\t\t\t\treturn this.currentAlias;\n\t\t\t}\n\n\t\t\tif (this.selectedVariables.size <= 0)\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_ADD');\n\t\t\t}\n\n\t\t\treturn getMultipleSelectedVariablesTitle(this.selectedVariables);\n\t\t},\n\t\thintHtml(): string {\n\t\t\treturn getMultipleSelectedVariablesHintHtml(this.selectedVariables, this.hintTitle, this.right.variables);\n\t\t},\n\t\thintTitle(): string {\n\t\t\tif (Type.isString(this.right.hintTitle))\n\t\t\t{\n\t\t\t\treturn this.right.hintTitle;\n\t\t\t}\n\n\t\t\treturn this.$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_SELECTED_ITEMS_TITLE');\n\t\t},\n\t},\n\tmethods: {\n\t\tapply({ values }): void\n\t\t{\n\t\t\tthis.$store.dispatch('userGroups/setAccessRightValues', {\n\t\t\t\tsectionCode: this.section.sectionCode,\n\t\t\t\tuserGroupId: this.userGroup.id,\n\t\t\t\tvalueId: this.value.id,\n\t\t\t\tvalues,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class='ui-access-rights-v2-column-item-text-link' :class=\"{\n\t\t\t'ui-access-rights-v2-text-ellipsis': !hintHtml\n\t\t}\" @click=\"isPopupShown = true\">\n\t\t\t<SelectedHint v-if=\"hintHtml\" :html=\"hintHtml\">{{title}}</SelectedHint>\n\t\t\t<div v-else :title=\"title\">{{title}}</div>\n\t\t\t<ValuePopup v-if=\"isPopupShown\" @close=\"isPopupShown = false\">\n\t\t\t\t<PopupContent\n\t\t\t\t\t@apply=\"apply\"\n\t\t\t\t\t:initial-values=\"value.values\"\n\t\t\t\t>\n\t\t\t\t\t<template #role-title>\n\t\t\t\t\t\t<SingleRoleTitle :user-group-title=\"userGroup.title\"/>\n\t\t\t\t\t</template>\n\t\t\t\t</PopupContent>\n\t\t\t</ValuePopup>\n\t\t</div>\n\t`,\n};\n","import { Type } from 'main.core';\nimport type { VariableCollection } from '../../../../store/model/access-rights-model';\nimport {\n\tgetMultipleSelectedVariablesHintHtml,\n\tgetMultipleSelectedVariablesTitle,\n\tgetSelectedVariables,\n} from '../../../../utils';\nimport { Selector } from '../../value/multivariables/selector';\nimport { SelectedHint } from './../../../util/selected-hint';\n\nexport const Multivariables = {\n\tname: 'Multivariables',\n\tcomponents: {\n\t\tSelectedHint,\n\t\tSelector,\n\t},\n\tprops: {\n\t\t// value for selector is id of a selected variable\n\t\tvalue: {\n\t\t\t/** @type AccessRightValue */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tinject: ['section', 'userGroup', 'right'],\n\tdata(): Object {\n\t\treturn {\n\t\t\tisSelectorShown: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tisAllSelected(): boolean {\n\t\t\treturn this.value.values.has(this.right.allSelectedCode);\n\t\t},\n\t\tselectedVariables(): VariableCollection {\n\t\t\treturn getSelectedVariables(this.right.variables, this.value.values, this.isAllSelected);\n\t\t},\n\t\tcurrentAlias(): ?string {\n\t\t\treturn this.$store.getters['accessRights/getSelectedVariablesAlias'](this.section.sectionCode, this.value.id, this.value.values);\n\t\t},\n\t\ttitle(): string {\n\t\t\tif (Type.isString(this.currentAlias))\n\t\t\t{\n\t\t\t\treturn this.currentAlias;\n\t\t\t}\n\n\t\t\tif (this.isAllSelected)\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_ALL_ACCEPTED');\n\t\t\t}\n\n\t\t\tif (this.selectedVariables.size <= 0)\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_ADD');\n\t\t\t}\n\n\t\t\treturn getMultipleSelectedVariablesTitle(this.selectedVariables);\n\t\t},\n\t\thintHtml(): string {\n\t\t\treturn getMultipleSelectedVariablesHintHtml(this.selectedVariables, this.hintTitle, this.right.variables);\n\t\t},\n\t\thintTitle(): string {\n\t\t\tif (Type.isString(this.right.hintTitle))\n\t\t\t{\n\t\t\t\treturn this.right.hintTitle;\n\t\t\t}\n\n\t\t\treturn this.$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_SELECTED_ITEMS_TITLE');\n\t\t},\n\t},\n\tmethods: {\n\t\tshowSelector(): void {\n\t\t\tthis.isSelectorShown = true;\n\t\t},\n\t\tsetValues({ values }): void {\n\t\t\tthis.$store.dispatch('userGroups/setAccessRightValues', {\n\t\t\t\tsectionCode: this.section.sectionCode,\n\t\t\t\tuserGroupId: this.userGroup.id,\n\t\t\t\tvalueId: this.value.id,\n\t\t\t\tvalues,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<SelectedHint \n\t\t\tv-if=\"hintHtml\"\n\t\t\t:html=\"hintHtml\" \n\t\t\tclass='ui-access-rights-v2-column-item-text-link'\n\t\t\t@click=\"showSelector\"\n\t\t\tv-bind=\"$attrs\"\n\t\t>\n\t\t\t{{ title }}\n\t\t</SelectedHint>\n\t\t<div \n\t\t\tv-else\n\t\t\tclass='ui-access-rights-v2-column-item-text-link ui-access-rights-v2-text-ellipsis'\n\t\t\t@click=\"showSelector\"\n\t\t\t:title=\"title\"\n\t\t\tv-bind=\"$attrs\"\n\t\t>\n\t\t\t{{ title }}\n\t\t</div>\n\t\t<Selector\n\t\t\tv-if=\"isSelectorShown\" \n\t\t\t:initial-values=\"value.values\"\n\t\t\t@close=\"isSelectorShown = false\"\n\t\t\t@apply=\"setValues\"\n\t\t/>\n\t`,\n};\n","import { Switcher } from 'ui.vue3.components.switcher';\n\nexport const Toggler = {\n\tname: 'Toggler',\n\tcomponents: { Switcher },\n\tprops: {\n\t\tvalue: {\n\t\t\t/** @type AccessRightValue */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tinject: ['section', 'userGroup'],\n\tcomputed: {\n\t\tisChecked(): boolean {\n\t\t\treturn this.value.values.has('1');\n\t\t},\n\t},\n\tmethods: {\n\t\tsetValue(value): void {\n\t\t\tthis.$store.dispatch('userGroups/setAccessRightValues', {\n\t\t\t\tuserGroupId: this.userGroup.id,\n\t\t\t\tsectionCode: this.section.sectionCode,\n\t\t\t\tvalueId: this.value.id,\n\t\t\t\tvalues: new Set([value]),\n\t\t\t});\n\t\t},\n\t},\n\t// eslint-disable-next-line quotes\n\ttemplate: `\n\t\t<Switcher\n\t\t\t:is-checked=\"isChecked\"\n\t\t\t@check=\"setValue('1')\"\n\t\t\t@uncheck=\"setValue('0')\"\n\t\t\t:options=\"{\n\t\t\t\tsize: 'extra-small',\n\t\t\t\tcolor: 'green',\n\t\t\t}\"\n\t\t/>\n\t`,\n};\n","import { Type } from 'main.core';\nimport { MenuManager } from 'main.popup';\n\nconst POPUP_ID = 'ui-access-rights-v2-column-item-popup-variables';\n\nexport const Variables = {\n\tname: 'Variables',\n\tprops: {\n\t\t// value for selector is id of a selected variable\n\t\tvalue: {\n\t\t\t/** @type AccessRightValue */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tinject: ['section', 'userGroup', 'right'],\n\tcomputed: {\n\t\temptyVariableId(): ?string {\n\t\t\tconst emptyValue: Set<string> = this.$store.getters['accessRights/getEmptyValue'](\n\t\t\t\tthis.section.sectionCode,\n\t\t\t\tthis.value.id,\n\t\t\t);\n\n\t\t\treturn emptyValue[0];\n\t\t},\n\t\tcurrentVariableId(): ?string {\n\t\t\tif (this.value.values.size <= 0)\n\t\t\t{\n\t\t\t\treturn this.emptyVariableId;\n\t\t\t}\n\n\t\t\tconst [firstItem] = this.value.values;\n\n\t\t\treturn firstItem;\n\t\t},\n\t\tcurrentAlias(): ?string {\n\t\t\treturn this.$store.getters['accessRights/getSelectedVariablesAlias'](this.section.sectionCode, this.value.id, this.value.values);\n\t\t},\n\t\tcurrentVariableTitle(): string {\n\t\t\tif (Type.isString(this.currentAlias))\n\t\t\t{\n\t\t\t\treturn this.currentAlias;\n\t\t\t}\n\n\t\t\tconst variable = this.right.variables.get(this.currentVariableId);\n\t\t\tif (!variable)\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_ADD');\n\t\t\t}\n\n\t\t\treturn variable.title;\n\t\t},\n\t},\n\tmethods: {\n\t\tshowSelector(event: PointerEvent): void {\n\t\t\tconst menuItems = [];\n\t\t\tfor (const variable of this.right.variables.values())\n\t\t\t{\n\t\t\t\tmenuItems.push({\n\t\t\t\t\tid: variable.id,\n\t\t\t\t\ttext: variable.title,\n\t\t\t\t\tonclick: (innerEvent, item) => {\n\t\t\t\t\t\titem\n\t\t\t\t\t\t\t.getMenuWindow()\n\t\t\t\t\t\t\t?.close()\n\t\t\t\t\t\t;\n\n\t\t\t\t\t\tthis.setValue(variable.id);\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tMenuManager.show({\n\t\t\t\tid: POPUP_ID,\n\t\t\t\tbindElement: event.target,\n\t\t\t\titems: menuItems,\n\t\t\t\tautoHide: true,\n\t\t\t\tcacheable: false,\n\t\t\t});\n\t\t},\n\t\tsetValue(value): void {\n\t\t\tthis.$store.dispatch('userGroups/setAccessRightValues', {\n\t\t\t\tsectionCode: this.section.sectionCode,\n\t\t\t\tuserGroupId: this.userGroup.id,\n\t\t\t\tvalueId: this.value.id,\n\t\t\t\tvalues: new Set([value]),\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass='ui-access-rights-v2-column-item-text-link ui-access-rights-v2-text-ellipsis'\n\t\t\t:title=\"currentVariableTitle\"\n\t\t\t@click=\"showSelector\"\n\t\t>\n\t\t\t{{ currentVariableTitle }}\n\t\t</div>\n\t`,\n};\n","import { ServiceLocator } from '../../../service/service-locator';\nimport type { AccessRightItem } from '../../../store/model/access-rights-model';\n\nimport { DependentVariables as DependentVariablesRow } from '../title-column/value/dependent-variables';\nimport { Multivariables as MultivariablesRow } from '../title-column/value/multivariables';\nimport { Variables as VariablesRow } from '../title-column/value/variables';\n\nimport { DependentVariables as DependentVariablesCell } from './../column/value/dependent-variables';\nimport { Multivariables as MultivariablesCell } from './../column/value/multivariables';\nimport { Toggler as TogglerCell } from './../column/value/toggler';\nimport { Variables as VariablesCell } from './../column/value/variables';\n\nexport const Cells = Object.freeze({\n\tDependentVariables: DependentVariablesCell,\n\tMultivariables: MultivariablesCell,\n\tToggler: TogglerCell,\n\tVariables: VariablesCell,\n});\n\nexport const Rows = Object.freeze({\n\tDependentVariables: DependentVariablesRow,\n\tMultivariables: MultivariablesRow,\n\t// no row value for toggler\n\tVariables: VariablesRow,\n});\n\nexport function getValueComponent(accessRightItem: AccessRightItem): string\n{\n\tconst type = ServiceLocator.getValueTypeByRight(accessRightItem);\n\tif (!type)\n\t{\n\t\t// vue will render empty cell\n\t\treturn '';\n\t}\n\n\treturn type.getComponentName();\n}\n","import type { AccessRightItem } from '../../../store/model/access-rights-model';\nimport type { AccessRightValue } from '../../../store/model/user-groups-model';\nimport { CellLayout } from '../../layout/cell-layout';\nimport { Cells, getValueComponent } from '../value/registry';\n\nexport const ValueCell = {\n\tname: 'ValueCell',\n\tcomponents: {\n\t\tCellLayout,\n\t\t...Cells,\n\t},\n\tprops: {\n\t\tright: {\n\t\t\t/** @type AccessRightItem */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tinject: ['section', 'userGroup'],\n\tprovide(): Object {\n\t\treturn {\n\t\t\tright: this.right,\n\t\t};\n\t},\n\tcomputed: {\n\t\tvalue(): AccessRightValue\n\t\t{\n\t\t\tconst value = this.userGroup.accessRights.get(this.right.id);\n\n\t\t\treturn value || this.$store.getters['userGroups/getEmptyAccessRightValue'](this.userGroup.id, this.section.sectionCode, this.right.id);\n\t\t},\n\t\tcellComponent(): string\n\t\t{\n\t\t\treturn getValueComponent(this.right);\n\t\t},\n\t},\n\t// data attributes are needed for e2e automated tests\n\ttemplate: `\n\t\t<CellLayout\n\t\t\t:class=\"{\n\t\t\t\t'ui-access-rights-v2-group-children': right.group,\n\t\t\t\t'--modified': value.isModified\n\t\t\t}\"\n\t\t\tv-memo=\"[userGroup.id, value.values, value.isModified]\"\n\t\t>\n\t\t\t<Component\n\t\t\t\t:is=\"cellComponent\"\n\t\t\t\t:value=\"value\"\n\t\t\t\t:data-accessrights-right-id=\"right.id\"\n\t\t\t/>\n\t\t</CellLayout>\n\t`,\n};\n","import { computed } from 'ui.vue3';\nimport { AccessRightItem } from '../../store/model/access-rights-model';\nimport type { UserGroup } from '../../store/model/user-groups-model';\nimport { shouldRowBeRendered } from '../../utils';\nimport { ColumnLayout } from '../layout/column-layout';\nimport { MenuCell } from './column/menu-cell';\nimport { ValueCell } from './column/value-cell';\n\nexport const Column = {\n\tname: 'Column',\n\tcomponents: {\n\t\tColumnLayout,\n\t\tValueCell,\n\t\tMenuCell,\n\t},\n\tprops: {\n\t\tuserGroup: {\n\t\t\t/** @type UserGroup */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\trights: {\n\t\t\ttype: Map,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tprovide(): Object {\n\t\treturn {\n\t\t\tuserGroup: computed(() => this.userGroup),\n\t\t};\n\t},\n\tcomputed: {\n\t\trenderedRights(): Map<string, AccessRightItem> {\n\t\t\tconst result = new Map();\n\t\t\tfor (const [rightId: string, right: AccessRightItem] of this.rights)\n\t\t\t{\n\t\t\t\tif (shouldRowBeRendered(right))\n\t\t\t\t{\n\t\t\t\t\tresult.set(rightId, right);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<ColumnLayout ref=\"column\">\n\t\t\t<MenuCell/>\n\t\t\t<ValueCell\n\t\t\t\tv-for=\"[rightId, accessRightItem] in renderedRights\"\n\t\t\t\t:key=\"rightId\"\n\t\t\t\t:right=\"accessRightItem\"\n\t\t\t/>\n\t\t</ColumnLayout>\n\t`,\n};\n","import { Dom, Event, Runtime } from 'main.core';\nimport { Ears } from 'ui.ears';\nimport { SyncHorizontalScroll } from '../util/sync-horizontal-scroll';\nimport { Column } from './column';\nimport { ColumnLayout } from '../layout/column-layout';\n\nexport const ColumnList = {\n\tname: 'ColumnList',\n\tcomponents: { Column, SyncHorizontalScroll, ColumnLayout },\n\tprops: {\n\t\tuserGroups: {\n\t\t\ttype: Map,\n\t\t\trequired: true,\n\t\t},\n\t\trights: {\n\t\t\ttype: Map,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tthrottledScrollHandler: null,\n\tthrottledResizeHandler: null,\n\tears: null,\n\tisEarsInited: false,\n\tdata(): Object {\n\t\treturn {\n\t\t\tisLeftShadowShown: false,\n\t\t\tisRightShadowShown: false,\n\t\t};\n\t},\n\tcreated()\n\t{\n\t\tthis.throttledScrollHandler = Runtime.throttle(() => {\n\t\t\tthis.adjustShadowsVisibility();\n\t\t}, 200);\n\t\tthis.throttledResizeHandler = Runtime.throttle(() => {\n\t\t\tthis.adjustShadowsVisibility();\n\t\t\tthis.adjustEars();\n\t\t}, 200);\n\t},\n\tmounted()\n\t{\n\t\tEvent.bind(window, 'resize', this.throttledResizeHandler);\n\t\tthis.adjustShadowsVisibility();\n\n\t\tthis.initEars();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.destroyEars();\n\n\t\tEvent.unbind(window, 'resize', this.throttledResizeHandler);\n\t},\n\twatch: {\n\t\tuserGroups(newValue: Map, oldValue: Map): void {\n\t\t\tif (newValue.size !== oldValue.size)\n\t\t\t{\n\t\t\t\tthis.adjustShadowsVisibility();\n\t\t\t\tthis.adjustEars();\n\t\t\t}\n\t\t},\n\t},\n\tmethods: {\n\t\tcalculateShadowsVisibility(): { isLeftShadowShown: boolean, isRightShadowShown: boolean } {\n\t\t\tif (!this.$refs['column-container'])\n\t\t\t{\n\t\t\t\t// in case it's accidentally called before mount or after unmount\n\t\t\t\treturn { isLeftShadowShown: false, isRightShadowShown: false };\n\t\t\t}\n\n\t\t\tconst scrollLeft = this.$refs['column-container'].$el.scrollLeft;\n\n\t\t\tconst isLeftShadowShown = scrollLeft > 0;\n\n\t\t\tconst offsetWidth = this.$refs['column-container'].$el.offsetWidth;\n\n\t\t\treturn {\n\t\t\t\tisLeftShadowShown,\n\t\t\t\tisRightShadowShown: this.$refs['column-container'].$el.scrollWidth > (Math.round(scrollLeft + offsetWidth)),\n\t\t\t};\n\t\t},\n\t\tadjustShadowsVisibility(): void {\n\t\t\t// avoid \"forced synchronous layout\"\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tconst { isLeftShadowShown, isRightShadowShown } = this.calculateShadowsVisibility();\n\t\t\t\tthis.isLeftShadowShown = isLeftShadowShown;\n\t\t\t\tthis.isRightShadowShown = isRightShadowShown;\n\t\t\t});\n\t\t},\n\t\tadjustEars(): void {\n\t\t\tif (!this.isEarsInited)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// avoid \"forced synchronous layout\"\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\t// force ears to recalculate its visibility\n\t\t\t\tthis.ears.toggleEars();\n\t\t\t});\n\t\t},\n\t\tinitEars(): void {\n\t\t\tif (!this.$refs['column-container'])\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.ears)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.ears = new Ears({\n\t\t\t\tcontainer: this.$refs['column-container'].$el,\n\t\t\t\timmediateInit: true,\n\t\t\t\tsmallSize: true,\n\t\t\t});\n\n\t\t\t// chrome is not happy when we query DOM values (scrollLeft, offsetWidth, ...) just after we've changed them\n\t\t\t// avoid \"forced synchronous layout\"\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tif (!this.ears || !this.$refs['column-container'])\n\t\t\t\t{\n\t\t\t\t\tthis.ears = null;\n\n\t\t\t\t\t// sometimes the callback is fired after the component is unmounted\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst scrollLeft = this.$refs['column-container'].$el.scrollLeft;\n\t\t\t\tthis.ears.init();\n\n\t\t\t\t// Ears add wrapper around the container, and it breaks our markup a little. Fix it\n\t\t\t\tDom.style(this.ears.getWrapper(), 'flex', 1);\n\t\t\t\tif (scrollLeft > 0)\n\t\t\t\t{\n\t\t\t\t\t// ears.init resets scrollLeft to 0\n\t\t\t\t\tthis.$refs['column-container'].$el.scrollLeft = scrollLeft;\n\t\t\t\t}\n\n\t\t\t\tthis.isEarsInited = true;\n\t\t\t});\n\t\t},\n\t\tdestroyEars(): void {\n\t\t\tthis.ears?.destroy();\n\t\t\tthis.isEarsInited = false;\n\t\t\tthis.ears = null;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass='ui-access-rights-v2-section-content'\n\t\t\t:class=\"{\n\t\t\t\t'ui-access-rights-v2-section-shadow-left-shown': isLeftShadowShown,\n\t\t\t\t'ui-access-rights-v2-section-shadow-right-shown': isRightShadowShown,\n\t\t\t}\"\n\t\t>\n\t\t\t<SyncHorizontalScroll\n\t\t\t\tref=\"column-container\"\n\t\t\t\tclass='ui-access-rights-v2-section-wrapper'\n\t\t\t\t@scroll=\"throttledScrollHandler\"\n\t\t\t>\n\t\t\t\t<Column\n\t\t\t\t\tv-for=\"[groupId, group] in userGroups\"\n\t\t\t\t\t:key=\"groupId\"\n\t\t\t\t\t:user-group=\"group\"\n\t\t\t\t\t:rights=\"rights\"\n\t\t\t\t\t:data-accessrights-user-group-id=\"groupId\"\n\t\t\t\t/>\n\t\t\t\t<ColumnLayout/>\n\t\t\t</SyncHorizontalScroll>\n\t\t</div>\n\t`,\n};\n","import { Dom, Tag } from 'main.core';\nimport 'ui.hint';\nimport { mapState } from 'ui.vue3.vuex';\nimport { ServiceLocator } from '../../service/service-locator';\n\n/**\n * A special case of Hint that provides interactivity and reactivity.\n */\nexport const Hint = {\n\tname: 'Hint',\n\tprops: {\n\t\thtml: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\t...mapState({\n\t\t\tguid: (state) => state.application.guid,\n\t\t}),\n\t},\n\tmounted()\n\t{\n\t\tthis.renderHint();\n\t},\n\twatch: {\n\t\thtml(): void {\n\t\t\t// make ui.hint reactive :(\n\t\t\tDom.clean(this.$refs.container);\n\t\t\tthis.renderHint();\n\t\t},\n\t},\n\tmethods: {\n\t\trenderHint(): void {\n\t\t\tconst hintIconWrapper = Tag.render`<span data-hint-html=\"true\" data-hint-interactivity=\"true\"></span>`;\n\t\t\t// Tag.render cant set prop value with HTML properly :(\n\t\t\thintIconWrapper.setAttribute('data-hint', this.html);\n\n\t\t\tDom.append(\n\t\t\t\thintIconWrapper,\n\t\t\t\tthis.$refs.container,\n\t\t\t);\n\n\t\t\tthis.getHintManager().initNode(hintIconWrapper);\n\t\t},\n\t\tgetHintManager(): BX.UI.Hint {\n\t\t\treturn ServiceLocator.getHint(this.guid);\n\t\t},\n\t},\n\ttemplate: '<span class=\"ui-access-rights-v2-hint-container\" ref=\"container\"></span>',\n};\n","import { Hint } from '../util/hint';\nimport { Icon } from './icon';\nimport '../../css/section/header.css';\n\nexport const Header = {\n\tname: 'Header',\n\tcomponents: { Hint, Icon },\n\tinject: ['section'],\n\tmethods: {\n\t\ttoggleSection(): void {\n\t\t\tthis.$store.dispatch('accessRights/toggleSection', { sectionCode: this.section.sectionCode });\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\t@click=\"toggleSection\"\n\t\t\tclass='ui-access-rights-v2-section-header'\n\t\t\t:class=\"{\n\t\t\t\t'--expanded': section.isExpanded,\n\t\t\t}\" \n\t\t\tv-memo=\"[section.isExpanded]\"\n\t\t>\n\t\t\t<div class=\"ui-access-rights-v2-section-header-expander\">\n\t\t\t\t<div class='ui-icon-set' :class=\"{\n\t\t\t\t\t'--chevron-up': section.isExpanded,\n\t\t\t\t\t'--chevron-down': !section.isExpanded,\n\t\t\t\t}\"\n\t\t\t\t></div>\n\t\t\t</div>\n\t\t\t<Icon/>\n\t\t\t<span \n\t\t\t\tclass=\"ui-access-rights-v2-text-ellipsis ui-access-rights-v2-section-title\"\n\t\t\t\t:title=\"section.sectionTitle\"\n\t\t\t>{{ section.sectionTitle }}</span>\n\t\t\t<span\n\t\t\t\tv-if=\"section.sectionSubTitle\"\n\t\t\t\tclass=\"ui-access-rights-v2-text-ellipsis ui-access-rights-v2-section-subtitle\"\n\t\t\t\t:title=\"section.sectionSubTitle\"\n\t\t\t>\n\t\t\t\t{{ section.sectionSubTitle }}\n\t\t\t</span>\n\t\t\t<Hint v-if=\"section.sectionHint\" :html=\"section.sectionHint\"/>\n\t\t</div>\n\t`,\n};\n","import { CellLayout } from '../../layout/cell-layout';\nimport '../../../css/section/menu-cell.css';\n\nexport const MenuCell = {\n\tname: 'MenuCell',\n\tcomponents: { CellLayout },\n\ttemplate: `\n\t\t<CellLayout class=\"ui-access-rights-v2-menu-cell\"/>\n\t`,\n};\n","import { getValueComponent, Rows } from '../value/registry';\n\nexport const RowValue = {\n\tname: 'RowValue',\n\tcomponents: { ...Rows },\n\temits: ['close'],\n\tinject: ['right'],\n\tcomputed: {\n\t\tcomponent(): string\n\t\t{\n\t\t\treturn getValueComponent(this.right);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Component :is=\"component\" @close=\"$emit('close')\" />\n\t`,\n};\n","import '../../../css/section/title-column/title-cell.css';\nimport { RichMenuItem, RichMenuItemIcon, RichMenuPopup } from 'ui.vue3.components.rich-menu';\nimport { ServiceLocator } from '../../../service/service-locator';\nimport { Hint } from '../../util/hint';\nimport { RowValue } from './row-value';\n\nexport const TitleCell = {\n\tname: 'TitleCell',\n\tcomponents: { Hint, RowValue, RichMenuItem, RichMenuPopup },\n\tprops: {\n\t\tright: {\n\t\t\t/** @type AccessRightItem */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tinject: ['section'],\n\tprovide(): Object {\n\t\treturn {\n\t\t\tright: this.right,\n\t\t};\n\t},\n\tdata(): Object {\n\t\treturn {\n\t\t\tisMenuShown: false,\n\t\t\tisRowValueShown: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tRichMenuItemIcon: () => RichMenuItemIcon,\n\t\tisMinValueSet(): boolean\n\t\t{\n\t\t\treturn this.$store.getters['accessRights/isMinValueSet'](this.section.sectionCode, this.right.id);\n\t\t},\n\t\tisMaxValueSet(): boolean\n\t\t{\n\t\t\treturn this.$store.getters['accessRights/isMaxValueSet'](this.section.sectionCode, this.right.id);\n\t\t},\n\t\tisRowValueConfigurable(): boolean\n\t\t{\n\t\t\treturn ServiceLocator.getValueTypeByRight(this.right)?.isRowValueConfigurable() ?? false;\n\t\t},\n\t},\n\tmethods: {\n\t\ttoggleGroup(): void\n\t\t{\n\t\t\tif (!this.right.groupHead)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$store.dispatch('accessRights/toggleGroup', { sectionCode: this.section.sectionCode, groupId: this.right.id });\n\t\t},\n\t\ttoggleMenu(): void\n\t\t{\n\t\t\tthis.isMenuShown = !this.isMenuShown;\n\t\t},\n\t\tsetMaxValuesForRight(): void\n\t\t{\n\t\t\tthis.isRowValueShown = false;\n\t\t\tthis.isMenuShown = false;\n\n\t\t\tthis.$store.dispatch('userGroups/setMaxAccessRightValuesForRight', {\n\t\t\t\tsectionCode: this.section.sectionCode,\n\t\t\t\trightId: this.right.id,\n\t\t\t});\n\t\t},\n\t\tsetMinValuesForRight(): void\n\t\t{\n\t\t\tthis.isRowValueShown = false;\n\t\t\tthis.isMenuShown = false;\n\n\t\t\tthis.$store.dispatch('userGroups/setMinAccessRightValuesForRight', {\n\t\t\t\tsectionCode: this.section.sectionCode,\n\t\t\t\trightId: this.right.id,\n\t\t\t});\n\t\t},\n\t\topenRowValue(): void\n\t\t{\n\t\t\tthis.isMenuShown = false;\n\n\t\t\tthis.isRowValueShown = true;\n\t\t},\n\t},\n\t// data attributes are needed for e2e automated tests\n\ttemplate: `\n\t\t<div\n\t\t\tclass='ui-access-rights-v2-column-item-text ui-access-rights-v2-column-item-title'\n\t\t\t@click=\"toggleGroup\"\n\t\t\t:style=\"{\n\t\t\t\tcursor: right.groupHead ? 'pointer' : null,\n\t\t\t}\"\n\t\t\tv-memo=\"[right.isGroupExpanded]\"\n\t\t\t:data-accessrights-right-id=\"right.id\"\n\t\t>\n\t\t\t<span\n\t\t\t\tv-if=\"right.groupHead\"\n\t\t\t\tclass=\"ui-icon-set\"\n\t\t\t\t:class=\"{\n\t\t\t\t\t'--minus-in-circle': right.isGroupExpanded,\n\t\t\t\t\t'--plus-in-circle': !right.isGroupExpanded,\n\t\t\t\t}\"\n\t\t\t></span>\n\t\t\t<span class=\"ui-access-rights-v2-text-wrap\" :style=\"{\n\t\t\t\t'margin-left': !right.groupHead && !right.group ? '23px' : null,\n\t\t\t}\">\n\t\t\t\t{{ right.title }}\n\t\t\t\t<Hint v-once v-if=\"right.hint\" :html=\"right.hint\" />\n\t\t\t</span>\n\t\t</div>\n\t\t<div\n\t\t\tref=\"icon\" \n\t\t\tclass=\"ui-icon-set --more ui-access-rights-v2-icon-more ui-access-rights-v2-title-column-menu\" \n\t\t\t@click=\"toggleMenu\"\n\t\t>\n\t\t\t<RichMenuPopup\n\t\t\t\tv-if=\"isMenuShown\"\n\t\t\t\t@close=\"isMenuShown = false\"\n\t\t\t\t:popup-options=\"{bindElement: $refs.icon, width: 300}\"\n\t\t\t>\n\t\t\t\t<RichMenuItem\n\t\t\t\t\tv-if=\"isMaxValueSet\"\n\t\t\t\t\t:icon=\"RichMenuItemIcon.check\"\n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_SET_MAX_ACCESS_RIGHTS_ROW')\"\n\t\t\t\t\t:subtitle=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_SET_MAX_ACCESS_RIGHTS_ROW_SUBTITLE')\"\n\t\t\t\t\t@click=\"setMaxValuesForRight\"\n\t\t\t\t/>\n\t\t\t\t<RichMenuItem\n\t\t\t\t\tv-if=\"isMinValueSet\"\n\t\t\t\t\t:icon=\"RichMenuItemIcon['red-lock']\"\n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_SET_MIN_ACCESS_RIGHTS_ROW')\"\n\t\t\t\t\t:subtitle=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_SET_MIN_ACCESS_RIGHTS_ROW_SUBTITLE')\"\n\t\t\t\t\t@click=\"setMinValuesForRight\"\n\t\t\t\t/>\n\t\t\t\t<RichMenuItem\n\t\t\t\t\tv-if=\"isRowValueConfigurable\"\n\t\t\t\t\t:icon=\"RichMenuItemIcon.settings\"\n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_OPEN_ROW_VALUE')\"\n\t\t\t\t\t:subtitle=\"$Bitrix.Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_OPEN_ROW_VALUE_SUBTITLE')\"\n\t\t\t\t\t@click=\"openRowValue\"\n\t\t\t\t/>\n\t\t\t</RichMenuPopup>\n\t\t\t<RowValue v-if=\"isRowValueShown\" @close=\"isRowValueShown = false\"/>\n\t\t</div>\n\t`,\n};\n","import { AccessRightItem } from '../../store/model/access-rights-model';\nimport { shouldRowBeRendered } from '../../utils';\nimport { CellLayout } from '../layout/cell-layout';\nimport { ColumnLayout } from '../layout/column-layout';\nimport { MenuCell } from './title-column/menu-cell';\nimport { TitleCell } from './title-column/title-cell';\n\nexport const TitleColumn = {\n\tname: 'TitleColumn',\n\tcomponents: { TitleCell, ColumnLayout, CellLayout, MenuCell },\n\tprops: {\n\t\trights: {\n\t\t\ttype: Map,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\trenderedRights(): Map<string, AccessRightItem> {\n\t\t\tconst result = new Map();\n\t\t\tfor (const [rightId: string, right: AccessRightItem] of this.rights)\n\t\t\t{\n\t\t\t\tif (shouldRowBeRendered(right))\n\t\t\t\t{\n\t\t\t\t\tresult.set(rightId, right);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<ColumnLayout>\n\t\t\t<MenuCell/>\n\t\t\t<CellLayout\n\t\t\t\tv-for=\"[rightId, accessRightItem] in renderedRights\"\n\t\t\t\t:key=\"rightId\"\n\t\t\t\t:class=\"{\n\t\t\t\t\t'ui-access-rights-v2-group-children': accessRightItem.group,\n\t\t\t\t}\"\n\t\t\t>\n\t\t\t\t<TitleCell :right=\"accessRightItem\" />\n\t\t\t</CellLayout>\n\t\t</ColumnLayout>\n\t`,\n};\n","import { computed } from 'ui.vue3';\nimport { Column } from './section/column';\nimport { ColumnList } from './section/column-list';\nimport { Header } from './section/header';\nimport { TitleColumn } from './section/title-column';\nimport { SyncHorizontalScroll } from './util/sync-horizontal-scroll';\n\n// @vue/component\nexport const Section = {\n\tname: 'Section',\n\tcomponents: { Column, SyncHorizontalScroll, TitleColumn, Header, ColumnList },\n\tprops: {\n\t\tuserGroups: {\n\t\t\ttype: Map,\n\t\t\trequired: true,\n\t\t},\n\t\trights: {\n\t\t\ttype: Map,\n\t\t\trequired: true,\n\t\t},\n\t\tcode: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tisExpanded: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tsubTitle: {\n\t\t\ttype: String,\n\t\t},\n\t\thint: {\n\t\t\ttype: String,\n\t\t},\n\t\ticon: {\n\t\t\t/** @type AccessRightSectionIcon */\n\t\t\ttype: Object,\n\t\t},\n\t},\n\tprovide(): Object {\n\t\treturn {\n\t\t\tsection: computed(() => {\n\t\t\t\treturn {\n\t\t\t\t\tsectionCode: this.code,\n\t\t\t\t\tsectionTitle: this.title,\n\t\t\t\t\tsectionSubTitle: this.subTitle,\n\t\t\t\t\tsectionIcon: this.icon,\n\t\t\t\t\tsectionHint: this.hint,\n\t\t\t\t\tisExpanded: this.isExpanded,\n\t\t\t\t\trights: this.rights,\n\t\t\t\t};\n\t\t\t}),\n\t\t};\n\t},\n\t// data attributes are needed for e2e automated tests\n\ttemplate: `\n\t\t<div class=\"ui-access-rights-v2-section\" :data-accessrights-section-code=\"code\">\n\t\t\t<Header/>\n\t\t\t<div v-if=\"isExpanded\" class='ui-access-rights-v2-section-container'>\n\t\t\t\t<div class='ui-access-rights-v2-section-head'>\n\t\t\t\t\t<TitleColumn :rights=\"rights\" />\n\t\t\t\t</div>\n\t\t\t\t<ColumnList :rights=\"rights\" :user-groups=\"userGroups\"/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Dom } from 'main.core';\nimport { mapGetters, mapState } from 'ui.vue3.vuex';\nimport { ServiceLocator } from '../service/service-locator';\nimport { Header } from './header';\nimport { SearchBox } from './searchbox';\nimport { Section } from './section';\n\nexport const Grid = {\n\tname: 'Grid',\n\tcomponents: { Section, Header, SearchBox },\n\tloader: null,\n\tcomputed: {\n\t\t...mapState({\n\t\t\tisSaving: (state) => state.application.isSaving,\n\t\t\tguid: (state) => state.application.guid,\n\t\t\tsearchContainerSelector: (state) => state.application.options.searchContainerSelector,\n\t\t}),\n\t\t...mapGetters({\n\t\t\tshownSections: 'accessRights/shown',\n\t\t\tshownUserGroups: 'userGroups/shown',\n\t\t}),\n\t},\n\tmounted()\n\t{\n\t\tServiceLocator.getHint(this.guid).initOwnerDocument(this.$refs.container);\n\t},\n\tmethods: {\n\t\tscrollToSection(sectionCode: string) {\n\t\t\tconst section = this.$refs.sections.find((item) => item.code === sectionCode);\n\t\t\tif (section)\n\t\t\t{\n\t\t\t\tscrollTo({\n\t\t\t\t\ttop: Dom.getPosition(section.$el).top - 155,\n\t\t\t\t\tbehavior: 'smooth',\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Teleport v-if=\"searchContainerSelector\" :to=\"searchContainerSelector\">\n\t\t\t<SearchBox/>\n\t\t</Teleport>\n\t\t<div ref=\"container\" class='ui-access-rights-v2' :class=\"{\n\t\t\t'ui-access-rights-v2-block': isSaving,\n\t\t}\">\n\t\t\t<Header :user-groups=\"shownUserGroups\"/>\n\t\t\t<Section\n\t\t\t\tv-for=\"[sectionCode, accessRightSection] in shownSections\"\n\t\t\t\t:key=\"sectionCode\"\n\t\t\t\t:code=\"accessRightSection.sectionCode\"\n\t\t\t\t:is-expanded=\"accessRightSection.isExpanded\"\n\t\t\t\t:title=\"accessRightSection.sectionTitle\"\n\t\t\t\t:sub-title=\"accessRightSection.sectionSubTitle\"\n\t\t\t\t:hint=\"accessRightSection.sectionHint\"\n\t\t\t\t:icon=\"accessRightSection.sectionIcon\"\n\t\t\t\t:rights=\"accessRightSection.rights\"\n\t\t\t\t:user-groups=\"shownUserGroups\"\n\t\t\t\tref=\"sections\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { type AjaxResponse, Text, Type } from 'main.core';\nimport { type AnalyticsOptions, sendData } from 'ui.analytics';\nimport type { Store } from 'ui.vue3.vuex';\nimport type { UserGroup } from '../store/model/user-groups-model';\n\nexport class AnalyticsManager\n{\n\t#store: Store;\n\t#data: AnalyticsOptions;\n\n\t#isEnabled: boolean;\n\t#isCancelAlreadyRegistered: boolean = false;\n\n\tconstructor(store: Store, analyticsData: AnalyticsOptions)\n\t{\n\t\tthis.#store = store;\n\t\tthis.#data = analyticsData;\n\n\t\t// check 2 out of 3 required fields\n\t\t// 'event' field is provided by AnalyticsManager\n\t\tthis.#isEnabled = Object.hasOwn(this.#data, 'tool') && Object.hasOwn(this.#data, 'category');\n\t}\n\n\tonSaveAttempt(): void\n\t{\n\t\tif (!this.#isEnabled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst { createdRoles, editedRoles, deletedRoles } = this.#analyzeRoles();\n\n\t\tfor (let i = 0; i < createdRoles; i++)\n\t\t{\n\t\t\tthis.#registerRoleCreateEvent('attempt');\n\t\t}\n\n\t\tfor (let i = 0; i < editedRoles; i++)\n\t\t{\n\t\t\tthis.#registerRoleEditEvent('attempt');\n\t\t}\n\n\t\tfor (let i = 0; i < deletedRoles; i++)\n\t\t{\n\t\t\tthis.#registerRoleDeleteEvent('attempt');\n\t\t}\n\t}\n\n\tonSaveSuccess(): void\n\t{\n\t\tif (!this.#isEnabled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst { createdRoles, editedRoles, deletedRoles } = this.#analyzeRoles();\n\n\t\tfor (let i = 0; i < createdRoles; i++)\n\t\t{\n\t\t\tthis.#registerRoleCreateEvent('success');\n\t\t}\n\n\t\tfor (let i = 0; i < editedRoles; i++)\n\t\t{\n\t\t\tthis.#registerRoleEditEvent('success');\n\t\t}\n\n\t\tfor (let i = 0; i < deletedRoles; i++)\n\t\t{\n\t\t\tthis.#registerRoleDeleteEvent('success');\n\t\t}\n\t}\n\n\tonSaveError(response: AjaxResponse): void\n\t{\n\t\tif (!this.#isEnabled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst status = this.#getSaveErrorStatus(response);\n\n\t\tconst { createdRoles, editedRoles, deletedRoles } = this.#analyzeRoles();\n\n\t\tfor (let i = 0; i < createdRoles; i++)\n\t\t{\n\t\t\tthis.#registerRoleCreateEvent(status);\n\t\t}\n\n\t\tfor (let i = 0; i < editedRoles; i++)\n\t\t{\n\t\t\tthis.#registerRoleEditEvent(status);\n\t\t}\n\n\t\tfor (let i = 0; i < deletedRoles; i++)\n\t\t{\n\t\t\tthis.#registerRoleDeleteEvent(status);\n\t\t}\n\t}\n\n\tonCancelChanges(): void\n\t{\n\t\tif (!this.#isEnabled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.#isCancelAlreadyRegistered)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tsendData({\n\t\t\t...this.#data,\n\t\t\tevent: 'settings_cancel',\n\t\t});\n\n\t\tthis.#isCancelAlreadyRegistered = true;\n\t}\n\n\tonCloseWithoutSave(): void\n\t{\n\t\tif (!this.#isEnabled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tsendData({\n\t\t\t...this.#data,\n\t\t\tevent: 'settings_pop_cancel',\n\t\t});\n\t}\n\n\t#analyzeRoles(): {createdRoles: number, editedRoles: number, deletedRoles: number}\n\t{\n\t\tconst result = {\n\t\t\tcreatedRoles: 0,\n\t\t\teditedRoles: 0,\n\t\t\tdeletedRoles: this.#store.state.userGroups.deleted.size,\n\t\t};\n\n\t\tfor (const userGroup: UserGroup of this.#store.state.userGroups.collection.values())\n\t\t{\n\t\t\tif (userGroup.isNew)\n\t\t\t{\n\t\t\t\tresult.createdRoles++;\n\t\t\t}\n\t\t\telse if (this.#isUserGroupEdited(userGroup))\n\t\t\t{\n\t\t\t\tresult.editedRoles++;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#isUserGroupEdited(userGroup: UserGroup): boolean\n\t{\n\t\tif (userGroup.isModified)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tfor (const value of userGroup.accessRights.values())\n\t\t{\n\t\t\tif (value.isModified)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t#getSaveErrorStatus(response: AjaxReponse): string\n\t{\n\t\tif (!Type.isArrayFilled(response?.errors))\n\t\t{\n\t\t\treturn 'error';\n\t\t}\n\n\t\tfor (const error of response.errors)\n\t\t{\n\t\t\tif (Type.isStringFilled(error?.code))\n\t\t\t{\n\t\t\t\treturn `error_${Text.toCamelCase(error.code)}`;\n\t\t\t}\n\t\t}\n\n\t\treturn 'error';\n\t}\n\n\t#registerRoleCreateEvent(status: string): void\n\t{\n\t\tconst data = {\n\t\t\t...this.#data,\n\t\t\tevent: 'role_create',\n\t\t\tstatus,\n\t\t};\n\n\t\tthis.#appendRoleCountView(data);\n\n\t\tsendData(data);\n\t}\n\n\t#registerRoleEditEvent(status: string): void\n\t{\n\t\tconst data = {\n\t\t\t...this.#data,\n\t\t\tevent: 'role_edit',\n\t\t\tstatus,\n\t\t};\n\n\t\tthis.#appendRoleCountView(data);\n\n\t\tsendData(data);\n\t}\n\n\t#registerRoleDeleteEvent(status: string): void\n\t{\n\t\tconst data = {\n\t\t\t...this.#data,\n\t\t\tevent: 'role_delete',\n\t\t\tstatus,\n\t\t};\n\n\t\tthis.#appendRoleCountView(data);\n\n\t\tsendData(data);\n\t}\n\n\t#appendRoleCountView(data: AnalyticsOptions): void\n\t{\n\t\tthis.#appendP(\n\t\t\tdata,\n\t\t\t'roleCountView',\n\t\t\tthis.#store.getters['userGroups/shown'].size,\n\t\t);\n\t}\n\n\t#appendP(data: AnalyticsOptions, name: string, value: any): void\n\t{\n\t\tfor (const pName of ['p1', 'p2', 'p3', 'p4', 'p5'])\n\t\t{\n\t\t\tif (!Object.hasOwn(data, pName))\n\t\t\t{\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tdata[pName] = `${name}_${value}`;\n\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n}\n","import { BuilderModel, type GetterTree, type MutationTree } from 'ui.vue3.vuex';\n\nexport type ApplicationState = {\n\toptions: Readonly<Options>,\n\tguid: string,\n\tisSaving: boolean,\n}\n\nexport type Options = {\n\tcomponent: string,\n\tactionSave: string,\n\tmode: string,\n\tbodyType?: 'json' | 'data',\n\tadditionalSaveParams: Object,\n\tisSaveOnlyChangedRights: boolean,\n\tmaxVisibleUserGroups: ?number,\n\tsearchContainerSelector: ?string,\n\tadditionalMembersParams: AdditionalMembersParams,\n}\n\nexport type AdditionalMembersParams = {\n\taddUserGroupsProviderTab?: boolean,\n\taddProjectsProviderTab?: boolean,\n\taddStructureTeamsProviderTab?: boolean,\n};\n\nexport const ACTION_SAVE = 'save';\nexport const MODE = 'ajax';\nexport const BODY_TYPE = 'data';\n\nexport class ApplicationModel extends BuilderModel\n{\n\t#guid: string;\n\t#options: Readonly<Options>;\n\n\tgetName(): string\n\t{\n\t\treturn 'application';\n\t}\n\n\tsetOptions(options: Options): ApplicationModel\n\t{\n\t\tthis.#options = options;\n\n\t\treturn this;\n\t}\n\n\tsetGuid(guid: string): ApplicationModel\n\t{\n\t\tthis.#guid = guid;\n\n\t\treturn this;\n\t}\n\n\tgetState(): ApplicationState\n\t{\n\t\treturn {\n\t\t\toptions: this.#options,\n\t\t\tguid: this.#guid,\n\t\t\tisSaving: false,\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree<ApplicationState>\n\t{\n\t\treturn {\n\t\t\tisMaxVisibleUserGroupsSet: (state): boolean => {\n\t\t\t\treturn state.options.maxVisibleUserGroups > 0;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree<ApplicationState>\n\t{\n\t\treturn {\n\t\t\tsetSaving: (state, isSaving: boolean): void => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.isSaving = Boolean(isSaving);\n\t\t\t},\n\t\t};\n\t}\n}\n","import { Loc, Runtime, Text, Type } from 'main.core';\nimport { type ActionTree, BuilderModel, type GetterTree, type MutationTree, type Store } from 'ui.vue3.vuex';\nimport { ServiceLocator } from '../../service/service-locator';\nimport type { AccessRightItem, AccessRightSection } from './access-rights-model';\n\nexport type UserGroupsState = {\n\tcollection: UserGroupsCollection,\n\tdeleted: Set<string>,\n}\n\nexport type UserGroupsStore = Store<UserGroupsState>;\n\nexport type UserGroupsCollection = Map<string, UserGroup>;\n\n// aka Role\nexport type UserGroup = {\n\tid: string,\n\tisNew: boolean,\n\tisModified: boolean, // whether group metadata is modified - title, members\n\tisShown: boolean,\n\ttitle: string,\n\taccessRights: Map<string, AccessRightValue>,\n\tmembers: MemberCollection, // access code => member\n};\n\nexport type AccessRightValue = {\n\tid: string,\n\tvalues: Set<string>,\n\tisModified: boolean,\n};\n\nexport type MemberCollection = Map<string, Member>; // access code => member\n\n// user/group/department/set of users\nexport type Member = {\n\ttype: string, // see main/install/components/bitrix/main.ui.selector/templates/.default/script.js\n\tid: string,\n\tname: string,\n\tavatar: ?string,\n};\n\ntype SetAccessRightValuesPayload = SetAccessRightValuesForShownPayload & {\n\tuserGroupId: string,\n};\n\ntype SetAccessRightValuesForShownPayload = {\n\tsectionCode: string,\n\tvalueId: string,\n\tvalues: Set<string>,\n};\n\nexport const NEW_USER_GROUP_ID_PREFIX = 'new~~~';\n\nexport class UserGroupsModel extends BuilderModel\n{\n\t#initialUserGroups: UserGroupsCollection = new Map();\n\n\tgetName(): string\n\t{\n\t\treturn 'userGroups';\n\t}\n\n\tsetInitialUserGroups(groups: UserGroupsCollection): UserGroupsModel\n\t{\n\t\tthis.#initialUserGroups = groups;\n\n\t\treturn this;\n\t}\n\n\tgetState(): UserGroupsState\n\t{\n\t\treturn {\n\t\t\tcollection: Runtime.clone(this.#initialUserGroups),\n\t\t\tdeleted: new Set(),\n\t\t};\n\t}\n\n\tgetElementState(params = {}): UserGroup\n\t{\n\t\treturn {\n\t\t\tid: `${NEW_USER_GROUP_ID_PREFIX}${Text.getRandom()}`,\n\t\t\tisNew: true,\n\t\t\tisModified: true,\n\t\t\tisShown: true,\n\t\t\ttitle: Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_ROLE_NAME'),\n\t\t\taccessRights: new Map(),\n\t\t\tmembers: new Map(),\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree<UserGroupsState>\n\t{\n\t\treturn {\n\t\t\tshown: (state): UserGroupsCollection => {\n\t\t\t\tconst result = new Map();\n\n\t\t\t\tfor (const [userGroupId, userGroup] of state.collection)\n\t\t\t\t{\n\t\t\t\t\tif (userGroup.isShown)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.set(userGroupId, userGroup);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\tgetEmptyAccessRightValue: (state, getters, rootState, rootGetters) => (userGroupId: string, sectionCode: string, valueId: string): AccessRightValue => {\n\t\t\t\tconst values = rootGetters['accessRights/getEmptyValue'](sectionCode, valueId);\n\n\t\t\t\treturn {\n\t\t\t\t\tid: valueId,\n\t\t\t\t\tvalues,\n\t\t\t\t\tisModified: state.collection.get(userGroupId).isNew,\n\t\t\t\t};\n\t\t\t},\n\t\t\tdefaultAccessRightValues: (state, getters, rootState): Map<string, AccessRightValue> => {\n\t\t\t\tconst result = new Map();\n\n\t\t\t\tfor (const section of rootState.accessRights.collection.values())\n\t\t\t\t{\n\t\t\t\t\tfor (const [rightId, right] of section.rights)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (Type.isNil(right.defaultValue))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tresult.set(rightId, {\n\t\t\t\t\t\t\tid: rightId,\n\t\t\t\t\t\t\tvalues: right.defaultValue,\n\t\t\t\t\t\t\tisModified: true,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\tisModified: (state): boolean => {\n\t\t\t\tif (state.deleted.size > 0)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tfor (const userGroup of state.collection.values())\n\t\t\t\t{\n\t\t\t\t\tif (userGroup.isNew || userGroup.isModified)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (const value of userGroup.accessRights.values())\n\t\t\t\t\t{\n\t\t\t\t\t\tif (value.isModified)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tisMaxVisibleUserGroupsReached: (state, getters, rootState, rootGetters): boolean => {\n\t\t\t\tif (!rootGetters['application/isMaxVisibleUserGroupsSet'])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn getters.shown.size >= rootState.application.options.maxVisibleUserGroups;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree<UserGroupsState>\n\t{\n\t\treturn {\n\t\t\tsetAccessRightValues: (store, payload): void => {\n\t\t\t\tthis.#setAccessRightValuesAction(store, payload);\n\t\t\t},\n\t\t\tsetAccessRightValuesForShown: (store, payload): void => {\n\t\t\t\tthis.#setAccessRightValuesForShownAction(store, payload);\n\t\t\t},\n\t\t\tsetMinAccessRightValues: (store, payload): void => {\n\t\t\t\tthis.#setMinAccessRightValuesAction(store, payload);\n\t\t\t},\n\t\t\tsetMaxAccessRightValues: (store, payload): void => {\n\t\t\t\tthis.#setMaxAccessRightValuesAction(store, payload);\n\t\t\t},\n\t\t\tsetMinAccessRightValuesInSection: (store, payload): void => {\n\t\t\t\tthis.#setMinAccessRightValuesInSectionAction(store, payload);\n\t\t\t},\n\t\t\tsetMaxAccessRightValuesInSection: (store, payload): void => {\n\t\t\t\tthis.#setMaxAccessRightValuesInSectionAction(store, payload);\n\t\t\t},\n\t\t\tsetMinAccessRightValuesForRight: (store, payload): void => {\n\t\t\t\tthis.#setMinAccessRightValuesForRight(store, payload);\n\t\t\t},\n\t\t\tsetMaxAccessRightValuesForRight: (store, payload): void => {\n\t\t\t\tthis.#setMaxAccessRightValuesForRight(store, payload);\n\t\t\t},\n\t\t\tsetRoleTitle: (store, payload): void => {\n\t\t\t\tthis.#setRoleTitleAction(store, payload);\n\t\t\t},\n\t\t\taddMember: (store, payload): void => {\n\t\t\t\tthis.#addMemberAction(store, payload);\n\t\t\t},\n\t\t\tremoveMember: (store, payload): void => {\n\t\t\t\tthis.#removeMemberAction(store, payload);\n\t\t\t},\n\t\t\tcopyUserGroup: (store, payload): void => {\n\t\t\t\tthis.#copyUserGroupAction(store, payload);\n\t\t\t},\n\t\t\tcopySectionValues: (store, payload): void => {\n\t\t\t\tthis.#copySectionValuesAction(store, payload);\n\t\t\t},\n\t\t\taddUserGroup: (store): void => {\n\t\t\t\tthis.#addUserGroupAction(store);\n\t\t\t},\n\t\t\tremoveUserGroup: (store, payload): void => {\n\t\t\t\tthis.#removeUserGroupAction(store, payload);\n\t\t\t},\n\t\t\tshowUserGroup: (store, payload): void => {\n\t\t\t\tthis.#showUserGroupAction(store, payload);\n\t\t\t},\n\t\t\thideUserGroup: (store, payload): void => {\n\t\t\t\tthis.#hideUserGroupAction(store, payload);\n\t\t\t},\n\t\t};\n\t}\n\n\t#setAccessRightValuesAction(store: UserGroupsStore, payload: SetAccessRightValuesPayload): void\n\t{\n\t\tif (!Type.isSet(payload.values))\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Attempt to set not-Set values', payload);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.#isUserGroupExists(store, payload.userGroupId))\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Attempt to set value to a user group that dont exists', payload);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.#isValueExistsInStructure(store, payload.sectionCode, payload.valueId))\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Attempt to set value to a right that dont exists in structure', payload);\n\n\t\t\treturn;\n\t\t}\n\n\t\tstore.commit('setAccessRightValues', {\n\t\t\tuserGroupId: payload.userGroupId,\n\t\t\tvalueId: payload.valueId,\n\t\t\tvalues: payload.values,\n\t\t\tisModified: this.#isValueModified(\n\t\t\t\tpayload.userGroupId,\n\t\t\t\tpayload.valueId,\n\t\t\t\tpayload.values,\n\t\t\t\tstore.rootGetters['accessRights/getEmptyValue'](payload.sectionCode, payload.valueId),\n\t\t\t),\n\t\t});\n\t}\n\n\t#setAccessRightValuesForShownAction(store: UserGroupsStore, payload: SetAccessRightValuesForShownPayload): void\n\t{\n\t\tfor (const userGroupId of store.getters.shown.keys())\n\t\t{\n\t\t\tvoid store.dispatch('setAccessRightValues', {\n\t\t\t\t...payload,\n\t\t\t\tuserGroupId,\n\t\t\t});\n\t\t}\n\t}\n\n\t#setMinAccessRightValuesAction(store: UserGroupsStore, { userGroupId }): void\n\t{\n\t\tfor (const sectionCode: string of store.rootState.accessRights.collection.keys())\n\t\t{\n\t\t\tvoid store.dispatch('setMinAccessRightValuesInSection', { userGroupId, sectionCode });\n\t\t}\n\n\t\tvoid store.dispatch('accessRights/expandAllSections', null, { root: true });\n\t}\n\n\t#setMinAccessRightValuesInSectionAction(store: UserGroupsStore, { userGroupId, sectionCode }): void\n\t{\n\t\tconst section: ?AccessRightSection = store.rootState.accessRights.collection.get(sectionCode);\n\t\tif (!section)\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: attempt to set min values in section that dont exists', { sectionCode });\n\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const item of section.rights.values())\n\t\t{\n\t\t\tconst valueToSet = this.#getMinValueForColumnAction(\n\t\t\t\titem,\n\t\t\t\tstore.rootGetters['accessRights/getEmptyValue'](section.sectionCode, item.id),\n\t\t\t);\n\t\t\tif (Type.isNil(valueToSet))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvoid store.dispatch('setAccessRightValues', {\n\t\t\t\tuserGroupId,\n\t\t\t\tsectionCode: section.sectionCode,\n\t\t\t\tvalueId: item.id,\n\t\t\t\tvalues: valueToSet,\n\t\t\t});\n\t\t}\n\t}\n\n\t#setMinAccessRightValuesForRight(store: UserGroupsStore, { sectionCode, rightId }): void\n\t{\n\t\tconst right: ?AccessRightItem = store.rootState.accessRights.collection.get(sectionCode)?.rights.get(rightId);\n\t\tif (!right)\n\t\t{\n\t\t\tconsole.warn(\n\t\t\t\t'ui.accessrights.v2: attempt to set min values for right that dont exists',\n\t\t\t\t{ sectionCode, rightId },\n\t\t\t);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst valueToSet = this.#getMinValue(right);\n\t\tif (Type.isNil(valueToSet))\n\t\t{\n\t\t\tconsole.warn(\n\t\t\t\t'ui.accessrights.v2: attempt to set min values for right that dont have min value set',\n\t\t\t\t{ sectionCode, rightId },\n\t\t\t);\n\n\t\t\treturn;\n\t\t}\n\n\t\tvoid store.dispatch('setAccessRightValuesForShown', {\n\t\t\tsectionCode,\n\t\t\tvalueId: rightId,\n\t\t\tvalues: valueToSet,\n\t\t});\n\t}\n\n\t#getMinValueForColumnAction(item: AccessRightItem, emptyValue: Set<string>): ?Set<string>\n\t{\n\t\tconst setEmpty = Type.isBoolean(item.setEmptyOnSetMinMaxValueInColumn) && item.setEmptyOnSetMinMaxValueInColumn;\n\t\tif (setEmpty)\n\t\t{\n\t\t\treturn emptyValue;\n\t\t}\n\n\t\treturn this.#getMinValue(item);\n\t}\n\n\t#getMinValue(item: AccessRightItem): ?Set<string>\n\t{\n\t\treturn ServiceLocator.getValueTypeByRight(item)?.getMinValue(item);\n\t}\n\n\t#setMaxAccessRightValuesAction(store: UserGroupsStore, { userGroupId }): void\n\t{\n\t\tfor (const sectionCode: string of store.rootState.accessRights.collection.keys())\n\t\t{\n\t\t\tvoid store.dispatch('setMaxAccessRightValuesInSection', { userGroupId, sectionCode });\n\t\t}\n\n\t\tvoid store.dispatch('accessRights/expandAllSections', null, { root: true });\n\t}\n\n\t#setMaxAccessRightValuesInSectionAction(store: UserGroupsStore, { userGroupId, sectionCode }): void\n\t{\n\t\tconst section: ?AccessRightSection = store.rootState.accessRights.collection.get(sectionCode);\n\t\tif (!section)\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: attempt to set max values in section that dont exists', { sectionCode });\n\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const item of section.rights.values())\n\t\t{\n\t\t\tconst valueToSet = this.#getMaxValueForColumnAction(\n\t\t\t\titem,\n\t\t\t\tstore.rootGetters['accessRights/getEmptyValue'](section.sectionCode, item.id),\n\t\t\t);\n\t\t\tif (Type.isNil(valueToSet))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvoid store.dispatch('setAccessRightValues', {\n\t\t\t\tuserGroupId,\n\t\t\t\tsectionCode: section.sectionCode,\n\t\t\t\tvalueId: item.id,\n\t\t\t\tvalues: valueToSet,\n\t\t\t});\n\t\t}\n\t}\n\n\t#setMaxAccessRightValuesForRight(store: UserGroupsStore, { sectionCode, rightId }): void\n\t{\n\t\tconst right: ?AccessRightItem = store.rootState.accessRights.collection.get(sectionCode)?.rights.get(rightId);\n\t\tif (!right)\n\t\t{\n\t\t\tconsole.warn(\n\t\t\t\t'ui.accessrights.v2: attempt to set max values for right that dont exists',\n\t\t\t\t{ sectionCode, rightId },\n\t\t\t);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst valueToSet = this.#getMaxValue(right);\n\t\tif (Type.isNil(valueToSet))\n\t\t{\n\t\t\tconsole.warn(\n\t\t\t\t'ui.accessrights.v2: attempt to set max values for right that dont have max value set',\n\t\t\t\t{ sectionCode, rightId },\n\t\t\t);\n\n\t\t\treturn;\n\t\t}\n\n\t\tvoid store.dispatch('setAccessRightValuesForShown', {\n\t\t\tsectionCode,\n\t\t\tvalueId: rightId,\n\t\t\tvalues: valueToSet,\n\t\t});\n\t}\n\n\t#getMaxValueForColumnAction(item: AccessRightItem, emptyValue: Set<string>): ?Set<string>\n\t{\n\t\tconst setEmpty = Type.isBoolean(item.setEmptyOnSetMinMaxValueInColumn) && item.setEmptyOnSetMinMaxValueInColumn;\n\t\tif (setEmpty)\n\t\t{\n\t\t\treturn emptyValue;\n\t\t}\n\n\t\treturn this.#getMaxValue(item);\n\t}\n\n\t#getMaxValue(item: AccessRightItem): ?Set<string>\n\t{\n\t\treturn ServiceLocator.getValueTypeByRight(item)?.getMaxValue(item);\n\t}\n\n\t#copySectionValuesAction(\n\t\tstore: UserGroupsStore,\n\t\tpayload: { srcUserGroupId: string, dstUserGroupId: string, sectionCode: string },\n\t): void\n\t{\n\t\tconst src = this.#getUserGroup(store.state, payload.srcUserGroupId);\n\t\tif (!src)\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Attempt to copy values from user group that dont exists', payload);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst section: ?AccessRightSection = store.rootState.accessRights.collection.get(payload.sectionCode);\n\t\tif (!section)\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Attempt to copy values for section that dont exists', payload);\n\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const rightId of section.rights.keys())\n\t\t{\n\t\t\tconst value = src.accessRights.get(rightId);\n\t\t\tif (value)\n\t\t\t{\n\t\t\t\tvoid store.dispatch('setAccessRightValues', {\n\t\t\t\t\tuserGroupId: payload.dstUserGroupId,\n\t\t\t\t\tsectionCode: section.sectionCode,\n\t\t\t\t\tvalueId: value.id,\n\t\t\t\t\tvalues: value.values,\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst emptyValue = store.rootGetters['accessRights/getEmptyValue'](section.sectionCode, rightId);\n\n\t\t\t\tvoid store.dispatch('setAccessRightValues', {\n\t\t\t\t\tuserGroupId: payload.dstUserGroupId,\n\t\t\t\t\tsectionCode: section.sectionCode,\n\t\t\t\t\tvalueId: rightId,\n\t\t\t\t\tvalues: emptyValue,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\t#setRoleTitleAction(store: UserGroupsStore, payload: {userGroupId: string, title: string}): void\n\t{\n\t\tif (!Type.isString(payload.title))\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Attempt to set role title with something other than string', payload);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.#isUserGroupExists(store, payload.userGroupId))\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Attempt to update user group that dont exists', payload);\n\n\t\t\treturn;\n\t\t}\n\n\t\tstore.commit('setRoleTitle', payload);\n\t}\n\n\t#addMemberAction(store: UserGroupsStore, payload: {userGroupId: string, accessCode: string, member: Member }): void\n\t{\n\t\tif (!this.#isUserGroupExists(store, payload.userGroupId))\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Attempt to add member to a user group that dont exists', payload);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\t!Type.isStringFilled(payload.accessCode)\n\t\t\t|| !Type.isStringFilled(payload.member.id)\n\t\t\t|| !Type.isStringFilled(payload.member.type)\n\t\t\t|| !Type.isStringFilled(payload.member.name)\n\t\t\t|| !(Type.isNil(payload.member.avatar) || Type.isStringFilled(payload.member.avatar))\n\t\t)\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Attempt to add member with invalid payload', payload);\n\n\t\t\treturn;\n\t\t}\n\n\t\tstore.commit('addMember', payload);\n\t}\n\n\t#removeMemberAction(store: UserGroupsStore, payload: {userGroupId: string, accessCode: string }): void\n\t{\n\t\tif (!this.#isUserGroupExists(store, payload.userGroupId))\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Attempt to remove member from a user group that dont exists', payload);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Type.isStringFilled(payload.accessCode))\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Attempt to remove member with invalid payload', payload);\n\n\t\t\treturn;\n\t\t}\n\n\t\tstore.commit('removeMember', payload);\n\t}\n\n\t#copyUserGroupAction(store: UserGroupsStore, { userGroupId }): void\n\t{\n\t\tconst sourceGroup = this.#getUserGroup(store.state, userGroupId);\n\n\t\tif (!sourceGroup)\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Attempt to copy user group that dont exists', { userGroupId });\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst emptyGroup = this.getElementState();\n\n\t\tconst copy: UserGroup = {\n\t\t\t...Runtime.clone(sourceGroup),\n\t\t\tid: emptyGroup.id,\n\t\t\ttitle: Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_COPIED_ROLE_NAME', {\n\t\t\t\t'#ORIGINAL#': sourceGroup.title,\n\t\t\t}),\n\t\t\tisNew: true,\n\t\t\tisModified: true,\n\t\t\tisShown: true,\n\t\t};\n\n\t\tfor (const value of copy.accessRights.values())\n\t\t{\n\t\t\t// is a new group all values are modified\n\t\t\tvalue.isModified = true;\n\t\t}\n\n\t\tstore.commit('addUserGroup', {\n\t\t\tuserGroup: copy,\n\t\t});\n\t}\n\n\t#addUserGroupAction(store: UserGroupsStore): void\n\t{\n\t\tconst newGroup = this.getElementState();\n\t\tnewGroup.accessRights = Runtime.clone(store.getters.defaultAccessRightValues);\n\n\t\tstore.commit('addUserGroup', {\n\t\t\tuserGroup: newGroup,\n\t\t});\n\t}\n\n\t#removeUserGroupAction(store: UserGroupsStore, { userGroupId }): void\n\t{\n\t\tconst userGroup = this.#getUserGroup(store.state, userGroupId);\n\t\tif (!userGroup)\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Attempt to remove user group that dont exists', { userGroupId });\n\n\t\t\treturn;\n\t\t}\n\n\t\tstore.commit('removeUserGroup', { userGroupId });\n\t\tif (!userGroup.isNew)\n\t\t{\n\t\t\tstore.commit('markUserGroupForDeletion', { userGroupId });\n\t\t}\n\t}\n\n\t#showUserGroupAction(store: UserGroupsState, { userGroupId }): void\n\t{\n\t\tif (!this.#isUserGroupExists(store, userGroupId))\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Attempt to show user group that dont exists', { userGroupId });\n\n\t\t\treturn;\n\t\t}\n\n\t\tstore.commit('showUserGroup', { userGroupId });\n\t}\n\n\t#hideUserGroupAction(store: UserGroupsState, { userGroupId }): void\n\t{\n\t\tif (!this.#isUserGroupExists(store, userGroupId))\n\t\t{\n\t\t\tconsole.warn('ui.accessrights.v2: Attempt to shrink user group that dont exists', { userGroupId });\n\n\t\t\treturn;\n\t\t}\n\n\t\tstore.commit('hideUserGroup', { userGroupId });\n\t}\n\n\t#isUserGroupExists(store, userGroupId: string): boolean\n\t{\n\t\tconst group = this.#getUserGroup(store.state, userGroupId);\n\n\t\treturn Boolean(group);\n\t}\n\n\t#getUserGroup(state: UserGroupsState, userGroupId: string): ?UserGroup\n\t{\n\t\treturn state.collection.get(userGroupId);\n\t}\n\n\t#isValueExistsInStructure(store, sectionCode: string, valueId: string): boolean\n\t{\n\t\tconst section: ?AccessRightSection = store.rootState.accessRights.collection.get(sectionCode);\n\n\t\treturn section?.rights.has(valueId);\n\t}\n\n\tgetMutations(): MutationTree<UserGroupsState>\n\t{\n\t\treturn {\n\t\t\tsetAccessRightValues: (state, { userGroupId, valueId, values, isModified }) => {\n\t\t\t\tconst userGroup = this.#getUserGroup(state, userGroupId);\n\n\t\t\t\tconst accessRightValue = userGroup.accessRights.get(valueId);\n\n\t\t\t\tif (!accessRightValue)\n\t\t\t\t{\n\t\t\t\t\tuserGroup.accessRights.set(\n\t\t\t\t\t\tvalueId,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: valueId,\n\t\t\t\t\t\t\tvalues,\n\t\t\t\t\t\t\tisModified,\n\t\t\t\t\t\t},\n\t\t\t\t\t);\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\taccessRightValue.values = values;\n\t\t\t\taccessRightValue.isModified = isModified;\n\t\t\t},\n\t\t\tsetRoleTitle: (state, { userGroupId, title }) => {\n\t\t\t\tconst userGroup = this.#getUserGroup(state, userGroupId);\n\t\t\t\tuserGroup.title = title;\n\t\t\t\tuserGroup.isModified = this.#isUserGroupModified(userGroup);\n\t\t\t},\n\t\t\taddMember: (state, { userGroupId, accessCode, member }) => {\n\t\t\t\tconst userGroup = this.#getUserGroup(state, userGroupId);\n\t\t\t\tuserGroup.members.set(accessCode, member);\n\t\t\t\tuserGroup.isModified = this.#isUserGroupModified(userGroup);\n\t\t\t},\n\t\t\tremoveMember: (state, { userGroupId, accessCode }) => {\n\t\t\t\tconst userGroup = this.#getUserGroup(state, userGroupId);\n\t\t\t\tuserGroup.members.delete(accessCode);\n\t\t\t\tuserGroup.isModified = this.#isUserGroupModified(userGroup);\n\t\t\t},\n\t\t\taddUserGroup: (state, { userGroup }) => {\n\t\t\t\tstate.collection.set(userGroup.id, userGroup);\n\t\t\t},\n\t\t\tremoveUserGroup: (state, { userGroupId }) => {\n\t\t\t\tstate.collection.delete(userGroupId);\n\t\t\t},\n\t\t\tmarkUserGroupForDeletion: (state, { userGroupId }) => {\n\t\t\t\tstate.deleted.add(userGroupId);\n\t\t\t},\n\t\t\tshowUserGroup: (state, { userGroupId }) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.collection.get(userGroupId).isShown = true;\n\t\t\t},\n\t\t\thideUserGroup: (state, { userGroupId }) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.collection.get(userGroupId).isShown = false;\n\t\t\t},\n\t\t};\n\t}\n\n\t#isValueModified(userGroupId: string, valueId: string, values: Set<string>, emptyValue: Set<string>): boolean\n\t{\n\t\tconst initialGroup = this.#initialUserGroups.get(userGroupId);\n\t\tif (!initialGroup)\n\t\t{\n\t\t\t// its a newly created group, all values are modified\n\n\t\t\treturn true;\n\t\t}\n\n\t\tconst initialValues = initialGroup.accessRights.get(valueId)?.values ?? emptyValue;\n\n\t\t// use native Sets instead of Vue-wrapped proxy-sets, they throw an error on `symmetricDifference`\n\t\treturn !this.#isSetsEqual(new Set(initialValues), new Set(values));\n\t}\n\n\t#isSetsEqual(a: Set, b: Set): boolean\n\t{\n\t\tif (Type.isFunction(a.symmetricDifference))\n\t\t{\n\t\t\t// native way to compare sets for modern browsers\n\t\t\treturn a.symmetricDifference(b).size === 0;\n\t\t}\n\n\t\t// polyfill\n\n\t\tif (a.size !== b.size)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tfor (const value of a)\n\t\t{\n\t\t\tif (!b.has(value))\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tfor (const value of b)\n\t\t{\n\t\t\tif (!a.has(value))\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t#isUserGroupModified(userGroup: UserGroup): boolean\n\t{\n\t\tif (userGroup.isNew)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst initialGroup = this.#initialUserGroups.get(userGroup.id);\n\t\tif (!initialGroup)\n\t\t{\n\t\t\tthrow new Error('ui.accessrights.v2: initial user group not found');\n\t\t}\n\n\t\tif (userGroup.title !== initialGroup.title)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst initialAccessCodes = new Set(initialGroup.members.keys());\n\t\tconst currentAccessCodes = new Set(userGroup.members.keys());\n\n\t\treturn !this.#isSetsEqual(initialAccessCodes, currentAccessCodes);\n\t}\n}\n","import { Builder, type Store } from 'ui.vue3.vuex';\nimport type { AccessRightsCollection } from './model/access-rights-model';\nimport { AccessRightsModel } from './model/access-rights-model';\nimport { ApplicationModel, type Options } from './model/application-model';\nimport type { UserGroupsCollection } from './model/user-groups-model';\nimport { UserGroupsModel } from './model/user-groups-model';\n\nexport function createStore(\n\toptions: Readonly<Options>,\n\tuserGroups: UserGroupsCollection,\n\taccessRights: AccessRightsCollection,\n\tappGuid: string | number,\n): {\n\tstore: Store,\n\tresetState: () => Promise<void>,\n\tuserGroupsModel: UserGroupsModel,\n}\n{\n\tconst userGroupsModel = UserGroupsModel.create()\n\t\t.setInitialUserGroups(userGroups)\n\t;\n\n\tconst { store } = Builder\n\t\t.init()\n\t\t.addModel(\n\t\t\tApplicationModel.create()\n\t\t\t\t.setOptions(options)\n\t\t\t\t.setGuid(appGuid)\n\t\t\t,\n\t\t)\n\t\t.addModel(\n\t\t\tAccessRightsModel.create()\n\t\t\t\t.setInitialAccessRights(accessRights)\n\t\t\t,\n\t\t)\n\t\t.addModel(userGroupsModel)\n\t\t.syncBuild()\n\t;\n\n\treturn {\n\t\tstore,\n\t\tresetState: () => userGroupsModel.clearState(),\n\t\tuserGroupsModel,\n\t};\n}\n","import type { AccessRightValue, Member, UserGroup, UserGroupsCollection } from '../../../user-groups-model';\nimport { NEW_USER_GROUP_ID_PREFIX } from '../../../user-groups-model';\nimport type { ExternalAccessRightValue, ExternalUserGroup } from '../../internalizer/user-groups-internalizer';\n\nexport type UserGroupSaveData = ExternalUserGroup & {\n\tmembers: null,\n\taccessCodes: { [accessCode: string]: string },\n};\n\n/**\n * @abstract\n */\nexport class BaseUserGroupsExporter implements Transformer<UserGroupsCollection, UserGroupSaveData[]>\n{\n\ttransform(source: UserGroupsCollection): UserGroupSaveData[]\n\t{\n\t\tconst result: UserGroupSaveData[] = [];\n\n\t\tfor (const userGroup of source.values())\n\t\t{\n\t\t\tresult.push({\n\t\t\t\tid: userGroup.id.startsWith(NEW_USER_GROUP_ID_PREFIX) ? '0' : userGroup.id,\n\t\t\t\ttitle: userGroup.title,\n\t\t\t\taccessCodes: this.#transformAccessCodes(userGroup.members),\n\t\t\t\taccessRights: this.#transformAccessRightValues(userGroup),\n\t\t\t});\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#transformAccessCodes(members: Map<string, Member>): { [accessCode: string]: string }\n\t{\n\t\tconst result = {};\n\n\t\tfor (const [accessCode, member] of members)\n\t\t{\n\t\t\tresult[accessCode] = member.type;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#transformAccessRightValues(userGroup: UserGroup): ExternalAccessRightValue[]\n\t{\n\t\tconst result: ExternalAccessRightValue[] = [];\n\n\t\tfor (const accessRightValue of userGroup.accessRights.values())\n\t\t{\n\t\t\tif (!this.shouldBeIncludedInExport(userGroup, accessRightValue))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tfor (const singleValue of accessRightValue.values)\n\t\t\t{\n\t\t\t\tresult.push({\n\t\t\t\t\tid: accessRightValue.id,\n\t\t\t\t\tvalue: singleValue,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t/**\n\t * @abstract\n\t * @protected\n\t */\n\tshouldBeIncludedInExport(userGroup: UserGroup, accessRightValue: AccessRightValue): boolean\n\t{\n\t\tthrow new Error('Not implemented');\n\t}\n}\n","import type { AccessRightValue, UserGroup } from '../../../user-groups-model';\nimport { BaseUserGroupsExporter } from './base-user-groups-exporter';\n\nexport class AllUserGroupsExporter extends BaseUserGroupsExporter\n{\n\tshouldBeIncludedInExport(userGroup: UserGroup, accessRightValue: AccessRightValue): boolean\n\t{\n\t\treturn true;\n\t}\n}\n","import type { AccessRightValue, UserGroup } from '../../../user-groups-model';\nimport { BaseUserGroupsExporter } from './base-user-groups-exporter';\n\nexport class OnlyChangedUserGroupsExporter extends BaseUserGroupsExporter\n{\n\tshouldBeIncludedInExport(userGroup: UserGroup, accessRightValue: AccessRightValue): boolean\n\t{\n\t\treturn userGroup.isNew || accessRightValue.isModified;\n\t}\n}\n","import { Text, Type } from 'main.core';\nimport { DEFAULT_ALIAS_SEPARATOR, normalizeAliasKey } from '../../../../utils';\nimport type {\n\tAccessRightItem,\n\tAccessRightsCollection,\n\tAccessRightSection,\n\tAccessRightSectionIcon,\n\tVariable,\n} from '../../access-rights-model';\nimport type { Transformer } from '../transformer';\n\nexport type ExternalAccessRightSection = {\n\tsectionTitle: ?any,\n\tsectionSubTitle: ?any,\n\tsectionCode: ?any,\n\tsectionHint: ?any,\n\tsectionIcon: ?any,\n\trights: ExternalAccessRightItem[],\n};\n\nexport type ExternalAccessRightItem = {\n\tid: any,\n\ttype: any,\n\ttitle: any,\n\thint: ?any,\n\tgroup: ?any,\n\tgroupHead: ?any,\n\tminValue?: any | any[],\n\tmaxValue?: any | any[],\n\tdefaultValue?: any | any[],\n\tnothingSelectedValue?: any | any[],\n\tsetEmptyOnSetMinMaxValueInColumn: ?any,\n\n\tvariables?: ExternalVariable[],\n\n\tallSelectedCode: ?any,\n\tselectedVariablesAliases: {[key: string]: string} & {separator?: string},\n\tenableSearch?: any,\n\tshowAvatars?: any,\n\tcompactView?: any,\n\thintTitle: ?any,\n};\n\nexport type ExternalVariable = {\n\tid: any,\n\ttitle: any,\n\tentityId: ?any,\n\tsupertitle: ?any,\n\tavatar: ?any,\n\tavatarOptions: ?any,\n\tconflictsWith?: any[],\n\trequires?: any[],\n\tsecondary: ?any,\n}\n\nexport class AccessRightsInternalizer implements Transformer<ExternalAccessRightSection[], AccessRightsCollection>\n{\n\ttransform(externalSource: ExternalAccessRightSection[]): AccessRightsCollection\n\t{\n\t\tconst result: AccessRightsCollection = new Map();\n\n\t\tfor (const external of externalSource)\n\t\t{\n\t\t\tconst internalized = this.#internalizeExternalSection(external);\n\t\t\tresult.set(internalized.sectionCode, internalized);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#internalizeExternalSection(externalSection: ExternalAccessRightSection): AccessRightSection\n\t{\n\t\tconst internalizedSection: AccessRightSection = {\n\t\t\tsectionCode: Type.isStringFilled(externalSection.sectionCode)\n\t\t\t\t? externalSection.sectionCode\n\t\t\t\t: Text.getRandom(),\n\t\t\tsectionTitle: String(externalSection.sectionTitle),\n\t\t\tsectionSubTitle: Type.isStringFilled(externalSection.sectionSubTitle)\n\t\t\t\t? externalSection.sectionSubTitle\n\t\t\t\t: null,\n\t\t\tsectionHint: Type.isStringFilled(externalSection.sectionHint)\n\t\t\t\t? externalSection.sectionHint\n\t\t\t\t: null,\n\t\t\tsectionIcon: this.#internalizeExternalIcon(externalSection.sectionIcon),\n\t\t\trights: new Map(),\n\t\t\tisExpanded: true,\n\t\t\tisShown: true,\n\t\t};\n\n\t\tfor (const externalItem of externalSection.rights)\n\t\t{\n\t\t\tconst internalizedItem = this.#internalizeExternalItem(externalItem);\n\n\t\t\tinternalizedSection.rights.set(internalizedItem.id, internalizedItem);\n\t\t}\n\n\t\treturn internalizedSection;\n\t}\n\n\t#internalizeExternalIcon(externalIcon: ?any): ?AccessRightSectionIcon\n\t{\n\t\tif (Type.isStringFilled(externalIcon?.type) && Type.isStringFilled(externalIcon?.bgColor))\n\t\t{\n\t\t\treturn {\n\t\t\t\ttype: externalIcon.type,\n\t\t\t\tbgColor: externalIcon.bgColor,\n\t\t\t};\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t#internalizeExternalItem(externalItem: ExternalAccessRightItem): AccessRightItem\n\t{\n\t\tconst [aliases, separator] = this.#internalizeSelectedVariablesAliases(externalItem.selectedVariablesAliases);\n\n\t\tconst normalizedItem: AccessRightItem = {\n\t\t\tid: String(externalItem.id),\n\t\t\ttype: String(externalItem.type),\n\t\t\ttitle: String(externalItem.title),\n\t\t\thint: Type.isStringFilled(externalItem.hint) ? externalItem.hint : null,\n\t\t\tgroup: Type.isNil(externalItem.group) ? null : String(externalItem.group),\n\t\t\tgroupHead: Type.isBoolean(externalItem.groupHead) ? externalItem.groupHead : false,\n\t\t\tisShown: true,\n\t\t\tminValue: this.#internalizeValueSet(externalItem.minValue),\n\t\t\tmaxValue: this.#internalizeValueSet(externalItem.maxValue),\n\t\t\tdefaultValue: this.#internalizeValueSet(externalItem.defaultValue),\n\t\t\temptyValue: this.#internalizeValueSet(externalItem.emptyValue),\n\t\t\tnothingSelectedValue: this.#internalizeValueSet(externalItem.nothingSelectedValue),\n\t\t\tsetEmptyOnSetMinMaxValueInColumn: this.#internalizeSetEmptyOnSetMinMaxValueInColumn(externalItem),\n\t\t\tvariables: Type.isArray(externalItem.variables) ? new Map() : null,\n\n\t\t\tallSelectedCode: Type.isStringFilled(externalItem.allSelectedCode) ? externalItem.allSelectedCode : null,\n\t\t\tselectedVariablesAliases: aliases,\n\t\t\tselectedVariablesAliasesSeparator: separator,\n\t\t\tenableSearch: Type.isBoolean(externalItem.enableSearch) ? externalItem.enableSearch : null,\n\t\t\tshowAvatars: Type.isBoolean(externalItem.showAvatars) ? externalItem.showAvatars : null,\n\t\t\tcompactView: Type.isBoolean(externalItem.compactView) ? externalItem.compactView : null,\n\t\t\thintTitle: Type.isStringFilled(externalItem.hintTitle) ? externalItem.hintTitle : null,\n\t\t};\n\t\tif (normalizedItem.groupHead || normalizedItem.group)\n\t\t{\n\t\t\tnormalizedItem.isGroupExpanded = false;\n\t\t}\n\n\t\tif (Type.isArray(externalItem.variables))\n\t\t{\n\t\t\tfor (const variable of externalItem.variables)\n\t\t\t{\n\t\t\t\tconst normalizedVariable = this.#internalizeExternalVariable(variable);\n\n\t\t\t\tnormalizedItem.variables.set(normalizedVariable.id, normalizedVariable);\n\t\t\t}\n\t\t}\n\n\t\treturn normalizedItem;\n\t}\n\n\t#internalizeSelectedVariablesAliases(externalAliases: {[key: string]: string} & {separator?: string}): [Map, string]\n\t{\n\t\tif (!Type.isPlainObject(externalAliases))\n\t\t{\n\t\t\treturn [new Map(), DEFAULT_ALIAS_SEPARATOR];\n\t\t}\n\n\t\tconst separator = Type.isString(externalAliases.separator) ? externalAliases.separator : DEFAULT_ALIAS_SEPARATOR;\n\n\t\tconst result = new Map();\n\t\tfor (const [key, value] of Object.entries(externalAliases))\n\t\t{\n\t\t\tif (key === 'separator')\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tresult.set(normalizeAliasKey(key, separator), String(value));\n\t\t}\n\n\t\treturn [result, separator];\n\t}\n\n\t#internalizeValueSet(value: any | any[] | undefined): ?Set<string>\n\t{\n\t\tif (Type.isNil(value))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (Type.isArray(value))\n\t\t{\n\t\t\treturn new Set(value.map((item) => String(item)));\n\t\t}\n\n\t\treturn new Set([String(value)]);\n\t}\n\n\t#internalizeSetEmptyOnSetMinMaxValueInColumn(externalItem: ExternalAccessRightItem): ?boolean\n\t{\n\t\tconst boolOrNull = (x: any) => (Type.isBoolean(x) ? x : null);\n\n\t\tif (!Type.isUndefined(externalItem.setEmptyOnSetMinMaxValueInColumn))\n\t\t{\n\t\t\treturn boolOrNull(externalItem.setEmptyOnSetMinMaxValueInColumn);\n\t\t}\n\n\t\t// todo compatibility, can be removed when crm update is out\n\t\treturn boolOrNull(externalItem.setEmptyOnGroupActions);\n\t}\n\n\t#internalizeExternalVariable(externalVariable: ExternalVariable): Variable\n\t{\n\t\treturn {\n\t\t\tid: String(externalVariable.id),\n\t\t\ttitle: String(externalVariable.title),\n\t\t\tentityId: Type.isStringFilled(externalVariable.entityId) ? externalVariable.entityId : null,\n\t\t\tsupertitle: Type.isStringFilled(externalVariable.supertitle) ? externalVariable.supertitle : null,\n\t\t\tavatar: Type.isStringFilled(externalVariable.avatar) ? externalVariable.avatar : null,\n\t\t\tavatarOptions: Type.isPlainObject(externalVariable.avatarOptions) ? externalVariable.avatarOptions : null,\n\t\t\tconflictsWith: Type.isArray(externalVariable.conflictsWith)\n\t\t\t\t? new Set(externalVariable.conflictsWith.map((x) => String(x)))\n\t\t\t\t: null,\n\t\t\trequires: Type.isArray(externalVariable.requires)\n\t\t\t\t? new Set(externalVariable.requires.map((x) => String(x)))\n\t\t\t\t: null,\n\t\t\tsecondary: Type.isBoolean(externalVariable.secondary) ? externalVariable.secondary : null,\n\t\t};\n\t}\n}\n","import { Type } from 'main.core';\nimport { ACTION_SAVE, BODY_TYPE, MODE, type Options } from '../../application-model';\nimport type { Transformer } from '../transformer';\n\nexport class ApplicationInternalizer implements Transformer<Options, Readonly<Options>>\n{\n\t// noinspection OverlyComplexFunctionJS\n\ttransform(externalSource: Options): Readonly<Options>\n\t{\n\t\t// freeze tells vue that we don't need reactivity on this state\n\t\t// and prevents accidental modification as well\n\t\treturn this.#deepFreeze({\n\t\t\tcomponent: String(externalSource.component),\n\t\t\tactionSave: Type.isStringFilled(externalSource.actionSave) ? externalSource.actionSave : ACTION_SAVE,\n\t\t\tmode: Type.isStringFilled(externalSource.mode) ? externalSource.mode : MODE,\n\t\t\tbodyType: Type.isStringFilled(externalSource.bodyType) ? externalSource.bodyType : BODY_TYPE,\n\t\t\tadditionalSaveParams: Type.isPlainObject(externalSource.additionalSaveParams)\n\t\t\t\t? externalSource.additionalSaveParams\n\t\t\t\t: null,\n\t\t\tisSaveOnlyChangedRights: Type.isBoolean(externalSource.isSaveOnlyChangedRights)\n\t\t\t\t? externalSource.isSaveOnlyChangedRights\n\t\t\t\t: false,\n\t\t\tmaxVisibleUserGroups: Type.isInteger(externalSource.maxVisibleUserGroups)\n\t\t\t\t? externalSource.maxVisibleUserGroups\n\t\t\t\t: null,\n\t\t\tsearchContainerSelector: Type.isStringFilled(externalSource.searchContainerSelector)\n\t\t\t\t? externalSource.searchContainerSelector\n\t\t\t\t: null,\n\t\t\tadditionalMembersParams: Type.isPlainObject(externalSource.additionalMembersParams)\n\t\t\t\t? {\n\t\t\t\t\taddUserGroupsProviderTab: Boolean(externalSource.additionalMembersParams?.addUserGroupsProviderTab ?? false),\n\t\t\t\t\taddProjectsProviderTab: Boolean(externalSource.additionalMembersParams?.addProjectsProviderTab ?? true),\n\t\t\t\t\taddStructureTeamsProviderTab: Boolean(externalSource.additionalMembersParams?.addStructureTeamsProviderTab ?? false),\n\t\t\t\t}\n\t\t\t\t: {\n\t\t\t\t\taddUserGroupsProviderTab: false,\n\t\t\t\t\taddProjectsProviderTab: true,\n\t\t\t\t\taddStructureTeamsProviderTab: false,\n\t\t\t\t},\n\t\t});\n\t}\n\n\t#deepFreeze(target: Object): Readonly<Object>\n\t{\n\t\tif (Type.isObject(target))\n\t\t{\n\t\t\tObject.values(target).forEach((value) => {\n\t\t\t\tthis.#deepFreeze(value);\n\t\t\t});\n\n\t\t\treturn Object.freeze(target);\n\t\t}\n\n\t\treturn target;\n\t}\n}\n","import { Type } from 'main.core';\nimport type { AccessRightValue, UserGroupsCollection } from '../../user-groups-model';\nimport { Member, UserGroup } from '../../user-groups-model';\nimport type { Transformer } from '../transformer';\n\nexport type ExternalUserGroup = {\n\tid: any,\n\ttitle: any,\n\taccessRights: ExternalAccessRightValue[],\n\tmembers: {[accessCode: string]: ExternalMember},\n}\n\nexport type ExternalAccessRightValue = {\n\tid: any,\n\tvalue: any | any[],\n};\n\nexport type ExternalMember = {\n\ttype: any,\n\tid: any,\n\tname: any,\n\tavatar: any,\n};\n\nexport class UserGroupsInternalizer implements Transformer<ExternalUserGroup[], UserGroupsCollection>\n{\n\t#maxVisibleUserGroups: ?number = null;\n\n\tconstructor(maxVisibleUserGroups: ?number)\n\t{\n\t\tif (Type.isInteger(maxVisibleUserGroups))\n\t\t{\n\t\t\tthis.#maxVisibleUserGroups = maxVisibleUserGroups;\n\t\t}\n\t}\n\n\ttransform(externalSource: ExternalUserGroup[]): UserGroupsCollection\n\t{\n\t\tconst result = new Map();\n\n\t\tfor (const externalGroup of externalSource)\n\t\t{\n\t\t\tconst internalGroup = this.#internalizeExternalGroup(externalGroup);\n\t\t\tif (this.#maxVisibleUserGroups > 0 && result.size >= this.#maxVisibleUserGroups)\n\t\t\t{\n\t\t\t\tinternalGroup.isShown = false;\n\t\t\t}\n\n\t\t\tresult.set(internalGroup.id, internalGroup);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#internalizeExternalGroup(externalGroup: ExternalUserGroup): UserGroup\n\t{\n\t\tconst internalizedGroup: UserGroup = {\n\t\t\tid: String(externalGroup.id),\n\t\t\tisNew: false,\n\t\t\tisModified: false,\n\t\t\tisShown: true,\n\t\t\ttitle: String(externalGroup.title),\n\t\t\taccessRights: new Map(),\n\t\t\tmembers: new Map(),\n\t\t};\n\n\t\tfor (const externalValue: ExternalAccessRightValue of externalGroup.accessRights)\n\t\t{\n\t\t\tconst internalizedValue = this.#internalizeExternalAccessRightsValue(externalValue);\n\n\t\t\tif (internalizedGroup.accessRights.has(internalizedValue.id))\n\t\t\t{\n\t\t\t\tfor (const previousValue of internalizedGroup.accessRights.get(internalizedValue.id).values)\n\t\t\t\t{\n\t\t\t\t\tinternalizedValue.values.add(previousValue);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tinternalizedGroup.accessRights.set(internalizedValue.id, internalizedValue);\n\t\t}\n\n\t\tfor (const [accessCode: string, externalMember: ExternalMember] of Object.entries(externalGroup.members))\n\t\t{\n\t\t\tconst internalizedAccessCode = this.#internalizeExternalAccessCode(accessCode);\n\n\t\t\tinternalizedGroup.members.set(internalizedAccessCode, this.#internalizeExternalMember(externalMember));\n\t\t}\n\n\t\treturn internalizedGroup;\n\t}\n\n\t#internalizeExternalAccessRightsValue(externalAccessRightsValue: ExternalAccessRightValue): AccessRightValue\n\t{\n\t\tconst valueId = String(externalAccessRightsValue.id);\n\n\t\tconst internalized: AccessRightValue = {\n\t\t\tid: valueId,\n\t\t\tisModified: false,\n\t\t};\n\n\t\tconst values: Array<any> = Type.isArray(externalAccessRightsValue.value)\n\t\t\t? externalAccessRightsValue.value\n\t\t\t: [externalAccessRightsValue.value];\n\n\t\tinternalized.values = new Set(values.map((x) => String(x)));\n\n\t\treturn internalized;\n\t}\n\n\t#internalizeExternalAccessCode(accessCode: any): string\n\t{\n\t\tlet stringAccessCode = String(accessCode);\n\n\t\tif (/^IU(\\d+)$/.test(stringAccessCode))\n\t\t{\n\t\t\t// `IU` and `U` are basically the same in this extension. differentiation between them is not supported\n\t\t\t// for data consistency, force `U`\n\t\t\tstringAccessCode = stringAccessCode.replace('IU', 'U');\n\t\t}\n\n\t\treturn stringAccessCode;\n\t}\n\n\t#internalizeExternalMember(externalMember: ExternalMember): Member\n\t{\n\t\treturn {\n\t\t\ttype: String(externalMember.type),\n\t\t\tid: String(externalMember.id),\n\t\t\tname: String(externalMember.name),\n\t\t\tavatar: Type.isStringFilled(externalMember.avatar) ? externalMember.avatar : null,\n\t\t};\n\t}\n}\n","import { Type } from 'main.core';\nimport type { UserGroupsCollection } from '../user-groups-model';\nimport type { Transformer } from './transformer';\n\nexport class ShownUserGroupsCopier implements Transformer<UserGroupsCollection, UserGroupsCollection>\n{\n\t#srcUserGroups: UserGroupsCollection;\n\t#maxVisibleUserGroups: ?number = null;\n\n\tconstructor(srcUserGroups: UserGroupsCollection, maxVisibleUserGroups: ?number)\n\t{\n\t\tthis.#srcUserGroups = srcUserGroups;\n\t\tif (Type.isInteger(maxVisibleUserGroups))\n\t\t{\n\t\t\tthis.#maxVisibleUserGroups = maxVisibleUserGroups;\n\t\t}\n\t}\n\n\t/**\n\t * WARNING! Mutates `externalSource`. Src is not copied for perf reasons, since we don't need it functionally\n\t */\n\ttransform(externalSource: UserGroupsCollection): UserGroupsCollection\n\t{\n\t\tfor (const [userGroupId, userGroup] of externalSource)\n\t\t{\n\t\t\tconst srcUserGroup = this.#srcUserGroups.get(userGroupId);\n\t\t\tif (srcUserGroup)\n\t\t\t{\n\t\t\t\tuserGroup.isShown = srcUserGroup.isShown;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t// likely it's a just created user group\n\t\t\t\tuserGroup.isShown = true;\n\t\t\t}\n\t\t}\n\n\t\tif (this.#maxVisibleUserGroups > 0)\n\t\t{\n\t\t\tthis.#ensureThatNoMoreUserGroupsThanMaxIsShown(externalSource);\n\t\t}\n\n\t\treturn externalSource;\n\t}\n\n\t#ensureThatNoMoreUserGroupsThanMaxIsShown(userGroups: UserGroupsCollection): void\n\t{\n\t\tlet shownCount = 0;\n\t\tfor (const userGroup of userGroups.values())\n\t\t{\n\t\t\tif (!userGroup.isShown)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tshownCount++;\n\n\t\t\tif (shownCount > this.#maxVisibleUserGroups)\n\t\t\t{\n\t\t\t\tuserGroup.isShown = false;\n\t\t\t}\n\t\t}\n\t}\n}\n","import { ajax as Ajax, type AjaxResponse, Dom, type JsonObject, Loc, Runtime, Text, Type } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { Button, ButtonColor, ButtonSize, CancelButton } from 'ui.buttons';\nimport { MessageBox } from 'ui.dialogs.messagebox';\nimport { BitrixVue, type VueCreateAppResult } from 'ui.vue3';\nimport type { Store } from 'ui.vue3.vuex';\nimport { Grid } from './components/grid';\nimport 'ui.notification';\nimport { AnalyticsManager } from './integration/analytics-manager';\nimport { createStore } from './store/index';\nimport type { Options } from './store/model/application-model';\nimport { AllUserGroupsExporter } from './store/model/transformation/backend-exporter/user-groups/all-user-groups-exporter';\nimport { OnlyChangedUserGroupsExporter } from './store/model/transformation/backend-exporter/user-groups/only-changed-user-groups-exporter';\nimport type { ExternalAccessRightSection } from './store/model/transformation/internalizer/access-rights-internalizer';\nimport { AccessRightsInternalizer } from './store/model/transformation/internalizer/access-rights-internalizer';\nimport { ApplicationInternalizer } from './store/model/transformation/internalizer/application-internalizer';\nimport type { ExternalUserGroup } from './store/model/transformation/internalizer/user-groups-internalizer';\nimport { UserGroupsInternalizer } from './store/model/transformation/internalizer/user-groups-internalizer';\nimport { ShownUserGroupsCopier } from './store/model/transformation/shown-user-groups-copier';\nimport type { UserGroupsCollection, UserGroupsModel } from './store/model/user-groups-model';\n\nexport type AppConstructOptions = Options & {\n\trenderTo: HTMLElement;\n\tuserGroups: ExternalUserGroup[];\n\taccessRights: ExternalAccessRightSection[];\n};\n\ntype SaveAjaxResponse = AjaxResponse<{ USER_GROUPS: JsonObject }>;\n\n/**\n * @memberOf BX.UI.AccessRights.V2\n */\nexport class App\n{\n\t#options: AppConstructOptions = {};\n\t#renderTo: HTMLElement;\n\t#buttonPanel: BX.UI.ButtonPanel;\n\n\t#guid: string;\n\t#isUserConfirmedClose: boolean = false;\n\n\t#handleSliderClose: (BaseEvent<BX.SidePanel.Event[]>) => void;\n\n\t#app: VueCreateAppResult;\n\t#rootComponent: Element;\n\t#store: Store;\n\t#resetState: () => void;\n\t#unwatch: () => void;\n\t#userGroupsModel: UserGroupsModel;\n\t#analyticsManager: AnalyticsManager;\n\n\tconstructor(options: AppConstructOptions)\n\t{\n\t\tthis.#options = options || {};\n\t\tthis.#renderTo = this.#options.renderTo;\n\t\tthis.#buttonPanel = BX.UI.ButtonPanel || null;\n\n\t\tthis.#guid = Text.getRandom(16);\n\n\t\tthis.#bindEvents();\n\t}\n\n\t#bindEvents(): void\n\t{\n\t\tthis.#handleSliderClose = (event: BaseEvent<BX.SidePanel.Event[]>): void => {\n\t\t\tconst [sliderEvent] = event.getData();\n\n\t\t\tconst isSliderBelongsToThisApp = BX.SidePanel?.Instance?.getSliderByWindow(window) === sliderEvent?.getSlider();\n\n\t\t\tif (!isSliderBelongsToThisApp)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.#confirmBeforeClosingModifiedSlider(sliderEvent);\n\t\t};\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onClose', this.#handleSliderClose);\n\t}\n\n\t#unbindEvents(): void\n\t{\n\t\tEventEmitter.unsubscribe('SidePanel.Slider:onClose', this.#handleSliderClose);\n\n\t\tthis.#handleSliderClose = null;\n\t}\n\n\tfireEventReset(): void\n\t{\n\t\tconst box = MessageBox.create({\n\t\t\tmessage: Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_MODIFIED_CANCEL_WARNING'),\n\t\t\tmodal: true,\n\t\t\tbuttons: [\n\t\t\t\tnew Button({\n\t\t\t\t\tcolor: ButtonColor.PRIMARY,\n\t\t\t\t\tsize: ButtonSize.SMALL,\n\t\t\t\t\ttext: Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_MODIFIED_CANCEL_YES_CANCEL'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.#analyticsManager.onCancelChanges();\n\t\t\t\t\t\tthis.#resetState();\n\t\t\t\t\t\tbox.close();\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t\tnew Button({\n\t\t\t\t\tcolor: ButtonColor.LINK,\n\t\t\t\t\tsize: ButtonSize.SMALL,\n\t\t\t\t\ttext: Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_MODIFIED_CANCEL_NO_CANCEL'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tbox.close();\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t],\n\t\t});\n\n\t\tbox.show();\n\t}\n\n\t#tryShowFeaturePromoter(response: SaveAjaxResponse): boolean\n\t{\n\t\tif (!Type.isArrayFilled(response?.errors))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tfor (const error of response.errors)\n\t\t{\n\t\t\tif (Type.isStringFilled(error?.customData?.sliderCode))\n\t\t\t{\n\t\t\t\tRuntime.loadExtension('ui.info-helper').then(({ FeaturePromotersRegistry }) => {\n\t\t\t\t\t/** @see BX.UI.FeaturePromotersRegistry */\n\t\t\t\t\tFeaturePromotersRegistry.getPromoter({ code: error.customData.sliderCode }).show();\n\t\t\t\t}).catch((loadError) => {\n\t\t\t\t\tconsole.error('ui.accessrights.v2: could not load ui.info-helper', loadError);\n\t\t\t\t});\n\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t#showNotification(title): void\n\t{\n\t\tBX.UI.Notification.Center.notify({\n\t\t\tcontent: title,\n\t\t\tposition: 'top-right',\n\t\t\tautoHideDelay: 3000,\n\t\t});\n\t}\n\n\tsendActionRequest(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif (this.#store.state.application.isSaving || !this.#store.getters['userGroups/isModified'])\n\t\t\t{\n\t\t\t\tresolve();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.#store.commit('application/setSaving', true);\n\n\t\t\tthis.#analyticsManager.onSaveAttempt();\n\n\t\t\tthis.#runSaveAjaxRequest()\n\t\t\t\t.then(({ userGroups }) => {\n\t\t\t\t\tthis.#analyticsManager.onSaveSuccess();\n\t\t\t\t\tthis.#userGroupsModel.setInitialUserGroups(userGroups);\n\n\t\t\t\t\t// reset modification flags and stuff\n\t\t\t\t\tthis.#resetState();\n\n\t\t\t\t\tthis.#showNotification(Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_SETTINGS_HAVE_BEEN_SAVED'));\n\t\t\t\t})\n\t\t\t\t.catch((response: SaveAjaxResponse) => {\n\t\t\t\t\tthis.#analyticsManager.onSaveError(response);\n\n\t\t\t\t\tconsole.warn('ui.accessrights.v2: error during save', response);\n\n\t\t\t\t\tif (this.#tryShowFeaturePromoter(response))\n\t\t\t\t\t{\n\t\t\t\t\t\treject(response);\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.#showNotification(response?.errors?.[0]?.message || 'Something went wrong');\n\n\t\t\t\t\treject(response);\n\t\t\t\t})\n\t\t\t\t.finally(() => {\n\t\t\t\t\tconst waitContainer = this.#buttonPanel?.getContainer().querySelector('.ui-btn-wait');\n\t\t\t\t\tDom.removeClass(waitContainer, 'ui-btn-wait');\n\t\t\t\t\tthis.#store.commit('application/setSaving', false);\n\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t});\n\t}\n\n\t#runSaveAjaxRequest(): Promise<{ userGroups: UserGroupsCollection }>\n\t{\n\t\tconst internalUserGroups = this.#store.state.userGroups.collection;\n\n\t\tlet userGroups = null;\n\t\tif (this.#store.state.application.options.isSaveOnlyChangedRights)\n\t\t{\n\t\t\tuserGroups = (new OnlyChangedUserGroupsExporter()).transform(internalUserGroups);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tuserGroups = (new AllUserGroupsExporter()).transform(internalUserGroups);\n\t\t}\n\n\t\tconst bodyType = this.#store.state.application.options.bodyType;\n\n\t\t// wrap ajax in native promise\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tAjax.runComponentAction(\n\t\t\t\tthis.#store.state.application.options.component,\n\t\t\t\tthis.#store.state.application.options.actionSave,\n\t\t\t\t{\n\t\t\t\t\tmode: this.#store.state.application.options.mode,\n\t\t\t\t\t[bodyType]: {\n\t\t\t\t\t\tuserGroups,\n\t\t\t\t\t\tdeletedUserGroups: [...this.#store.state.userGroups.deleted.values()],\n\t\t\t\t\t\tparameters: this.#store.state.application.options.additionalSaveParams,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t)\n\t\t\t\t.then((response: SaveAjaxResponse) => {\n\t\t\t\t\tconst maxVisibleUserGroups = this.#store.state.application.options.maxVisibleUserGroups;\n\n\t\t\t\t\tconst newUserGroups = (new UserGroupsInternalizer(maxVisibleUserGroups))\n\t\t\t\t\t\t.transform(response.data.USER_GROUPS)\n\t\t\t\t\t;\n\n\t\t\t\t\t(new ShownUserGroupsCopier(internalUserGroups, maxVisibleUserGroups)).transform(newUserGroups);\n\n\t\t\t\t\tresolve({\n\t\t\t\t\t\tuserGroups: newUserGroups,\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.catch(reject)\n\t\t\t;\n\t\t});\n\t}\n\n\t#confirmBeforeClosingModifiedSlider(sliderEvent: BX.SidePanel.Event): void\n\t{\n\t\tif (!this.#store.getters['userGroups/isModified'] || this.#isUserConfirmedClose)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tsliderEvent.denyAction();\n\n\t\tconst box = MessageBox.create({\n\t\t\ttitle: Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_MODIFIED_CLOSE_WARNING_TITLE'),\n\t\t\tmessage: Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_MODIFIED_CLOSE_WARNING'),\n\t\t\tmodal: true,\n\t\t\tbuttons: [\n\t\t\t\tnew Button({\n\t\t\t\t\tcolor: ButtonColor.PRIMARY,\n\t\t\t\t\tsize: ButtonSize.SMALL,\n\t\t\t\t\ttext: Loc.getMessage('JS_UI_ACCESSRIGHTS_V2_MODIFIED_CLOSE_YES_CLOSE'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.#analyticsManager.onCloseWithoutSave();\n\t\t\t\t\t\tthis.#isUserConfirmedClose = true;\n\t\t\t\t\t\tbox.close();\n\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tsliderEvent.getSlider().close();\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t\tnew CancelButton({\n\t\t\t\t\tsize: ButtonSize.SMALL,\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tbox.close();\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t],\n\t\t});\n\n\t\tbox.show();\n\t}\n\n\tdraw(): void\n\t{\n\t\tconst applicationOptions = (new ApplicationInternalizer()).transform(this.#options);\n\n\t\tconst { store, resetState, userGroupsModel } = createStore(\n\t\t\tapplicationOptions,\n\t\t\t(new UserGroupsInternalizer(applicationOptions.maxVisibleUserGroups)).transform(this.#options.userGroups),\n\t\t\t(new AccessRightsInternalizer()).transform(this.#options.accessRights),\n\t\t\tthis.#guid,\n\t\t);\n\n\t\tthis.#store = store;\n\t\tthis.#resetState = resetState;\n\t\tthis.#userGroupsModel = userGroupsModel;\n\n\t\tthis.#unwatch = this.#store.watch(\n\t\t\t(state, getters) => getters['userGroups/isModified'],\n\t\t\t(newValue) => {\n\t\t\t\tif (newValue)\n\t\t\t\t{\n\t\t\t\t\tthis.#buttonPanel?.show();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.#buttonPanel?.hide();\n\t\t\t\t}\n\t\t\t},\n\t\t);\n\n\t\tthis.#app = BitrixVue.createApp(Grid);\n\t\tthis.#app.use(this.#store);\n\n\t\tDom.clean(this.#renderTo);\n\t\tthis.#rootComponent = this.#app.mount(this.#renderTo);\n\t\tthis.#analyticsManager = new AnalyticsManager(this.#store, this.#options.analytics);\n\t}\n\n\tdestroy(): void\n\t{\n\t\tthis.#analyticsManager = null;\n\n\t\tthis.#app.unmount();\n\t\tthis.#app = null;\n\n\t\tthis.#unbindEvents();\n\n\t\tthis.#unwatch();\n\t\tthis.#unwatch = null;\n\n\t\tthis.#store = null;\n\t\tthis.#resetState = null;\n\t\tthis.#userGroupsModel = null;\n\t\tthis.#options = null;\n\t\tthis.#buttonPanel = null;\n\n\t\tDom.clean(this.#renderTo);\n\t\tthis.#renderTo = null;\n\t}\n\n\thasUnsavedChanges(): boolean\n\t{\n\t\treturn !(!this.#store.getters['userGroups/isModified'] || this.#isUserConfirmedClose);\n\t}\n\n\tscrollToSection(sectionCode)\n\t{\n\t\tthis.#rootComponent.scrollToSection(sectionCode);\n\t}\n}\n"],"names":["Base","getComponentName","Error","getEmptyValue","item","emptyValue","Set","getMinValue","Type","isNil","minValue","getMaxValue","maxValue","isRowValueConfigurable","DependentVariables","Multivariables","Toggler","isFalsy","explicit","isNull","Variables","ServiceLocator","getHint","appGuid","remember","BX","UI","Hint","createInstance","id","popupParameters","className","autoHide","darkMode","maxWidth","offsetTop","offsetLeft","angle","animation","getValueTypeByRight","right","getValueType","type","stringType","String","console","warn","Cache","MemoryCache","EntitySelectorContext","Object","freeze","ROLE","MEMBER","VARIABLE","EntitySelectorEntities","Selector","name","emits","props","userGroup","required","bindNode","HTMLElement","computed","selectedItems","result","accessCode","members","keys","push","getItemIdByAccessCode","mapState","options","state","application","addUserGroupsProviderTab","additionalMembersParams","addProjectsProviderTab","addStructureTeamsProviderTab","mounted","entities","getEntities","Dialog","enableSearch","context","alwaysShowLabels","targetNode","preselectedItems","cacheable","events","onMemberAdd","onMemberRemove","onHide","$emit","show","methods","test","match","userId","departmentId","groupId","at","projectId","postfix","structureNodeId","event","member","getMemberFromEvent","$store","dispatch","userGroupId","getData","getAccessCodeByItem","getMemberTypeByItem","title","text","avatar","isStringFilled","entityId","isString","endsWith","originalId","subType","customData","get","intranetUsersOnly","emailUsers","inviteEmployeeLink","inviteGuestLink","selectMode","allowSelectRootDepartment","allowFlatDepartments","dynamicLoad","dynamicSearch","includedNodeEntityTypes","useMultipleTabs","visual","avatarMode","tagStyle","addProjectMetaUsers","itemOptions","default","link","linkTitle","template","SingleMember","avatarBackgroundImage","encodeURI","noAvatarClass","MAX_SHOWN_MEMBERS","Members","components","data","isSelectorShown","isSelectedMembersPopupShown","popup","shownMembers","size","shownKeyValuePairs","slice","Map","notShownMembersCount","$refs","container","RoleHeading","RichMenuPopup","RichMenuItem","isEdit","isPopupShown","RichMenuItemIcon","isSaving","guid","maxVisibleUserGroups","mapGetters","isMaxVisibleUserGroupsReached","isMaxValueSetForAny","isMinValueSetForAny","set","watch","newValue","bindClickedOutsideHandler","$nextTick","input","scrollIntoView","behavior","block","inline","focus","select","unbindClickedOutsideHandler","isNew","beforeUnmount","Event","bind","window","turnOffEditWhenClickedOutside","capture","unbind","target","showDeleteConfirmation","Popup","bindElement","width","overlay","contentPadding","content","$Bitrix","Loc","getMessage","buttons","Button","ButtonSize","SMALL","color","ButtonColor","PRIMARY","click","destroy","CancelButton","showActionsMenu","onSetMaxValuesClick","onSetMinValuesClick","onEnableEditClick","onCopyRoleClick","onDeleteRoleClick","ItemsMapper","mapUserGroups","userGroups","values","supertitle","tabs","mapVariables","variables","items","variable","Runtime","clone","CellLayout","ColumnLayout","RolesControl","viewDialog","allUserGroups","collection","isMaxVisibleUserGroupsSet","shownGroupsCounter","copyDialogItems","viewDialogItems","copyDialogItem","selected","has","onCreateNewRoleClick","onRoleViewClick","showViewDialog","configure","showCopyDialog","copyDialog","multiple","dropdownMode","dialogEvent","getId","footer","getSelectedItems","length","preventDefault","toggleViewDialog","hide","isMaxListenersSet","lastScrollLeft","SyncHorizontalScroll","componentGuid","Text","getRandom","throttledEmitScrollEvent","created","requestAnimationFrameThrottle","emitScrollEvent","sectionsNumber","accessRights","eventEmitter","incrementMaxListeners","subscribe","handleScrollEvent","syncScroll","unsubscribe","scrollLeft","emit","$el","func","callbackSet","invoke","wrapper","args","q","requestAnimationFrame","Header","directives","hint","SearchBox","debouncedSetSearchQuery","setSearchQuery","query","debounce","searchQuery","shouldRowBeRendered","accessRightItem","isShown","group","isGroupExpanded","getSelectedVariables","isAllSelected","selectedVariables","variableId","getMultipleSelectedVariablesTitle","lastVariable","pop","cutLongTitle","VARIABLE_TITLE_MAX_LENGTH","getMultipleSelectedVariablesHintHtml","hintTitle","allVariables","listItems","value","makeSortedVariablesArray","encode","toSort","example","orderMap","index","sort","a","b","indexA","indexB","DEFAULT_ALIAS_SEPARATOR","parseAliasKey","key","separator","parts","split","compileAliasKey","sortedParts","join","normalizeAliasKey","parsed","AccessRightsModel","BuilderModel","getName","setInitialAccessRights","rights","getState","getElementState","params","getGetters","shown","sectionCode","section","getters","isSet","isMinValueSet","rightId","isMaxValueSet","valueId","getNothingSelectedValue","nothingSelectedValue","getSelectedVariablesAlias","selectedVariablesAliasesSeparator","selectedVariablesAliases","getActions","toggleSection","store","commit","expandAllSections","collapseAllSections","toggleGroup","groupHead","search","payload","getMutations","isExpanded","expandSection","collapseSection","expandGroup","showItem","itemId","showGroup","showSection","showAll","hideAll","lowerQuery","toLowerCase","sectionTitle","includes","sectionSubTitle","MenuCell","inject","isMenuShown","menuPopupOptions","icon","Math","floor","shownUserGroupsWithoutCurrent","shownWithoutCurrent","delete","applyDialogItems","toggleMenu","showApplyDialog","applyDialog","srcUserGroupId","dstUserGroupId","setMaxValuesInSection","setMinValuesInSection","Icon","iconBgColor","sectionIcon","bgColor","startsWith","Locator","SectionIcon","Number","rightOrGroupTitle","MasterSwitcher","Switcher","isChecked","Boolean","switcherOptions","SingleRoleTitle","userGroupTitle","PopupHeader","isMinMaxValuesSet","isSelectedAnythingBesidesMin","setMin","setMax","PopupContent","initialValues","notSavedValues","getNotSavedValues","variablesShownInList","variablesWithoutMinAndSecondary","secondary","secondaryVariables","nothingSelectedValues","secondarySwitcherOptions","redefineApply","apply","addValue","add","requires","requiredId","conflictsWith","conflictId","otherVariable","removeValue","otherVariableId","setMaxValue","setMinValue","forEach","AllRolesTitle","ValuePopup","provide","onApply","popupOptions","closeEsc","minWidth","padding","applyButton","ApplyButton","onclick","renderTo","cancelButton","Footer","DefaultFooter","constructor","dialog","selectAllButton","Tag","render","Dom","deselectAllButton","getDialog","getContent","getItems","deselect","BaseHeader","app","BitrixVue","createApp","getWidth","getOption","mount","allSelectedCode","dialogItems","selectedDialogItems","filter","showSelector","height","hideByEsc","compactView","showAvatars","searchOptions","allowCreateItem","onItemSelect","onItemDeselect","onDestroy","header","headerOptions","addedItem","removedItem","newValues","setValues","allVariablesIds","map","allVariablesIdsWithoutRemoved","candidate","setNothingSelectedValueIfNeeded","nothingSelected","nothing","close","POPUP_ID","closeSelector","menuItems","innerEvent","getMenuWindow","setValue","MenuManager","onClose","getMenuById","SelectedHint","html","isRendered","currentAlias","hintHtml","emptyVariableId","currentVariableId","firstItem","currentVariableTitle","Cells","DependentVariablesCell","MultivariablesCell","TogglerCell","VariablesCell","Rows","DependentVariablesRow","MultivariablesRow","VariablesRow","getValueComponent","ValueCell","cellComponent","Column","renderedRights","ColumnList","throttledScrollHandler","throttledResizeHandler","ears","isEarsInited","isLeftShadowShown","isRightShadowShown","throttle","adjustShadowsVisibility","adjustEars","initEars","destroyEars","oldValue","calculateShadowsVisibility","offsetWidth","scrollWidth","round","toggleEars","Ears","immediateInit","smallSize","init","style","getWrapper","renderHint","clean","hintIconWrapper","setAttribute","append","getHintManager","initNode","RowValue","component","TitleCell","isRowValueShown","setMaxValuesForRight","setMinValuesForRight","openRowValue","TitleColumn","Section","code","subTitle","sectionHint","Grid","loader","searchContainerSelector","shownSections","shownUserGroups","initOwnerDocument","scrollToSection","sections","find","scrollTo","top","getPosition","AnalyticsManager","analyticsData","hasOwn","onSaveAttempt","createdRoles","editedRoles","deletedRoles","i","onSaveSuccess","onSaveError","response","status","onCancelChanges","sendData","onCloseWithoutSave","deleted","isModified","isArrayFilled","errors","error","toCamelCase","pName","ACTION_SAVE","MODE","BODY_TYPE","ApplicationModel","setOptions","setGuid","setSaving","NEW_USER_GROUP_ID_PREFIX","UserGroupsModel","setInitialUserGroups","groups","getEmptyAccessRightValue","rootState","rootGetters","defaultAccessRightValues","defaultValue","setAccessRightValues","setAccessRightValuesForShown","setMinAccessRightValues","setMaxAccessRightValues","setMinAccessRightValuesInSection","setMaxAccessRightValuesInSection","setMinAccessRightValuesForRight","setMaxAccessRightValuesForRight","setRoleTitle","addMember","removeMember","copyUserGroup","copySectionValues","addUserGroup","removeUserGroup","showUserGroup","hideUserGroup","accessRightValue","markUserGroupForDeletion","root","valueToSet","setEmpty","isBoolean","setEmptyOnSetMinMaxValueInColumn","src","sourceGroup","emptyGroup","copy","newGroup","initialGroup","isFunction","symmetricDifference","initialAccessCodes","currentAccessCodes","createStore","userGroupsModel","create","Builder","addModel","syncBuild","resetState","clearState","BaseUserGroupsExporter","transform","source","accessCodes","shouldBeIncludedInExport","singleValue","AllUserGroupsExporter","OnlyChangedUserGroupsExporter","AccessRightsInternalizer","externalSource","external","internalized","externalSection","internalizedSection","externalItem","internalizedItem","externalIcon","aliases","normalizedItem","isArray","normalizedVariable","externalAliases","isPlainObject","entries","boolOrNull","x","isUndefined","setEmptyOnGroupActions","externalVariable","avatarOptions","ApplicationInternalizer","actionSave","mode","bodyType","additionalSaveParams","isSaveOnlyChangedRights","isInteger","isObject","UserGroupsInternalizer","externalGroup","internalGroup","internalizedGroup","externalValue","internalizedValue","previousValue","externalMember","internalizedAccessCode","externalAccessRightsValue","stringAccessCode","replace","ShownUserGroupsCopier","srcUserGroups","srcUserGroup","shownCount","App","ButtonPanel","fireEventReset","box","MessageBox","message","modal","LINK","sendActionRequest","Promise","resolve","reject","then","catch","finally","waitContainer","getContainer","querySelector","removeClass","draw","applicationOptions","use","analytics","unmount","hasUnsavedChanges","sliderEvent","isSliderBelongsToThisApp","SidePanel","Instance","getSliderByWindow","getSlider","EventEmitter","sliderCode","loadExtension","FeaturePromotersRegistry","getPromoter","loadError","Notification","Center","notify","position","autoHideDelay","internalUserGroups","Ajax","runComponentAction","deletedUserGroups","parameters","newUserGroups","USER_GROUPS","denyAction","setTimeout"],"mappings":"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"}