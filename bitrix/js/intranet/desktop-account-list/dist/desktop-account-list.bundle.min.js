this.BX=this.BX||{},function(e,s,t,a,i,l,r,o){"use strict";let n,c,b,p,d,u=e=>e;var P=babelHelpers.classPrivateFieldLooseKey("cache"),v=babelHelpers.classPrivateFieldLooseKey("setOptions"),h=babelHelpers.classPrivateFieldLooseKey("getOptions"),L=babelHelpers.classPrivateFieldLooseKey("getMoreMenu"),H=babelHelpers.classPrivateFieldLooseKey("getAvatar"),F=babelHelpers.classPrivateFieldLooseKey("getHost"),B=babelHelpers.classPrivateFieldLooseKey("getDeleteConfirmPopup"),g=babelHelpers.classPrivateFieldLooseKey("getStatus"),m=babelHelpers.classPrivateFieldLooseKey("getEmail");class _{constructor(e){Object.defineProperty(this,m,{value:C}),Object.defineProperty(this,g,{value:A}),Object.defineProperty(this,B,{value:I}),Object.defineProperty(this,F,{value:y}),Object.defineProperty(this,H,{value:O}),Object.defineProperty(this,L,{value:T}),Object.defineProperty(this,h,{value:E}),Object.defineProperty(this,v,{value:f}),Object.defineProperty(this,P,{writable:!0,value:new o.Cache.MemoryCache}),babelHelpers.classPrivateFieldLooseBase(this,v)[v](e)}getContainer(){return babelHelpers.classPrivateFieldLooseBase(this,P)[P].remember("container",(()=>o.Tag.render(n||(n=u`
				<div class="intranet-desktop-account-list-item__wrapper">
					<div class="intranet-desktop-account-list-item__avatar">
						${0}
					</div>
					<div class="intranet-desktop-account-list-item__info-wrapper">
						${0}
						${0}
					</div>
					${0}
				</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,H)[H]().getContainer(),babelHelpers.classPrivateFieldLooseBase(this,F)[F](),babelHelpers.classPrivateFieldLooseBase(this,m)[m](),babelHelpers.classPrivateFieldLooseBase(this,L)[L]())))}}function f(e){return babelHelpers.classPrivateFieldLooseBase(this,P)[P].set("options",e),this}function E(){return babelHelpers.classPrivateFieldLooseBase(this,P)[P].get("options",{})}function T(){return babelHelpers.classPrivateFieldLooseBase(this,P)[P].remember("moreMenuElement",(()=>{const e=o.Tag.render(c||(c=u`
				<i class="ui-icon-set --more-l intranet-desktop-account-list-item__more"/>
			`)),s=new a.Menu({bindElement:e,items:[babelHelpers.classPrivateFieldLooseBase(this,h)[h]().account.connected?{text:o.Loc.getMessage("INTRANET_DESKTOP_PORTAL_LIST_MENU_ITEM_DISCONNECT"),onclick:()=>{l.DesktopApi.disconnectAccount(babelHelpers.classPrivateFieldLooseBase(this,h)[h]().account.host),s.close(),r.EventEmitter.emit("BX.Intranet.DesktopPortalList.Item:change")}}:{text:o.Loc.getMessage("INTRANET_DESKTOP_PORTAL_LIST_MENU_ITEM_CONNECT"),onclick:()=>{l.DesktopApi.connectAccount(babelHelpers.classPrivateFieldLooseBase(this,h)[h]().account.host,babelHelpers.classPrivateFieldLooseBase(this,h)[h]().account.login,babelHelpers.classPrivateFieldLooseBase(this,h)[h]().account.protocol,navigator.language),s.close(),r.EventEmitter.emit("BX.Intranet.DesktopPortalList.Item:change")}},{text:o.Loc.getMessage("INTRANET_DESKTOP_PORTAL_LIST_MENU_ITEM_DELETE"),onclick:()=>{s.close(),babelHelpers.classPrivateFieldLooseBase(this,B)[B](s).show()}}]});return o.Event.bind(e,"click",(e=>{e.preventDefault(),e.stopPropagation(),s.toggle()})),e}))}function O(){const e="/bitrix/js/im/images/blank.gif"===babelHelpers.classPrivateFieldLooseBase(this,h)[h]().account.avatar?"/bitrix/js/ui/icons/b24/images/ui-user.svg?v2":babelHelpers.classPrivateFieldLooseBase(this,h)[h]().account.avatar,s={size:36,userpicPath:encodeURI(e)};return new t.AvatarRound(s)}function y(){return o.Tag.render(b||(b=u`
			<div class="intranet-desktop-account-list-item__title-wrapper">
				<span class="intranet-desktop-account-list-item__title${0}">${0}</span>
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,h)[h]().isCurrent?" --current":"",babelHelpers.classPrivateFieldLooseBase(this,h)[h]().account.host,babelHelpers.classPrivateFieldLooseBase(this,g)[g]())}function I(){return babelHelpers.classPrivateFieldLooseBase(this,P)[P].remember("deleteConfirmPopup",(()=>new i.MessageBox({minWidth:500,title:o.Loc.getMessage("INTRANET_DESKTOP_PORTAL_LIST_CONFIRM_POPUP_TITLE"),message:o.Loc.getMessage("INTRANET_DESKTOP_PORTAL_LIST_CONFIRM_POPUP_MESSAGE"),buttons:i.MessageBoxButtons.OK_CANCEL,okCaption:o.Loc.getMessage("INTRANET_DESKTOP_PORTAL_LIST_CONFIRM_POPUP_CONFIRM_BUTTON"),onOk:()=>{const{host:e,login:s}=babelHelpers.classPrivateFieldLooseBase(this,h)[h]().account;l.DesktopApi.deleteAccount(e,s),r.EventEmitter.emit("BX.Intranet.DesktopPortalList.Item:change"),babelHelpers.classPrivateFieldLooseBase(this,B)[B]().close()},useAirDesign:!0})))}function A(){return babelHelpers.classPrivateFieldLooseBase(this,h)[h]().isCurrent?babelHelpers.classPrivateFieldLooseBase(this,P)[P].remember("statusElement",(()=>o.Tag.render(p||(p=u`
				<span class="intranet-desktop-account-list-item__status">${0}</span>
			`),o.Loc.getMessage("INTRANET_DESKTOP_PORTAL_LIST_CURRENT_STATUS")))):null}function C(){return o.Tag.render(d||(d=u`
			<span class="intranet-desktop-account-list-item__description">${0}</span>
		`),babelHelpers.classPrivateFieldLooseBase(this,h)[h]().account.email)}let k,K,D=e=>e;var M=babelHelpers.classPrivateFieldLooseKey("cache"),N=babelHelpers.classPrivateFieldLooseKey("getCurrentPortal"),w=babelHelpers.classPrivateFieldLooseKey("getPanel"),S=babelHelpers.classPrivateFieldLooseKey("getPortalList");class R{constructor(){Object.defineProperty(this,S,{value:U}),Object.defineProperty(this,w,{value:X}),Object.defineProperty(this,N,{value:j}),Object.defineProperty(this,M,{writable:!0,value:new o.Cache.MemoryCache})}getAccounts(){return babelHelpers.classPrivateFieldLooseBase(this,M)[M].remember("accounts",(()=>"undefined"==typeof BXDesktopSystem?[]:l.DesktopApi.getAccountList()))}getCurrentAccount(){return babelHelpers.classPrivateFieldLooseBase(this,M)[M].remember("currentAccount",(()=>{const e=o.Loc.getMessage("USER_ID"),s=this.getAccounts(),t=location.host;return s.find((s=>s.id===e&&t===s.host))}))}getContent(){return[babelHelpers.classPrivateFieldLooseBase(this,N)[N](),babelHelpers.classPrivateFieldLooseBase(this,w)[w](),babelHelpers.classPrivateFieldLooseBase(this,S)[S]()]}}function j(){return babelHelpers.classPrivateFieldLooseBase(this,M)[M].remember("currentPortal",(()=>{if(!this.getCurrentAccount())return null;return{html:new _({account:this.getCurrentAccount(),isCurrent:!0}).getContainer()}}))}function X(){return babelHelpers.classPrivateFieldLooseBase(this,M)[M].remember("panel",(()=>({html:o.Tag.render(k||(k=D`
					<div class="intranet-desktop-account-list-item-list-header__wrapper">
						<span class="intranet-desktop-account-list-item-list-header__title">
							${0}
						</span>
						<div onclick="${0}" class="intranet-desktop-account-list-item-list-header__connect-wrapper">
							<i class="ui-icon-set --plus-s intranet-desktop-account-list-item-list-header__connect-icon"></i>
							<span class="intranet-desktop-account-list-item-list-header__connect-title">
								${0}
							</span>
						</div>
					</div>
				`),o.Loc.getMessage("INTRANET_DESKTOP_PORTAL_LIST_HEADER_TITLE"),(()=>{l.DesktopApi.openAddAccountTab(),r.EventEmitter.emit("BX.Intranet.DesktopPortalList:openConnector")}),o.Loc.getMessage("INTRANET_DESKTOP_PORTAL_LIST_HEADER_BUTTON")),withoutBackground:!0})))}function U(){return babelHelpers.classPrivateFieldLooseBase(this,M)[M].remember("portalList",(()=>{const e=o.Tag.render(K||(K=D`
				<div class="intranet-desktop-account-list-item-list__wrapper"></div>
			`));return this.getAccounts().forEach((s=>{if(s!==this.getCurrentAccount()){const t=new _({account:s,isCurrent:!1});o.Dom.append(t.getContainer(),e)}})),{html:e}}))}var $=babelHelpers.classPrivateFieldLooseKey("cache"),x=babelHelpers.classPrivateFieldLooseKey("popupsShowAfterBasePopup"),z=babelHelpers.classPrivateFieldLooseKey("setOptions"),G=babelHelpers.classPrivateFieldLooseKey("getOptions"),W=babelHelpers.classPrivateFieldLooseKey("getBasePopup"),q=babelHelpers.classPrivateFieldLooseKey("getContent"),J=babelHelpers.classPrivateFieldLooseKey("cleanCache"),Q=babelHelpers.classPrivateFieldLooseKey("setEventHandlers"),V=babelHelpers.classPrivateFieldLooseKey("setAutoHideEventHandlers");class Y extends r.EventEmitter{constructor(e){super(),Object.defineProperty(this,V,{value:le}),Object.defineProperty(this,Q,{value:ie}),Object.defineProperty(this,J,{value:ae}),Object.defineProperty(this,q,{value:te}),Object.defineProperty(this,W,{value:se}),Object.defineProperty(this,G,{value:ee}),Object.defineProperty(this,z,{value:Z}),Object.defineProperty(this,$,{writable:!0,value:new o.Cache.MemoryCache}),Object.defineProperty(this,x,{writable:!0,value:[]}),babelHelpers.classPrivateFieldLooseBase(this,z)[z](e),this.setEventNamespace("BX.Intranet.DesktopPortalList.Popup"),babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]()}show(){babelHelpers.classPrivateFieldLooseBase(this,W)[W]().isShown()||babelHelpers.classPrivateFieldLooseBase(this,W)[W]().show()}}function Z(e){return babelHelpers.classPrivateFieldLooseBase(this,$)[$].set("options",e),this}function ee(){return babelHelpers.classPrivateFieldLooseBase(this,$)[$].get("options",{})}function se(){return babelHelpers.classPrivateFieldLooseBase(this,$)[$].remember("popup",(()=>{this.emit("beforeInit");const e=new s.PopupComponentsMaker({target:babelHelpers.classPrivateFieldLooseBase(this,G)[G]().bindElement,width:450,content:babelHelpers.classPrivateFieldLooseBase(this,q)[q](),offsetTop:-50,offsetLeft:50,useAngle:!1});return babelHelpers.classPrivateFieldLooseBase(this,$)[$].set("popup",e),this.emit("afterInit"),e}))}function te(){return babelHelpers.classPrivateFieldLooseBase(this,$)[$].remember("content",(()=>(new R).getContent()))}function ae(){babelHelpers.classPrivateFieldLooseBase(this,$)[$].delete("popup"),babelHelpers.classPrivateFieldLooseBase(this,$)[$].delete("content")}function ie(){this.subscribe("beforeInit",(()=>{r.EventEmitter.subscribe("BX.Intranet.DesktopPortalList.Item:change",(()=>{babelHelpers.classPrivateFieldLooseBase(this,W)[W]().close(),babelHelpers.classPrivateFieldLooseBase(this,J)[J]()})),r.EventEmitter.subscribe("BX.Intranet.DesktopPortalList:openConnector",(()=>{babelHelpers.classPrivateFieldLooseBase(this,W)[W]().close(),babelHelpers.classPrivateFieldLooseBase(this,J)[J]()})),this.subscribe("afterInit",(()=>{babelHelpers.classPrivateFieldLooseBase(this,V)[V]()}))}))}function le(){r.EventEmitter.subscribe("BX.Main.Popup:onShow",(e=>{if(!babelHelpers.classPrivateFieldLooseBase(this,W)[W]().getPopup().isShown())return;const s=e.getTarget();if(s&&s.getId()!==babelHelpers.classPrivateFieldLooseBase(this,W)[W]().getPopup().getId()){babelHelpers.classPrivateFieldLooseBase(this,W)[W]().getPopup().setAutoHide(!1),babelHelpers.classPrivateFieldLooseBase(this,x)[x].includes(s)||babelHelpers.classPrivateFieldLooseBase(this,x)[x].push(s);const e=()=>{babelHelpers.classPrivateFieldLooseBase(this,x)[x]=babelHelpers.classPrivateFieldLooseBase(this,x)[x].filter((e=>e!==s)),0===babelHelpers.classPrivateFieldLooseBase(this,x)[x].length&&babelHelpers.classPrivateFieldLooseBase(this,W)[W]().getPopup().setAutoHide(!0)};s.subscribeOnce("onClose",e),s.subscribeOnce("onDestroy",e)}}))}var re=babelHelpers.classPrivateFieldLooseKey("cache"),oe=babelHelpers.classPrivateFieldLooseKey("setOptions"),ne=babelHelpers.classPrivateFieldLooseKey("getOptions"),ce=babelHelpers.classPrivateFieldLooseKey("getPopup");class be extends r.EventEmitter{constructor(e){super(),Object.defineProperty(this,ce,{value:ue}),Object.defineProperty(this,ne,{value:de}),Object.defineProperty(this,oe,{value:pe}),Object.defineProperty(this,re,{writable:!0,value:new o.Cache.MemoryCache}),babelHelpers.classPrivateFieldLooseBase(this,oe)[oe](e),this.setEventNamespace("BX.Intranet.DesktopPortalList")}show(){babelHelpers.classPrivateFieldLooseBase(this,ce)[ce]().show()}}function pe(e){return babelHelpers.classPrivateFieldLooseBase(this,re)[re].set("options",e),this}function de(){return babelHelpers.classPrivateFieldLooseBase(this,re)[re].get("options",{})}function ue(){return babelHelpers.classPrivateFieldLooseBase(this,re)[re].remember("popup",(()=>new Y({bindElement:babelHelpers.classPrivateFieldLooseBase(this,ne)[ne]().bindElement})))}e.DesktopAccountList=be}(this.BX.Intranet=this.BX.Intranet||{},BX.UI,BX.UI,BX.Main,BX.UI.Dialogs,BX.Messenger.v2.Lib,BX.Event,BX);
//# sourceMappingURL=desktop-account-list.bundle.map.js