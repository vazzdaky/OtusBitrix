{"version":3,"file":"invitation-input.bundle.js","sources":["../src/provider/invitation-provider.js","../src/provider/invitation-to-group.js","../src/provider/invitation-to-portal.js","../src/invitation-input.js"],"sourcesContent":["export class InvitationProvider\n{\n\tinvite(): Promise\n\t{\n\t\tthrow new Error('Implement the method \"invite\" in the child class');\n\t}\n}\n","import { ajax } from 'main.core';\nimport { InvitationProvider } from './invitation-provider';\n\nexport class InvitationToGroup extends InvitationProvider\n{\n\t#groupId: number;\n\t#users: Object;\n\n\tconstructor(groupId: number, users: Object)\n\t{\n\t\tsuper();\n\t\tthis.#groupId = groupId;\n\t\tthis.#users = users;\n\t}\n\n\tinvite(): Promise\n\t{\n\t\treturn ajax.runAction('intranet.invite.inviteUsersToCollab', {\n\t\t\tdata: {\n\t\t\t\tcollabId: this.#groupId,\n\t\t\t\tusers: this.#users,\n\t\t\t},\n\t\t});\n\t}\n}\n","import { ajax } from 'main.core';\nimport { InvitationProvider } from './invitation-provider';\n\nexport class InvitationToPortal extends InvitationProvider\n{\n\t#users: Object;\n\n\tconstructor(users: Object)\n\t{\n\t\tsuper();\n\t\tthis.#users = users;\n\t}\n\n\tinvite(): Promise\n\t{\n\t\treturn ajax.runAction('intranet.v2.Invitation.inviteUsers', {\n\t\t\tdata: {\n\t\t\t\tinvitations: this.#users,\n\t\t\t},\n\t\t});\n\t}\n}\n","import { Cache, Dom, Tag, Validation, Loc, Extension, Type } from 'main.core';\nimport { MemoryCache } from 'main.core.cache';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { TagSelector } from 'ui.entity-selector';\nimport './style.css';\nimport type { InvitationProvider } from './provider/invitation-provider';\nimport { InvitationToGroup } from './provider/invitation-to-group';\nimport { InvitationToPortal } from './provider/invitation-to-portal';\n\nexport type InvitationInputOptionType = {\n\tplaceholder: ?string,\n\tminHeight: ?number,\n\tshowErrorBeforeSubmit: ?boolean,\n\tshowErrorAfterSubmit: ?boolean,\n};\n\nexport const InvitationInputType = Object.freeze({\n\tPHONE: 'phone',\n\tEMAIL: 'email',\n\tALL: 'all',\n});\n\nexport class InvitationInput extends EventEmitter\n{\n\t#cache: MemoryCache = new Cache.MemoryCache();\n\t#invalidPhoneNumbersTagIds: Array<string> = [];\n\t#isReadySendInvitation: boolean = false;\n\t#placeholder: string;\n\t#inputType: InvitationInputType;\n\t#isPhoneEnabled: boolean;\n\t#isEmailEnabled: boolean;\n\t#userLang: string = null;\n\t#minHeight: ?number = null;\n\t#showErrorBeforeSubmit: boolean;\n\t#showErrorAfterSubmit: boolean;\n\n\tconstructor(options: InvitationInputOptionType)\n\t{\n\t\tsuper();\n\t\tthis.#inputType = options?.inputType ?? InvitationInputType.ALL;\n\t\tthis.setEventNamespace('BX.Intranet.InvitationInput');\n\n\t\tthis.#placeholder = Type.isStringFilled(options?.placeholder) ? options.placeholder : this.#getDefaultPlaceholder();\n\t\tthis.#minHeight = options?.minHeight;\n\t\tthis.#showErrorBeforeSubmit = Type.isBoolean(options?.showErrorBeforeSubmit)\n\t\t\t? options.showErrorBeforeSubmit\n\t\t\t: false;\n\t\tthis.#showErrorAfterSubmit = Type.isBoolean(options?.showErrorAfterSubmit)\n\t\t\t? options.showErrorAfterSubmit\n\t\t\t: true;\n\n\t\tconst settings = Extension.getSettings('intranet.invitation-input');\n\t\tif (this.#inputType === InvitationInputType.PHONE && !settings?.isInvitationByPhoneAvailable)\n\t\t{\n\t\t\tthrow new Error('Incorrect component operation parameters.');\n\t\t}\n\n\t\tthis.#isPhoneEnabled = [InvitationInputType.ALL, InvitationInputType.PHONE].includes(this.#inputType)\n\t\t\t&& Boolean(settings?.isInvitationByPhoneAvailable);\n\t\tthis.#isEmailEnabled = [InvitationInputType.ALL, InvitationInputType.EMAIL].includes(this.#inputType);\n\t}\n\n\tchangeLanguage(lang: string): void\n\t{\n\t\tif (Type.isString(lang))\n\t\t{\n\t\t\tthis.#userLang = lang;\n\t\t}\n\t}\n\n\tgetTagSelector(): TagSelector\n\t{\n\t\treturn this.#cache.remember('tagSelector', () => {\n\t\t\treturn new TagSelector({\n\t\t\t\tid: `intranet-invitation-input-${Math.random(4)}`,\n\t\t\t\tshowTextBox: true,\n\t\t\t\tshowAddButton: false,\n\t\t\t\tplaceholder: this.#placeholder,\n\t\t\t\ttagTextColor: '#1E8D36',\n\t\t\t\ttagBgColor: '#D4FDB0',\n\t\t\t\ttagMaxWidth: 200,\n\t\t\t\tevents: {\n\t\t\t\t\tonAfterTagRemove: this.#onAfterTagRemove.bind(this),\n\t\t\t\t\tonBeforeTagAdd: this.#onBeforeTagAdd.bind(this),\n\t\t\t\t\tonEnter: this.#onEnter.bind(this),\n\t\t\t\t\tonBlur: this.#onBlur.bind(this),\n\t\t\t\t\tonInput: this.#onInput.bind(this),\n\t\t\t\t\tonContainerClick: this.#onContainerClick.bind(this),\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\tisReadySendInvitation(): boolean\n\t{\n\t\treturn this.#isReadySendInvitation;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn this.#cache.remember('node', () => {\n\t\t\tthis.getTagSelector().renderTo(this.getWrapper());\n\t\t\tthis.getTagSelector().focusTextBox();\n\n\t\t\tif (Type.isNumber(this.#minHeight))\n\t\t\t{\n\t\t\t\tconst itemsContainer = (this.getTagSelector().getItemsContainer());\n\t\t\t\tDom.style(itemsContainer, 'min-height', `${this.#minHeight}px`);\n\t\t\t}\n\n\t\t\treturn this.getWrapper();\n\t\t});\n\t}\n\n\trenderTo(node: HTMLElement): void\n\t{\n\t\tDom.append(this.render(), node);\n\t}\n\n\tgetWrapper(): HTMLDivElement\n\t{\n\t\treturn this.#cache.remember('wrapper', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"intranet-invitation-wrapper\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tinviteToGroup(groupId: number): Promise\n\t{\n\t\tconst invitationProvider = new InvitationToGroup(\n\t\t\tgroupId,\n\t\t\tthis.#getPreparedUserList(),\n\t\t);\n\n\t\treturn this.#invite(invitationProvider);\n\t}\n\n\tinviteToPortal(): Promise\n\t{\n\t\tconst invitationProvider = new InvitationToPortal(this.#getPreparedUserList());\n\n\t\treturn this.#invite(invitationProvider);\n\t}\n\n\thasErrorTags(): boolean\n\t{\n\t\treturn this.#getErrorTags().length > 0;\n\t}\n\n\tisEmptyTags(): boolean\n\t{\n\t\treturn this.getTagSelector().getTags().length === 0;\n\t}\n\n\t#invite(invitationProvider: InvitationProvider): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.#removeErrorBlock();\n\n\t\t\tif (this.#getErrorTags().length > 0)\n\t\t\t{\n\t\t\t\tthis.#addErrorBlockByMessage(this.#getDefaultValidationMessage());\n\t\t\t\treject(this.#getDefaultValidationMessage());\n\t\t\t}\n\t\t\telse if (this.getTagSelector().getTags().length === 0)\n\t\t\t{\n\t\t\t\tthis.#addErrorBlockByMessage(this.#getEmptyValidationMessage());\n\t\t\t\treject(this.#getEmptyValidationMessage());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tinvitationProvider.invite().then(() => {\n\t\t\t\t\tthis.getTagSelector().removeTags();\n\t\t\t\t\tthis.#setUnreadySaveState();\n\t\t\t\t\tresolve();\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tif (this.#showErrorAfterSubmit)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#addErrorBlockByMessage(response.errors[0].message);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.getTagSelector().removeTags();\n\t\t\t\t\t}\n\n\t\t\t\t\treject(response.errors[0].message);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\t#getPreparedUserList(): Array\n\t{\n\t\tthis.#removeErrorBlock();\n\t\tconst selector = this.getTagSelector();\n\t\tconst tags = selector.getTags();\n\t\tconst users = [];\n\n\t\ttags.forEach((tag) => {\n\t\t\tif (this.#isEmailEnabled && tag.getEntityType() === 'email')\n\t\t\t{\n\t\t\t\tusers.push({\n\t\t\t\t\temail: tag.getTitle(),\n\t\t\t\t\tlanguageId: this.#userLang,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\ttag.getEntityType() === 'phone'\n\t\t\t\t&& this.#isPhoneEnabled\n\t\t\t\t&& !this.#invalidPhoneNumbersTagIds.includes(tag.getId())\n\t\t\t)\n\t\t\t{\n\t\t\t\tusers.push({\n\t\t\t\t\tphone: tag.getTitle(),\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\treturn users;\n\t}\n\n\t#getErrorTags(): Array\n\t{\n\t\tconst selector = this.getTagSelector();\n\t\tconst tags = selector.getTags();\n\t\tconst errorTags = [];\n\n\t\ttags.forEach((tag) => {\n\t\t\tif (tag.getEntityType() === 'error')\n\t\t\t{\n\t\t\t\terrorTags.push(tag);\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\ttag.getEntityType() === 'phone'\n\t\t\t\t&& this.#isPhoneEnabled\n\t\t\t\t&& this.#invalidPhoneNumbersTagIds.includes(tag.getId())\n\t\t\t)\n\t\t\t{\n\t\t\t\terrorTags.push(tag);\n\t\t\t}\n\t\t});\n\n\t\treturn errorTags;\n\t}\n\n\t#setReadySaveState(): void\n\t{\n\t\tthis.emit('onReadySave');\n\t\tthis.#isReadySendInvitation = true;\n\t}\n\n\t#setUnreadySaveState(): void\n\t{\n\t\tthis.emit('onUnreadySave');\n\t\tthis.#isReadySendInvitation = false;\n\t}\n\n\t#getPhoneParser(): BX.PhoneNumberParser\n\t{\n\t\treturn BX.PhoneNumberParser.getInstance();\n\t}\n\n\t#getDefaultPlaceholder(): string\n\t{\n\t\tif (this.#inputType === InvitationInputType.PHONE)\n\t\t{\n\t\t\treturn Loc.getMessage('INTRANET_INVITATION_INPUT_PLACEHOLDER_PHONE');\n\t\t}\n\t\telse if (this.#inputType === InvitationInputType.EMAIL)\n\t\t{\n\t\t\treturn Loc.getMessage('INTRANET_INVITATION_INPUT_PLACEHOLDER');\n\t\t}\n\n\t\treturn Loc.getMessage('INTRANET_INVITATION_INPUT_PLACEHOLDER_WITH_PHONE');\n\t}\n\n\t#getDefaultValidationMessage(): string\n\t{\n\t\tif (this.#inputType === InvitationInputType.PHONE)\n\t\t{\n\t\t\treturn Loc.getMessage('INTRANET_INVITATION_INPUT_VALIDATION_MESSAGE_PHONE');\n\t\t}\n\t\telse if (this.#inputType === InvitationInputType.EMAIL)\n\t\t{\n\t\t\treturn Loc.getMessage('INTRANET_INVITATION_INPUT_VALIDATION_MESSAGE');\n\t\t}\n\n\t\treturn Loc.getMessage('INTRANET_INVITATION_INPUT_VALIDATION_MESSAGE_WITH_PHONE');\n\t}\n\n\t#getEmptyValidationMessage(): string\n\t{\n\t\tif (this.#inputType === InvitationInputType.PHONE)\n\t\t{\n\t\t\treturn Loc.getMessage('INTRANET_INVITATION_INPUT_VALIDATION_MESSAGE_PHONE');\n\t\t}\n\t\telse if (this.#inputType === InvitationInputType.EMAIL)\n\t\t{\n\t\t\treturn Loc.getMessage('INTRANET_INVITATION_INPUT_EMPTY_MESSAGE');\n\t\t}\n\n\t\treturn Loc.getMessage('INTRANET_INVITATION_INPUT_EMPTY_MESSAGE_WITH_PHONE');\n\t}\n\n\t#onAfterTagRemove(event: BaseEvent): void\n\t{\n\t\tconst selector = event.getTarget();\n\n\t\tconst tags = selector.getTags();\n\t\tconst errorTags = tags.filter((item) => item.getEntityType() === 'error');\n\n\t\tif (errorTags.length === 0)\n\t\t{\n\t\t\tthis.#removeErrorBlock();\n\t\t}\n\n\t\tif (tags.length === 0)\n\t\t{\n\t\t\tthis.#setUnreadySaveState();\n\t\t}\n\t\telse if (errorTags.length === 0)\n\t\t{\n\t\t\tthis.#setReadySaveState();\n\n\t\t\tif (this.#showErrorBeforeSubmit)\n\t\t\t{\n\t\t\t\tthis.#removeErrorBlock();\n\t\t\t}\n\t\t}\n\t}\n\n\t#onBeforeTagAdd(event: BaseEvent): void\n\t{\n\t\tconst { tag } = event.getData();\n\t\tconst textBox = event.target.getTextBox();\n\t\ttextBox.placeholder = '';\n\t\tthis.#setReadySaveState();\n\n\t\tif (tag.getEntityType() === 'error')\n\t\t{\n\t\t\tthis.#setErrorStateForTag(tag);\n\n\t\t\tif (this.#showErrorBeforeSubmit)\n\t\t\t{\n\t\t\t\tthis.#addErrorBlockByMessage(this.#getDefaultValidationMessage());\n\t\t\t}\n\t\t}\n\n\t\tif (tag.getEntityType() === 'phone')\n\t\t{\n\t\t\tthis.#getPhoneParser().parse(tag.getTitle()).then((result) => {\n\t\t\t\tif (result.valid)\n\t\t\t\t{\n\t\t\t\t\ttag.setTitle(result.rawNumber);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.#setErrorStateForTag(tag);\n\t\t\t\t\tthis.#invalidPhoneNumbersTagIds.push(tag.getId());\n\t\t\t\t}\n\t\t\t\ttag.render();\n\t\t\t}).catch(() => {});\n\t\t}\n\t}\n\n\t#setErrorStateForTag(tag): void\n\t{\n\t\ttag.setTextColor('#E92F2A');\n\t\ttag.setBgColor('#FFDCDB');\n\t}\n\n\t#onEnter(event: BaseEvent): void\n\t{\n\t\tconst selector = event.getTarget();\n\t\tconst value = selector.getTextBoxValue();\n\n\t\tif (value && !/^\\s*$/.test(value))\n\t\t{\n\t\t\tthis.#addTagByValue(value);\n\t\t}\n\t}\n\n\t#onBlur(event: BaseEvent): void\n\t{\n\t\tthis.#onEnter(event);\n\t}\n\n\t#onInput(event: BaseEvent): void\n\t{\n\t\tthis.#setReadySaveState();\n\t\tconst selector = event.target;\n\t\tconst inputEvent = event.getData().event;\n\t\tconst specialSymbols = [' ', ','];\n\t\tlet value = selector.getTextBoxValue();\n\n\t\tconst index = specialSymbols.indexOf(inputEvent.data);\n\n\t\tif (index === -1)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst symbol = specialSymbols[index];\n\n\t\tif (value.endsWith(symbol))\n\t\t{\n\t\t\tvalue = value.slice(0, -1);\n\t\t}\n\n\t\tif (value)\n\t\t{\n\t\t\tthis.#addTagByValue(value);\n\t\t}\n\t}\n\n\t#onContainerClick(): void\n\t{\n\t\tthis.getTagSelector().getTextBox().focus();\n\t}\n\n\t#getEntityTypeByValue(value: string): string\n\t{\n\t\tconst isPhone = this.#isPhoneEnabled ? this.#isPhone(value) : false;\n\t\tconst isEmail = this.#isEmailEnabled ? (Validation.isEmail(value) && /^[^@]+@[^@]+\\.[^@]+$/.test(value)) : false;\n\n\t\tif (isEmail)\n\t\t{\n\t\t\treturn 'email';\n\t\t}\n\n\t\tif (isPhone)\n\t\t{\n\t\t\treturn 'phone';\n\t\t}\n\n\t\treturn 'error';\n\t}\n\n\t#addTagByValue(value: string): void\n\t{\n\t\tconst selector = this.getTagSelector();\n\t\tconst parsedValues = this.#parseValue(value);\n\n\t\tparsedValues.forEach((part) => {\n\t\t\tselector.addTag({\n\t\t\t\tid: part,\n\t\t\t\ttitle: part,\n\t\t\t\tentityId: 'invitation-tag',\n\t\t\t\tentityType: this.#getEntityTypeByValue(part),\n\t\t\t});\n\t\t});\n\t\tselector.clearTextBox();\n\t}\n\n\t#parseValue(value: string): Array<string>\n\t{\n\t\tconst parts = value.split(/[\\s,]+/);\n\n\t\treturn parts.filter((part) => part.length > 0);\n\t}\n\n\t#isPhone(value: string): boolean\n\t{\n\t\treturn BX.PhoneNumber.getValidNumberRegex().test(value);\n\t}\n\n\t#addErrorBlockByMessage(message: string): void\n\t{\n\t\tif (this.getWrapper().querySelector('.intranet-invitation-input-error__wrapper'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst errorBlock = this.#createErrorBlockByMessage(message);\n\t\tthis.getWrapper().append(errorBlock);\n\t\tthis.#setUnreadySaveState();\n\n\t\tif (!Dom.hasClass(this.getTagSelector().getOuterContainer(), '--error'))\n\t\t{\n\t\t\tDom.addClass(this.getTagSelector().getOuterContainer(), '--error');\n\t\t}\n\t}\n\n\t#removeErrorBlock(): void\n\t{\n\t\tconst errorBlock = this.getWrapper()\n\t\t\t.querySelector('.intranet-invitation-input-error__wrapper');\n\n\t\tif (errorBlock)\n\t\t{\n\t\t\terrorBlock.remove();\n\t\t}\n\n\t\tif (Dom.hasClass(this.getTagSelector().getOuterContainer(), '--error'))\n\t\t{\n\t\t\tDom.removeClass(this.getTagSelector().getOuterContainer(), '--error');\n\t\t}\n\t}\n\n\t#createErrorBlockByMessage(message: string): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"intranet-invitation-input-error__wrapper\">\n\t\t\t\t<span class=\"ui-icon-set --warning\"></span>\n\t\t\t\t<span class=\"intranet-invitation-input-error__text\">${message}</span>\n\t\t\t</div>\n\t\t`;\n\t}\n}\n"],"names":["InvitationProvider","invite","Error","InvitationToGroup","constructor","groupId","users","super","Object","writable","value","babelHelpers","ajax","runAction","data","collabId","this","InvitationToPortal","invitations","InvitationInputType","freeze","PHONE","EMAIL","ALL","InvitationInput","EventEmitter","options","Cache","MemoryCache","inputType","setEventNamespace","Type","isStringFilled","placeholder","minHeight","isBoolean","showErrorBeforeSubmit","showErrorAfterSubmit","settings","Extension","getSettings","isInvitationByPhoneAvailable","includes","Boolean","changeLanguage","lang","isString","getTagSelector","remember","TagSelector","id","Math","random","showTextBox","showAddButton","tagTextColor","tagBgColor","tagMaxWidth","events","onAfterTagRemove","bind","onBeforeTagAdd","onEnter","onBlur","onInput","onContainerClick","isReadySendInvitation","render","renderTo","getWrapper","focusTextBox","isNumber","itemsContainer","getItemsContainer","Dom","style","node","append","Tag","inviteToGroup","invitationProvider","inviteToPortal","hasErrorTags","length","isEmptyTags","getTags","Promise","resolve","reject","then","removeTags","catch","response","errors","message","tags","forEach","tag","getEntityType","push","email","getTitle","languageId","getId","phone","errorTags","emit","BX","PhoneNumberParser","getInstance","Loc","getMessage","event","getTarget","filter","item","getData","target","getTextBox","parse","result","valid","setTitle","rawNumber","setTextColor","setBgColor","getTextBoxValue","test","selector","inputEvent","specialSymbols","index","indexOf","symbol","endsWith","slice","focus","isPhone","Validation","isEmail","part","addTag","title","entityId","entityType","clearTextBox","split","PhoneNumber","getValidNumberRegex","querySelector","errorBlock","hasClass","getOuterContainer","addClass","remove","removeClass"],"mappings":"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"}