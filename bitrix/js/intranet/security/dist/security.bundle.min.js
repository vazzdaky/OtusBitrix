this.BX=this.BX||{};this.BX.Intranet=this.BX.Intranet||{};(function(e,t){"use strict";class n{constructor(e={}){this.signedParameters=e.signedParameters;this.componentName=e.componentName;this.loader=null;this.container=e.contentContainer;this.userId=e.userId;this.currentPage=e.currentPage;this.menuContainer=e.menuContainer;this.changeContent(this.currentPage);if(t.Type.isDomNode(this.menuContainer)){this.menuItems=this.menuContainer.querySelectorAll("a");(this.menuItems||[]).forEach((e=>{t.Event.bind(e,"click",(()=>{this.changeContent(e.getAttribute("data-action"))}))}))}BX.addCustomEvent("BX.Security.UserOtpInit:afterOtpSetup",function(e){this.showOtpConnectedComponent()}.bind(this))}changeContent(e){if(!e){return}switch(e){case"auth":case"otpConnected":case"socnetEmail":const t={userId:this.userId};this.sendAction(e,t);break;case"otp":case"appPasswords":case"synchronize":case"mailingAgreement":case"sso":this.sendAction(e,{});break;case"recoveryCodes":this.showRecoveryCodesComponent();break;case"socserv":this.showSocservComponent();break}}clearHtml(){BX.html(this.container,"");const e=document.getElementsByClassName("ui-entity-wrap");if(e&&e[0]){t.Dom.remove(e[0])}}sendAction(e,t){this.clearHtml();this.loader=this.showLoader({node:this.container,loader:null,size:100});BX.ajax.runComponentAction(this.componentName,e,{signedParameters:this.signedParameters,mode:"ajax",data:t}).then(function(t){this.showComponentData(t,e)}.bind(this),function(e){this.showErrorPopup(e["errors"][0].message);this.hideLoader({loader:this.loader})}.bind(this))}showOtpComponent(){this.changeContent("otp")}showOtpConnectedComponent(){this.changeContent("otpConnected")}showRecoveryCodesComponent(e){if(!e){e=""}this.sendAction("recoveryCodes",{componentMode:e})}showSocservComponent(){this.clearHtml();const e=document.querySelector("[data-action='socserv']");if(BX.type.isDomNode(e)){const t=BX.data(e,"url");if(top.BX.SidePanel.Instance.open(t,{cacheable:false,width:840})){top.BX.addCustomEvent(top.BX.SidePanel.Instance.getSlider(t),"SidePanel.Slider:onClose",BX.proxy((function(){const e=document.querySelector("[data-action='auth']");if(BX.type.isDomNode(e)){e.click()}}),this))}}}showComponentData(e,t){const n=BX.prop.getArray(e,"errors",[]);if(n.length>0){this.showErrorPopup(e["errors"][0].message);return}if(!e.data){this.showErrorPopup("Unknown error");this.hideLoader({loader:this.loader});return}const o=new Promise(BX.delegate((function(t,n){if(e.data.hasOwnProperty("assets")&&e.data.assets["css"].length){BX.load(e.data.assets["css"],(function(){if(e.data.assets["js"].length){BX.load(e.data.assets["js"],(function(){if(e.data.assets["string"].length){for(var n=0;n<e.data.assets["string"].length;n++){BX.html(null,e.data.assets["string"][n])}}t()}))}}))}}),this));o.then(BX.delegate((function(){const n=BX.prop.getString(e.data,"html","");BX.html(this.container,n);const o=BX.prop.getString(BX.prop.getObject(e.data,"additionalParams",""),"pageTitle","");BX.html(BX("pagetitle"),o);top.history.pushState(null,"","?page="+t)}),this))}showLoader(e){let t=null;if(e.node){if(e.loader===null){t=new BX.Loader({target:e.node,size:e.hasOwnProperty("size")?e.size:40})}else{t=e.loader}t.show()}return t}hideLoader(e){if(e.loader!==null){e.loader.hide()}if(e.node){t.Dom.clean(e.node)}if(e.loader!==null){e.loader=null}}showErrorPopup(e){if(!e){return}BX.PopupWindowManager.create({id:"intranet-user-profile-error-popup",content:BX.create("div",{props:{style:"max-width: 450px"},html:BX.util.htmlspecialchars(e)}),closeIcon:true,lightShadow:true,offsetLeft:100,overlay:false,contentPadding:10}).show()}}e.Security=n})(this.BX.Intranet.UserProfile=this.BX.Intranet.UserProfile||{},BX);
//# sourceMappingURL=security.bundle.map.js