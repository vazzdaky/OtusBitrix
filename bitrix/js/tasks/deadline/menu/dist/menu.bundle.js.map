{"version":3,"file":"menu.bundle.js","sources":["../src/item/item.js","../src/item/default-item.js","../src/item/notification-item.js","../src/menu.js"],"sourcesContent":["import { Loc, Dom, Tag, Type } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\nimport { Menu, MenuItem } from 'main.popup';\nimport { MessageBox } from 'ui.dialogs.messagebox';\n\nexport class Item\n{\n\tACCEPTED_ITEM_CLASS: string = 'menu-popup-item-accept';\n\tDISABLED_ITEM_CLASS: string = 'menu-popup-item-disabled';\n\n\tMENU_ID: string;\n\tHINT_ID: string;\n\tTITLE: string;\n\n\t#item: MenuItem;\n\t#hintManager: BX.UI.Hint;\n\n\tgetItem(): MenuItem | null\n\t{\n\t\tif (!Type.isUndefined(this.#item))\n\t\t{\n\t\t\treturn this.#item;\n\t\t}\n\n\t\tif (Type.isUndefined(this.MENU_ID) || Type.isUndefined(this.HINT_ID) || Type.isUndefined(this.TITLE))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tthis.#item = {\n\t\t\tdataset: { id: this.MENU_ID },\n\t\t\tid: this.MENU_ID,\n\t\t\thtml: this.#getHtml(),\n\t\t\tclassName: `menu-popup-item-none menu-popup-${this.TITLE}-deadline`,\n\t\t\tevents: {\n\t\t\t\tonSubMenuShow: this.#onSubMenuShow.bind(this),\n\t\t\t},\n\t\t\titems: this.getSubItems(),\n\t\t};\n\n\t\treturn this.#item;\n\t}\n\n\tonPromiseError(error: Object): void\n\t{\n\t\tconst errors = error.errors;\n\t\tif (Type.isUndefined(errors))\n\t\t{\n\t\t\tconsole.error(error);\n\n\t\t\treturn;\n\t\t}\n\n\t\tMessageBox.alert(\n\t\t\tLoc.getMessage('TASKS_DEADLINE_MENU_ERROR_DESCRIPTION'),\n\t\t\tLoc.getMessage('TASKS_DEADLINE_MENU_ERROR_TITLE'),\n\t\t);\n\t}\n\n\tgetSubItems(): MenuItem[]\n\t{\n\t\treturn [];\n\t}\n\n\trefreshIcons(subItems: MenuItem[], subMenu: Menu): void\n\t{}\n\n\t#getHtml(): string\n\t{\n\t\tconst node = Tag.render`\n\t\t\t<div class=\"tasks-deadline-menu_${this.TITLE}-deadline-item__text\">\n\t\t\t\t${Loc.getMessage(`TASKS_DEADLINE_MENU_${this.TITLE.toUpperCase()}_ITEM_TITLE`)}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#hintManager = BX.UI.Hint.createInstance({\n\t\t\tid: this.HINT_ID,\n\t\t});\n\t\tconst hint = this.#hintManager.createNode(Loc.getMessage(`TASKS_DEADLINE_MENU_${this.TITLE.toUpperCase()}_ITEM_HINT`));\n\n\t\tDom.append(hint, node);\n\n\t\treturn node;\n\t}\n\n\t#onSubMenuShow(event: BaseEvent): void\n\t{\n\t\tconst item = event.getTarget();\n\n\t\tconst subMenu = item.getSubMenu();\n\t\tconst subItems = subMenu.getMenuItems();\n\n\t\tthis.refreshIcons(subItems, subMenu);\n\t\tthis.#bringHintToFront(subMenu);\n\t}\n\n\t#bringHintToFront(subMenu: Menu): void\n\t{\n\t\tconst subMenuComponent = subMenu.getPopupWindow().getZIndexComponent();\n\n\t\tconst hintPopup = this.#hintManager.popup;\n\t\tif (!hintPopup)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst hintComponent = hintPopup.getZIndexComponent();\n\n\t\thintComponent.setSort(subMenuComponent.getSort() + 1);\n\n\t\tconst stack = hintComponent.getStack();\n\t\tstack.sort();\n\t}\n}\n","import { Type, Loc, Extension, Dom, ajax as Ajax } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\nimport { Menu, MenuItem } from 'main.popup';\nimport { PULL as Pull } from 'pull.client';\nimport { Item } from './item';\n\ntype DefaultDeadlineChangedParams = {\n\tdeadline: number,\n};\n\nexport class DefaultItem extends Item\n{\n\tMENU_ID: string = 'default-deadline-menu';\n\tHINT_ID: string = 'default-deadline-hint';\n\tTITLE: string = 'default';\n\n\t#PULL_EVENT: string = 'default_deadline_changed';\n\t#SECONDS_IN_DAY: number = 86400;\n\t#SECONDS_IN_WEEK: number = 7 * this.#SECONDS_IN_DAY;\n\t#SUBITEMS_CLASS_NAME: string = 'menu-popup-default-deadline-item';\n\n\t#subMenu: Menu;\n\t#subItems: MenuItem[];\n\t#defaultDeadline: number;\n\t#isDeadlineNotificationAvailable: boolean;\n\n\tconstructor(isDeadlineNotificationAvailable: boolean = true)\n\t{\n\t\tsuper();\n\n\t\tthis.#isDeadlineNotificationAvailable = isDeadlineNotificationAvailable;\n\n\t\tthis.#subscribeToPull();\n\t}\n\n\tgetSubItems(): MenuItem[]\n\t{\n\t\tconst onclick = this.#onMenuItemClick.bind(this);\n\n\t\tconst subItems = [\n\t\t\tnew MenuItem({\n\t\t\t\tdataset: { id: `${this.MENU_ID}-day` },\n\t\t\t\ttext: Loc.getMessage('TASKS_DEADLINE_MENU_DEFAULT_ITEM_1_DAY'),\n\t\t\t\tvalue: this.#SECONDS_IN_DAY,\n\t\t\t\tisExactTime: false,\n\t\t\t\tclassName: this.#SUBITEMS_CLASS_NAME,\n\t\t\t\tonclick,\n\t\t\t}),\n\t\t\tnew MenuItem({\n\t\t\t\tdataset: { id: `${this.MENU_ID}-three-days` },\n\t\t\t\ttext: Loc.getMessage('TASKS_DEADLINE_MENU_DEFAULT_ITEM_3_DAYS'),\n\t\t\t\tvalue: 3 * this.#SECONDS_IN_DAY,\n\t\t\t\tisExactTime: false,\n\t\t\t\tclassName: this.#SUBITEMS_CLASS_NAME,\n\t\t\t\tonclick,\n\t\t\t}),\n\t\t\tnew MenuItem({\n\t\t\t\tdataset: { id: `${this.MENU_ID}-week` },\n\t\t\t\ttext: Loc.getMessage('TASKS_DEADLINE_MENU_DEFAULT_ITEM_1_WEEK'),\n\t\t\t\tvalue: this.#SECONDS_IN_WEEK,\n\t\t\t\tisExactTime: false,\n\t\t\t\tclassName: this.#SUBITEMS_CLASS_NAME,\n\t\t\t\tonclick,\n\t\t\t}),\n\t\t\tnew MenuItem({\n\t\t\t\tdataset: { id: `${this.MENU_ID}-two-weeks` },\n\t\t\t\ttext: Loc.getMessage('TASKS_DEADLINE_MENU_DEFAULT_ITEM_2_WEEKS'),\n\t\t\t\tvalue: 2 * this.#SECONDS_IN_WEEK,\n\t\t\t\tisExactTime: false,\n\t\t\t\tclassName: this.#SUBITEMS_CLASS_NAME,\n\t\t\t\tonclick,\n\t\t\t}),\n\t\t\tnew MenuItem({\n\t\t\t\tdataset: { id: `${this.MENU_ID}-empty` },\n\t\t\t\ttext: Loc.getMessage('TASKS_DEADLINE_MENU_DEFAULT_ITEM_EMPTY'),\n\t\t\t\tvalue: 0,\n\t\t\t\tisExactTime: false,\n\t\t\t\tclassName: this.#SUBITEMS_CLASS_NAME,\n\t\t\t\tonclick,\n\t\t\t}),\n\t\t];\n\n\t\tif (this.#isDeadlineNotificationAvailable)\n\t\t{\n\t\t\tsubItems.push(new MenuItem({\n\t\t\t\tdataset: { id: `${this.MENU_ID}-custom` },\n\t\t\t\ttext: Loc.getMessage('TASKS_DEADLINE_MENU_DEFAULT_ITEM_CUSTOM'),\n\t\t\t\tclassName: this.#SUBITEMS_CLASS_NAME,\n\t\t\t}));\n\t\t}\n\n\t\treturn subItems;\n\t}\n\n\trefreshIcons(subItems: MenuItem[], subMenu: Menu): void\n\t{\n\t\tconst subItemsFilled = Type.isArrayFilled(subItems) || !Type.isUndefined(this.#subItems);\n\t\tconst subMenuFilled = !Type.isUndefined(subMenu) || !Type.isUndefined(this.#subMenu);\n\t\tif (!subItemsFilled || !subMenuFilled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isArrayFilled(subItems))\n\t\t{\n\t\t\tthis.#subItems = subItems;\n\t\t}\n\n\t\tif (!Type.isUndefined(subMenu))\n\t\t{\n\t\t\tthis.#subMenu = subMenu;\n\t\t}\n\n\t\tlet isDefaultDeadlineFound = false;\n\t\tlet customItem = null;\n\n\t\tthis.#subItems.forEach((item: MenuItem): void => {\n\t\t\tconst node = item.getLayout().item;\n\t\t\tif (!Type.isElementNode(node))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst currentDeadline = item.value;\n\n\t\t\tif (Type.isUndefined(currentDeadline))\n\t\t\t{\n\t\t\t\tcustomItem = item;\n\t\t\t}\n\t\t\telse if (currentDeadline === this.defaultDeadline)\n\t\t\t{\n\t\t\t\tDom.addClass(node, this.ACCEPTED_ITEM_CLASS);\n\t\t\t\tisDefaultDeadlineFound = true;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tDom.removeClass(node, this.ACCEPTED_ITEM_CLASS);\n\t\t});\n\n\t\tif (!Type.isNull(customItem))\n\t\t{\n\t\t\tconst customItemClass = isDefaultDeadlineFound ? this.DISABLED_ITEM_CLASS : this.ACCEPTED_ITEM_CLASS;\n\n\t\t\tDom.addClass(customItem.getLayout().item, customItemClass);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (isDefaultDeadlineFound)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tcustomItem = new MenuItem({\n\t\t\tdataset: { id: `${this.MENU_ID}-custom` },\n\t\t\ttext: Loc.getMessage('TASKS_DEADLINE_MENU_DEFAULT_ITEM_CUSTOM'),\n\t\t\tclassName: `${this.#SUBITEMS_CLASS_NAME} ${this.ACCEPTED_ITEM_CLASS}`,\n\t\t});\n\t\tthis.#subMenu.addMenuItem(customItem);\n\t}\n\n\t#onMenuItemClick(event: BaseEvent, item: MenuItem): void\n\t{\n\t\tconst deadline = item.value;\n\t\tif (!Type.isNumber(deadline))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (deadline === this.#defaultDeadline)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#defaultDeadline = deadline;\n\n\t\tconst subMenu = item.getMenuWindow();\n\t\tconst subItems = subMenu.getMenuItems();\n\t\tthis.refreshIcons(subItems, subMenu);\n\n\t\tAjax.runAction('tasks.deadline.Deadline.setDefault', {\n\t\t\tdata: {\n\t\t\t\tdeadlineData: {\n\t\t\t\t\tdefault: deadline,\n\t\t\t\t\tisExactTime: item.isExactTime ? 'Y' : 'N',\n\t\t\t\t},\n\t\t\t},\n\t\t})\n\t\t\t.catch((error): void => this.onPromiseError(error))\n\t\t;\n\t}\n\n\t#subscribeToPull(): void\n\t{\n\t\tPull.subscribe({\n\t\t\tmoduleId: 'tasks',\n\t\t\tcommand: this.#PULL_EVENT,\n\t\t\tcallback: this.#onDefaultDeadlineChanged.bind(this),\n\t\t});\n\t}\n\n\t#onDefaultDeadlineChanged(params: DefaultDeadlineChangedParams): void\n\t{\n\t\tconst deadline = params.deadline;\n\n\t\tif (!Type.isNumber(deadline) || this.#defaultDeadline === deadline)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#defaultDeadline = deadline;\n\t}\n\n\tget defaultDeadline(): number\n\t{\n\t\tif (!Type.isUndefined(this.#defaultDeadline))\n\t\t{\n\t\t\treturn this.#defaultDeadline;\n\t\t}\n\n\t\tconst settings = Extension.getSettings('tasks.deadline.menu');\n\t\tthis.#defaultDeadline = Number(settings.get('defaultDeadline'));\n\n\t\treturn this.#defaultDeadline;\n\t}\n}\n","import { Type, Loc, Extension, Dom, ajax as Ajax } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\nimport { MenuItem } from 'main.popup';\nimport { PULL as Pull } from 'pull.client';\nimport { Item } from './item';\n\ntype SkipPeriodChangedParams = {\n\tperiod: string,\n};\n\nexport class NotificationItem extends Item\n{\n\tMENU_ID: string = 'skip-deadline-notification-menu';\n\tHINT_ID: string = 'skip-deadline-notification-hint';\n\tTITLE: string = 'notification';\n\n\t#PULL_EVENT: string = 'skip_deadline_notification_period_changed';\n\t#SUBITEMS_CLASS_NAME: string = 'menu-popup-skip-deadline-item';\n\n\t#subItems: MenuItem[];\n\t#skipPeriod: string;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.#subscribeToPull();\n\t}\n\n\tgetSubItems(): MenuItem[]\n\t{\n\t\tconst onclick = this.#onMenuItemClick.bind(this);\n\n\t\treturn [\n\t\t\tnew MenuItem({\n\t\t\t\ttext: Loc.getMessage('TASKS_DEADLINE_MENU_NOTIFICATION_ITEM_DELIMITER'),\n\t\t\t\tdelimiter: true,\n\t\t\t\tclassName: this.#SUBITEMS_CLASS_NAME,\n\t\t\t}),\n\t\t\tnew MenuItem({\n\t\t\t\tdataset: { id: `${this.MENU_ID}-always` },\n\t\t\t\ttext: Loc.getMessage('TASKS_DEADLINE_MENU_NOTIFICATION_ITEM_DONT_SKIP'),\n\t\t\t\tvalue: '',\n\t\t\t\tclassName: this.#SUBITEMS_CLASS_NAME,\n\t\t\t\tonclick,\n\t\t\t}),\n\t\t\tnew MenuItem({\n\t\t\t\tdataset: { id: `${this.MENU_ID}-day` },\n\t\t\t\ttext: Loc.getMessage('TASKS_DEADLINE_MENU_NOTIFICATION_ITEM_SKIP_FOR_DAY'),\n\t\t\t\tvalue: 'day',\n\t\t\t\tclassName: this.#SUBITEMS_CLASS_NAME,\n\t\t\t\tonclick,\n\t\t\t}),\n\t\t\tnew MenuItem({\n\t\t\t\tdataset: { id: `${this.MENU_ID}-week` },\n\t\t\t\ttext: Loc.getMessage('TASKS_DEADLINE_MENU_NOTIFICATION_ITEM_SKIP_FOR_WEEK'),\n\t\t\t\tvalue: 'week',\n\t\t\t\tclassName: this.#SUBITEMS_CLASS_NAME,\n\t\t\t\tonclick,\n\t\t\t}),\n\t\t\tnew MenuItem({\n\t\t\t\tdataset: { id: `${this.MENU_ID}-month` },\n\t\t\t\ttext: Loc.getMessage('TASKS_DEADLINE_MENU_NOTIFICATION_ITEM_SKIP_FOR_MONTH'),\n\t\t\t\tvalue: 'month',\n\t\t\t\tclassName: this.#SUBITEMS_CLASS_NAME,\n\t\t\t\tonclick,\n\t\t\t}),\n\t\t\tnew MenuItem({\n\t\t\t\tdataset: { id: `${this.MENU_ID}-forever` },\n\t\t\t\ttext: Loc.getMessage('TASKS_DEADLINE_MENU_NOTIFICATION_ITEM_SKIP_FOREVER'),\n\t\t\t\tvalue: 'forever',\n\t\t\t\tclassName: this.#SUBITEMS_CLASS_NAME,\n\t\t\t\tonclick,\n\t\t\t}),\n\t\t];\n\t}\n\n\trefreshIcons(subItems: MenuItem[], subMenu: Menu): void\n\t{\n\t\tconst subItemsFilled = Type.isArrayFilled(subItems) || !Type.isUndefined(this.#subItems);\n\t\tif (!subItemsFilled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isArrayFilled(subItems))\n\t\t{\n\t\t\tthis.#subItems = subItems;\n\t\t}\n\n\t\tthis.#subItems.forEach((item: MenuItem): void => {\n\t\t\tconst node = item.getLayout().item;\n\t\t\tif (!Type.isElementNode(node))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst currentSkipPeriod = item.value;\n\t\t\tif (currentSkipPeriod === this.skipPeriod)\n\t\t\t{\n\t\t\t\tDom.addClass(node, this.ACCEPTED_ITEM_CLASS);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tDom.removeClass(node, this.ACCEPTED_ITEM_CLASS);\n\t\t});\n\t}\n\n\t#onMenuItemClick(event: BaseEvent, item: MenuItem): void\n\t{\n\t\tconst skipPeriod = item.value;\n\t\tif (!Type.isString(skipPeriod))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (skipPeriod === this.#skipPeriod)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#skipPeriod = skipPeriod;\n\n\t\tconst subMenu = item.getMenuWindow();\n\t\tconst subItems = subMenu.getMenuItems();\n\t\tthis.refreshIcons(subItems, subMenu);\n\n\t\tAjax.runAction('tasks.deadline.Notification.skip', {\n\t\t\tdata: {\n\t\t\t\tnotificationData: {\n\t\t\t\t\tskipPeriod,\n\t\t\t\t},\n\t\t\t},\n\t\t})\n\t\t\t.catch((error): void => this.onPromiseError(error))\n\t\t;\n\t}\n\n\t#subscribeToPull(): void\n\t{\n\t\tPull.subscribe({\n\t\t\tmoduleId: 'tasks',\n\t\t\tcommand: this.#PULL_EVENT,\n\t\t\tcallback: this.#onNotificationPeriodChanged.bind(this),\n\t\t});\n\t}\n\n\t#onNotificationPeriodChanged(params: SkipPeriodChangedParams): void\n\t{\n\t\tconst period = params.period;\n\n\t\tif (!Type.isString(period) || this.#skipPeriod === period)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#skipPeriod = period;\n\t}\n\n\tget skipPeriod(): string\n\t{\n\t\tif (!Type.isUndefined(this.#skipPeriod))\n\t\t{\n\t\t\treturn this.#skipPeriod;\n\t\t}\n\n\t\tconst settings = Extension.getSettings('tasks.deadline.menu');\n\t\tthis.#skipPeriod = String(settings.get('skipDeadlineNotificationPeriod'));\n\n\t\treturn this.#skipPeriod;\n\t}\n}\n","import { Type, Extension } from 'main.core';\nimport { MenuItem } from 'main.popup';\nimport { DefaultItem } from './item/default-item';\nimport { NotificationItem } from './item/notification-item';\nimport './style.css';\n\nexport class Menu\n{\n\t#isDeadlineNotificationAvailable: boolean;\n\n\tget menuItems(): MenuItem[]\n\t{\n\t\tconst defaultMenuItem = new DefaultItem(this.isDeadlineNotificationAvailable);\n\t\tconst menuItems = [defaultMenuItem.getItem()];\n\n\t\tif (this.isDeadlineNotificationAvailable)\n\t\t{\n\t\t\tconst notificationMenuItem = new NotificationItem();\n\t\t\tmenuItems.push(notificationMenuItem.getItem());\n\t\t}\n\n\t\treturn menuItems;\n\t}\n\n\tget isDeadlineNotificationAvailable(): boolean\n\t{\n\t\tif (!Type.isUndefined(this.#isDeadlineNotificationAvailable))\n\t\t{\n\t\t\treturn this.#isDeadlineNotificationAvailable;\n\t\t}\n\n\t\tconst settings = Extension.getSettings('tasks.deadline.menu');\n\t\tthis.#isDeadlineNotificationAvailable = Boolean(settings.get('isDeadlineNotificationAvailable'));\n\n\t\treturn this.#isDeadlineNotificationAvailable;\n\t}\n}\n"],"names":["Item","ACCEPTED_ITEM_CLASS","DISABLED_ITEM_CLASS","getItem","Type","isUndefined","MENU_ID","HINT_ID","TITLE","dataset","id","html","className","events","onSubMenuShow","bind","items","getSubItems","onPromiseError","error","errors","console","MessageBox","alert","Loc","getMessage","refreshIcons","subItems","subMenu","node","Tag","render","toUpperCase","BX","UI","Hint","createInstance","hint","createNode","Dom","append","event","item","getTarget","getSubMenu","getMenuItems","subMenuComponent","getPopupWindow","getZIndexComponent","hintPopup","popup","hintComponent","setSort","getSort","stack","getStack","sort","DefaultItem","constructor","isDeadlineNotificationAvailable","onclick","MenuItem","text","value","isExactTime","push","subItemsFilled","isArrayFilled","subMenuFilled","isDefaultDeadlineFound","customItem","forEach","getLayout","isElementNode","currentDeadline","defaultDeadline","addClass","removeClass","isNull","customItemClass","addMenuItem","settings","Extension","getSettings","Number","get","deadline","isNumber","getMenuWindow","Ajax","runAction","data","deadlineData","default","catch","Pull","subscribe","moduleId","command","callback","params","NotificationItem","delimiter","currentSkipPeriod","skipPeriod","String","isString","notificationData","period","Menu","menuItems","defaultMenuItem","notificationMenuItem","Boolean"],"mappings":"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"}