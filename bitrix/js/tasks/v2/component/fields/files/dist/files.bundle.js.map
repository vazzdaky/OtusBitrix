{"version":3,"file":"files.bundle.js","sources":["../src/files-meta.js","../src/files.js","../src/component/upload-button.js","../src/files-sheet.js","../src/files-popup/files-popup.js","../src/files-chip.js"],"sourcesContent":["import { Loc } from 'main.core';\n\nexport const filesMeta = Object.freeze({\n\tid: 'fileIds',\n\ttitle: Loc.getMessage('TASKS_V2_FILES_TITLE'),\n});\n","import { FileStatus } from 'ui.uploader.core';\nimport { BIcon } from 'ui.icon-set.api.vue';\nimport { Animated, Outline } from 'ui.icon-set.api.core';\nimport 'ui.icon-set.animated';\nimport 'ui.icon-set.outline';\n\nimport { Model } from 'tasks.v2.const';\nimport { fileService } from 'tasks.v2.provider.service.file-service';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport { filesMeta } from './files-meta';\nimport './files.css';\n\n// @vue/component\nexport const Files = {\n\tname: 'TaskFiles',\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['open'],\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tAnimated,\n\t\t\tOutline,\n\t\t\tfilesMeta,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tfiles: fileService.get(this.taskId).getFiles(),\n\t\t};\n\t},\n\tcomputed: {\n\t\ttask(): TaskModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/getById`](this.taskId);\n\t\t},\n\t\tfilesCount(): number\n\t\t{\n\t\t\treturn this.task.fileIds.length;\n\t\t},\n\t\ttextFormatted(): string\n\t\t{\n\t\t\tif (this.filesCount > 0)\n\t\t\t{\n\t\t\t\treturn this.loc('TASKS_V2_FILES_COUNT', {\n\t\t\t\t\t'#COUNT#': this.filesCount,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn this.loc('TASKS_V2_FILES_ADD');\n\t\t},\n\t\tisUploading(): boolean\n\t\t{\n\t\t\treturn this.files.some(({ status }) => [FileStatus.UPLOADING, FileStatus.LOADING].includes(status));\n\t\t},\n\t\treadonly(): boolean\n\t\t{\n\t\t\treturn !this.task.rights.edit;\n\t\t},\n\t},\n\tmethods: {\n\t\thandleAddClick(): void\n\t\t{\n\t\t\tfileService.get(this.taskId).browse({\n\t\t\t\tbindElement: this.$refs.add.$el,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"tasks-field-files\"\n\t\t\t:data-task-id=\"taskId\"\n\t\t\t:data-task-field-id=\"filesMeta.id\"\n\t\t\t:data-task-files-count=\"filesCount\"\n\t\t>\n\t\t\t<div\n\t\t\t\tclass=\"tasks-field-files-main\"\n\t\t\t\tdata-task-files-open\n\t\t\t\t@click=\"$emit('open')\"\n\t\t\t>\n\t\t\t\t<template v-if=\"isUploading\">\n\t\t\t\t\t<BIcon class=\"tasks-field-files-icon\" :name=\"Animated.LOADER_WAIT\"/>\n\t\t\t\t\t<div class=\"tasks-field-files-text\">{{ loc('TASKS_V2_FILES_LOADING') }}</div>\n\t\t\t\t</template>\n\t\t\t\t<template v-else>\n\t\t\t\t\t<BIcon class=\"tasks-field-files-icon\" :name=\"Outline.ATTACH\"/>\n\t\t\t\t\t<div class=\"tasks-field-files-text\" :class=\"{ '--add': filesCount === 0 }\">\n\t\t\t\t\t\t{{ textFormatted }}\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t\t<BIcon\n\t\t\t\tv-if=\"!readonly\"\n\t\t\t\tclass=\"tasks-field-files-add\"\n\t\t\t\t:name=\"Outline.PLUS_L\"\n\t\t\t\tdata-task-files-plus\n\t\t\t\tref=\"add\"\n\t\t\t\t@click=\"handleAddClick\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { fileService } from 'tasks.v2.provider.service.file-service';\nimport { Button as UiButton, ButtonSize } from 'ui.vue3.components.button';\n\n// @vue/component\nexport const UploadButton = {\n\tcomponents: {\n\t\tUiButton,\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tButtonSize,\n\t\t};\n\t},\n\tmethods: {\n\t\thandleClick(): void\n\t\t{\n\t\t\tfileService.get(this.taskId).browse({\n\t\t\t\tbindElement: this.$el,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<span data-task-files-upload>\n\t\t\t<UiButton\n\t\t\t\t:text=\"loc('TASKS_V2_FILES_UPLOAD')\"\n\t\t\t\t:size=\"ButtonSize.MEDIUM\"\n\t\t\t\t@click=\"handleClick\"\n\t\t\t/>\n\t\t</span>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\nimport { BIcon } from 'ui.icon-set.api.vue';\nimport { Outline } from 'ui.icon-set.api.core';\nimport 'ui.icon-set.outline';\nimport type { VueUploaderAdapter } from 'ui.uploader.vue';\n\nimport { UserFieldWidgetComponent, type UserFieldWidgetOptions } from 'disk.uploader.user-field-widget';\nimport { Model } from 'tasks.v2.const';\nimport { BottomSheet } from 'tasks.v2.component.elements.bottom-sheet';\nimport { fileService } from 'tasks.v2.provider.service.file-service';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport { UploadButton } from './component/upload-button';\n\n// @vue/component\nexport const FilesSheet = {\n\tname: 'TaskFilesSheet',\n\tcomponents: {\n\t\tUserFieldWidgetComponent,\n\t\tUploadButton,\n\t\tBottomSheet,\n\t\tBIcon,\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tisShown: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['close'],\n\tsetup(props): { uploaderAdapter: VueUploaderAdapter }\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t\tuploaderAdapter: fileService.get(props.taskId).getAdapter(),\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tfiles: [],\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\ttitleFieldOffsetHeight: `${Model.Interface}/titleFieldOffsetHeight`,\n\t\t}),\n\t\ttask(): TaskModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/getById`](this.taskId);\n\t\t},\n\t\treadonly(): boolean\n\t\t{\n\t\t\treturn !this.task.rights.edit;\n\t\t},\n\t\twidgetOptions(): UserFieldWidgetOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tisEmbedded: true,\n\t\t\t\twithControlPanel: false,\n\t\t\t\tcanCreateDocuments: false,\n\t\t\t\ttileWidgetOptions: {\n\t\t\t\t\tcompact: true,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t},\n\twatch: {\n\t\tisShown(): void\n\t\t{\n\t\t\tif (!this.isShown)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvoid this.loadFiles();\n\t\t},\n\t\ttitleFieldOffsetHeight(): void\n\t\t{\n\t\t\tthis.$refs.bottomSheet?.adjustPosition();\n\t\t},\n\t},\n\tmethods: {\n\t\tasync loadFiles(): Promise<void>\n\t\t{\n\t\t\tthis.files = await fileService.get(this.taskId).list(this.task.fileIds);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BottomSheet :isShown=\"isShown\" ref=\"bottomSheet\">\n\t\t\t<div class=\"tasks-field-files-sheet\" :data-task-id=\"taskId\">\n\t\t\t\t<div class=\"tasks-field-files-header\">\n\t\t\t\t\t<div class=\"tasks-field-files-title\">{{ loc('TASKS_V2_FILES_TITLE') }}</div>\n\t\t\t\t\t<BIcon :name=\"Outline.CROSS_L\" data-task-files-close @click=\"$emit('close')\"/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-field-files-list\">\n\t\t\t\t\t<UserFieldWidgetComponent :uploaderAdapter=\"uploaderAdapter\" :widgetOptions=\"widgetOptions\"/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-field-files-footer\" v-if=\"!readonly\">\n\t\t\t\t\t<UploadButton :taskId=\"taskId\"/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</BottomSheet>\n\t`,\n};\n","import type { PopupOptions } from 'main.popup';\n\nimport { Popup } from 'ui.vue3.components.popup';\nimport { Button as UiButton, AirButtonStyle, ButtonSize, ButtonIcon } from 'ui.vue3.components.button';\nimport type { VueUploaderAdapter } from 'ui.uploader.vue';\n\nimport { UserFieldWidgetComponent, type UserFieldWidgetOptions } from 'disk.uploader.user-field-widget';\nimport { fileService } from 'tasks.v2.provider.service.file-service';\nimport './files-popup.css';\n\n// @vue/component\nexport const FilesPopup = {\n\tcomponents: {\n\t\tPopup,\n\t\tUiButton,\n\t\tUserFieldWidgetComponent,\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tgetBindElement: {\n\t\t\ttype: Function,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['upload', 'close'],\n\tsetup(props): { uploaderAdapter: VueUploaderAdapter }\n\t{\n\t\treturn {\n\t\t\tButtonSize,\n\t\t\tAirButtonStyle,\n\t\t\tButtonIcon,\n\t\t\tuploaderAdapter: fileService.get(props.taskId).getAdapter(),\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tfiles: fileService.get(this.taskId).getFiles(),\n\t\t};\n\t},\n\tcomputed: {\n\t\tbindElement(): HTMLElement\n\t\t{\n\t\t\treturn this.getBindElement();\n\t\t},\n\t\tpopupOptions(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tid: 'tasks-field-files-popup',\n\t\t\t\tbindElement: this.bindElement,\n\t\t\t\tminWidth: 350,\n\t\t\t\tmaxHeight: 320,\n\t\t\t\tpadding: 18,\n\t\t\t\tbindOptions: {\n\t\t\t\t\tforceBindPosition: true,\n\t\t\t\t\tforceTop: true,\n\t\t\t\t\tposition: 'top',\n\t\t\t\t},\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tautoHideHandler: (event: MouseEvent): boolean => {\n\t\t\t\t\tconst anyTileMenuShown = this.files.some(({ isMenuShown }) => isMenuShown);\n\n\t\t\t\t\treturn this.$refs.popup?.autoHideHandler(event) && !anyTileMenuShown;\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\twidgetOptions(): UserFieldWidgetOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tisEmbedded: true,\n\t\t\t\twithControlPanel: false,\n\t\t\t\tcanCreateDocuments: false,\n\t\t\t\ttileWidgetOptions: {\n\t\t\t\t\tenableDropzone: false,\n\t\t\t\t\thideDropArea: true,\n\t\t\t\t\tcompact: true,\n\t\t\t\t\tautoCollapse: false,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tfilesCount(): number\n\t\t{\n\t\t\treturn this.files.length;\n\t\t},\n\t},\n\twatch: {\n\t\tfilesCount(): void\n\t\t{\n\t\t\tif (this.filesCount === 0)\n\t\t\t{\n\t\t\t\tthis.closePopup();\n\t\t\t}\n\t\t},\n\t},\n\tmethods: {\n\t\thandleClearClick(): void\n\t\t{\n\t\t\tfileService.get(this.taskId).getAdapter().getUploader().removeFiles();\n\n\t\t\tthis.closePopup();\n\t\t},\n\t\thandleUploadClick(): void\n\t\t{\n\t\t\tfileService.get(this.taskId).browseFiles();\n\t\t},\n\t\thandleMyDriveClick(): void\n\t\t{\n\t\t\tfileService.get(this.taskId).browseMyDrive();\n\t\t},\n\t\tclosePopup(): void\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Popup\n\t\t\t:options=\"popupOptions\"\n\t\t\tref=\"popup\"\n\t\t\t@close=\"closePopup\"\n\t\t>\n\t\t\t<div class=\"tasks-field-files-popup\">\n\t\t\t\t<div class=\"tasks-field-files-popup-files\">\n\t\t\t\t\t<UserFieldWidgetComponent :uploaderAdapter=\"uploaderAdapter\" :widgetOptions=\"widgetOptions\"/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-field-files-popup-footer\">\n\t\t\t\t\t<div class=\"tasks-field-files-popup-add-buttons\">\n\t\t\t\t\t\t<UiButton\n\t\t\t\t\t\t\t:text=\"loc('TASKS_V2_FILES_UPLOAD_BUTTON')\"\n\t\t\t\t\t\t\t:size=\"ButtonSize.EXTRA_SMALL\"\n\t\t\t\t\t\t\t:style=\"AirButtonStyle.TINTED\"\n\t\t\t\t\t\t\t:leftIcon=\"ButtonIcon.DOWNLOAD\"\n\t\t\t\t\t\t\t@click=\"handleUploadClick\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<UiButton\n\t\t\t\t\t\t\t:text=\"loc('TASKS_V2_FILES_MY_DRIVE')\"\n\t\t\t\t\t\t\t:size=\"ButtonSize.EXTRA_SMALL\"\n\t\t\t\t\t\t\t:style=\"AirButtonStyle.TINTED\"\n\t\t\t\t\t\t\t:leftIcon=\"ButtonIcon.CLOUD\"\n\t\t\t\t\t\t\t@click=\"handleMyDriveClick\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<UiButton\n\t\t\t\t\t\t:text=\"loc('TASKS_V2_FILES_CLEAR')\"\n\t\t\t\t\t\t:size=\"ButtonSize.EXTRA_SMALL\"\n\t\t\t\t\t\t:style=\"AirButtonStyle.PLAIN_NO_ACCENT\"\n\t\t\t\t\t\t:leftIcon=\"ButtonIcon.REMOVE\"\n\t\t\t\t\t\t@click=\"handleClearClick\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</Popup>\n\t`,\n};\n","import { FileStatus, UploaderFileInfo } from 'ui.uploader.core';\nimport { Animated, Outline } from 'ui.icon-set.api.core';\nimport 'ui.icon-set.animated';\nimport 'ui.icon-set.outline';\n\nimport { Chip, ChipDesign } from 'tasks.v2.component.elements.chip';\nimport { GroupType, Model } from 'tasks.v2.const';\nimport { fieldHighlighter } from 'tasks.v2.lib.field-highlighter';\nimport { analytics } from 'tasks.v2.lib.analytics';\nimport { fileService, type FileService } from 'tasks.v2.provider.service.file-service';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\nimport type { GroupModel } from 'tasks.v2.model.groups';\n\nimport { filesMeta } from './files-meta';\nimport { FilesPopup } from './files-popup/files-popup';\n\n// @vue/component\nexport const FilesChip = {\n\tcomponents: {\n\t\tChip,\n\t\tFilesPopup,\n\t},\n\tinject: ['analytics', 'cardType'],\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tisAutonomous: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tsetup(props): { fileService: FileService }\n\t{\n\t\treturn {\n\t\t\tfilesMeta,\n\t\t\tfileService: fileService.get(props.taskId),\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tfiles: this.fileService.getFiles(),\n\t\t\tisPopupShown: false,\n\t\t\tisPopupShownWithFiles: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\ttask(): TaskModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/getById`](this.taskId);\n\t\t},\n\t\tgroup(): ?GroupModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Groups}/getById`](this.task.groupId);\n\t\t},\n\t\tfilesCount(): number\n\t\t{\n\t\t\treturn this.task.fileIds.length;\n\t\t},\n\t\tdesign(): string\n\t\t{\n\t\t\treturn {\n\t\t\t\t[!this.isAutonomous && !this.isSelected]: ChipDesign.Shadow,\n\t\t\t\t[!this.isAutonomous && this.isSelected]: ChipDesign.ShadowAccent,\n\t\t\t\t[this.isAutonomous && !this.isSelected]: ChipDesign.Outline,\n\t\t\t\t[this.isAutonomous && this.isSelected]: ChipDesign.OutlineAccent,\n\t\t\t\t[this.hasError]: ChipDesign.OutlineAlert,\n\t\t\t}.true;\n\t\t},\n\t\tisSelected(): boolean\n\t\t{\n\t\t\tif (this.isAutonomous)\n\t\t\t{\n\t\t\t\treturn this.files.length > 0;\n\t\t\t}\n\n\t\t\tconst wasFilesFilled = this.$store.getters[`${Model.Tasks}/wasFieldFilled`](this.taskId, filesMeta.id);\n\n\t\t\treturn wasFilesFilled || this.files.length > 0;\n\t\t},\n\t\ticon(): string\n\t\t{\n\t\t\tif (this.isAutonomous && this.isUploading)\n\t\t\t{\n\t\t\t\treturn Animated.LOADER_WAIT;\n\t\t\t}\n\n\t\t\treturn Outline.ATTACH;\n\t\t},\n\t\ttext(): string\n\t\t{\n\t\t\tif (this.isAutonomous && this.filesCount > 0)\n\t\t\t{\n\t\t\t\treturn this.loc('TASKS_V2_FILES_COUNT', {\n\t\t\t\t\t'#COUNT#': this.filesCount,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn filesMeta.title;\n\t\t},\n\t\tisUploading(): boolean\n\t\t{\n\t\t\treturn this.fileService.isUploading();\n\t\t},\n\t\thasError(): boolean\n\t\t{\n\t\t\treturn this.files.some(({ status }) => [FileStatus.UPLOAD_FAILED, FileStatus.LOAD_FAILED].includes(status));\n\t\t},\n\t\treadonly(): boolean\n\t\t{\n\t\t\treturn !this.task.rights.edit;\n\t\t},\n\t\tpopupHasAlreadyBeenShown(): boolean\n\t\t{\n\t\t\treturn this.filesCount > 0 && this.isPopupShownWithFiles;\n\t\t},\n\t},\n\tmounted(): void\n\t{\n\t\tthis.fileService.subscribe('onFileAdd', this.handleFileAdd);\n\t\tthis.fileService.subscribe('onFileComplete', this.handleFileComplete);\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tthis.fileService.unsubscribe('onFileAdd', this.handleFileAdd);\n\t\tthis.fileService.unsubscribe('onFileComplete', this.handleFileComplete);\n\t},\n\tmethods: {\n\t\thandleFileAdd(): void\n\t\t{\n\t\t\tif (this.isAutonomous && this.popupHasAlreadyBeenShown)\n\t\t\t{\n\t\t\t\tthis.showPopup();\n\t\t\t}\n\t\t},\n\t\thandleFileComplete(event): void\n\t\t{\n\t\t\tthis.sendAnalytics(event.getData());\n\t\t},\n\t\tsendAnalytics(file: UploaderFileInfo): void\n\t\t{\n\t\t\tanalytics.sendAttachFile(this.analytics, {\n\t\t\t\tcardType: this.cardType,\n\t\t\t\tcollabId: this.group?.type === GroupType.Collab ? this.group.id : null,\n\t\t\t\tfileOrigin: file.origin,\n\t\t\t\tfileSize: file.size,\n\t\t\t\tfileExtension: file.extension,\n\t\t\t\tfilesCount: this.filesCount,\n\t\t\t});\n\t\t},\n\t\thandleClick(): void\n\t\t{\n\t\t\tif (!this.isAutonomous && this.isSelected)\n\t\t\t{\n\t\t\t\tthis.highlightField();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.files.length > 0)\n\t\t\t{\n\t\t\t\tthis.isPopupShownWithFiles = true;\n\n\t\t\t\tthis.showPopup();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.browseFiles();\n\t\t\t}\n\t\t},\n\t\tshowPopup(): void\n\t\t{\n\t\t\tthis.isPopupShown = true;\n\t\t},\n\t\tclosePopup(): void\n\t\t{\n\t\t\tthis.isPopupShown = false;\n\n\t\t\tif (!this.filesCount)\n\t\t\t{\n\t\t\t\tthis.isPopupShownWithFiles = false;\n\t\t\t}\n\t\t},\n\t\tbrowseFiles(): void\n\t\t{\n\t\t\tthis.fileService.browse({ bindElement: this.$refs.chip.$el, onHideCallback: this.onFileBrowserClose });\n\t\t},\n\t\thighlightField(): void\n\t\t{\n\t\t\tvoid fieldHighlighter.setContainer(this.$root.$el).highlight(filesMeta.id);\n\t\t},\n\t\tonFileBrowserClose(): void\n\t\t{\n\t\t\tthis.$refs.chip?.focus();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Chip\n\t\t\tv-if=\"isSelected || !readonly\"\n\t\t\t:design=\"design\"\n\t\t\t:icon=\"icon\"\n\t\t\t:text=\"text\"\n\t\t\t:data-task-id=\"taskId\"\n\t\t\t:data-task-chip-id=\"filesMeta.id\"\n\t\t\tref=\"chip\"\n\t\t\t@click=\"handleClick\"\n\t\t/>\n\t\t<FilesPopup\n\t\t\tv-if=\"isPopupShown\"\n\t\t\t:taskId=\"taskId\"\n\t\t\t:getBindElement=\"() => $refs.chip.$el\"\n\t\t\t@upload=\"browseFiles\"\n\t\t\t@close=\"closePopup\"\n\t\t/>\n\t`,\n};\n"],"names":["filesMeta","Object","freeze","id","title","Loc","getMessage","Files","name","components","BIcon","props","taskId","type","Number","String","required","emits","setup","Animated","Outline","data","files","fileService","get","getFiles","computed","task","$store","getters","Model","Tasks","filesCount","fileIds","length","textFormatted","loc","isUploading","some","status","FileStatus","UPLOADING","LOADING","includes","readonly","rights","edit","methods","handleAddClick","browse","bindElement","$refs","add","$el","template","UploadButton","UiButton","ButtonSize","handleClick","FilesSheet","UserFieldWidgetComponent","BottomSheet","isShown","Boolean","uploaderAdapter","getAdapter","mapGetters","titleFieldOffsetHeight","Interface","widgetOptions","isEmbedded","withControlPanel","canCreateDocuments","tileWidgetOptions","compact","watch","loadFiles","bottomSheet","adjustPosition","list","FilesPopup","Popup","getBindElement","Function","AirButtonStyle","ButtonIcon","popupOptions","minWidth","maxHeight","padding","bindOptions","forceBindPosition","forceTop","position","closeByEsc","autoHideHandler","event","anyTileMenuShown","isMenuShown","popup","enableDropzone","hideDropArea","autoCollapse","closePopup","handleClearClick","getUploader","removeFiles","handleUploadClick","browseFiles","handleMyDriveClick","browseMyDrive","$emit","FilesChip","Chip","inject","isAutonomous","default","isPopupShown","isPopupShownWithFiles","group","Groups","groupId","design","isSelected","ChipDesign","Shadow","ShadowAccent","OutlineAccent","hasError","OutlineAlert","true","wasFilesFilled","icon","LOADER_WAIT","ATTACH","text","UPLOAD_FAILED","LOAD_FAILED","popupHasAlreadyBeenShown","mounted","subscribe","handleFileAdd","handleFileComplete","beforeUnmount","unsubscribe","showPopup","sendAnalytics","getData","file","analytics","sendAttachFile","cardType","collabId","GroupType","Collab","fileOrigin","origin","fileSize","size","fileExtension","extension","highlightField","chip","onHideCallback","onFileBrowserClose","fieldHighlighter","setContainer","$root","highlight","focus"],"mappings":"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"}