this.BX=this.BX||{};this.BX.Tasks=this.BX.Tasks||{};this.BX.Tasks.V2=this.BX.Tasks.V2||{};this.BX.Tasks.V2.Component=this.BX.Tasks.V2.Component||{};(function(t,e,i){"use strict";const a={name:"GrowingTextArea",components:{Popup:e.Popup},props:{initialValue:{type:String,default:""},placeholderValue:{type:String,default:""},fontColor:{type:String,default:"var(--ui-color-base-1)"},fontSize:{type:Number,default:21},fontWeight:{type:[Number,String],default:"inherit"},lineHeight:{type:Number,default:29},readonly:{type:Boolean,default:false}},emits:["update","input","focus","blur","emptyFocus","emptyBlur","enterBlur"],data(){return{areaId:i.Text.getRandom(),editableValue:this.initialValue,focus:false,mouseover:false,isOverflowing:false}},computed:{value:{get(){if(this.readonlyPlaceholder){return this.placeholderValue.trim()}return this.editableValue.trim()},set(t){this.editableValue=t;this.$emit("input",this.value)}},isEmpty(){return this.value.trim()===""},isDisplay(){return this.readonly||this.isOverflowing&&!this.isEmpty&&!this.focus},popupId(){return`growing-text-area-value-hint-${this.areaId}`},popupOptions(){return{bindElement:this.$refs.container,offsetLeft:40,maxWidth:440,angle:{offset:40},targetContainer:document.body}},showHint(){return this.focus===false&&this.mouseover===true&&this.isOverflowing===true},readonlyPlaceholder(){return this.readonly===true&&this.initialValue===""},color(){if(this.readonlyPlaceholder){return"var(--ui-color-base-4)"}return this.fontColor}},watch:{initialValue(){this.editableValue=this.initialValue;this.value=this.editableValue}},mounted(){requestAnimationFrame((()=>{if(this.isEmpty){this.focusToEnd()}void this.adjustTextareaHeight()}))},methods:{async adjustTextareaHeight(){const t=this.$refs.textarea;if(!t){return}i.Dom.style(t,"height","auto");const e=this.lineHeight*3;const a=Math.min(t.scrollHeight,e);this.isOverflowing=t.scrollHeight>e;i.Dom.style(t,"height",`${a}px`);i.Dom.style(t,"maxHeight",`${e}px`)},async focusToTextarea(){this.focusToEnd()},clearValue(){this.$refs.textarea.value="";this.value="";void this.adjustTextareaHeight()},focusToEnd(){if(this.readonly===true){return}const t=this.$refs.textarea;t.focus({preventScroll:true});t.setSelectionRange(t.value.length,t.value.length);this.scrollToBeginning();this.scrollToEnd()},focusTextarea(){if(this.readonly===true){return}this.focus=true;void this.$nextTick((()=>{this.$refs.textarea.focus()}))},scrollToBeginning(){if(!this.$refs.textarea){return}this.$refs.textarea.scrollTop=0},scrollToEnd(){const t=this.$refs.textarea;t.scrollTo({top:t.scrollHeight,behavior:"smooth"})},handleInput(t){this.value=t.target.value;this.$emit("update",this.value);void this.adjustTextareaHeight()},handleKeyDown(t){if(t.key==="Enter"&&(t.ctrlKey||t.metaKey)){t.stopPropagation();return}if(t.key==="Enter"){this.$refs.textarea.dataset.enterBlur="true";t.target.blur();t.preventDefault()}if(t.key==="Escape"){t.target.blur();t.stopPropagation()}},async handleFocus(t){this.focus=true;await this.adjustTextareaHeight();this.focusToEnd();if(this.value===""){this.$emit("emptyFocus")}this.$emit("focus",t)},async handleBlur(t){var e,i;const a=((e=this.$refs.textarea)==null?void 0:e.dataset.enterBlur)==="true";(i=this.$refs.textarea)==null?true:delete i.dataset.enterBlur;this.focus=false;this.mouseover=false;if(!this.isOverflowing){await this.adjustTextareaHeight();this.scrollToBeginning()}if(this.value===""){this.$emit("emptyBlur")}if(a){this.$emit("enterBlur",this.value==="")}this.$emit("blur",t)}},template:`\n\t\t<div ref="container" class="b24-growing-text-area-content">\n\t\t\t<div\n\t\t\t\tv-if="isDisplay"\n\t\t\t\tclass="b24-growing-text-area-display"\n\t\t\t\t:class="{ '--readonly': readonly }"\n\t\t\t\t:data-id="'b24-growing-text-area-display-' + areaId"\n\t\t\t\t:style="{\n\t\t\t\t\tlineHeight: lineHeight + 'px',\n\t\t\t\t\tcolor: color,\n\t\t\t\t\tfontSize: fontSize + 'px',\n\t\t\t\t\tfontWeight: fontWeight,\n\t\t\t\t}"\n\t\t\t\t@click="focusTextarea"\n\t\t\t\t@mouseover="mouseover = true"\n\t\t\t\t@mouseleave="mouseover = false"\n\t\t\t>\n\t\t\t\t{{ value }}\n\t\t\t</div>\n\t\t\t<textarea\n\t\t\t\tv-else\n\t\t\t\tv-model="editableValue"\n\t\t\t\tref="textarea"\n\t\t\t\tclass="b24-growing-text-area-edit"\n\t\t\t\t:placeholder="placeholderValue"\n\t\t\t\t:data-id="'b24-growing-text-area-edit-' + areaId"\n\t\t\t\t:style="{\n\t\t\t\t\tlineHeight: lineHeight + 'px',\n\t\t\t\t\tcolor: fontColor,\n\t\t\t\t\tfontSize: fontSize + 'px',\n\t\t\t\t\tfontWeight: fontWeight,\n\t\t\t\t}"\n\t\t\t\trows="1"\n\t\t\t\t@input="handleInput"\n\t\t\t\t@keydown="handleKeyDown"\n\t\t\t\t@focus="handleFocus"\n\t\t\t\t@blur="handleBlur"\n\t\t\t></textarea>\n\t\t\t<Popup\n\t\t\t\tv-if="showHint"\n\t\t\t\tref="hint"\n\t\t\t\t:id="popupId"\n\t\t\t\t:options="popupOptions"\n\t\t\t>\n\t\t\t\t<div class="b24-growing-text-area-popup-content">\n\t\t\t\t\t{{ value }}\n\t\t\t\t</div>\n\t\t\t</Popup>\n\t\t</div>\n\t`};t.GrowingTextArea=a})(this.BX.Tasks.V2.Component.Elements=this.BX.Tasks.V2.Component.Elements||{},BX.UI.Vue3.Components,BX);
//# sourceMappingURL=growing-text-area.bundle.map.js