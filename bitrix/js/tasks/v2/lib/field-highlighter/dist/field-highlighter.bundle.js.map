{"version":3,"file":"field-highlighter.bundle.js","sources":["../src/field-highlighter.js"],"sourcesContent":["import { Dom, Event } from 'main.core';\nimport './field-highlighter.css';\n\nconst fieldAttribute = 'data-task-field-id';\nconst chipAttribute = 'data-task-chip-id';\nconst fieldSelector = '[data-field-container]';\n\nclass FieldHighlighter\n{\n\t#container: HTMLElement = document.body;\n\t#highlightTimeouts: { [fieldId: string]: number } = {};\n\n\tsetContainer(container: HTMLElement): FieldHighlighter\n\t{\n\t\tthis.#container = container;\n\n\t\treturn this;\n\t}\n\n\taddHighlight(fieldId: string): HTMLElement\n\t{\n\t\treturn this.highlightContainer(this.#getFieldContainer(fieldId));\n\t}\n\n\taddChipHighlight(fieldId: string): HTMLElement\n\t{\n\t\treturn this.highlightContainer(this.#getChipContainer(fieldId));\n\t}\n\n\thighlightContainer(container: HTMLElement): HTMLElement\n\t{\n\t\tDom.addClass(container, 'tasks-field-highlight');\n\n\t\tconst removeHighlight = () => {\n\t\t\tDom.removeClass(container, 'tasks-field-highlight');\n\t\t\tEvent.unbind(window, 'click', removeHighlight);\n\t\t\tEvent.unbind(window, 'keydown', removeHighlight);\n\t\t};\n\t\tEvent.bind(window, 'click', removeHighlight);\n\t\tEvent.bind(window, 'keydown', removeHighlight);\n\n\t\treturn container;\n\t}\n\n\tasync highlight(fieldId: string): Promise<HTMLElement>\n\t{\n\t\tawait this.#nextTick();\n\n\t\tconst fieldContainer = this.#getFieldContainer(fieldId);\n\n\t\tthis.#stopAnimation(fieldContainer);\n\t\tsetTimeout(() => this.#startAnimation(fieldContainer));\n\n\t\tclearTimeout(this.#highlightTimeouts[fieldId]);\n\t\tthis.#highlightTimeouts[fieldId] = setTimeout(() => this.#stopAnimation(fieldContainer), 1500);\n\n\t\tthis.#scrollToField(fieldId);\n\n\t\treturn fieldContainer;\n\t}\n\n\t#startAnimation(fieldContainer: HTMLElement): void\n\t{\n\t\tDom.addClass(fieldContainer, ['tasks-field-highlight', '--animate']);\n\t}\n\n\t#stopAnimation(fieldContainer: HTMLElement): void\n\t{\n\t\tDom.removeClass(fieldContainer, ['tasks-field-highlight', '--animate']);\n\t}\n\n\t#scrollToField(fieldId: string): void\n\t{\n\t\tconst fieldContainer = this.#getFieldContainer(fieldId);\n\n\t\tfieldContainer.scrollIntoView({\n\t\t\tblock: 'center',\n\t\t\tbehavior: 'smooth',\n\t\t});\n\t}\n\n\t#getFieldContainer(fieldId: string): HTMLElement\n\t{\n\t\treturn this.#container.querySelector(`[${fieldAttribute}=\"${fieldId}\"]`).closest(fieldSelector);\n\t}\n\n\t#getChipContainer(fieldId: string): HTMLElement\n\t{\n\t\treturn this.#container.querySelector(`[${chipAttribute}=\"${fieldId}\"]`);\n\t}\n\n\t#nextTick(): Promise<void>\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tsetTimeout(resolve, 0);\n\t\t});\n\t}\n}\n\nexport const fieldHighlighter = new FieldHighlighter();\n"],"names":["fieldAttribute","chipAttribute","fieldSelector","FieldHighlighter","document","body","setContainer","container","addHighlight","fieldId","highlightContainer","addChipHighlight","Dom","addClass","removeHighlight","removeClass","Event","unbind","window","bind","highlight","fieldContainer","setTimeout","clearTimeout","scrollIntoView","block","behavior","querySelector","closest","Promise","resolve","fieldHighlighter"],"mappings":";;;;;;;CAGA,MAAMA,cAAc,GAAG,oBAAoB;CAC3C,MAAMC,aAAa,GAAG,mBAAmB;CACzC,MAAMC,aAAa,GAAG,wBAAwB;CAAC;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAE/C,MAAMC,gBAAgB,CACtB;GAAA;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;OAAA,OAC2BC,QAAQ,CAACC;;KAAI;OAAA;OAAA,OACa;;;GAEpDC,YAAY,CAACC,SAAsB,EACnC;KACC,4CAAI,4BAAcA,SAAS;KAE3B,OAAO,IAAI;;GAGZC,YAAY,CAACC,OAAe,EAC5B;KACC,OAAO,IAAI,CAACC,kBAAkB,yCAAC,IAAI,0CAAoBD,OAAO,EAAE;;GAGjEE,gBAAgB,CAACF,OAAe,EAChC;KACC,OAAO,IAAI,CAACC,kBAAkB,yCAAC,IAAI,wCAAmBD,OAAO,EAAE;;GAGhEC,kBAAkB,CAACH,SAAsB,EACzC;KACCK,aAAG,CAACC,QAAQ,CAACN,SAAS,EAAE,uBAAuB,CAAC;KAEhD,MAAMO,eAAe,GAAG,MAAM;OAC7BF,aAAG,CAACG,WAAW,CAACR,SAAS,EAAE,uBAAuB,CAAC;OACnDS,eAAK,CAACC,MAAM,CAACC,MAAM,EAAE,OAAO,EAAEJ,eAAe,CAAC;OAC9CE,eAAK,CAACC,MAAM,CAACC,MAAM,EAAE,SAAS,EAAEJ,eAAe,CAAC;MAChD;KACDE,eAAK,CAACG,IAAI,CAACD,MAAM,EAAE,OAAO,EAAEJ,eAAe,CAAC;KAC5CE,eAAK,CAACG,IAAI,CAACD,MAAM,EAAE,SAAS,EAAEJ,eAAe,CAAC;KAE9C,OAAOP,SAAS;;GAGjB,MAAMa,SAAS,CAACX,OAAe,EAC/B;KACC,8CAAM,IAAI,yBAAY;KAEtB,MAAMY,cAAc,2CAAG,IAAI,0CAAoBZ,OAAO,CAAC;KAEvD,4CAAI,kCAAgBY,cAAc;KAClCC,UAAU,CAAC,8CAAM,IAAI,oCAAiBD,cAAc,CAAC,CAAC;KAEtDE,YAAY,CAAC,4CAAI,0CAAoBd,OAAO,CAAC,CAAC;KAC9C,4CAAI,0CAAoBA,OAAO,CAAC,GAAGa,UAAU,CAAC,8CAAM,IAAI,kCAAgBD,cAAc,CAAC,EAAE,IAAI,CAAC;KAE9F,4CAAI,kCAAgBZ,OAAO;KAE3B,OAAOY,cAAc;;CAuCvB;CAAC,0BApCgBA,cAA2B,EAC3C;GACCT,aAAG,CAACC,QAAQ,CAACQ,cAAc,EAAE,CAAC,uBAAuB,EAAE,WAAW,CAAC,CAAC;CACrE;CAAC,yBAEcA,cAA2B,EAC1C;GACCT,aAAG,CAACG,WAAW,CAACM,cAAc,EAAE,CAAC,uBAAuB,EAAE,WAAW,CAAC,CAAC;CACxE;CAAC,yBAEcZ,OAAe,EAC9B;GACC,MAAMY,cAAc,2CAAG,IAAI,0CAAoBZ,OAAO,CAAC;GAEvDY,cAAc,CAACG,cAAc,CAAC;KAC7BC,KAAK,EAAE,QAAQ;KACfC,QAAQ,EAAE;IACV,CAAC;CACH;CAAC,6BAEkBjB,OAAe,EAClC;GACC,OAAO,4CAAI,0BAAYkB,aAAa,CAAE,IAAG3B,cAAe,KAAIS,OAAQ,IAAG,CAAC,CAACmB,OAAO,CAAC1B,aAAa,CAAC;CAChG;CAAC,4BAEiBO,OAAe,EACjC;GACC,OAAO,4CAAI,0BAAYkB,aAAa,CAAE,IAAG1B,aAAc,KAAIQ,OAAQ,IAAG,CAAC;CACxE;CAAC,sBAGD;GACC,OAAO,IAAIoB,OAAO,CAAEC,OAAO,IAAK;KAC/BR,UAAU,CAACQ,OAAO,EAAE,CAAC,CAAC;IACtB,CAAC;CACH;AAGD,OAAaC,gBAAgB,GAAG,IAAI5B,gBAAgB,EAAE;;;;;;;;"}