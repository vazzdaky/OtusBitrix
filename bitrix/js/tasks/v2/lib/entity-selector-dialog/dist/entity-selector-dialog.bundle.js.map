{"version":3,"file":"entity-selector-dialog.bundle.js","sources":["../src/entity-selector-dialog.js"],"sourcesContent":["import { Dialog, Item, type DialogOptions } from 'ui.entity-selector';\n\nexport type ItemId = [string, number];\n\nexport class EntitySelectorDialog extends Dialog\n{\n\t#isSelectProgrammatically: boolean = false;\n\n\tconstructor(dialogOptions: DialogOptions)\n\t{\n\t\tconst minHeight = 280;\n\t\tconst minTagSelectorHeight = 34;\n\t\tconst options = {\n\t\t\ttagSelectorOptions: {\n\t\t\t\tmaxHeight: minTagSelectorHeight * 2,\n\t\t\t},\n\t\t\t...dialogOptions,\n\t\t\theight: Math.max(minHeight, dialogOptions.height ?? (window.innerHeight / 2 - minTagSelectorHeight)),\n\t\t\tevents: {\n\t\t\t\t...dialogOptions.events,\n\t\t\t\t'Item:onSelect': () => {\n\t\t\t\t\tif (this.#isSelectProgrammatically)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tdialogOptions.events?.['Item:onSelect']?.();\n\t\t\t\t},\n\t\t\t\t'Item:onDeselect': () => {\n\t\t\t\t\tif (this.#isSelectProgrammatically)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tdialogOptions.events?.['Item:onDeselect']?.();\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\tsuper(options);\n\t}\n\n\tshowTo(targetNode: HTMLElement): void\n\t{\n\t\tthis.getPopup();\n\t\tthis.setTargetNode(targetNode);\n\t\tthis.show();\n\t}\n\n\tselectItemsByIds(items: ItemId[]): void\n\t{\n\t\tthis.#isSelectProgrammatically = true;\n\n\t\tthis.getItems().forEach((item: Item) => {\n\t\t\tconst isSelected = this.#inIds(item, items);\n\n\t\t\tif (!item.isSelected() && isSelected)\n\t\t\t{\n\t\t\t\titem.select();\n\t\t\t}\n\n\t\t\tif (item.isSelected() && !isSelected)\n\t\t\t{\n\t\t\t\titem.deselect();\n\t\t\t}\n\t\t});\n\n\t\tthis.#isSelectProgrammatically = false;\n\t}\n\n\tgetItemsByIds(items: ItemId[]): Item[]\n\t{\n\t\treturn this.getItems().filter((item: Item) => this.#inIds(item, items));\n\t}\n\n\t#inIds(item: Item, items: ItemId[]): boolean\n\t{\n\t\tconst itemId = [item.getEntityId(), item.getId()];\n\n\t\treturn items.some((it) => itemId[0] === it[0] && itemId[1] === it[1]);\n\t}\n}\n"],"names":["EntitySelectorDialog","Dialog","constructor","dialogOptions","minHeight","minTagSelectorHeight","options","tagSelectorOptions","maxHeight","height","Math","max","window","innerHeight","events","showTo","targetNode","getPopup","setTargetNode","show","selectItemsByIds","items","getItems","forEach","item","isSelected","select","deselect","getItemsByIds","filter","itemId","getEntityId","getId","some","it"],"mappings":";;;;;;;CAAsE;CAAA;AAItE,CAAO,MAAMA,oBAAoB,SAASC,wBAAM,CAChD;GAGCC,WAAW,CAACC,aAA4B,EACxC;KAAA;KACC,MAAMC,SAAS,GAAG,GAAG;KACrB,MAAMC,oBAAoB,GAAG,EAAE;KAC/B,MAAMC,OAAO,GAAG;OACfC,kBAAkB,EAAE;SACnBC,SAAS,EAAEH,oBAAoB,GAAG;QAClC;OACD,GAAGF,aAAa;OAChBM,MAAM,EAAEC,IAAI,CAACC,GAAG,CAACP,SAAS,2BAAED,aAAa,CAACM,MAAM,oCAAKG,MAAM,CAACC,WAAW,GAAG,CAAC,GAAGR,oBAAoB,CAAE;OACpGS,MAAM,EAAE;SACP,GAAGX,aAAa,CAACW,MAAM;SACvB,eAAe,EAAE,MAAM;WAAA;WACtB,4CAAI,IAAI,yDACR;aACC;;WAGD,yBAAAX,aAAa,CAACW,MAAM,+CAApB,sBAAuB,eAAe,CAAC,qBAAvC,kDAA2C;UAC3C;SACD,iBAAiB,EAAE,MAAM;WAAA;WACxB,4CAAI,IAAI,yDACR;aACC;;WAGD,0BAAAX,aAAa,CAACW,MAAM,+CAApB,uBAAuB,iBAAiB,CAAC,qBAAzC,mDAA6C;;;MAG/C;KAED,KAAK,CAACR,OAAO,CAAC;KAAC;OAAA;;KAAA;OAAA;OAAA,OAjCqB;;;GAoCrCS,MAAM,CAACC,UAAuB,EAC9B;KACC,IAAI,CAACC,QAAQ,EAAE;KACf,IAAI,CAACC,aAAa,CAACF,UAAU,CAAC;KAC9B,IAAI,CAACG,IAAI,EAAE;;GAGZC,gBAAgB,CAACC,KAAe,EAChC;KACC,4CAAI,0DAA6B,IAAI;KAErC,IAAI,CAACC,QAAQ,EAAE,CAACC,OAAO,CAAEC,IAAU,IAAK;OACvC,MAAMC,UAAU,2CAAG,IAAI,kBAAQD,IAAI,EAAEH,KAAK,CAAC;OAE3C,IAAI,CAACG,IAAI,CAACC,UAAU,EAAE,IAAIA,UAAU,EACpC;SACCD,IAAI,CAACE,MAAM,EAAE;;OAGd,IAAIF,IAAI,CAACC,UAAU,EAAE,IAAI,CAACA,UAAU,EACpC;SACCD,IAAI,CAACG,QAAQ,EAAE;;MAEhB,CAAC;KAEF,4CAAI,0DAA6B,KAAK;;GAGvCC,aAAa,CAACP,KAAe,EAC7B;KACC,OAAO,IAAI,CAACC,QAAQ,EAAE,CAACO,MAAM,CAAEL,IAAU,4CAAK,IAAI,kBAAQA,IAAI,EAAEH,KAAK,CAAC,CAAC;;CASzE;CAAC,iBANOG,IAAU,EAAEH,KAAe,EAClC;GACC,MAAMS,MAAM,GAAG,CAACN,IAAI,CAACO,WAAW,EAAE,EAAEP,IAAI,CAACQ,KAAK,EAAE,CAAC;GAEjD,OAAOX,KAAK,CAACY,IAAI,CAAEC,EAAE,IAAKJ,MAAM,CAAC,CAAC,CAAC,KAAKI,EAAE,CAAC,CAAC,CAAC,IAAIJ,MAAM,CAAC,CAAC,CAAC,KAAKI,EAAE,CAAC,CAAC,CAAC,CAAC;CACtE;;;;;;;;"}