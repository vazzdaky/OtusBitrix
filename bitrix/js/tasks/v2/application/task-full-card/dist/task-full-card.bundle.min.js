this.BX=this.BX||{};this.BX.Tasks=this.BX.Tasks||{};this.BX.Tasks.V2=this.BX.Tasks.V2||{};(function(t,e,s,i,n,a,l,o,r,d,c,h,u,p,k,m,v,I,S,f,b,C,g,F,B,T,L,w,A,E,y,P,_,D,O,M){"use strict";const R={name:"TaskFullCardChat",props:{taskId:{type:[Number,String],required:true}},computed:{task(){return this.$store.getters[`${_.Model.Tasks}/getById`](this.taskId)}},watch:{taskId(){void this.openChat()}},mounted(){void this.openChat()},methods:{async openChat(){var t,e;(t=this.app)==null?void 0:t.bitrixVue.unmount();(e=this.app)!=null?e:this.app=await C.Messenger.initApplication("task");if(this.taskId>0){void this.app.mount({rootContainer:this.$el,chatId:this.task.chatId,taskId:this.taskId,type:F.Core.getParams().chatType})}else{await this.app.mountPlaceholder({rootContainer:this.$el,taskId:this.taskId});b.EventEmitter.emit("tasks:card:onMembersCountChange",{taskId:this.taskId,userCounter:1})}}},template:`\n\t\t<div class="tasks-full-card-chat"></div>\n\t`};const V={components:{UiButton:T.Button,AddTaskButton:B.AddTaskButton},props:{taskId:{type:[Number,String],required:true}},emits:["addTask"],setup(){return{AirButtonStyle:T.AirButtonStyle,ButtonSize:T.ButtonSize}},methods:{close(){L.Event.EventEmitter.emit(_.EventName.CloseFullCard)}},template:`\n\t\t<div class="tasks-full-card-footer-create">\n\t\t\t<AddTaskButton :taskId="taskId" @addTask="$emit('addTask')"/>\n\t\t\t<UiButton\n\t\t\t\t:text="loc('TASKS_V2_TASK_FULL_CARD_CANCEL')"\n\t\t\t\t:size="ButtonSize.LARGE"\n\t\t\t\t:style="AirButtonStyle.PLAIN"\n\t\t\t\tdata-task-cancel-button\n\t\t\t\t@click="close"\n\t\t\t/>\n\t\t\t<UiButton\n\t\t\t\tclass="tasks-full-card-footer-template-button"\n\t\t\t\t:text="loc('TASKS_V2_TASK_FULL_CARD_TEMPLATES')"\n\t\t\t\t:size="ButtonSize.SMALL"\n\t\t\t\t:style="AirButtonStyle.PLAIN_NO_ACCENT"\n\t\t\t\t:dropdown="true"\n\t\t\t/>\n\t\t</div>\n\t`};const $={name:"TaskFullCardMore",components:{BIcon:E.BIcon,BMenu:A.BMenu},props:{taskId:{type:[Number,String],required:true}},setup(){return{Outline:y.Outline}},data(){return{isMenuShown:false}},computed:{...w.mapGetters({currentUserId:`${_.Model.Interface}/currentUserId`}),task(){return this.$store.getters[`${_.Model.Tasks}/getById`](this.taskId)},preselected(){return[["user",this.task.responsibleId||this.currentUserId]]},isCreator(){return this.currentUserId===this.task.creatorId},isResponsible(){return this.currentUserId===this.task.responsibleId},menuOptions(){return()=>({id:"tasks-full-card-footer-more-menu",bindElement:this.$refs.button.$el,items:this.menuItems})},menuItems(){const t={[_.TaskStatus.Pending]:{[this.isResponsible]:[this.getCompleteItem(),this.getDefferItem(),this.getDelegateItem()],[this.isCreator]:[this.getDefferItem(),this.getDelegateItem(),this.getDeleteItem()],[this.isResponsible&&this.isCreator]:[this.getCompleteItem(),this.getDefferItem(),this.getDelegateItem(),this.getDeleteItem()]},[_.TaskStatus.InProgress]:{[this.isResponsible]:[this.getPauseItem(),this.getDefferItem(),this.getDelegateItem()],[this.isCreator]:[this.getDefferItem(),this.getDelegateItem(),this.getDeleteItem()],[this.isResponsible&&this.isCreator]:[this.getPauseItem(),this.getDefferItem(),this.getDelegateItem(),this.getDeleteItem()]},[_.TaskStatus.Deferred]:{[this.isResponsible]:[this.getCompleteItem(),this.getDelegateItem()],[this.isCreator]:[this.getCompleteItem(),this.getDelegateItem(),this.getDeleteItem()]},[_.TaskStatus.SupposedlyCompleted]:{[this.isResponsible]:[this.getFixItem(),this.getDelegateItem()],[this.isCreator]:[this.getDisapproveItem(),this.getDelegateItem(),this.getDeleteItem()],[this.isResponsible&&this.isCreator]:[this.getCompleteItem(),this.getDelegateItem(),this.getDeleteItem()]},[_.TaskStatus.Completed]:{[this.isCreator]:[this.getRenewItem(),this.getDeleteItem()]}};return t[this.task.status].true}},methods:{handleClick(){this.isMenuShown=true},getDefferItem(){if(!this.task.rights.defer){return null}return{title:this.loc("TASKS_V2_TASK_FULL_CARD_DEFER"),icon:y.Outline.PAUSE_L,onClick:()=>M.taskService.defer(this.taskId)}},getPauseItem(){if(!this.task.rights.pause){return null}return{title:this.loc("TASKS_V2_TASK_FULL_CARD_PAUSE"),icon:y.Outline.STOP_L,onClick:()=>M.taskService.pause(this.taskId)}},getRenewItem(){if(!this.task.rights.renew){return null}return{title:this.loc("TASKS_V2_TASK_FULL_CARD_RENEW"),icon:y.Outline.UNDO,onClick:()=>M.taskService.renew(this.taskId)}},getFixItem(){if(!this.task.rights.renew){return null}return{title:this.loc("TASKS_V2_TASK_FULL_CARD_FIX"),icon:y.Outline.UNDO,onClick:()=>M.taskService.renew(this.taskId)}},getDisapproveItem(){if(!this.task.rights.disapprove){return null}return{title:this.loc("TASKS_V2_TASK_FULL_CARD_DISAPPROVE"),icon:y.Outline.UNDO,onClick:()=>M.taskService.disapprove(this.taskId)}},getCompleteItem(){if(!this.task.rights.complete){return null}return{title:this.loc("TASKS_V2_TASK_FULL_CARD_COMPLETE"),icon:y.Outline.SENDED,onClick:()=>M.taskService.complete(this.taskId)}},getDelegateItem(){if(!this.task.rights.delegate){return null}return{title:this.loc("TASKS_V2_TASK_FULL_CARD_DELEGATE"),icon:y.Outline.DELEGATE,onClick:()=>{var t;const e=L.Runtime.debounce(this.handleDelegateSelect,10,this);(t=this.dialog)!=null?t:this.dialog=new O.EntitySelectorDialog({...D.responsibleMeta.dialogOptions(this.$options.name),preselectedItems:this.preselected,events:{"Item:onSelect":e,"Item:onDeselect":e}});this.dialog.selectItemsByIds(this.preselected);this.dialog.showTo(this.$refs.button.$el)}}},handleDelegateSelect(){var t,e;const s=(t=(e=this.dialog.getSelectedItems()[0])==null?void 0:e.getId())!=null?t:0;void M.taskService.update(this.taskId,{responsibleId:s})},getDeleteItem(){if(!this.task.rights.remove){return null}return{design:A.MenuItemDesign.Alert,title:this.loc("TASKS_V2_TASK_FULL_CARD_DELETE"),icon:y.Outline.TRASHCAN,onClick:()=>{void M.taskService.delete(this.taskId);L.Event.EventEmitter.emit(_.EventName.CloseFullCard)}}}},template:`\n\t\t<BIcon\n\t\t\tv-if="menuItems"\n\t\t\tclass="tasks-full-card-footer-more"\n\t\t\t:name="Outline.MORE_L"\n\t\t\tdata-task-more-button\n\t\t\tref="button"\n\t\t\t@click="handleClick"\n\t\t/>\n\t\t<BMenu v-if="isMenuShown" :options="menuOptions()" @close="isMenuShown = false"/>\n\t`};const X={components:{UiButton:T.Button,BIcon:E.BIcon,More:$},props:{taskId:{type:[Number,String],required:true}},setup(){return{AirButtonStyle:T.AirButtonStyle,ButtonSize:T.ButtonSize,ButtonIcon:T.ButtonIcon,Outline:y.Outline,TaskStatus:_.TaskStatus}},computed:{...w.mapGetters({currentUserId:`${_.Model.Interface}/currentUserId`}),task(){return this.$store.getters[`${_.Model.Tasks}/getById`](this.taskId)},isCreator(){return this.currentUserId===this.task.creatorId},isResponsible(){return this.currentUserId===this.task.responsibleId},statusButton(){const t={[_.TaskStatus.Pending]:{[this.isCreator]:this.getCompleteButton(),[this.isResponsible]:this.getStartButton()},[_.TaskStatus.InProgress]:{[this.isResponsible]:this.getCompleteButton(),[this.isCreator]:this.getCompleteButton()},[_.TaskStatus.Deferred]:{[this.isResponsible]:this.getRenewButton(),[this.isCreator]:this.getRenewButton()},[_.TaskStatus.SupposedlyCompleted]:{[this.isResponsible]:this.getReviewButton(),[this.isCreator]:this.getApproveButton()},[_.TaskStatus.Completed]:{[this.isResponsible&&!this.isCreator]:this.getRenewButton(T.AirButtonStyle.PLAIN)}};return t[this.task.status].true}},methods:{getStartButton(){if(!this.task.rights.start){return null}return{text:this.loc("TASKS_V2_TASK_FULL_CARD_START"),onClick:()=>M.taskService.start(this.taskId)}},getCompleteButton(){if(!this.task.rights.complete){return null}return{text:this.loc("TASKS_V2_TASK_FULL_CARD_COMPLETE"),onClick:()=>M.taskService.complete(this.taskId)}},getRenewButton(t){if(!this.task.rights.renew){return null}return{text:this.loc("TASKS_V2_TASK_FULL_CARD_RENEW"),style:t,onClick:()=>M.taskService.renew(this.taskId)}},getReviewButton(){return{text:this.loc("TASKS_V2_TASK_FULL_CARD_ON_REVIEW"),disabled:true}},getApproveButton(){if(!this.task.rights.approve){return null}return{text:this.loc("TASKS_V2_TASK_FULL_CARD_APPROVE"),onClick:()=>M.taskService.complete(this.taskId)}}},template:`\n\t\t<div class="tasks-full-card-footer-edit">\n\t\t\t<UiButton\n\t\t\t\tv-if="statusButton"\n\t\t\t\t:text="statusButton.text"\n\t\t\t\t:size="ButtonSize.LARGE"\n\t\t\t\t:style="statusButton.style ?? AirButtonStyle.FILLED"\n\t\t\t\t:disabled="statusButton.disabled ?? false"\n\t\t\t\tdata-task-status-button\n\t\t\t\t@click="statusButton.onClick"\n\t\t\t/>\n\t\t\t<More :taskId="taskId"/>\n\t\t\t<div class="tasks-full-card-footer-actions">\n\t\t\t\t<div class="tasks-full-card-footer-reaction">\n\t\t\t\t\t<BIcon :name="Outline.LIKE"/>\n\t\t\t\t\t<div class="tasks-full-card-footer-reaction-text">\u041d\u0440\u0430\u0432\u0438\u0442\u0441\u044f</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="tasks-full-card-footer-views">\n\t\t\t\t\t<BIcon :name="Outline.OBSERVER"/>\n\t\t\t\t\t<div class="tasks-full-card-footer-views-text">1</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`};const K={name:"TaskFullCard",components:{FieldTitle:l.Title,Importance:o.Importance,DescriptionField:r.DescriptionField,DescriptionSheet:r.DescriptionSheet,Files:u.Files,FilesSheet:u.FilesSheet,CheckList:p.CheckList,CheckListSheet:p.CheckListSheet,FieldList:a.FieldList,Chip:n.Chip,Chat:R,FooterCreate:V,FooterEdit:X},provide(){return{analytics:this.analytics,cardType:_.CardType.Full}},props:{id:{type:[Number,String],default:()=>L.Text.getRandom()},analytics:{type:Object,default:()=>({})}},setup(){return{Outline:y.Outline,resizeObserver:null}},data(){return{taskId:this.id,isBottomSheetShown:false,isFilesSheetShown:false,isCheckListSheetShown:false,chipsEventHandlers:{showCheckList:this.openCheckList},checkListId:0,files:S.fileService.get(this.id).getFiles()}},computed:{...w.mapGetters({currentUserId:`${_.Model.Interface}/currentUserId`}),wasAccomplicesFilled(){return this.$store.getters[`${_.Model.Tasks}/wasFieldFilled`](this.taskId,v.accomplicesMeta.id)},wasAuditorsFilled(){return this.$store.getters[`${_.Model.Tasks}/wasFieldFilled`](this.taskId,I.auditorsMeta.id)},wasFlowFilled(){return this.$store.getters[`${_.Model.Tasks}/wasFieldFilled`](this.taskId,m.flowMeta.id)},wasGroupFilled(){return this.$store.getters[`${_.Model.Tasks}/wasFieldFilled`](this.taskId,k.groupMeta.id)},wasFilesFilled(){return this.$store.getters[`${_.Model.Tasks}/wasFieldFilled`](this.taskId,u.filesMeta.id)},task(){return this.$store.getters[`${_.Model.Tasks}/getById`](this.taskId)},checkLists(){var t;return(t=this.task)!=null&&t.checklist?this.$store.getters[`${_.Model.CheckList}/getByIds`](this.task.checklist):[]},isEdit(){return L.Type.isNumber(this.taskId)&&this.taskId>0},fields(){const t=[{title:d.creatorMeta.title,component:d.Creator,props:{taskId:this.taskId,context:this.$options.name,selectorWithActionMenu:this.isEdit}},{title:D.responsibleMeta.title,component:D.Responsible,props:{taskId:this.taskId,context:this.$options.name,selectorWithActionMenu:this.isEdit}},{title:c.deadlineMeta.title,component:c.Deadline},{title:h.statusMeta.title,component:h.Status,withSeparator:true},{title:u.filesMeta.title,component:u.Files,chip:u.FilesChip},{title:p.checkListMeta.title,component:p.CheckList,chip:p.CheckListChip},{title:k.groupMeta.getTitle(this.task.groupId),component:k.Group,chip:k.GroupChip},{title:v.accomplicesMeta.title,component:v.Accomplices,chip:v.AccomplicesChip},{title:I.auditorsMeta.title,component:I.Auditors,chip:I.AuditorsChip,withSeparator:this.wasAccomplicesFilled},{title:m.flowMeta.title,component:m.Flow,chip:m.FlowChip,withSeparator:true}];t.forEach((t=>{var e;(e=t.props)!=null?e:t.props={};t.props.taskId=this.taskId}));return t},primaryFields(){const t=new Set([d.Creator,D.Responsible,c.Deadline,h.Status]);return this.fields.filter((({component:e})=>t.has(e)))},projectFields(){const t=new Set;if(this.wasGroupFilled){t.add(k.Group)}if(this.wasFlowFilled){t.add(m.Flow)}return this.fields.filter((({component:e})=>t.has(e)))},participantsFields(){const t=new Set;if(this.wasAccomplicesFilled){t.add(v.Accomplices)}if(this.wasAuditorsFilled){t.add(I.Auditors)}return this.fields.filter((({component:e})=>t.has(e)))},chips(){return this.fields.filter((({chip:t})=>t)).map((({chip:t})=>t))}},watch:{async task(){if(this.task){await this.$nextTick();this.tryStartObserver()}}},async created(){if(!this.isEdit&&!this.task){void this.$store.dispatch(`${_.Model.Tasks}/insert`,{id:this.taskId,creatorId:this.currentUserId})}await this.$store.dispatch(`${_.Model.Tasks}/clearFieldsFilled`,this.taskId);if(this.isEdit&&!this.task){await M.taskService.getById(this.taskId)}},mounted(){this.tryStartObserver()},beforeUnmount(){if(this.resizeObserver){this.resizeObserver.disconnect()}},unmounted(){if(!this.isEdit){void this.$store.dispatch(`${_.Model.Tasks}/delete`,this.taskId);S.fileService.delete(this.taskId)}},methods:{...w.mapActions(_.Model.Interface,["updateTitleFieldOffsetHeight"]),tryStartObserver(){if(this.$refs.title&&!this.resizeObserver){this.resizeObserver=this.getObserver();this.resizeObserver.observe(this.$refs.title)}},getObserver(){return new ResizeObserver((t=>{for(const e of t){if(e.target===this.$refs.title){this.updateTitleFieldOffsetHeight(e.contentRect.height)}}}))},async addTask(){const t=this.checkLists;const[e]=await M.taskService.add(this.task);this.taskId=e;if(t.length>0){await f.checkListService.save(this.taskId,t)}S.fileService.replace(this.id,this.taskId)},openEditor(){this.handleShowBottomSheet()},closeEditor(t){t.close();this.handleCloseBottomSheet()},openFiles(){this.isFilesSheetShown=true;this.handleShowBottomSheet()},closeFiles(){this.isFilesSheetShown=false;this.handleCloseBottomSheet();this.handleCloseBottomSheet()},openCheckList(t){this.checkListId=t;this.isCheckListSheetShown=true;this.handleShowBottomSheet()},closeCheckList(){this.isCheckListSheetShown=false;this.handleCloseBottomSheet()},handleShowBottomSheet(){this.isBottomSheetShown=true;L.Dom.addClass(this.$refs.scrollContent,"--disable-scroll");this.$refs.scrollContent.scrollTo({top:0,behavior:"smooth"})},handleCloseBottomSheet(){this.isBottomSheetShown=false;L.Dom.removeClass(this.$refs.scrollContent,"--disable-scroll")},close(){L.Event.EventEmitter.emit(_.EventName.CloseFullCard)},getEventListeners(t,e){const s={};if(t.emits){Object.keys(e).forEach((i=>{if(t.emits.includes(i)){s[i]=e[i]}}))}return s}},template:`\n\t\t<div class="tasks-full-card" :data-task-id="taskId" data-task-full>\n\t\t\t<template v-if="task">\n\t\t\t\t<div class="tasks-full-card-main" :class="{ '--overlay': isBottomSheetShown }">\n\t\t\t\t\t<div class="tasks-full-card-content" ref="scrollContent">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass="tasks-full-card-title"\n\t\t\t\t\t\t\t:class="{'--no-padding-bottom': task.description.length > 0}"\n\t\t\t\t\t\t\tref="title"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<FieldTitle :taskId="taskId"/>\n\t\t\t\t\t\t\t<Importance :taskId="taskId"/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<FilesSheet\n\t\t\t\t\t\t\t:taskId="taskId"\n\t\t\t\t\t\t\t:isShown="isFilesSheetShown"\n\t\t\t\t\t\t\t@close="closeFiles"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<CheckListSheet\n\t\t\t\t\t\t\t:taskId="taskId"\n\t\t\t\t\t\t\t:checkListId="checkListId"\n\t\t\t\t\t\t\t:isShown="isCheckListSheetShown"\n\t\t\t\t\t\t\t@close="closeCheckList"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<DescriptionField\n\t\t\t\t\t\t\t:taskId="taskId"\n\t\t\t\t\t\t\tv-slot="slot"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<DescriptionSheet\n\t\t\t\t\t\t\t\t:taskId="taskId"\n\t\t\t\t\t\t\t\t:isShown="slot.isShown"\n\t\t\t\t\t\t\t\t:doOpenInEditMode="slot.doOpenInEditMode"\n\t\t\t\t\t\t\t\t@show="openEditor"\n\t\t\t\t\t\t\t\t@close="closeEditor(slot)"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</DescriptionField>\n\t\t\t\t\t\t<div class="tasks-full-card-fields">\n\t\t\t\t\t\t\t<div class="tasks-full-card-field-container" data-field-container>\n\t\t\t\t\t\t\t\t<FieldList :fields="primaryFields"/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="tasks-full-card-chips-fields">\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-if="files.length > 0 || wasFilesFilled"\n\t\t\t\t\t\t\t\t\tclass="tasks-full-card-field-container"\n\t\t\t\t\t\t\t\t\tdata-field-container\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Files :taskId="taskId" @open="openFiles"/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-if="task.checklist.length > 0"\n\t\t\t\t\t\t\t\t\tclass="tasks-full-card-field-container --custom"\n\t\t\t\t\t\t\t\t\tdata-field-container\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<CheckList :taskId="taskId" @open="openCheckList"/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-if="projectFields.length > 0"\n\t\t\t\t\t\t\t\t\tclass="tasks-full-card-field-container"\n\t\t\t\t\t\t\t\t\tdata-field-container\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<FieldList :fields="projectFields"/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-if="participantsFields.length > 0"\n\t\t\t\t\t\t\t\t\tclass="tasks-full-card-field-container"\n\t\t\t\t\t\t\t\t\tdata-field-container\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<FieldList\n\t\t\t\t\t\t\t\t\t\t:fields="participantsFields"\n\t\t\t\t\t\t\t\t\t\t:useSeparator="participantsFields.length > 1"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="tasks-full-card-chips">\n\t\t\t\t\t\t\t\t\t<template v-for="(chip, index) of chips" :key="index">\n\t\t\t\t\t\t\t\t\t\t<component\n\t\t\t\t\t\t\t\t\t\t\t:is="chip"\n\t\t\t\t\t\t\t\t\t\t\tv-bind="{ taskId }"\n\t\t\t\t\t\t\t\t\t\t\tv-on="getEventListeners(chip, chipsEventHandlers)"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<Chip :icon="Outline.APPS" :text="'\u0415\u0449\u0451'" :soon="true"/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="tasks-full-card-footer">\n\t\t\t\t\t\t<FooterEdit v-if="isEdit" :taskId="taskId"/>\n\t\t\t\t\t\t<FooterCreate v-else :taskId="taskId" @addTask="addTask"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<Chat :taskId="taskId"/>\n\t\t\t</template>\n\t\t\t<template v-else>\n\t\t\t\tLoading...\n\t\t\t</template>\n\t\t</div>\n\t`};let U=t=>t,H;var x=babelHelpers.classPrivateFieldLooseKey("application");var N=babelHelpers.classPrivateFieldLooseKey("params");var j=babelHelpers.classPrivateFieldLooseKey("container");var z=babelHelpers.classPrivateFieldLooseKey("showSidePanel");var G=babelHelpers.classPrivateFieldLooseKey("onSidePanelClose");var W=babelHelpers.classPrivateFieldLooseKey("renderContainer");var q=babelHelpers.classPrivateFieldLooseKey("mountApplication");var J=babelHelpers.classPrivateFieldLooseKey("unmountApplication");var Q=babelHelpers.classPrivateFieldLooseKey("subscribe");var Y=babelHelpers.classPrivateFieldLooseKey("unsubscribe");var Z=babelHelpers.classPrivateFieldLooseKey("onClose");var tt=babelHelpers.classPrivateFieldLooseKey("handlePopupShow");class et{constructor(t={}){Object.defineProperty(this,Y,{value:ot});Object.defineProperty(this,Q,{value:lt});Object.defineProperty(this,J,{value:at});Object.defineProperty(this,q,{value:nt});Object.defineProperty(this,W,{value:it});Object.defineProperty(this,z,{value:st});Object.defineProperty(this,x,{writable:true,value:null});Object.defineProperty(this,N,{writable:true,value:void 0});Object.defineProperty(this,j,{writable:true,value:void 0});Object.defineProperty(this,G,{writable:true,value:()=>{this.unmountCard()}});Object.defineProperty(this,Z,{writable:true,value:()=>{i.SidePanelInstance.close()}});Object.defineProperty(this,tt,{writable:true,value:t=>{const e=t.getCompatData()[0];const s=()=>e.adjustPosition();const i=()=>{e.unsubscribe("onClose",i);e.unsubscribe("onDestroy",i);L.Event.unbind(document,"scroll",s,true)};e.subscribe("onClose",i);e.subscribe("onDestroy",i);L.Event.bind(document,"scroll",s,true)}});babelHelpers.classPrivateFieldLooseBase(this,N)[N]=t}async showCard(){return new Promise(((t,e)=>{babelHelpers.classPrivateFieldLooseBase(this,z)[z](t).then((()=>{t()})).catch((t=>{e(t)}))}))}async mountCard(){babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]();babelHelpers.classPrivateFieldLooseBase(this,j)[j]=babelHelpers.classPrivateFieldLooseBase(this,W)[W]();await babelHelpers.classPrivateFieldLooseBase(this,q)[q](babelHelpers.classPrivateFieldLooseBase(this,j)[j]);return babelHelpers.classPrivateFieldLooseBase(this,j)[j]}unmountCard(){babelHelpers.classPrivateFieldLooseBase(this,J)[J]();babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]()}}async function st(){var t;const e=`tasks-task-full-card-${(t=babelHelpers.classPrivateFieldLooseBase(this,N)[N].taskId)!=null?t:0}`;const s=1510;const n=await this.mountCard();return new Promise((t=>{i.SidePanelInstance.open(e,{customLeftBoundary:0,width:s,cacheable:false,contentClassName:"tasks-full-card-slider-content",customRightBoundary:0,events:{onOpen:t,onClose:babelHelpers.classPrivateFieldLooseBase(this,G)[G]},contentCallback:()=>n})}))}function it(){return L.Tag.render(H||(H=U`
			<div class="tasks-full-card-container"></div>
		`))}async function nt(t){await F.Core.init();const i=e.BitrixVue.createApp(K,{...babelHelpers.classPrivateFieldLooseBase(this,N)[N],id:babelHelpers.classPrivateFieldLooseBase(this,N)[N].taskId});i.mixin(s.locMixin);i.use(F.Core.getStore());i.mount(t);babelHelpers.classPrivateFieldLooseBase(this,x)[x]=i}function at(){babelHelpers.classPrivateFieldLooseBase(this,x)[x].unmount()}function lt(){L.Event.EventEmitter.subscribe(_.EventName.CloseFullCard,babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]);L.Event.EventEmitter.subscribe("BX.Main.Popup:onShow",babelHelpers.classPrivateFieldLooseBase(this,tt)[tt])}function ot(){L.Event.EventEmitter.unsubscribe(_.EventName.CloseFullCard,babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]);L.Event.EventEmitter.unsubscribe("BX.Main.Popup:onShow",babelHelpers.classPrivateFieldLooseBase(this,tt)[tt])}t.TaskFullCard=et})(this.BX.Tasks.V2.Application=this.BX.Tasks.V2.Application||{},BX.Vue3,BX.Vue3.Mixins,BX.Tasks.V2.Lib,BX.Tasks.V2.Component.Elements,BX.Tasks.V2.Component.Elements,BX.Tasks.V2.Component.Fields,BX.Tasks.V2.Component.Fields,BX.Tasks.V2.Component.Fields,BX.Tasks.V2.Component.Fields,BX.Tasks.V2.Component.Fields,BX.Tasks.V2.Component.Fields,BX.Tasks.V2.Component.Fields,BX.Tasks.V2.Component.Fields,BX.Tasks.V2.Component.Fields,BX.Tasks.V2.Component.Fields,BX.Tasks.V2.Component.Fields,BX.Tasks.V2.Component.Fields,BX.Tasks.V2.Provider.Service,BX.Tasks.V2.Provider.Service,BX.Event,BX.Messenger.v2.Lib,BX.Messenger.v2.Application,BX.Tasks.V2,BX.Tasks.V2.Component,BX.Vue3.Components,BX,BX.Vue3.Vuex,BX.UI.Vue3.Components,BX.UI.IconSet,BX.UI.IconSet,BX,BX.Tasks.V2.Const,BX.Tasks.V2.Component.Fields,BX.Tasks.V2.Lib,BX.Tasks.V2.Provider.Service);
//# sourceMappingURL=task-full-card.bundle.map.js