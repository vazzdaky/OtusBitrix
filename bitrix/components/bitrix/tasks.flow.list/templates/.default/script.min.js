this.BX=this.BX||{};this.BX.Tasks=this.BX.Tasks||{};(function(e,s,a,t,i,l,r,o,n,c,d,b,v,p,u){"use strict";let h=e=>e,P,F,L,m,H,f,y;var B=babelHelpers.classPrivateFieldLooseKey("rowId");var w=babelHelpers.classPrivateFieldLooseKey("changeLabel");var O=babelHelpers.classPrivateFieldLooseKey("renderPersonNode");class _{constructor(e){Object.defineProperty(this,O,{value:T});Object.defineProperty(this,w,{value:g});Object.defineProperty(this,B,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,B)[B]=e}changeAvatarsToEmpty(e){const s=e.map((e=>new Promise((s=>{v.Dom.addClass(e,"--icon");v.Event.bindOnce(e,"transitionend",(()=>{v.Dom.style(e,null);v.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,O)[O](),e);requestAnimationFrame((()=>{s()}))}))}))));return Promise.all(s)}async showAvatars(e){const s=e.map((e=>new Promise((s=>{v.Dom.removeClass(e,"--hidden");v.Event.bindOnce(e,"transitionend",(()=>{s()}))}))));return Promise.all(s)}async hideAvatars(e){const s=e.map((e=>new Promise((s=>{v.Dom.addClass(e,"--hidden");v.Event.bindOnce(e,"transitionend",(()=>{s(e)}))}))));return Promise.all(s)}renderHiddenEmptyAvatar(){return v.Tag.render(P||(P=h`
			<div class="tasks-flow__list-members-icon_element --icon --hidden --center">
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,O)[O]())}renderHiddenAvatar(e,s=""){if("src"in e.photo){return v.Tag.render(F||(F=h`
				<div
					class="tasks-flow__list-members-icon_element --hidden ${0}"
					style="background-image: url('${0}')"
				></div>
			`),s,encodeURI(e.photo.src))}const a="ui-icon ui-icon-common-user ui-icon-xs";return v.Tag.render(L||(L=h`
			<div
				class="tasks-flow__list-members-icon_element ${0} --hidden ${0}"
			>
				<i></i>
			</div>
		`),a,s)}async changeAvatarsToUser(e,s){return new Promise(((a,t)=>{e.forEach(((e,a)=>{const t=s[a];v.Dom.removeClass(e,["--icon","--count","--at-work"]);v.Dom.clean(e);if("src"in t.photo){v.Dom.style(e,"background-image",`url('${encodeURI(t.photo.src)}')`)}else{v.Dom.addClass(e,["ui-icon","ui-icon-common-user","ui-icon-xs"]);v.Dom.append(v.Tag.render(m||(m=h`<i></i>`)),e)}}));requestAnimationFrame((()=>{a()}))}))}changeAvatarToCounter(e,s,a=""){return new Promise(((t,i)=>{v.Dom.removeClass(e,["ui-icon","ui-icon-common-user","ui-icon-xs"]);v.Dom.addClass(e,["--count",a]);v.Dom.clean(e);v.Dom.style(e,null);v.Dom.append(v.Tag.render(H||(H=h`
				<span class="tasks-flow__warning-icon_element-plus">+</span>
			`)),e);v.Dom.append(v.Tag.render(f||(f=h`
				<span class="tasks-flow__warning-icon_element-number">${0}</span>
			`),parseInt(s,10)),e);requestAnimationFrame((()=>{t()}))}))}changeNodeAttributes(e,s,a,t){const i=s.querySelector(".tasks-flow__list-members_wrapper");const l=s.querySelector(".tasks-flow__list-members_info");const r=s.querySelector(".tasks-flow__list-members");v.Dom.attr(r,"data-total",a.total);v.Dom.attr(r,"data-subsequence",a.subsequence.join(","));if(t){v.Dom.removeClass(i,"--link");v.Dom.attr(i,"onclick",null);babelHelpers.classPrivateFieldLooseBase(this,w)[w](l,v.Loc.getMessage("TASKS_FLOW_LIST_NO_TASKS"),true)}else{v.Dom.addClass(i,"--link");i.setAttribute("onclick",`BX.Tasks.Flow.Grid.showTaskQueue('${babelHelpers.classPrivateFieldLooseBase(this,B)[B]}', '${e}', this)`);babelHelpers.classPrivateFieldLooseBase(this,w)[w](l,a.label)}}blinkAvatar(e){return new Promise((s=>{v.Event.bindOnce(e,"animationend",(()=>{v.Dom.removeClass(e,["--blink"]);s()}));v.Dom.addClass(e,["--blink"])}))}removeClassesWithoutAnimation(e,s){v.Dom.style(e,"transition","none");v.Dom.removeClass(e,s);e.offsetHeight;v.Dom.style(e,"transition","")}defineSubsequenceIndices(e,s){const a=e.length>=s.length?e:s;const t=e.length>=s.length?s:e;return a.reduce(((e,s,a)=>{if(t.includes(s)){e.presentIndices.push(a)}else{e.absentIndices.push(a)}return e}),{presentIndices:[],absentIndices:[]})}}function g(e,s,a=false){e.textContent=v.Text.encode(s);if(a){v.Dom.removeClass(e,"--link")}else{v.Dom.addClass(e,"--link")}}function T(){return v.Tag.render(y||(y=h`
			<div
				class="ui-icon-set --person"
				style="--ui-icon-set__icon-color: var(--ui-color-base-50);"
			></div>
		`))}class E{animate(e,s,a,t){const i=e.querySelector(".tasks-flow__list-members");const l=i.children;const r=i.childElementCount;const o={1:this.animateFromStateWithOneElement.bind(this,i,l,s,a),2:this.animateFromStateWithTwoElement.bind(this,i,l,s,a),3:this.animateFromStateWithThreeElement.bind(this,i,l,s,a),4:this.animateFromStateWithCounter.bind(this,i,l,s,a),default:this.skipAnimation.bind(this)};const n=o[r]||o.default;return n()}async animateFromStateWithOneElement(e,s,a,t){return Promise.resolve()}async animateFromStateWithTwoElement(e,s,a,t){return Promise.resolve()}async animateFromStateWithThreeElement(e,s,a,t){return Promise.resolve()}async animateFromStateWithCounter(e,s,a,t){return Promise.resolve()}skipAnimation(){return Promise.resolve()}}var C=babelHelpers.classPrivateFieldLooseKey("animationHelper");var S=babelHelpers.classPrivateFieldLooseKey("moveAvatarsToCenter");var I=babelHelpers.classPrivateFieldLooseKey("moveAvatarsToDefaultPosition");class A extends E{constructor(e){super(e);Object.defineProperty(this,I,{value:j});Object.defineProperty(this,S,{value:K});Object.defineProperty(this,C,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,C)[C]=e}async animateFromStateWithOneElement(e,s,a,t){console.log("EmptyState");const i=e.lastElementChild;v.Dom.prepend(babelHelpers.classPrivateFieldLooseBase(this,C)[C].renderHiddenEmptyAvatar(),e);v.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,C)[C].renderHiddenEmptyAvatar(),e);return new Promise((e=>{requestAnimationFrame((()=>{babelHelpers.classPrivateFieldLooseBase(this,S)[S]([...s]);babelHelpers.classPrivateFieldLooseBase(this,C)[C].changeAvatarsToEmpty([i]).then((()=>{babelHelpers.classPrivateFieldLooseBase(this,I)[I]([...s]);e()}))}))}))}async animateFromStateWithTwoElement(e,s,a,t){const i=s[0];const l=s[2];const r=babelHelpers.classPrivateFieldLooseBase(this,C)[C].renderHiddenEmptyAvatar();v.Dom.prepend(r,e);return requestAnimationFrame((()=>{babelHelpers.classPrivateFieldLooseBase(this,S)[S]([...s]);return babelHelpers.classPrivateFieldLooseBase(this,C)[C].changeAvatarsToEmpty([i,l]).then((()=>{babelHelpers.classPrivateFieldLooseBase(this,I)[I]([...s])}))}))}async animateFromStateWithThreeElement(e,s,a,t){babelHelpers.classPrivateFieldLooseBase(this,S)[S]([...s]);return babelHelpers.classPrivateFieldLooseBase(this,C)[C].changeAvatarsToEmpty([...s]).then((()=>{babelHelpers.classPrivateFieldLooseBase(this,I)[I]([...s])}))}}function K(e){e.forEach((e=>{v.Dom.addClass(e,"--center")}))}function j(e){e.forEach((e=>{v.Dom.removeClass(e,["--center","--hidden"])}))}var k=babelHelpers.classPrivateFieldLooseKey("animationHelper");class D extends E{constructor(e){super(e);Object.defineProperty(this,k,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,k)[k]=e}async animateFromStateWithOneElement(e,s,a,t){const i=s[0];return babelHelpers.classPrivateFieldLooseBase(this,k)[k].changeAvatarsToUser([i],a).then((()=>{babelHelpers.classPrivateFieldLooseBase(this,k)[k].blinkAvatar(i)}))}async animateFromStateWithTwoElement(e,s,a,t){const i=s[0];const l=s[1];const r=babelHelpers.classPrivateFieldLooseBase(this,k)[k].renderHiddenAvatar(a[0],"--invisible");v.Dom.prepend(r,e);return new Promise(((e,s)=>{v.Event.bindOnce(l,"transitionend",(()=>{v.Dom.remove(i);v.Dom.remove(l);v.Event.bindOnce(r,"transitionend",(()=>{babelHelpers.classPrivateFieldLooseBase(this,k)[k].blinkAvatar(r);e()}));v.Dom.removeClass(r,["--hidden","--invisible"])}));v.Dom.addClass(i,"--tiny-right");v.Dom.addClass(i,"--hidden");v.Dom.addClass(l,"--tiny-left");v.Dom.addClass(l,"--hidden")}))}async animateFromStateWithThreeElement(e,s,a,t){const i=s[0];const l=s[1];const r=s[2];v.Dom.addClass(i,["--center"]);v.Dom.addClass(r,["--center"]);return babelHelpers.classPrivateFieldLooseBase(this,k)[k].changeAvatarsToUser([l],a).then((()=>{v.Event.bindOnce(r,"transitionend",(()=>{babelHelpers.classPrivateFieldLooseBase(this,k)[k].blinkAvatar(l);v.Dom.remove(i);v.Dom.remove(r)}));v.Dom.addClass(r,"--hidden")}))}}var W=babelHelpers.classPrivateFieldLooseKey("animationHelper");class M extends E{constructor(e){super(e);Object.defineProperty(this,W,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,W)[W]=e}animateFromStateWithOneElement(e,s,a,t){return new Promise((t=>{const i=s[0];const l=babelHelpers.classPrivateFieldLooseBase(this,W)[W].renderHiddenAvatar(a[0],"--start-invisible");v.Dom.prepend(l,e);requestAnimationFrame((()=>{v.Event.bindOnce(i,"transitionend",(()=>{babelHelpers.classPrivateFieldLooseBase(this,W)[W].blinkAvatar(l).then((()=>{babelHelpers.classPrivateFieldLooseBase(this,W)[W].removeClassesWithoutAnimation(l,["--start-invisible","--tiny-left"]);babelHelpers.classPrivateFieldLooseBase(this,W)[W].removeClassesWithoutAnimation(i,["--tiny-right"]);t()}))}));v.Dom.removeClass(l,["--hidden"]);v.Dom.addClass(l,["--tiny-left"]);v.Dom.addClass(i,["--tiny-right"])}))}))}async animateFromStateWithTwoElement(e,s,a,t){return babelHelpers.classPrivateFieldLooseBase(this,W)[W].changeAvatarsToUser([...s],a)}async animateFromStateWithThreeElement(e,s,a,t){const i=e.dataset.subsequence.split(",").map(Number);const l=t.subsequence;const{presentIndices:r,absentIndices:o}=babelHelpers.classPrivateFieldLooseBase(this,W)[W].defineSubsequenceIndices(i,l);const n=(e,s)=>babelHelpers.classPrivateFieldLooseBase(this,W)[W].hideAvatars(e).then((()=>{e.forEach((e=>{v.Dom.remove(e)}));s()}));const c={"1,2":e=>new Promise((a=>{const t=s[1];const i=s[2];v.Event.bindOnce(i,"transitionend",(()=>{babelHelpers.classPrivateFieldLooseBase(this,W)[W].removeClassesWithoutAnimation(t,["--tiny-left"]);babelHelpers.classPrivateFieldLooseBase(this,W)[W].removeClassesWithoutAnimation(i,["--tiny-left"])}));v.Dom.addClass(t,"--tiny-left");v.Dom.addClass(i,"--tiny-left");n(e,a)})),"0,1":e=>new Promise((a=>{const t=s[0];const i=s[1];v.Event.bindOnce(t,"transitionend",(()=>{babelHelpers.classPrivateFieldLooseBase(this,W)[W].removeClassesWithoutAnimation(i,["--tiny-right"]);babelHelpers.classPrivateFieldLooseBase(this,W)[W].removeClassesWithoutAnimation(t,["--tiny-right"])}));v.Dom.addClass(i,"--tiny-right");v.Dom.addClass(t,"--tiny-right");n(e,a)})),"0,2":e=>new Promise((a=>{const t=s[0];const i=s[2];v.Event.bindOnce(i,"transitionend",(()=>{babelHelpers.classPrivateFieldLooseBase(this,W)[W].removeClassesWithoutAnimation(t,["--tiny-right"]);babelHelpers.classPrivateFieldLooseBase(this,W)[W].removeClassesWithoutAnimation(i,["--tiny-left"])}));v.Dom.addClass(t,"--tiny-right");v.Dom.addClass(i,"--tiny-left");n(e,a)})),default:()=>Promise.resolve()};const d=r.join(",");const b=c[d]||c.default;const p=[];o.forEach((e=>{p.push(s[e])}));return b(p)}}var N=babelHelpers.classPrivateFieldLooseKey("animationHelper");class R extends E{constructor(e){super(e);Object.defineProperty(this,N,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,N)[N]=e}async animateFromStateWithTwoElement(e,s,a,t){return new Promise((t=>{const i=s[0];const l=s[1];const r=babelHelpers.classPrivateFieldLooseBase(this,N)[N].renderHiddenAvatar(a[0],"--start-invisible");v.Dom.prepend(r,e);requestAnimationFrame((()=>{v.Event.bindOnce(i,"transitionend",(()=>{babelHelpers.classPrivateFieldLooseBase(this,N)[N].blinkAvatar(r).then((()=>{babelHelpers.classPrivateFieldLooseBase(this,N)[N].removeClassesWithoutAnimation(r,["--start-invisible","--tiny-left"]);babelHelpers.classPrivateFieldLooseBase(this,N)[N].removeClassesWithoutAnimation(i,["--tiny-right"]);babelHelpers.classPrivateFieldLooseBase(this,N)[N].removeClassesWithoutAnimation(l,["--tiny-right"]);t()}))}));v.Dom.removeClass(r,["--hidden"]);v.Dom.addClass(r,["--tiny-left"]);v.Dom.addClass(i,["--tiny-right"]);v.Dom.addClass(l,["--tiny-right"])}))}))}async animateFromStateWithThreeElement(e,s,a,t){return babelHelpers.classPrivateFieldLooseBase(this,N)[N].changeAvatarsToUser([...s],a)}async animateFromStateWithCounter(e,s,a,t){await babelHelpers.classPrivateFieldLooseBase(this,N)[N].hideAvatars([...s]);await babelHelpers.classPrivateFieldLooseBase(this,N)[N].changeAvatarsToUser([...s],a).then((()=>babelHelpers.classPrivateFieldLooseBase(this,N)[N].showAvatars([...s])));return Promise.resolve()}}var U=babelHelpers.classPrivateFieldLooseKey("animationHelper");var X=babelHelpers.classPrivateFieldLooseKey("counter");var x=babelHelpers.classPrivateFieldLooseKey("statusId");class q extends E{constructor(e){super(e);Object.defineProperty(this,U,{writable:true,value:void 0});Object.defineProperty(this,X,{writable:true,value:void 0});Object.defineProperty(this,x,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,U)[U]=e}animate(e,s,a,t){const i=99;const l=2;const r=a.total-l;babelHelpers.classPrivateFieldLooseBase(this,X)[X]=Math.min(r,i);babelHelpers.classPrivateFieldLooseBase(this,x)[x]=t;return super.animate(e,s,a,t)}async animateFromStateWithThreeElement(e,s,a,t){const i=s[0];const l=s[1];const r=s[2];const o=babelHelpers.classPrivateFieldLooseBase(this,U)[U].renderHiddenAvatar(a[0],"--invisible");const n=babelHelpers.classPrivateFieldLooseBase(this,U)[U].renderHiddenAvatar(a[1],"--invisible");v.Dom.prepend(n,e);v.Dom.prepend(o,e);v.Event.bindOnce(i,"transitionend",(()=>{v.Dom.remove(i);v.Dom.removeClass(o,["--invisible"])}));v.Event.bindOnce(l,"transitionend",(()=>{v.Dom.remove(l);v.Dom.removeClass(n,["--invisible"])}));v.Dom.removeClass(o,["--hidden"]);v.Dom.removeClass(n,["--hidden"]);v.Dom.addClass(i,["--right"]);v.Dom.addClass(l,["--right"]);const c=babelHelpers.classPrivateFieldLooseBase(this,x)[x]==="AT_WORK"?"--at-work":"";return babelHelpers.classPrivateFieldLooseBase(this,U)[U].changeAvatarToCounter(r,babelHelpers.classPrivateFieldLooseBase(this,X)[X],c).then((()=>{babelHelpers.classPrivateFieldLooseBase(this,U)[U].blinkAvatar(r)}))}}var Q=babelHelpers.classPrivateFieldLooseKey("animationHelper");class ${constructor(e){Object.defineProperty(this,Q,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]=new _(e)}async animate(e){const s={0:new A(babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]),1:new D(babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]),2:new M(babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]),3:new R(babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]),default:new q(babelHelpers.classPrivateFieldLooseBase(this,Q)[Q])};const a=async a=>{for(const[t,i]of a){const a=s[i.total]||s.default;const l=e.linkToNodes.get(t);const r=e.linkToQueueData.get(t);await a.animate(l,r,i,t).then((()=>{babelHelpers.classPrivateFieldLooseBase(this,Q)[Q].changeNodeAttributes(t,l,i,i.total===0)}))}};await a(e.newStateOfStatuses);return new Promise((e=>setTimeout(e,500)))}}var G=babelHelpers.classPrivateFieldLooseKey("grid");var V=babelHelpers.classPrivateFieldLooseKey("data");var Y=babelHelpers.classPrivateFieldLooseKey("rowId");var z=babelHelpers.classPrivateFieldLooseKey("animationManager");var J=babelHelpers.classPrivateFieldLooseKey("prepareData");var Z=babelHelpers.classPrivateFieldLooseKey("getNodes");var ee=babelHelpers.classPrivateFieldLooseKey("getNewStatuses");var se=babelHelpers.classPrivateFieldLooseKey("getCurrentState");var ae=babelHelpers.classPrivateFieldLooseKey("getNewState");var te=babelHelpers.classPrivateFieldLooseKey("getRow");var ie=babelHelpers.classPrivateFieldLooseKey("getCell");var le=babelHelpers.classPrivateFieldLooseKey("isValidSequence");var re=babelHelpers.classPrivateFieldLooseKey("statesAreEqual");var oe=babelHelpers.classPrivateFieldLooseKey("compareAndFilterStates");var ne=babelHelpers.classPrivateFieldLooseKey("removeDeletedKeys");class ce{constructor(e,s){Object.defineProperty(this,ne,{value:He});Object.defineProperty(this,oe,{value:me});Object.defineProperty(this,re,{value:Le});Object.defineProperty(this,le,{value:Fe});Object.defineProperty(this,ie,{value:Pe});Object.defineProperty(this,te,{value:he});Object.defineProperty(this,ae,{value:ue});Object.defineProperty(this,se,{value:pe});Object.defineProperty(this,ee,{value:ve});Object.defineProperty(this,Z,{value:be});Object.defineProperty(this,J,{value:de});Object.defineProperty(this,G,{writable:true,value:void 0});Object.defineProperty(this,V,{writable:true,value:void 0});Object.defineProperty(this,Y,{writable:true,value:void 0});Object.defineProperty(this,z,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,G)[G]=e;babelHelpers.classPrivateFieldLooseBase(this,V)[V]=s;babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]=parseInt(s.FLOW_ID,10);babelHelpers.classPrivateFieldLooseBase(this,z)[z]=new $(babelHelpers.classPrivateFieldLooseBase(this,Y)[Y])}start(){return new Promise(((e,s)=>{const a=babelHelpers.classPrivateFieldLooseBase(this,J)[J]();babelHelpers.classPrivateFieldLooseBase(this,z)[z].animate(a).then((()=>{e()})).catch((()=>{s()}))}))}}function de(){const e=new Map;const s=new Map;const a=new Map;const t=new Map;babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]().forEach(((s,t)=>{e.set(t,s);a.set(t,babelHelpers.classPrivateFieldLooseBase(this,se)[se](s))}));babelHelpers.classPrivateFieldLooseBase(this,ee)[ee]().forEach(((e,a)=>{s.set(a,e.queue);t.set(a,babelHelpers.classPrivateFieldLooseBase(this,ae)[ae](e))}));babelHelpers.classPrivateFieldLooseBase(this,oe)[oe](a,t);babelHelpers.classPrivateFieldLooseBase(this,ne)[ne](t,e,s);return{linkToNodes:e,linkToQueueData:s,currentStateOfStatuses:a,newStateOfStatuses:t}}function be(){const e=new Map;const s=s=>{e.set(s,babelHelpers.classPrivateFieldLooseBase(this,ie)[ie](s))};if("newStatus"in babelHelpers.classPrivateFieldLooseBase(this,V)[V]){s(babelHelpers.classPrivateFieldLooseBase(this,V)[V].newStatus.id)}if("oldStatus"in babelHelpers.classPrivateFieldLooseBase(this,V)[V]){s(babelHelpers.classPrivateFieldLooseBase(this,V)[V].oldStatus.id)}return e}function ve(){const e=new Map;const s=s=>{e.set(s.id,s)};if("newStatus"in babelHelpers.classPrivateFieldLooseBase(this,V)[V]){s(babelHelpers.classPrivateFieldLooseBase(this,V)[V].newStatus)}if("oldStatus"in babelHelpers.classPrivateFieldLooseBase(this,V)[V]){s(babelHelpers.classPrivateFieldLooseBase(this,V)[V].oldStatus)}return e}function pe(e){const s=e.querySelector(".tasks-flow__list-members");const a=e.querySelector(".tasks-flow__list-members_info");const t=babelHelpers.classPrivateFieldLooseBase(this,le)[le](s.dataset.subsequence)?s.dataset.subsequence.split(",").map(Number):[];return{total:parseInt(s.dataset.total,10),subsequence:t,label:a.textContent.trim()}}function ue(e){return{total:parseInt(e.total,10),subsequence:e.queueSubsequence,label:e.date}}function he(){return babelHelpers.classPrivateFieldLooseBase(this,G)[G].getRows().getById(babelHelpers.classPrivateFieldLooseBase(this,Y)[Y])}function Pe(e){return babelHelpers.classPrivateFieldLooseBase(this,te)[te](babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]).getCellById(e)}function Fe(e){const s=/^\d+(,\d+)*$/;return s.test(e)}function Le(e,s){if(e.total!==s.total){return false}if(e.subsequence.length!==s.subsequence.length){return false}for(let a=0;a<e.subsequence.length;a++){if(e.subsequence[a]!==s.subsequence[a]){return false}}return true}function me(e,s){for(const[a,t]of e){if(s.has(a)&&babelHelpers.classPrivateFieldLooseBase(this,re)[re](t,s.get(a))){e.delete(a);s.delete(a)}}}function He(e,s,a){for(const a of s.keys()){if(!e.has(a)){s.delete(a)}}for(const s of a.keys()){if(!e.has(s)){a.delete(s)}}}var fe=babelHelpers.classPrivateFieldLooseKey("params");var ye=babelHelpers.classPrivateFieldLooseKey("grid");var Be=babelHelpers.classPrivateFieldLooseKey("instantPullHandlers");var we=babelHelpers.classPrivateFieldLooseKey("delayedPullFlowHandlers");var Oe=babelHelpers.classPrivateFieldLooseKey("delayedPullTasksHandlers");var _e=babelHelpers.classPrivateFieldLooseKey("clueMyTasks");var ge=babelHelpers.classPrivateFieldLooseKey("clueCopilotAdvice");var Te=babelHelpers.classPrivateFieldLooseKey("rowIdForMyTasksAhaMoment");var Ee=babelHelpers.classPrivateFieldLooseKey("notificationList");var Ce=babelHelpers.classPrivateFieldLooseKey("addedFlowId");var Se=babelHelpers.classPrivateFieldLooseKey("loadItemsDelay");var Ie=babelHelpers.classPrivateFieldLooseKey("reload");var Ae=babelHelpers.classPrivateFieldLooseKey("updateRow");var Ke=babelHelpers.classPrivateFieldLooseKey("removeRow");var je=babelHelpers.classPrivateFieldLooseKey("moveRowToFirstPosition");var ke=babelHelpers.classPrivateFieldLooseKey("highlightRow");var De=babelHelpers.classPrivateFieldLooseKey("isFirstRow");var We=babelHelpers.classPrivateFieldLooseKey("isRowExist");var Me=babelHelpers.classPrivateFieldLooseKey("isFirstPage");var Ne=babelHelpers.classPrivateFieldLooseKey("getRowById");var Re=babelHelpers.classPrivateFieldLooseKey("getFirstPinnedRow");var Ue=babelHelpers.classPrivateFieldLooseKey("getFirstUnpinnedRow");var Xe=babelHelpers.classPrivateFieldLooseKey("getCell");var xe=babelHelpers.classPrivateFieldLooseKey("subscribeToPull");var qe=babelHelpers.classPrivateFieldLooseKey("subscribeToGridEvents");var Qe=babelHelpers.classPrivateFieldLooseKey("onBeforePull");var $e=babelHelpers.classPrivateFieldLooseKey("onPull");var Ge=babelHelpers.classPrivateFieldLooseKey("onBeforeQueueExecute");var Ve=babelHelpers.classPrivateFieldLooseKey("onQueueExecute");var Ye=babelHelpers.classPrivateFieldLooseKey("executeQueueAnimation");var ze=babelHelpers.classPrivateFieldLooseKey("processItemAnimation");var Je=babelHelpers.classPrivateFieldLooseKey("getMapIds");var Ze=babelHelpers.classPrivateFieldLooseKey("onReload");var es=babelHelpers.classPrivateFieldLooseKey("executeQueue");var ss=babelHelpers.classPrivateFieldLooseKey("commentReadAll");var as=babelHelpers.classPrivateFieldLooseKey("onFlowAdd");var ts=babelHelpers.classPrivateFieldLooseKey("onFlowUpdate");var is=babelHelpers.classPrivateFieldLooseKey("onFlowPinned");var ls=babelHelpers.classPrivateFieldLooseKey("onFlowDelete");var rs=babelHelpers.classPrivateFieldLooseKey("afterRowUpdated");var os=babelHelpers.classPrivateFieldLooseKey("recognizeFlowId");var ns=babelHelpers.classPrivateFieldLooseKey("recognizeTaskId");var cs=babelHelpers.classPrivateFieldLooseKey("getEntityIds");var ds=babelHelpers.classPrivateFieldLooseKey("identifyFlowItems");var bs=babelHelpers.classPrivateFieldLooseKey("identifyTaskItems");var vs=babelHelpers.classPrivateFieldLooseKey("convertTaskItems");var ps=babelHelpers.classPrivateFieldLooseKey("uniqueItems");var us=babelHelpers.classPrivateFieldLooseKey("findTaskAddAction");var hs=babelHelpers.classPrivateFieldLooseKey("findTaskRemoveAction");var Ps=babelHelpers.classPrivateFieldLooseKey("addTaskRemoveItemToMap");var Fs=babelHelpers.classPrivateFieldLooseKey("isCurrentUserCreatorOfTheTask");var Ls=babelHelpers.classPrivateFieldLooseKey("showAhaOnMyTasksColumn");var ms=babelHelpers.classPrivateFieldLooseKey("showAhaCopilotAdvice");var Hs=babelHelpers.classPrivateFieldLooseKey("getBindElementForAhaOnCell");var fs=babelHelpers.classPrivateFieldLooseKey("consoleError");var ys=babelHelpers.classPrivateFieldLooseKey("clearAnalyticsParams");var Bs=babelHelpers.classPrivateFieldLooseKey("activateHint");var ws=babelHelpers.classPrivateFieldLooseKey("highlightAddedFlow");var Os=babelHelpers.classPrivateFieldLooseKey("showFlowCreationWizard");var _s=babelHelpers.classPrivateFieldLooseKey("colorPinnedRows");var gs=babelHelpers.classPrivateFieldLooseKey("isPinned");class Ts{constructor(e){Object.defineProperty(this,gs,{value:wa});Object.defineProperty(this,_s,{value:Ba});Object.defineProperty(this,Os,{value:ya});Object.defineProperty(this,ws,{value:fa});Object.defineProperty(this,Bs,{value:Ha});Object.defineProperty(this,ys,{value:ma});Object.defineProperty(this,fs,{value:La});Object.defineProperty(this,Hs,{value:Fa});Object.defineProperty(this,ms,{value:Pa});Object.defineProperty(this,Ls,{value:ha});Object.defineProperty(this,Fs,{value:ua});Object.defineProperty(this,Ps,{value:pa});Object.defineProperty(this,hs,{value:va});Object.defineProperty(this,us,{value:ba});Object.defineProperty(this,ps,{value:da});Object.defineProperty(this,vs,{value:ca});Object.defineProperty(this,bs,{value:na});Object.defineProperty(this,ds,{value:oa});Object.defineProperty(this,cs,{value:ra});Object.defineProperty(this,ns,{value:la});Object.defineProperty(this,os,{value:ia});Object.defineProperty(this,rs,{value:ta});Object.defineProperty(this,ls,{value:aa});Object.defineProperty(this,is,{value:sa});Object.defineProperty(this,ts,{value:ea});Object.defineProperty(this,as,{value:Zs});Object.defineProperty(this,ss,{value:Js});Object.defineProperty(this,es,{value:zs});Object.defineProperty(this,Ze,{value:Ys});Object.defineProperty(this,Je,{value:Vs});Object.defineProperty(this,ze,{value:Gs});Object.defineProperty(this,Ye,{value:$s});Object.defineProperty(this,Ve,{value:Qs});Object.defineProperty(this,Ge,{value:qs});Object.defineProperty(this,$e,{value:xs});Object.defineProperty(this,Qe,{value:Xs});Object.defineProperty(this,qe,{value:Us});Object.defineProperty(this,xe,{value:Rs});Object.defineProperty(this,Xe,{value:Ns});Object.defineProperty(this,Ue,{value:Ms});Object.defineProperty(this,Re,{value:Ws});Object.defineProperty(this,Ne,{value:Ds});Object.defineProperty(this,Me,{value:ks});Object.defineProperty(this,We,{value:js});Object.defineProperty(this,De,{value:Ks});Object.defineProperty(this,ke,{value:As});Object.defineProperty(this,je,{value:Is});Object.defineProperty(this,Ke,{value:Ss});Object.defineProperty(this,Ae,{value:Cs});Object.defineProperty(this,Ie,{value:Es});Object.defineProperty(this,fe,{writable:true,value:void 0});Object.defineProperty(this,ye,{writable:true,value:void 0});Object.defineProperty(this,Be,{writable:true,value:void 0});Object.defineProperty(this,we,{writable:true,value:void 0});Object.defineProperty(this,Oe,{writable:true,value:void 0});Object.defineProperty(this,_e,{writable:true,value:null});Object.defineProperty(this,ge,{writable:true,value:null});Object.defineProperty(this,Te,{writable:true,value:null});Object.defineProperty(this,Ee,{writable:true,value:new Set});Object.defineProperty(this,Ce,{writable:true,value:null});Object.defineProperty(this,Se,{writable:true,value:500});babelHelpers.classPrivateFieldLooseBase(this,fe)[fe]=e;babelHelpers.classPrivateFieldLooseBase(this,ye)[ye]=BX.Main.gridManager.getById(babelHelpers.classPrivateFieldLooseBase(this,fe)[fe].gridId).instance;babelHelpers.classPrivateFieldLooseBase(this,Be)[Be]={comment_read_all:babelHelpers.classPrivateFieldLooseBase(this,ss)[ss],flow_add:babelHelpers.classPrivateFieldLooseBase(this,as)[as],flow_delete:babelHelpers.classPrivateFieldLooseBase(this,ls)[ls],flow_pinned_for_user:babelHelpers.classPrivateFieldLooseBase(this,is)[is]};babelHelpers.classPrivateFieldLooseBase(this,we)[we]={flow_update:babelHelpers.classPrivateFieldLooseBase(this,ts)[ts]};babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe]={comment_add:babelHelpers.classPrivateFieldLooseBase(this,ts)[ts],task_add:babelHelpers.classPrivateFieldLooseBase(this,ts)[ts],task_update:babelHelpers.classPrivateFieldLooseBase(this,ts)[ts],task_view:babelHelpers.classPrivateFieldLooseBase(this,ts)[ts],task_remove:babelHelpers.classPrivateFieldLooseBase(this,ts)[ts]};babelHelpers.classPrivateFieldLooseBase(this,xe)[xe]();babelHelpers.classPrivateFieldLooseBase(this,qe)[qe]();babelHelpers.classPrivateFieldLooseBase(this,ys)[ys]();babelHelpers.classPrivateFieldLooseBase(this,Bs)[Bs]();babelHelpers.classPrivateFieldLooseBase(this,_s)[_s]();babelHelpers.classPrivateFieldLooseBase(this,Os)[Os]();babelHelpers.classPrivateFieldLooseBase(this,ms)[ms]()}activateFlow(e){v.ajax.runAction("tasks.flow.Flow.activate",{data:{flowId:e}}).then((()=>{}))}pinFlow(e,s=false){v.ajax.runAction("tasks.flow.Flow.pin",{data:{flowId:e}}).then((a=>{if(!s){const s=a.data?"TASKS_FLOW_LIST_FLOW_PINNED":"TASKS_FLOW_LIST_FLOW_UNPINNED";c.UI.Notification.Center.notify({content:BX.Loc.getMessage(s),actions:[{title:BX.Loc.getMessage("TASKS_FLOW_LIST_FLOW_PIN_CANCEL"),events:{click:(s,a)=>{this.pinFlow(e,true);a.close()}}}]})}}))}removeFlow(e){const s=new a.MessageBox({message:v.Loc.getMessage("TASKS_FLOW_LIST_CONFIRM_REMOVE_MESSAGE"),buttons:a.MessageBoxButtons.OK_CANCEL,okCaption:v.Loc.getMessage("TASKS_FLOW_LIST_CONFIRM_REMOVE_BUTTON"),popupOptions:{id:`tasks-flow-remove-confirm-${e}`},onOk:()=>{s.close();babelHelpers.classPrivateFieldLooseBase(this,Ae)[Ae](e,"remove")},onCancel:()=>{s.close()}});s.show()}showTeam(e,s){l.TeamPopup.showInstance({flowId:e,bindElement:s})}showTaskQueue(e,s,a){r.TaskQueue.showInstance({flowId:e,type:s,bindElement:a})}showFlowLimit(){t.FeaturePromotersRegistry.getPromoter({code:babelHelpers.classPrivateFieldLooseBase(this,fe)[fe].flowLimitCode}).show()}showNotificationHint(e,s){if(!babelHelpers.classPrivateFieldLooseBase(this,Ee)[Ee].has(e)){BX.UI.Notification.Center.notify({id:e,content:s,width:"auto"});babelHelpers.classPrivateFieldLooseBase(this,Ee)[Ee].add(e);d.EventEmitter.subscribeOnce("UI.Notification.Balloon:onClose",(s=>{const a=s.getTarget();if(a.getId()===e){babelHelpers.classPrivateFieldLooseBase(this,Ee)[Ee].delete(e)}}))}}showGuide(e){n.Manual.show({manualCode:"flows",urlParams:{utm_source:"portal",utm_medium:"referral"},analytics:{tool:"tasks",category:"flows",event:"flow_guide_view",c_section:"tasks",c_sub_section:"flows_grid",c_element:"guide_button",p1:`isDemo_${e}`}})}}function Es(){babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].reload(babelHelpers.classPrivateFieldLooseBase(this,fe)[fe].currentUrl)}function Cs(e,s){babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].updateRow(e,{action:s,currentPage:babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].getCurrentPage()},babelHelpers.classPrivateFieldLooseBase(this,fe)[fe].currentUrl,babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].bind(this))}function Ss(e){babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].removeRow(e)}function Is(e){return new Promise((s=>{const a=babelHelpers.classPrivateFieldLooseBase(this,Ne)[Ne](e);const t=babelHelpers.classPrivateFieldLooseBase(this,gs)[gs](a.getNode())?babelHelpers.classPrivateFieldLooseBase(this,Re)[Re]():babelHelpers.classPrivateFieldLooseBase(this,Ue)[Ue]();babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].getRows().insertBefore(e,t.getId());babelHelpers.classPrivateFieldLooseBase(this,ke)[ke](e).then((()=>{s()}))}))}function As(e){return new Promise((s=>{const a=babelHelpers.classPrivateFieldLooseBase(this,Ne)[Ne](e).getNode();v.Event.bindOnce(a,"animationend",(()=>{s();v.Dom.removeClass(a,"tasks-flow__list-flow-highlighted")}));v.Dom.addClass(a,"tasks-flow__list-flow-highlighted")}))}function Ks(e){const s=babelHelpers.classPrivateFieldLooseBase(this,Ne)[Ne](e);if(babelHelpers.classPrivateFieldLooseBase(this,gs)[gs](s.getNode())){const s=babelHelpers.classPrivateFieldLooseBase(this,Re)[Re]();return parseInt(s==null?void 0:s.getId(),10)===e}const a=babelHelpers.classPrivateFieldLooseBase(this,Ue)[Ue]();return parseInt(a==null?void 0:a.getId(),10)===e}function js(e){return babelHelpers.classPrivateFieldLooseBase(this,Ne)[Ne](e)!==null}function ks(){return babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].getCurrentPage()===1}function Ds(e){return babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].getRows().getById(e)}function Ws(){const e=babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].getRows().getBodyChild();return e.find((e=>babelHelpers.classPrivateFieldLooseBase(this,gs)[gs](e.getNode())))}function Ms(){const e=babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].getRows().getBodyChild();return e.find((e=>!babelHelpers.classPrivateFieldLooseBase(this,gs)[gs](e.getNode())))}function Ns(e,s){return babelHelpers.classPrivateFieldLooseBase(this,Ne)[Ne](e).getCellById(s)}function Rs(){new i.QueueManager({moduleId:"tasks",userId:babelHelpers.classPrivateFieldLooseBase(this,fe)[fe].currentUserId,config:{loadItemsDelay:babelHelpers.classPrivateFieldLooseBase(this,Se)[Se]},additionalData:{},events:{onBeforePull:e=>{babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe](e)},onPull:e=>{babelHelpers.classPrivateFieldLooseBase(this,$e)[$e](e)}},callbacks:{onBeforeQueueExecute:e=>babelHelpers.classPrivateFieldLooseBase(this,Ge)[Ge](e),onQueueExecute:e=>babelHelpers.classPrivateFieldLooseBase(this,Ve)[Ve](e),onReload:()=>{babelHelpers.classPrivateFieldLooseBase(this,Ze)[Ze]()}}})}function Us(){d.EventEmitter.subscribe("Grid::updated",(()=>{babelHelpers.classPrivateFieldLooseBase(this,Bs)[Bs]();babelHelpers.classPrivateFieldLooseBase(this,ws)[ws]();babelHelpers.classPrivateFieldLooseBase(this,_s)[_s]()}))}function Xs(e){const{pullData:{command:s,params:a}}=e.data;if(babelHelpers.classPrivateFieldLooseBase(this,Be)[Be][s]){const e=babelHelpers.classPrivateFieldLooseBase(this,os)[os](a);babelHelpers.classPrivateFieldLooseBase(this,Be)[Be][s].apply(this,[a,e])}}function xs(e){const{pullData:{command:s,params:a},promises:t}=e.data;if(Object.keys(babelHelpers.classPrivateFieldLooseBase(this,we)[we]).includes(s)){const e=babelHelpers.classPrivateFieldLooseBase(this,os)[os](a);if(e){t.push(Promise.resolve({data:{id:e,action:s,actionParams:a}}))}}if(Object.keys(babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe]).includes(s)){const e=babelHelpers.classPrivateFieldLooseBase(this,ns)[ns](a);if(e){t.push(Promise.resolve({data:{id:e,action:s,actionParams:a}}))}}}function qs(e){return Promise.resolve()}async function Qs(e){const s=babelHelpers.classPrivateFieldLooseBase(this,ds)[ds](e);const a=babelHelpers.classPrivateFieldLooseBase(this,bs)[bs](e);if(a.length===0){await babelHelpers.classPrivateFieldLooseBase(this,Ye)[Ye](s);return babelHelpers.classPrivateFieldLooseBase(this,es)[es](s,babelHelpers.classPrivateFieldLooseBase(this,we)[we])}let t=await babelHelpers.classPrivateFieldLooseBase(this,Je)[Je](babelHelpers.classPrivateFieldLooseBase(this,cs)[cs](a));const i=babelHelpers.classPrivateFieldLooseBase(this,hs)[hs](a);if(i){t=babelHelpers.classPrivateFieldLooseBase(this,Ps)[Ps](i,t)}const l=babelHelpers.classPrivateFieldLooseBase(this,vs)[vs](a,t);const r=babelHelpers.classPrivateFieldLooseBase(this,us)[us](l);if(r&&babelHelpers.classPrivateFieldLooseBase(this,Fs)[Fs](r)){const{data:{id:e}}=r;babelHelpers.classPrivateFieldLooseBase(this,Te)[Te]=e}const o=[...s,...l];await babelHelpers.classPrivateFieldLooseBase(this,Ye)[Ye](o);return babelHelpers.classPrivateFieldLooseBase(this,es)[es](babelHelpers.classPrivateFieldLooseBase(this,ps)[ps](o),{...babelHelpers.classPrivateFieldLooseBase(this,we)[we],...babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe]})}async function $s(e){const s=async()=>{for(const s of e){await babelHelpers.classPrivateFieldLooseBase(this,ze)[ze](s)}};await s();return Promise.resolve()}function Gs(e){const{data:{action:s,actionParams:a,id:t}}=e;return new Promise(((e,i)=>{if(s==="flow_update"&&"activity"in a&&babelHelpers.classPrivateFieldLooseBase(this,We)[We](t)){if(babelHelpers.classPrivateFieldLooseBase(this,Me)[Me]()&&!babelHelpers.classPrivateFieldLooseBase(this,De)[De](t)){babelHelpers.classPrivateFieldLooseBase(this,je)[je](t).then((()=>{new ce(babelHelpers.classPrivateFieldLooseBase(this,ye)[ye],a).start().then((()=>e())).catch((()=>e()))}))}else{new ce(babelHelpers.classPrivateFieldLooseBase(this,ye)[ye],a).start().then((()=>e())).catch((()=>e()))}}else{e()}}))}function Vs(e){return new Promise((s=>{v.ajax.runComponentAction("bitrix:tasks.flow.list","getMapIds",{mode:"class",data:{taskIds:e}}).then((e=>{s(v.Type.isArray(e.data)?{}:e.data)})).catch((e=>{babelHelpers.classPrivateFieldLooseBase(this,fs)[fs]("getMapIds",e)}))}))}function Ys(e){}function zs(e,s){return new Promise(((a,t)=>{e.forEach((e=>{const{data:{action:a,actionParams:t,id:i}}=e;if(s[a]){s[a].apply(this,[t,i])}}));a()}))}function Js(){babelHelpers.classPrivateFieldLooseBase(this,Ie)[Ie]()}function Zs(e,s){if(babelHelpers.classPrivateFieldLooseBase(this,We)[We](s)){return}if(babelHelpers.classPrivateFieldLooseBase(this,Me)[Me]()){babelHelpers.classPrivateFieldLooseBase(this,Ce)[Ce]=s;babelHelpers.classPrivateFieldLooseBase(this,Ie)[Ie]()}}function ea(e,s){if(!babelHelpers.classPrivateFieldLooseBase(this,We)[We](s)){return}babelHelpers.classPrivateFieldLooseBase(this,Ae)[Ae](s,"update")}function sa(e,s){if(!babelHelpers.classPrivateFieldLooseBase(this,We)[We](s)){return}babelHelpers.classPrivateFieldLooseBase(this,Ae)[Ae](s)}function aa(e,s){if(!babelHelpers.classPrivateFieldLooseBase(this,We)[We](s)){return}babelHelpers.classPrivateFieldLooseBase(this,Ke)[Ke](s)}function ta(e,s,a,t){if(babelHelpers.classPrivateFieldLooseBase(this,Te)[Te]){if(babelHelpers.classPrivateFieldLooseBase(this,_e)[_e]&&babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].isShown()){const e=babelHelpers.classPrivateFieldLooseBase(this,Hs)[Hs](babelHelpers.classPrivateFieldLooseBase(this,Te)[Te],"MY_TASKS",".tasks-flow__list-my-tasks span");if(e){babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].adjustPosition(e)}else{babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].close()}}if(babelHelpers.classPrivateFieldLooseBase(this,fe)[fe].isAhaShownOnMyTasksColumn===false&&babelHelpers.classPrivateFieldLooseBase(this,_e)[_e]===null){babelHelpers.classPrivateFieldLooseBase(this,Ls)[Ls](babelHelpers.classPrivateFieldLooseBase(this,Te)[Te])}}}function ia(e){if("FLOW_ID"in e){return parseInt(e.FLOW_ID,10)}return 0}function la(e){if("TASK_ID"in e){return parseInt(e.TASK_ID,10)}if("taskId"in e){return parseInt(e.taskId,10)}if("entityXmlId"in e&&e.entityXmlId.indexOf("TASK_")===0){return parseInt(e.entityXmlId.slice(5),10)}return 0}function ra(e){const s=[];e.forEach((e=>{const{data:{id:a}}=e;s.push(a)}));return s}function oa(e){return e.filter((e=>{const{data:{action:s}}=e;return Object.keys(babelHelpers.classPrivateFieldLooseBase(this,we)[we]).includes(s)}))}function na(e){return e.filter((e=>{const{data:{action:s}}=e;return Object.keys(babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe]).includes(s)}))}function ca(e,s){const a=[];e.forEach((e=>{const{data:{id:t}}=e;if(t in s){e.data.id=s[t];a.push(e)}}));return a}function da(e){const s=e.reduce(((e,s)=>{if(!e[s.data.id]){e[s.data.id]=s}return e}),{});return Object.values(s)}function ba(e){return e.find((e=>e.data.action==="task_add"))}function va(e){return e.find((e=>e.data.action==="task_remove"))}function pa(e,s){var a;s[e.data.id]=(a=e.data.actionParams)==null?void 0:a.FLOW_ID;return s}function ua(e){var s,a;const t=(s=e.data.actionParams)==null?void 0:(a=s.AFTER)==null?void 0:a.CREATED_BY;return parseInt(t,10)===parseInt(babelHelpers.classPrivateFieldLooseBase(this,fe)[fe].currentUserId,10)}function ha(e){const s=babelHelpers.classPrivateFieldLooseBase(this,Hs)[Hs](e,"MY_TASKS",".tasks-flow__list-my-tasks span");if(s){babelHelpers.classPrivateFieldLooseBase(this,_e)[_e]=new o.Clue({id:`my_tasks_${babelHelpers.classPrivateFieldLooseBase(this,fe)[fe].currentUserId}`,autoSave:true});babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].show(o.Clue.SPOT.MY_TASKS,s);babelHelpers.classPrivateFieldLooseBase(this,fe)[fe].isAhaShownOnMyTasksColumn=true}}function Pa(){if(babelHelpers.classPrivateFieldLooseBase(this,fe)[fe].isAhaShownCopilotAdvice){return}const e=babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].getRows().getBodyChild()[0];if(!e){return}const s=babelHelpers.classPrivateFieldLooseBase(this,Hs)[Hs](e.getId(),"EFFICIENCY",".tasks-flow__efficiency-copilot-icon-wrapper");if(s){babelHelpers.classPrivateFieldLooseBase(this,ge)[ge]=new o.Clue({id:"flow_copilot_advice",autoSave:true});babelHelpers.classPrivateFieldLooseBase(this,ge)[ge].show(o.Clue.SPOT.FLOW_COPILOT_ADVICE,s);babelHelpers.classPrivateFieldLooseBase(this,fe)[fe].isAhaShownCopilotAdvice=true}}function Fa(e,s,a){var t;return(t=babelHelpers.classPrivateFieldLooseBase(this,Xe)[Xe](e,s))==null?void 0:t.querySelector(a)}function La(e,s){console.error(`BX.Tasks.Flow.Grid: ${e} error`,s)}function ma(){const e=new v.Uri(window.location.href);const s=e.getQueryParam("ta_sec");if(s){e.removeQueryParam("ta_cat","ta_sec","ta_sub","ta_el","p1","p2","p3","p4","p5");window.history.replaceState(null,null,e.toString())}}function Ha(){BX.UI.Hint.init(babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].getContainer())}function fa(){if(babelHelpers.classPrivateFieldLooseBase(this,Ce)[Ce]!==null&&babelHelpers.classPrivateFieldLooseBase(this,We)[We](babelHelpers.classPrivateFieldLooseBase(this,Ce)[Ce])){babelHelpers.classPrivateFieldLooseBase(this,ke)[ke](babelHelpers.classPrivateFieldLooseBase(this,Ce)[Ce]);babelHelpers.classPrivateFieldLooseBase(this,Ce)[Ce]=null}}function ya(){const e=new v.Uri(window.location.href);const a=e.getQueryParam("demo_flow");if(a){e.removeQueryParam("demo_flow");window.history.replaceState(null,null,e.toString());s.EditForm.createInstance({flowId:a,demoFlow:"Y",isFeatureTrialable:babelHelpers.classPrivateFieldLooseBase(this,fe)[fe].isFeatureTrialable})}const t=e.getQueryParam("create_flow");if(t){e.removeQueryParam("create_flow");window.history.replaceState(null,null,e.toString());s.EditForm.createInstance({guideFlow:"Y",isFeatureTrialable:babelHelpers.classPrivateFieldLooseBase(this,fe)[fe].isFeatureTrialable})}}function Ba(){const e=babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].getRows().getRows();e.forEach((e=>{const s=e.getNode();if(babelHelpers.classPrivateFieldLooseBase(this,gs)[gs](s)){v.Dom.addClass(s,"tasks-flow_list_row_pinned")}else{v.Dom.removeClass(s,"tasks-flow_list_row_pinned")}}))}function wa(e){return v.Type.isDomNode(e.querySelector(".main-grid-cell-content-action-pin.main-grid-cell-content-action-active"))}var Oa=babelHelpers.classPrivateFieldLooseKey("props");var _a=babelHelpers.classPrivateFieldLooseKey("filter");var ga=babelHelpers.classPrivateFieldLooseKey("MIN_QUERY_LENGTH");var Ta=babelHelpers.classPrivateFieldLooseKey("fields");var Ea=babelHelpers.classPrivateFieldLooseKey("init");var Ca=babelHelpers.classPrivateFieldLooseKey("updateFields");var Sa=babelHelpers.classPrivateFieldLooseKey("unSubscribeToEvents");var Ia=babelHelpers.classPrivateFieldLooseKey("subscribeToEvents");var Aa=babelHelpers.classPrivateFieldLooseKey("inputFilterHandler");var Ka=babelHelpers.classPrivateFieldLooseKey("applyFilterHandler");var ja=babelHelpers.classPrivateFieldLooseKey("counterClickHandler");var ka=babelHelpers.classPrivateFieldLooseKey("toggleByField");var Da=babelHelpers.classPrivateFieldLooseKey("isFilteredByFieldValue");var Wa=babelHelpers.classPrivateFieldLooseKey("isFilteredByField");var Ma=babelHelpers.classPrivateFieldLooseKey("setActive");class Na{constructor(e){Object.defineProperty(this,Ma,{value:za});Object.defineProperty(this,Wa,{value:Ya});Object.defineProperty(this,Da,{value:Va});Object.defineProperty(this,ka,{value:Ga});Object.defineProperty(this,ja,{value:$a});Object.defineProperty(this,Ka,{value:Qa});Object.defineProperty(this,Aa,{value:qa});Object.defineProperty(this,Ia,{value:xa});Object.defineProperty(this,Sa,{value:Xa});Object.defineProperty(this,Ca,{value:Ua});Object.defineProperty(this,Ea,{value:Ra});Object.defineProperty(this,Oa,{writable:true,value:void 0});Object.defineProperty(this,_a,{writable:true,value:void 0});Object.defineProperty(this,ga,{writable:true,value:3});Object.defineProperty(this,Ta,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,Oa)[Oa]=e;babelHelpers.classPrivateFieldLooseBase(this,Ea)[Ea]()}hasFilteredFields(){const e=babelHelpers.classPrivateFieldLooseBase(this,_a)[_a].getFilterFieldsValues();const s=Object.values(e);for(const e of s){if(this.isArrayFieldFiller(e)||this.isStringFieldFilled(e)){return true}}return false}isFilterActive(){const e=!["default_filter","tmp_filter"].includes(babelHelpers.classPrivateFieldLooseBase(this,_a)[_a].getPreset().getCurrentPresetId());const s=!this.isSearchEmpty();const a=this.hasFilteredFields();return e||s||a}isArrayFieldFiller(e){return v.Type.isArrayFilled(e)}isStringFieldFilled(e){return e!=="NONE"&&v.Type.isStringFilled(e)}isSearchEmpty(){const e=babelHelpers.classPrivateFieldLooseBase(this,_a)[_a].getSearch().getSearchString();return!e||e.length<babelHelpers.classPrivateFieldLooseBase(this,ga)[ga]}}function Ra(){babelHelpers.classPrivateFieldLooseBase(this,_a)[_a]=BX.Main.filterManager.getById(babelHelpers.classPrivateFieldLooseBase(this,Oa)[Oa].filterId);babelHelpers.classPrivateFieldLooseBase(this,Ca)[Ca]();babelHelpers.classPrivateFieldLooseBase(this,Ia)[Ia]()}function Ua(){babelHelpers.classPrivateFieldLooseBase(this,Ta)[Ta]=babelHelpers.classPrivateFieldLooseBase(this,_a)[_a].getFilterFieldsValues()}function Xa(){d.EventEmitter.unsubscribe("BX.Filter.Search:input",babelHelpers.classPrivateFieldLooseBase(this,Aa)[Aa].bind(this));d.EventEmitter.unsubscribe("BX.Main.Filter:apply",babelHelpers.classPrivateFieldLooseBase(this,Ka)[Ka].bind(this));d.EventEmitter.unsubscribe("Tasks.Toolbar:onItem",babelHelpers.classPrivateFieldLooseBase(this,ja)[ja].bind(this))}function xa(){d.EventEmitter.subscribe("BX.Filter.Search:input",babelHelpers.classPrivateFieldLooseBase(this,Aa)[Aa].bind(this));d.EventEmitter.subscribe("BX.Main.Filter:apply",babelHelpers.classPrivateFieldLooseBase(this,Ka)[Ka].bind(this));d.EventEmitter.subscribe("Tasks.Toolbar:onItem",babelHelpers.classPrivateFieldLooseBase(this,ja)[ja].bind(this))}function qa(){babelHelpers.classPrivateFieldLooseBase(this,Ma)[Ma](this.isFilterActive())}function Qa(){babelHelpers.classPrivateFieldLooseBase(this,Ca)[Ca]()}function $a(e){const s=e.getData();if(s.counter&&s.counter.filter){babelHelpers.classPrivateFieldLooseBase(this,ka)[ka]({[s.counter.filterField]:s.counter.filterValue})}}function Ga(e){const s=Object.keys(e)[0];const a=e[s];if(!babelHelpers.classPrivateFieldLooseBase(this,Da)[Da](s,a)){babelHelpers.classPrivateFieldLooseBase(this,_a)[_a].getApi().extendFilter({[s]:a});return}babelHelpers.classPrivateFieldLooseBase(this,_a)[_a].getFilterFields().forEach((e=>{if(e.getAttribute("data-name")===s){babelHelpers.classPrivateFieldLooseBase(this,_a)[_a].getFields().deleteField(e)}}));babelHelpers.classPrivateFieldLooseBase(this,_a)[_a].getSearch().apply()}function Va(e,s){return babelHelpers.classPrivateFieldLooseBase(this,Wa)[Wa](e)&&babelHelpers.classPrivateFieldLooseBase(this,Ta)[Ta][e]===s}function Ya(e){if(!Object.keys(babelHelpers.classPrivateFieldLooseBase(this,Ta)[Ta]).includes(e)){return false}if(v.Type.isArray(babelHelpers.classPrivateFieldLooseBase(this,Ta)[Ta][e])){return babelHelpers.classPrivateFieldLooseBase(this,Ta)[Ta][e].length>0}return babelHelpers.classPrivateFieldLooseBase(this,Ta)[Ta][e]!==""}function za(e){const s=babelHelpers.classPrivateFieldLooseBase(this,_a)[_a].popupBindElement;if(e){v.Dom.removeClass(s,"main-ui-filter-default-applied");v.Dom.addClass(s,"main-ui-filter-search--showed")}else{v.Dom.addClass(s,"main-ui-filter-default-applied");v.Dom.removeClass(s,"main-ui-filter-search--showed")}}var Ja=babelHelpers.classPrivateFieldLooseKey("id");var Za=babelHelpers.classPrivateFieldLooseKey("flowId");var et=babelHelpers.classPrivateFieldLooseKey("dashboards");var st=babelHelpers.classPrivateFieldLooseKey("target");var at=babelHelpers.classPrivateFieldLooseKey("getMenuItems");class tt{constructor(e){Object.defineProperty(this,at,{value:it});Object.defineProperty(this,Ja,{writable:true,value:void 0});Object.defineProperty(this,Za,{writable:true,value:void 0});Object.defineProperty(this,et,{writable:true,value:void 0});Object.defineProperty(this,st,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,et)[et]=Object.values(e.dashboards);babelHelpers.classPrivateFieldLooseBase(this,st)[st]=e.target;babelHelpers.classPrivateFieldLooseBase(this,Za)[Za]=Number(e.flowId);babelHelpers.classPrivateFieldLooseBase(this,Ja)[Ja]=`tasks-flow-bi-analytics-menu_${babelHelpers.classPrivateFieldLooseBase(this,Za)[Za]}`}static create(e){return new tt(e)}openMenu(){const e=p.MenuManager.create({id:babelHelpers.classPrivateFieldLooseBase(this,Ja)[Ja],bindElement:babelHelpers.classPrivateFieldLooseBase(this,st)[st],items:babelHelpers.classPrivateFieldLooseBase(this,at)[at](),cacheable:false});e.show()}openFirstDashboard(){const e=babelHelpers.classPrivateFieldLooseBase(this,et)[et][0];if(e){window.open(e.url,"_blank")}}}function it(){const e=[];babelHelpers.classPrivateFieldLooseBase(this,et)[et].forEach((s=>{e.push({tabId:s.id,text:s.title,onclick:()=>{window.open(s.url,"_blank")}})}));return e}let lt=e=>e,rt;const ot=Object.freeze({NotEnoughTasks:"notEnoughTasks",UnexpectedError:"unexpectedError",AdviceFetching:"adviceFetching"});class nt{static show(e,s=null){const a=this.getMessagesByErrorType(s);const{root:t,exampleLink:i}=v.Tag.render(rt||(rt=lt`
			<div class="tasks-flow__copilot-advice-error-popup">
				<div class="tasks-flow__copilot-advice-error-popup-title">
					<span class="tasks-flow__copilot-advice-error-popup-icon ui-icon-set --copilot-ai"/>
					<span class="tasks-flow__copilot-advice-error-popup-title-text">
						${0}
					</span>
				</div>
				<div class="tasks-flow__copilot-advice-error-popup-description">
					${0}
				</div>
				<div class="tasks-flow__copilot-advice-error-popup-example">
					<span class="tasks-flow__copilot-advice-error-popup-example-text" ref="exampleLink">
						${0}
					</span>
				</div>
			</div>
		`),v.Loc.getMessage(a.titleCode),v.Loc.getMessage(a.descriptionCode),v.Loc.getMessage("TASKS_FLOW_LIST_COPILOT_NOT_ENOUGH_TASKS_POPUP_SHOW_EXAMPLE"));const l=new p.Popup({bindElement:e,content:t,cacheable:false,autoHide:true,minWidth:270,width:270,padding:12,angle:{position:"top",offset:30}});v.Event.bind(i,"click",(()=>{u.CopilotAdvice.showExample();l==null?void 0:l.close()}));l.show()}static getMessagesByErrorType(e=null){let s="";let a="";switch(e){case ot.UnexpectedError:{s="TASKS_FLOW_LIST_COPILOT_UNEXPECTED_ERROR_POPUP_TITLE";a="TASKS_FLOW_LIST_COPILOT_UNEXPECTED_ERROR_POPUP_DESCRIPTION";break}case ot.AdviceFetching:{s="TASKS_FLOW_LIST_COPILOT_ADVICE_FETCHING_POPUP_TITLE";a="TASKS_FLOW_LIST_COPILOT_ADVICE_FETCHING_POPUP_DESCRIPTION";break}case ot.NotEnoughTasks:default:{s="TASKS_FLOW_LIST_COPILOT_NOT_ENOUGH_TASKS_POPUP_TITLE";a="TASKS_FLOW_LIST_COPILOT_NOT_ENOUGH_TASKS_POPUP_DESCRIPTION";break}}return{titleCode:s,descriptionCode:a}}}e.Grid=Ts;e.Filter=Na;e.BIAnalytics=tt;e.CopilotAdviceErrorPopup=nt;e.CopilotAdviceErrorTypes=ot})(this.BX.Tasks.Flow=this.BX.Tasks.Flow||{},BX.Tasks.Flow,BX.UI.Dialogs,BX.UI,BX.Pull,BX.Tasks.Flow,BX.Tasks.Flow,BX.Tasks,BX.UI.Manual,BX,BX.Event,BX.SidePanel,BX,BX.Main,BX.Tasks.Flow);
//# sourceMappingURL=script.map.js