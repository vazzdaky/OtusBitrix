{"version":3,"file":"script.js","sources":["src/jwt-decode/build/esm/index.js","src/flip-board-sdk/src/lib/types/SDK.js","src/flip-board-sdk/src/lib/types/events.js","src/flip-board-sdk/src/lib/flip-board-sdk.js","src/board.js","src/index.js"],"sourcesContent":["export class InvalidTokenError extends Error {\n}\nInvalidTokenError.prototype.name = \"InvalidTokenError\";\nfunction b64DecodeUnicode(str) {\n    return decodeURIComponent(atob(str).replace(/(.)/g, (m, p) => {\n        let code = p.charCodeAt(0).toString(16).toUpperCase();\n        if (code.length < 2) {\n            code = \"0\" + code;\n        }\n        return \"%\" + code;\n    }));\n}\nfunction base64UrlDecode(str) {\n    let output = str.replace(/-/g, \"+\").replace(/_/g, \"/\");\n    switch (output.length % 4) {\n        case 0:\n            break;\n        case 2:\n            output += \"==\";\n            break;\n        case 3:\n            output += \"=\";\n            break;\n        default:\n            throw new Error(\"base64 string is not of the correct length\");\n    }\n    try {\n        return b64DecodeUnicode(output);\n    }\n    catch (err) {\n        return atob(output);\n    }\n}\nexport function jwtDecode(token, options) {\n    if (typeof token !== \"string\") {\n        throw new InvalidTokenError(\"Invalid token specified: must be a string\");\n    }\n    options || (options = {});\n    const pos = options.header === true ? 0 : 1;\n    const part = token.split(\".\")[pos];\n    if (typeof part !== \"string\") {\n        throw new InvalidTokenError(`Invalid token specified: missing part #${pos + 1}`);\n    }\n    let decoded;\n    try {\n        decoded = base64UrlDecode(part);\n    }\n    catch (e) {\n        throw new InvalidTokenError(`Invalid token specified: invalid base64 for part #${pos + 1} (${e.message})`);\n    }\n    try {\n        return JSON.parse(decoded);\n    }\n    catch (e) {\n        throw new InvalidTokenError(`Invalid token specified: invalid json for part #${pos + 1} (${e.message})`);\n    }\n}\n","export var AccessLevel;\n(function (AccessLevel) {\n    AccessLevel[\"private\"] = \"private\";\n    AccessLevel[\"readonly\"] = \"readonly\";\n    AccessLevel[\"editable\"] = \"editable\";\n})(AccessLevel || (AccessLevel = {}));\nexport var DashboardFlow;\n(function (DashboardFlow) {\n    DashboardFlow[\"short\"] = \"short\";\n})(DashboardFlow || (DashboardFlow = {}));\n//# sourceMappingURL=SDK.js.map","export var SDKEvents;\n(function (SDKEvents) {\n    SDKEvents[\"waitParams\"] = \"waitSDKParams\";\n    SDKEvents[\"setParams\"] = \"setParams\";\n    SDKEvents[\"boardChanged\"] = \"boardChanged\";\n    SDKEvents[\"tryToCloseApp\"] = \"tryToCloseApp\";\n    SDKEvents[\"successCloseApp\"] = \"successCloseApp\";\n    SDKEvents[\"errorCloseApp\"] = \"errorCloseApp\";\n    SDKEvents[\"renameBoard\"] = \"renameBoard\";\n    SDKEvents[\"successBoardRenamed\"] = \"successBoardRenamed\";\n    SDKEvents[\"errorBoardRenamed\"] = \"errorBoardRenamed\";\n    SDKEvents[\"userIsKicked\"] = \"userIsKicked\";\n    SDKEvents[\"userConfirmKickFromBoard\"] = \"userConfirmKickFromBoard\";\n})(SDKEvents || (SDKEvents = {}));\n//# sourceMappingURL=events.js.map","import { jwtDecode } from \"../../../jwt-decode/build/esm/index\";\nimport { AccessLevel } from './types/SDK';\nimport { SDKEvents } from './types/events';\nexport default class WebSDK {\n    constructor(params) {\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j;\n        this.params = params;\n        let accessLevel;\n        let canEditBoard;\n        const boardData = {};\n        let jwtParams = {\n            user_id: '',\n            username: '',\n            avatar_url: '',\n            access_level: 'read',\n            can_edit_board: false,\n            webhook_url: '',\n            document_id: '',\n            download_link: '',\n            session_id: '',\n            file_name: '',\n        };\n        if (params.token) {\n            try {\n                jwtParams = jwtDecode(params.token);\n                accessLevel = jwtParams.access_level === 'read' ? AccessLevel.readonly : AccessLevel.editable;\n                canEditBoard = jwtParams.can_edit_board;\n                boardData.documentId = jwtParams.document_id;\n                boardData.fileUrl = jwtParams.download_link;\n                boardData.sessionId = jwtParams.session_id;\n                boardData.fileName = jwtParams.file_name;\n            }\n            catch (e) {\n                console.error('invalid token');\n            }\n        }\n        this.boardParams = {\n            appUrl: encodeURIComponent(params.appUrl),\n            accessLevel,\n            canEditBoard,\n            token: params.token,\n            lang: params.lang || 'ru',\n            // bitrix partnerId by default\n            partnerId: params.partnerId || '0',\n            ui: {\n                colorTheme: ((_a = params.ui) === null || _a === void 0 ? void 0 : _a.colorTheme) || 'flipOriginLight',\n                openTemplatesModal: !!((_b = params.ui) === null || _b === void 0 ? void 0 : _b.openTemplatesModal),\n                compactHeader: !!((_c = params.ui) === null || _c === void 0 ? void 0 : _c.compactHeader),\n                showCloseButton: !!((_d = params.ui) === null || _d === void 0 ? void 0 : _d.showCloseButton),\n                dashboardFlow: ((_e = params.ui) === null || _e === void 0 ? void 0 : _e.dashboardFlow) || undefined,\n                exportAsFile: ((_f = params.ui) === null || _f === void 0 ? void 0 : _f.exportAsFile) !== false,\n                spinner: (_g = params.ui) === null || _g === void 0 ? void 0 : _g.spinner,\n                userKickable: (_h = params.ui) === null || _h === void 0 ? void 0 : _h.userKickable,\n                confirmUserKick: (_j = params.ui) === null || _j === void 0 ? void 0 : _j.confirmUserKick,\n            },\n            appContainerDomain: window.location.origin,\n            boardData,\n        };\n        this.iframeEl = document.createElement('iframe');\n        this.iframeEl.allow = 'clipboard-read; clipboard-write';\n        window.addEventListener('beforeunload', this.destroy.bind(this));\n    }\n    init() {\n        const container = document.getElementById(this.params.containerId);\n        if (!container) {\n            console.error(`Элемент с id \"${this.params.containerId}\" не найден.`);\n            return;\n        }\n        this.iframeEl.src = this.createUrl();\n        this.iframeEl.style.width = '100%';\n        this.iframeEl.style.height = '100%';\n        this.iframeEl.style.border = 'none';\n        container.appendChild(this.iframeEl);\n        this.addEventListener();\n        window.FlipBoard = this.getBoardMethods();\n    }\n    getBoardMethods() {\n        return {\n            tryToCloseBoard: () => new Promise((resolve, reject) => {\n                var _a;\n                window.addEventListener('message', (event) => {\n                    var _a, _b;\n                    if (((_a = event.data) === null || _a === void 0 ? void 0 : _a.event) === SDKEvents.successCloseApp) {\n                        resolve();\n                    }\n                    if (((_b = event.data) === null || _b === void 0 ? void 0 : _b.event) === SDKEvents.errorCloseApp) {\n                        reject();\n                    }\n                });\n                (_a = this.iframeEl.contentWindow) === null || _a === void 0 ? void 0 : _a.postMessage({ event: SDKEvents.tryToCloseApp }, '*');\n            }),\n            renameBoard: (name) => new Promise((resolve, reject) => {\n                var _a;\n                window.addEventListener('message', (event) => {\n                    var _a, _b;\n                    if (((_a = event.data) === null || _a === void 0 ? void 0 : _a.event) === SDKEvents.successBoardRenamed) {\n                        resolve();\n                    }\n                    if (((_b = event.data) === null || _b === void 0 ? void 0 : _b.event) === SDKEvents.errorBoardRenamed) {\n                        reject();\n                    }\n                });\n                (_a = this.iframeEl.contentWindow) === null || _a === void 0 ? void 0 : _a.postMessage({\n                    event: SDKEvents.renameBoard,\n                    data: { name },\n                }, '*');\n            }),\n            // Другие методы можно добавить здесь\n        };\n    }\n    createUrl() {\n        const url = new URL(`${this.params.appUrl}${this.boardParams.partnerId === '0' ? '/sdkBoard' : ''}`);\n        url.searchParams.set('fromSDK', 'true');\n        if (this.boardParams.ui.openTemplatesModal)\n            url.searchParams.set('openTemplates', 'true');\n        if (this.boardParams.ui.spinner && this.boardParams.ui.spinner !== 'default')\n            url.searchParams.set('spinner', this.boardParams.ui.spinner);\n        url.searchParams.set('dt', Date.now().toString());\n        return url.toString();\n    }\n    addEventListener() {\n        window.addEventListener('message', this.listenBoardEvents.bind(this));\n    }\n    listenBoardEvents(event) {\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t, _u, _v;\n        if (((_a = event.data) === null || _a === void 0 ? void 0 : _a.event) === SDKEvents.waitParams) {\n            // @ts-ignore\n            (_b = this.iframeEl.contentWindow) === null || _b === void 0 ? void 0 : _b.postMessage({ event: SDKEvents.setParams, data: this.boardParams }, '*');\n        }\n        if (((_c = event.data) === null || _c === void 0 ? void 0 : _c.event) === SDKEvents.boardChanged) {\n            if ((_e = (_d = this.params) === null || _d === void 0 ? void 0 : _d.events) === null || _e === void 0 ? void 0 : _e.onBoardChanged) {\n                this.params.events.onBoardChanged();\n            }\n        }\n        if (((_f = event.data) === null || _f === void 0 ? void 0 : _f.event) === SDKEvents.successBoardRenamed) {\n            if ((_h = (_g = this.params) === null || _g === void 0 ? void 0 : _g.events) === null || _h === void 0 ? void 0 : _h.onBoardRenamed) {\n                this.params.events.onBoardRenamed(((_k = (_j = event.data) === null || _j === void 0 ? void 0 : _j.data) === null || _k === void 0 ? void 0 : _k.name) || '');\n            }\n        }\n        if (((_l = event.data) === null || _l === void 0 ? void 0 : _l.event) === SDKEvents.userIsKicked) {\n            if ((_o = (_m = this.params) === null || _m === void 0 ? void 0 : _m.events) === null || _o === void 0 ? void 0 : _o.onUserKicked) {\n                (_q = (_p = this.params) === null || _p === void 0 ? void 0 : _p.events) === null || _q === void 0 ? void 0 : _q.onUserKicked();\n            }\n        }\n        if (((_r = event.data) === null || _r === void 0 ? void 0 : _r.event) === SDKEvents.userConfirmKickFromBoard) {\n            if ((_t = (_s = this.params) === null || _s === void 0 ? void 0 : _s.events) === null || _t === void 0 ? void 0 : _t.onUserKickConfirmed) {\n                (_v = (_u = this.params) === null || _u === void 0 ? void 0 : _u.events) === null || _v === void 0 ? void 0 : _v.onUserKickConfirmed();\n            }\n        }\n    }\n    destroy() {\n        window.removeEventListener('message', this.listenBoardEvents);\n    }\n}\n//# sourceMappingURL=flip-board-sdk.js.map","import { ButtonManager, Button } from 'ui.buttons';\nimport { MenuItem } from 'main.popup';\nimport { ExternalLink } from 'disk.external-link';\nimport { LegacyPopup } from 'disk.sharing-legacy-popup';\nimport type { BoardData } from './types';\n\nexport default class Board\n{\n\tsetupSharingButton: Button = null;\n\tdata: BoardData = null;\n\n\tconstructor(options)\n\t{\n\t\tthis.setupSharingButton = ButtonManager.createByUniqId(options.panelButtonUniqIds.setupSharing);\n\t\tthis.data = options.boardData;\n\n\t\tthis.bindEvents();\n\t}\n\n\tbindEvents(): void\n\t{\n\t\tif (this.setupSharingButton)\n\t\t{\n\t\t\tconst menuWindow = this.setupSharingButton.getMenuWindow();\n\t\t\tconst extLinkOptions = menuWindow.getMenuItem('ext-link').options;\n\t\t\textLinkOptions.onclick = this.handleClickSharingByExternalLink.bind(this);\n\n\t\t\tmenuWindow.removeMenuItem('ext-link');\n\t\t\tmenuWindow.addMenuItem(extLinkOptions);\n\n\t\t\tconst sharingOptions = menuWindow.getMenuItem('sharing').options;\n\t\t\tsharingOptions.onclick = this.handleClickSharing.bind(this);\n\n\t\t\tmenuWindow.removeMenuItem('sharing');\n\t\t\tmenuWindow.addMenuItem(sharingOptions);\n\t\t}\n\t}\n\n\thandleClickSharingByExternalLink(event, menuItem: MenuItem): void\n\t{\n\t\tthis.setupSharingButton.getMenuWindow().close();\n\t\tif (menuItem.dataset.shouldBlockExternalLinkFeature)\n\t\t{\n\t\t\teval(menuItem.dataset.blockerExternalLinkFeature);\n\n\t\t\treturn;\n\t\t}\n\n\t\tExternalLink.showPopup(this.data.id);\n\t}\n\n\thandleClickSharing(): void\n\t{\n\t\tthis.setupSharingButton.getMenuWindow().close();\n\t\t(new LegacyPopup()).showSharingDetailWithChangeRights({\n\t\t\tobject: {\n\t\t\t\tid: this.data.id,\n\t\t\t\tname: this.data.name,\n\t\t\t},\n\t\t});\n\t}\n}\n","import WebSDK from './flip-board-sdk/src/lib/flip-board-sdk';\nimport Board from './board.js';\n\nconst SDK = WebSDK;\n\nexport {\n\tBoard,\n\tSDK,\n};\n"],"names":["InvalidTokenError","Error","prototype","name","b64DecodeUnicode","str","decodeURIComponent","atob","replace","m","p","code","charCodeAt","toString","toUpperCase","length","base64UrlDecode","output","err","jwtDecode","token","options","pos","header","part","split","decoded","e","message","JSON","parse","AccessLevel","DashboardFlow","SDKEvents","WebSDK","params","_a","_b","_c","_d","_e","_f","_g","_h","_j","accessLevel","canEditBoard","boardData","jwtParams","user_id","username","avatar_url","access_level","can_edit_board","webhook_url","document_id","download_link","session_id","file_name","readonly","editable","documentId","fileUrl","sessionId","fileName","console","error","boardParams","appUrl","encodeURIComponent","lang","partnerId","ui","colorTheme","openTemplatesModal","compactHeader","showCloseButton","dashboardFlow","undefined","exportAsFile","spinner","userKickable","confirmUserKick","appContainerDomain","window","location","origin","iframeEl","document","createElement","allow","addEventListener","destroy","bind","container","getElementById","containerId","src","createUrl","style","width","height","border","appendChild","FlipBoard","getBoardMethods","tryToCloseBoard","Promise","resolve","reject","event","data","successCloseApp","errorCloseApp","contentWindow","postMessage","tryToCloseApp","renameBoard","successBoardRenamed","errorBoardRenamed","url","URL","searchParams","set","Date","now","listenBoardEvents","_k","_l","_m","_o","_p","_q","_r","_s","_t","_u","_v","waitParams","setParams","boardChanged","events","onBoardChanged","onBoardRenamed","userIsKicked","onUserKicked","userConfirmKickFromBoard","onUserKickConfirmed","removeEventListener","Board","setupSharingButton","ButtonManager","createByUniqId","panelButtonUniqIds","setupSharing","bindEvents","menuWindow","getMenuWindow","extLinkOptions","getMenuItem","onclick","handleClickSharingByExternalLink","removeMenuItem","addMenuItem","sharingOptions","handleClickSharing","menuItem","close","dataset","shouldBlockExternalLinkFeature","eval","blockerExternalLinkFeature","ExternalLink","showPopup","id","LegacyPopup","showSharingDetailWithChangeRights","object","SDK"],"mappings":"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"}