{"version":3,"file":"default.js","sources":["src/default.js"],"sourcesContent":["BX.Default.Field.Employee = function (params)\n{\n\tthis.init(params);\n};\n\nBX.Default.Field.Employee.prototype = {\n\tinit: function (params)\n\t{\n\t\tthis.selectorName = (params['selectorName'] || '');\n\t\tthis.isMultiple = (params['isMultiple'] || '');\n\t\tthis.fieldNameJs = (params['fieldNameJs'] || '');\n\t\tthis.selectControl = this.createSelectControl();\n\t\tthis.entity = this.createEntity();\n\n\t\tBX.addCustomEvent(\n\t\t\tthis.selectControl,\n\t\t\t'onUpdateValue',\n\t\t\tBX.delegate(this.updateHandler, this)\n\t\t);\n\n\t\tBX.addCustomEvent(\n\t\t\tthis.entity,\n\t\t\t'BX.Intranet.UserFieldEmployeeEntity:remove',\n\t\t\tBX.delegate(this.removeHandler, this)\n\t\t);\n\t},\n\n\tcreateSelectControl: function ()\n\t{\n\t\treturn new BX.Intranet.UserFieldEmployee(this.selectorName, {\n\t\t\tmultiple: this.isMultiple\n\t\t});\n\t},\n\n\tcreateEntity: function ()\n\t{\n\t\treturn new BX.Intranet.UserFieldEmployeeEntity({\n\t\t\tfield: `field_${this.selectorName}`,\n\t\t\tmultiple: this.isMultiple\n\t\t});\n\t},\n\n\tupdateHandler: function (value, userStack)\n\t{\n\t\tif (this.isMultiple)\n\t\t{\n\t\t\tlet result = [];\n\t\t\tfor (let i = 0; i < value.length; i++)\n\t\t\t{\n\t\t\t\tresult.push({\n\t\t\t\t\tname: userStack[value[i]].name,\n\t\t\t\t\tvalue: value[i]\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis.setData(result);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (value === null)\n\t\t\t{\n\t\t\t\tthis.setData(null);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.setData({\n\t\t\t\t\tname: userStack[value].name,\n\t\t\t\t\tvalue: value\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t},\n\n\tremoveHandler: function (value)\n\t{\n\t\tlet result = (this.isMultiple ? [] : null);\n\t\tlet\tselectControlValue = (this.isMultiple ? [] : null);\n\n\t\tfor (let i = 0; i < value.length; i++)\n\t\t{\n\t\t\tlet item = {\n\t\t\t\tname: value[i].label,\n\t\t\t\tvalue: value[i].value\n\t\t\t};\n\n\t\t\tif (!this.isMultiple)\n\t\t\t{\n\t\t\t\tselectControlValue = item.value;\n\t\t\t\tresult = item;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tselectControlValue.push(item.value);\n\t\t\t\tresult.push(item);\n\t\t\t}\n\t\t}\n\t\tthis.selectControl.setValue(selectControlValue);\n\t\tthis.setData(result);\n\t},\n\n\tsetData: function (value)\n\t{\n\t\tlet valueContainer = BX(`value_${this.selectorName}`);\n\t\tlet html = '';\n\n\t\tif (this.isMultiple)\n\t\t{\n\t\t\tif (value.length > 0)\n\t\t\t{\n\t\t\t\tlet entityValue = [];\n\t\t\t\tfor (let i = 0; i < value.length; i++)\n\t\t\t\t{\n\t\t\t\t\tentityValue.push({\n\t\t\t\t\t\tvalue: value[i].value,\n\t\t\t\t\t\tlabel: value[i].name\n\t\t\t\t\t});\n\n\t\t\t\t\thtml += `<input type=\"hidden\" name=\"${this.fieldNameJs}\" value=\"${BX.util.htmlspecialchars(value[i].value)}\">`;\n\t\t\t\t}\n\n\t\t\t\tthis.entity.setData(entityValue);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.entity.removeSquares();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (value !== null)\n\t\t\t{\n\t\t\t\tthis.entity.setData(value.name, value.value);\n\t\t\t\thtml += `<input type=\"hidden\" name=\"${this.fieldNameJs}\" value=\"${BX.util.htmlspecialchars(value.value)}\">`;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.entity.removeSquares();\n\t\t\t}\n\t\t}\n\n\t\tif (html.length <= 0)\n\t\t{\n\t\t\thtml = `<input type=\"hidden\" name=\"${this.fieldNameJs}\" value=\"\">`\n\t\t}\n\n\t\tvalueContainer.innerHTML = html;\n\n\t\tBX.defer(function ()\n\t\t{\n\t\t\tBX.fireEvent(valueContainer.firstChild, 'change');\n\t\t})();\n\t}\n};"],"names":["BX","Default","Field","Employee","params","init","prototype","selectorName","isMultiple","fieldNameJs","selectControl","createSelectControl","entity","createEntity","addCustomEvent","delegate","updateHandler","removeHandler","Intranet","UserFieldEmployee","multiple","UserFieldEmployeeEntity","field","value","userStack","result","i","length","push","name","setData","selectControlValue","item","label","setValue","valueContainer","html","entityValue","util","htmlspecialchars","removeSquares","innerHTML","defer","fireEvent","firstChild"],"mappings":"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"}