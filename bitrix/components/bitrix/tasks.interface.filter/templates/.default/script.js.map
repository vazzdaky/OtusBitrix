{"version":3,"sources":["src/legacy.js","src/preset.js","src/tasks-interface-filter.js"],"names":["Preset","options","filterId","setTimeout","guide","showNextStep","DELAY","BX","Main","filterManager","getById","Guide","simpleMode","onEvents","steps","target","getPopupBindElement","title","Loc","getMessage","text","position","condition","top","bottom","color","getPopup","setWidth","ajax","runComponentAction","mode","data","error","console","log","TasksInterfaceFilter","params","_classPrivateMethodInitSpec","_classPrivateFieldInitSpec","_classPrivateMethodGet","isV2Form","createNode","button","Button","className","onclick","Tasks","V2","Application","TaskCard","groupId","analytics","showCompactCard","props","id","replaceWith","render","showPresetTourGuide","Aha","payAttention"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;ACtZA,CACsC;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;AAMtC,KAAaA,MAAM;GAOlB,gBAAYC,OAAgB,EAC5B;KAAA;KAAA;KAAA;KAAA;KAAA;KAAA;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KACC,sCAAI,aAAaA,OAAO,CAACC,QAAQ;KACjC,2BAAI,sBAAJ,IAAI;;GACJ;KAAA;KAAA,+BAGD;OAAA;OACCC,UAAU,CAAC,YAAM;SAChB,KAAI,CAACC,KAAK,CAACC,YAAY,EAAE;SACzB,4BAAI,kCAAJ,KAAI;QACJ,EAAEL,MAAM,CAACM,KAAK,CAAC;;;GAChB;CAAA;CAuDD,kBApDA;GAAA;GACC,0EAAI,gCAAJ,IAAI;CAGL;CAAC,uBAGD;GACC,sCAAI,WAAWC,EAAE,CAACC,IAAI,CAACC,aAAa,CAACC,OAAO,mCAAC,IAAI,aAAW;GAC5D,OAAO,IAAI;CACZ;CAAC,sBAGD;GACC,IAAI,CAACN,KAAK,GAAG,IAAIO,aAAK,CAAC;KACtBC,UAAU,EAAE,IAAI;KAChBC,QAAQ,EAAE,IAAI;KACdC,KAAK,EAAE,CACN;OACCC,MAAM,EAAE,sCAAI,WAASC,mBAAmB,EAAE;OAC1CC,KAAK,EAAEC,aAAG,CAACC,UAAU,CAAC,4CAA4C,CAAC;OACnEC,IAAI,EAAEF,aAAG,CAACC,UAAU,CAAC,2CAA2C,CAAC;OACjEE,QAAQ,EAAE,QAAQ;OAClBC,SAAS,EAAE;SACVC,GAAG,EAAE,IAAI;SACTC,MAAM,EAAE,KAAK;SACbC,KAAK,EAAE;;MAER;IAEF,CAAC;GAEF,IAAI,CAACrB,KAAK,CAACsB,QAAQ,EAAE,CAACC,QAAQ,CAAC,GAAG,CAAC;GAEnC,OAAO,IAAI;CACZ;CAAC,wBAGD;GAAA;GACCC,cAAI,CAACC,kBAAkB,CAAC,+BAA+B,EAAE,2BAA2B,EAAE;KACpFC,IAAI,EAAE,OAAO;KACbC,IAAI,EAAE;IACN,CAAC,SACI,CAAC,UAAAC,KAAK,EAAI;KACf,6BAAI,oBAAJ,MAAI,EAAMA,KAAK;IACf,CAAC;CACJ;CAAC,eAEIA,KAAY,EACjB;GACCC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC;CACnB;CAAC,4BAzEWhC,MAAM,WAEH,IAAI;;;;;;ACTpB,CACoC;CAAA;CAAA;AAWpC,KAAamC,oBAAoB,GAIhC,8BAAYC,MAAc,EAC1B;GAAA;GAAAC;GAAAA;GAAAC;KAAA;KAAA;;GACC,sCAAI,WAAWF,MAAM;GAErBG,6BAAI,wCAAJ,IAAI;GACJA,6BAAI,oDAAJ,IAAI;CACL,CAAC;CAsCD,2BAnCA;GAAA;GACC,IAAI,CAAC,sCAAI,WAASC,QAAQ,IAAI,CAAC,sCAAI,WAASC,UAAU,EACtD;KACC;;GAGD,IAAMC,MAAM,GAAG,IAAIC,iBAAM,CAAC;KACzBC,SAAS,EAAE,aAAa;KACxBxB,IAAI,EAAEF,aAAG,CAACC,UAAU,CAAC,uBAAuB,CAAC;KAC7C0B,OAAO,EAAE,mBAAM;OACb,IAAItC,EAAE,CAACuC,KAAK,CAACC,EAAE,CAACC,WAAW,CAACC,QAAQ,CAAC;SACrCC,OAAO,EAAE,uCAAI,WAASA,OAAO;SAC7BC,SAAS,EAAE,uCAAI,WAASA;QACxB,CAAC,CAAEC,eAAe,EAAE;MACrB;KACDC,KAAK,EAAE;OACNC,EAAE,EAAE;;IAEL,CAAC;GAEF,sCAAI,WAASb,UAAU,CAACc,WAAW,CAACb,MAAM,CAACc,MAAM,EAAE,CAAC;CACrD;CAAC,iCAGD;GACC,IAAI,CAAC,sCAAI,WAASC,mBAAmB,EACrC;KACC;;GAGDlD,EAAE,CAACuC,KAAK,CAAC9C,MAAM,CAAC0D,GAAG,GAAG,IAAInD,EAAE,CAACuC,KAAK,CAAC9C,MAAM,CAAC;KACzCE,QAAQ,EAAE,sCAAI,WAASA;IACvB,CAAC;GACFK,EAAE,CAACuC,KAAK,CAAC9C,MAAM,CAAC0D,GAAG,CAACC,YAAY,EAAE;CACnC","file":"script.js.map","sourcesContent":[null,"import { Guide } from 'ui.tour';\nimport { ajax, Loc } from 'main.core';\n\ntype Options = {\n\tfilterId: number,\n};\n\nexport class Preset\n{\n\tstatic DELAY = 1000;\n\n\t#filterId: number;\n\t#filter: BX.Main.Filter;\n\n\tconstructor(options: Options)\n\t{\n\t\tthis.#filterId = options.filterId;\n\t\tthis.#init();\n\t}\n\n\tpayAttention(): void\n\t{\n\t\tsetTimeout(() => {\n\t\t\tthis.guide.showNextStep();\n\t\t\tthis.#markViewed();\n\t\t}, Preset.DELAY);\n\t}\n\n\t#init(): void\n\t{\n\t\tthis\n\t\t\t.#setFilter()\n\t\t\t.#setGuide();\n\t}\n\n\t#setFilter(): Preset\n\t{\n\t\tthis.#filter = BX.Main.filterManager.getById(this.#filterId);\n\t\treturn this;\n\t}\n\n\t#setGuide(): Preset\n\t{\n\t\tthis.guide = new Guide({\n\t\t\tsimpleMode: true,\n\t\t\tonEvents: true,\n\t\t\tsteps: [\n\t\t\t\t{\n\t\t\t\t\ttarget: this.#filter.getPopupBindElement(),\n\t\t\t\t\ttitle: Loc.getMessage('TASKS_INTERFACE_FILTER_PRESETS_MOVED_TITLE'),\n\t\t\t\t\ttext: Loc.getMessage('TASKS_INTERFACE_FILTER_PRESETS_MOVED_TEXT'),\n\t\t\t\t\tposition: 'bottom',\n\t\t\t\t\tcondition: {\n\t\t\t\t\t\ttop: true,\n\t\t\t\t\t\tbottom: false,\n\t\t\t\t\t\tcolor: 'primary',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t});\n\n\t\tthis.guide.getPopup().setWidth(420);\n\n\t\treturn this;\n\t}\n\n\t#markViewed(): void\n\t{\n\t\tajax.runComponentAction('bitrix:tasks.interface.filter', 'markPresetAhaMomentViewed', {\n\t\t\t\tmode: 'class',\n\t\t\t\tdata: {},\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tthis.#log(error);\n\t\t\t});\n\t}\n\n\t#log(error: Error): void\n\t{\n\t\tconsole.log(error);\n\t}\n}\n","import { Loc } from 'main.core';\nimport { Button } from 'ui.buttons';\n\ntype Params = {\n\tfilterId: string,\n\tcreateNode: HTMLElement,\n\tshowPresetTourGuide: boolean,\n\tisV2Form: boolean,\n\tgroupId?: number,\n\tanalytics: Object,\n};\n\nexport class TasksInterfaceFilter\n{\n\t#params: Params;\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#params = params;\n\n\t\tthis.#initAddButton();\n\t\tthis.#showPresetTourGuide();\n\t}\n\n\t#initAddButton(): void\n\t{\n\t\tif (!this.#params.isV2Form || !this.#params.createNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst button = new Button({\n\t\t\tclassName: 'ui-btn-main',\n\t\t\ttext: Loc.getMessage('TASKS_BTN_CREATE_TASK'),\n\t\t\tonclick: () => {\n\t\t\t\t(new BX.Tasks.V2.Application.TaskCard({\n\t\t\t\t\tgroupId: this.#params.groupId,\n\t\t\t\t\tanalytics: this.#params.analytics,\n\t\t\t\t})).showCompactCard();\n\t\t\t},\n\t\t\tprops: {\n\t\t\t\tid: 'tasks-buttonAdd',\n\t\t\t},\n\t\t});\n\n\t\tthis.#params.createNode.replaceWith(button.render());\n\t}\n\n\t#showPresetTourGuide(): void\n\t{\n\t\tif (!this.#params.showPresetTourGuide)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.Tasks.Preset.Aha = new BX.Tasks.Preset({\n\t\t\tfilterId: this.#params.filterId,\n\t\t});\n\t\tBX.Tasks.Preset.Aha.payAttention();\n\t}\n}\n"]}