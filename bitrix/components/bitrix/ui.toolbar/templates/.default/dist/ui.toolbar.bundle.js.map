{"version":3,"file":"ui.toolbar.bundle.js","sources":["../src/title-editor.js","../src/toolbar-star.js","../src/toolbar.js","../src/toolbar-manager.js"],"sourcesContent":["import { bind, Dom, Event } from 'main.core';\n\nexport type TitleEditorOptions = {\n\tactive: boolean;\n\tselector: HTMLElement;\n\tdisabled?: boolean;\n\tdefaultTitle?: string;\n}\n\nexport const TitleEditorEvents = {\n\tbeforeStartEditing: 'beforeStartEditing',\n\tstartEditing: 'startEditing',\n\tfinishEditing: 'finishEditing',\n};\n\nexport class TitleEditor extends Event.EventEmitter\n{\n\t// #dataContainer: ?HTMLElement;\n\t#initialTitle: string;\n\t#defaultTitle: string;\n\t#toolbarNode: ?HTMLElement;\n\t#titleNode: ?HTMLElement;\n\t#inputNode: ?HTMLInputElement;\n\t// #dataNode: ?HTMLElement;\n\t#editTitleButtonNode: ?HTMLElement;\n\t#editTitleResultButtonsContainer: ?HTMLElement;\n\t#titleIconButtonsContainer: ?HTMLElement;\n\t#saveTitleButton: ?HTMLElement;\n\t#cancelTitleEditButton: ?HTMLElement;\n\t#isInit: boolean = false;\n\n\tconstructor(options: TitleEditorOptions)\n\t{\n\t\tsuper(options);\n\t\tthis.setEventNamespace('UI.Toolbar.TitleEditor');\n\t\tthis.#init(options);\n\t}\n\n\t#init(params: TitleEditorOptions)\n\t{\n\t\t// if (!params.selector)\n\t\t// {\n\t\t// \treturn;\n\t\t// }\n\t\t//\n\t\t// this.dataContainer = document.querySelector(params.selector);\n\t\t// if (!this.dataContainer)\n\t\t// {\n\t\t// \treturn;\n\t\t// }\n\t\t//\n\t\t// Dom.style(this.dataContainer, 'display', 'none');\n\n\t\tthis.#toolbarNode = document.getElementById('uiToolbarContainer');\n\t\tthis.#titleNode = document.querySelector('.ui-wrap-title-name');\n\t\tthis.#inputNode = document.querySelector('.ui-toolbar-edit-title-input');\n\t\tthis.#editTitleButtonNode = document.querySelector('.ui-toolbar-edit-title-button');\n\t\tthis.#editTitleResultButtonsContainer = document.getElementById('ui-toolbar-title-edit-result-buttons');\n\t\tthis.#saveTitleButton = document.getElementById('ui-toolbar-save-title-button');\n\t\tthis.#cancelTitleEditButton = document.getElementById('ui-toolbar-cancel-title-edit-button');\n\t\tthis.#titleIconButtonsContainer = document.getElementById('ui-toolbar-title-item-box-buttons');\n\t\tthis.#initialTitle = this.#titleNode.textContent;\n\t\tthis.#defaultTitle = params.defaultTitle;\n\n\t\t// bind(this.dataNode, 'bxchange', this.onDataNodeChange.bind(this));\n\t\tbind(this.#editTitleButtonNode, 'click', this.startEdit.bind(this));\n\t\tbind(this.#inputNode, 'keyup', this.onKeyUp.bind(this));\n\t\tbind(this.#inputNode, 'blur', (event) => {\n\t\t\tif (event.relatedTarget === this.#cancelTitleEditButton)\n\t\t\t{\n\t\t\t\tthis.cancelEdit();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.finishEdit();\n\t\t});\n\t\tbind(this.#saveTitleButton, 'click', this.finishEdit.bind(this));\n\t\tbind(this.#cancelTitleEditButton, 'click', this.cancelEdit.bind(this));\n\n\t\tthis.#isInit = true;\n\n\t\tif (!params.disabled)\n\t\t{\n\t\t\tthis.enable();\n\t\t}\n\t}\n\n\tenable(isDisable: boolean = false)\n\t{\n\t\tif (!this.#isInit)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.changeDisplay(this.#editTitleButtonNode, isDisable === false);\n\t\t// this.titleNode.textContent = isDisable === false\n\t\t// \t? (this.dataNode.value ?? this.defaultTitle)\n\t\t// \t: this.initialTitle\n\t\t// ;\n\n\t\tthis.#titleNode.textContent = this.#initialTitle;\n\t}\n\n\tdisable(): void\n\t{\n\t\tthis.enable(true);\n\t}\n\n\t// onDataNodeChange()\n\t// {\n\t// \tthis.#titleNode.textContent = this.#dataNode.value;\n\t// }\n\n\tonKeyUp(event: KeyboardEvent): boolean\n\t{\n\t\tif (event.key === 'Enter')\n\t\t{\n\t\t\tthis.finishEdit();\n\t\t\tevent.preventDefault();\n\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tstartEdit(): void\n\t{\n\t\t// this.inputNode.value = this.dataNode.value || this.titleNode.textContent;\n\n\t\tconst event = new Event.BaseEvent();\n\t\tthis.emit(TitleEditorEvents.beforeStartEditing, event);\n\t\tif (event.isDefaultPrevented())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#inputNode.value = this.#titleNode.textContent;\n\t\tthis.changeDisplay(this.#titleNode, false);\n\t\tthis.changeDisplay(this.#editTitleButtonNode, false);\n\t\tthis.changeDisplay(this.#inputNode, true);\n\t\tthis.changeDisplay(this.#titleIconButtonsContainer, false);\n\t\tDom.addClass(this.#editTitleResultButtonsContainer, '--show');\n\t\tDom.addClass(this.#toolbarNode, '--title-editing');\n\n\t\tthis.#inputNode.focus();\n\n\t\tthis.emit(TitleEditorEvents.startEditing);\n\t}\n\n\tfinishEdit()\n\t{\n\t\t// this.dataNode.value = this.inputNode.value;\n\t\tthis.#titleNode.textContent = this.#inputNode.value;\n\t\tthis.changeDisplay(this.#inputNode, false);\n\t\tthis.changeDisplay(this.#editTitleButtonNode, true);\n\t\tthis.changeDisplay(this.#titleNode, true);\n\t\tthis.changeDisplay(this.#titleIconButtonsContainer, true);\n\t\tDom.removeClass(this.#editTitleResultButtonsContainer, '--show');\n\t\tDom.removeClass(this.#toolbarNode, '--title-editing');\n\n\t\tthis.emit(TitleEditorEvents.finishEditing, {\n\t\t\tupdatedTitle: this.#inputNode.value,\n\t\t});\n\t}\n\n\tcancelEdit(): void\n\t{\n\t\tthis.changeDisplay(this.#inputNode, false);\n\t\tthis.changeDisplay(this.#editTitleButtonNode, true);\n\t\tthis.changeDisplay(this.#titleNode, true);\n\t\tthis.changeDisplay(this.#titleIconButtonsContainer, true);\n\t\tDom.removeClass(this.#editTitleResultButtonsContainer, '--show');\n\t\tDom.removeClass(this.#toolbarNode, '--title-editing');\n\t}\n\n\tchangeDisplay(node: HTMLElement, isShow: boolean): string\n\t{\n\t\tconst displayValue = isShow ? '' : 'none';\n\n\t\tDom.style(node, 'display', displayValue);\n\n\t\treturn displayValue;\n\t}\n}\n","import { ready, Event, Type, Uri, Dom, Loc, bind } from 'main.core';\nimport { PopupWindowManager } from 'main.popup';\n\nexport class ToolbarStar\n{\n\tinitialized: boolean;\n\tcurrentPageInMenu: false;\n\tstarContNode: HTMLElement;\n\n\tconstructor()\n\t{\n\t\tthis.initialized = false;\n\t\tthis.currentPageInMenu = false;\n\t\tthis.starContNode = null;\n\n\t\tready(() => this.init());\n\n\t\tEvent.EventEmitter.subscribe('onFrameDataProcessed', () => {\n\t\t\tthis.init();\n\t\t});\n\t\t// BX.addCustomEvent('onFrameDataProcessed', () => this.init());\n\t}\n\n\tinit(): boolean\n\t{\n\t\tthis.starContNode = document.getElementById('uiToolbarStar');\n\t\tif (!this.starContNode || this.initialized)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.initialized = true;\n\n\t\tlet currentFullPath = Dom.attr(this.starContNode, 'data-bx-url');\n\t\tif (!Type.isStringFilled(currentFullPath))\n\t\t{\n\t\t\tcurrentFullPath = document.location.pathname + document.location.search;\n\t\t}\n\t\tcurrentFullPath = Uri.removeParam(currentFullPath, ['IFRAME', 'IFRAME_TYPE']);\n\n\t\ttop.BX.addCustomEvent('BX.Bitrix24.LeftMenuClass:onSendMenuItemData', (params) => {\n\t\t\tthis.processMenuItemData(params);\n\t\t});\n\t\ttop.BX.addCustomEvent('BX.Bitrix24.LeftMenuClass:onStandardItemChangedSuccess', (params) => {\n\t\t\tthis.onStandardItemChangedSuccess(params);\n\t\t});\n\n\t\ttop.BX.onCustomEvent('UI.Toolbar:onRequestMenuItemData', [\n\t\t\t{\n\t\t\t\tcurrentFullPath,\n\t\t\t\tcontext: window,\n\t\t\t},\n\t\t]);\n\n\t\treturn true;\n\t}\n\n\tprocessMenuItemData(params): void | boolean\n\t{\n\t\tif (params.context && params.context !== window)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.currentPageInMenu = params.currentPageInMenu;\n\n\t\tif (Type.isObjectLike(params.currentPageInMenu))\n\t\t{\n\t\t\tDom.addClass(this.starContNode, 'ui-toolbar-star-active');\n\t\t}\n\n\t\tthis.starContNode.title = Loc.getMessage(\n\t\t\tDom.hasClass(this.starContNode, 'ui-toolbar-star-active')\n\t\t\t\t? 'UI_TOOLBAR_DELETE_PAGE_FROM_LEFT_MENU'\n\t\t\t\t: 'UI_TOOLBAR_ADD_PAGE_TO_LEFT_MENU',\n\t\t);\n\n\t\t// default page\n\t\tif (Type.isDomNode(this.currentPageInMenu)\n\t\t\t&& Dom.attr(this.currentPageInMenu, 'data-type') !== 'standard'\n\t\t)\n\t\t{\n\t\t\tthis.starContNode.title = Loc.getMessage('UI_TOOLBAR_STAR_TITLE_DEFAULT_PAGE');\n\t\t\tbind(this.starContNode, 'click', () => {\n\t\t\t\tthis.showMessage(Loc.getMessage('UI_TOOLBAR_STAR_TITLE_DEFAULT_PAGE_DELETE_ERROR'));\n\t\t\t});\n\n\t\t\treturn true;\n\t\t}\n\n\t\t// any page\n\t\tbind(this.starContNode, 'click', () => {\n\t\t\tlet pageTitle = document.getElementById('pagetitle')?.innerText || '';\n\t\t\tconst titleTemplate = this.starContNode.getAttribute('data-bx-title-template');\n\t\t\tif (Type.isStringFilled(titleTemplate))\n\t\t\t{\n\t\t\t\tpageTitle = titleTemplate.replace(/#page_title#/i, pageTitle);\n\t\t\t}\n\n\t\t\tlet pageLink = this.starContNode.getAttribute('data-bx-url');\n\t\t\tif (!Type.isStringFilled(pageLink))\n\t\t\t{\n\t\t\t\tpageLink = document.location.pathname + document.location.search;\n\t\t\t}\n\t\t\tpageLink = Uri.removeParam(pageLink, ['IFRAME', 'IFRAME_TYPE']);\n\n\t\t\ttop.BX.onCustomEvent('UI.Toolbar:onStarClick', [\n\t\t\t\t{\n\t\t\t\t\tisActive: Dom.hasClass(this.starContNode, 'ui-toolbar-star-active'),\n\t\t\t\t\tcontext: window,\n\t\t\t\t\tpageTitle,\n\t\t\t\t\tpageLink,\n\t\t\t\t},\n\t\t\t]);\n\t\t});\n\t}\n\n\tonStandardItemChangedSuccess(params): void\n\t{\n\t\tif (!Type.isBoolean(params.isActive) || !this.starContNode || (params.context && params.context !== window))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (params.isActive)\n\t\t{\n\t\t\tthis.showMessage(Loc.getMessage('UI_TOOLBAR_ITEM_WAS_ADDED_TO_LEFT'));\n\t\t\tthis.starContNode.title = Loc.getMessage('UI_TOOLBAR_DELETE_PAGE_FROM_LEFT_MENU');\n\t\t\tDom.addClass(this.starContNode, 'ui-toolbar-star-active');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showMessage(Loc.getMessage('UI_TOOLBAR_ITEM_WAS_DELETED_FROM_LEFT'));\n\t\t\tthis.starContNode.title = Loc.getMessage('UI_TOOLBAR_ADD_PAGE_TO_LEFT_MENU');\n\t\t\tDom.removeClass(this.starContNode, 'ui-toolbar-star-active');\n\t\t}\n\t}\n\n\tshowMessage(message) {\n\t\tlet popup = PopupWindowManager.create('left-menu-message', this.starContNode, {\n\t\t\tcontent: message,\n\t\t\tdarkMode: true,\n\t\t\toffsetTop: 2,\n\t\t\toffsetLeft: 0,\n\t\t\tangle: true,\n\t\t\tautoHide: true,\n\t\t\tevents: {\n\t\t\t\tonPopupClose: () => {\n\t\t\t\t\tif (popup)\n\t\t\t\t\t{\n\t\t\t\t\t\tpopup.destroy();\n\t\t\t\t\t\tpopup = null;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tpopup.show();\n\n\t\tsetTimeout(() => {\n\t\t\tif (popup)\n\t\t\t{\n\t\t\t\tpopup.destroy();\n\t\t\t\tpopup = null;\n\t\t\t}\n\t\t}, 3000);\n\t}\n}\n","import { bind, Dom, Event, Text, Type, Uri } from 'main.core';\nimport { type BaseEvent } from 'main.core.events';\nimport { Popup } from 'main.popup';\nimport { ButtonColor, ButtonIcon, ButtonManager } from 'ui.buttons';\n\nimport { TitleEditor, TitleEditorEvents, type TitleEditorOptions } from './title-editor';\nimport { ToolbarStar } from './toolbar-star';\n\nexport type ToolbarOptions = {\n\ttitleMinWidth?: number;\n\ttitleMaxWidth?: number;\n\tfilterMinWidth?: number;\n\tfilterMaxWidth?: number;\n\tid?: string;\n\ttarget: HTMLElement;\n\tbuttonIds?: string[];\n\ttitleEditor: TitleEditorOptions;\n};\n\nexport const ToolbarEvents = {\n\tbeforeStartEditing: 'beforeStartEditing',\n\tstartEditing: 'startEditing',\n\tfinishEditing: 'finishEditing',\n};\n\nexport class Toolbar extends Event.EventEmitter\n{\n\ttitleMinWidth: number;\n\ttitleMaxWidth: number;\n\tfilterMinWidth: number;\n\tfilterMaxWidth: number;\n\tid: string;\n\ttoolbarContainer: HTMLElement;\n\tbuttons: Object;\n\tbuttonIds: string[];\n\twindowWidth: number;\n\t#copyLinkButton: HTMLElement;\n\t#titleEditor: ?TitleEditor;\n\n\tstatic TitleEditor = TitleEditor;\n\tstatic Star = ToolbarStar;\n\n\t// eslint-disable-next-line sonarjs/cognitive-complexity\n\tconstructor(options: ToolbarOptions = {})\n\t{\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.UI.Toolbar');\n\t\tthis.titleMinWidth = Type.isNumber(options.titleMinWidth) ? options.titleMinWidth : 158;\n\t\tthis.titleMaxWidth = Type.isNumber(options.titleMaxWidth) ? options.titleMaxWidth : '';\n\n\t\tthis.filterMinWidth = Type.isNumber(options.filterMinWidth) ? options.filterMinWidth : 300;\n\t\tthis.filterMaxWidth = Type.isNumber(options.filterMaxWidth) ? options.filterMaxWidth : 748;\n\n\t\tthis.id = Type.isStringFilled(options.id) ? options.id : Text.getRandom();\n\t\tthis.toolbarContainer = options.target;\n\n\t\tif (!Type.isDomNode(this.toolbarContainer))\n\t\t{\n\t\t\tthrow new Error('BX.UI.Toolbar: \"target\" parameter is required.');\n\t\t}\n\n\t\tthis.titleContainer = this.toolbarContainer.querySelector('.ui-toolbar-title-box');\n\t\tthis.filterContainer = this.toolbarContainer.querySelector('.ui-toolbar-filter-box');\n\t\tthis.filterButtons = this.toolbarContainer.querySelector('.ui-toolbar-filter-buttons');\n\t\tthis.rightButtons = this.toolbarContainer.querySelector('.ui-toolbar-right-buttons');\n\t\tthis.afterTitleButtons = this.toolbarContainer.querySelector('.ui-toolbar-after-title-buttons');\n\t\tthis.#copyLinkButton = this.toolbarContainer.querySelector('#ui-toolbar-copy-link-button');\n\n\t\tif (this.#copyLinkButton)\n\t\t{\n\t\t\tEvent.bind(this.#copyLinkButton, 'click', this.#getClickOnCopyLinkButtonHandler());\n\t\t}\n\n\t\tif (!this.filterContainer)\n\t\t{\n\t\t\tthis.filterMinWidth = 0;\n\t\t\tthis.filterMaxWidth = 0;\n\t\t}\n\n\t\tthis.buttons = Object.create(null);\n\t\tthis.buttonIds = Type.isArray(options.buttonIds) ? options.buttonIds : [];\n\n\t\tif (this.buttonIds.length > 0)\n\t\t{\n\t\t\tthis.buttonIds.forEach((buttonId) => {\n\t\t\t\tconst button = ButtonManager.createByUniqId(buttonId);\n\t\t\t\tif (button)\n\t\t\t\t{\n\t\t\t\t\tconst container = button.getContainer();\n\t\t\t\t\tcontainer.originalWidth = container.offsetWidth;\n\n\t\t\t\t\tif (!button.getIcon() && !Type.isStringFilled(button.getDataSet().toolbarCollapsedIcon))\n\t\t\t\t\t{\n\t\t\t\t\t\tif (button.getColor() === ButtonColor.PRIMARY)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tbutton.setDataSet({\n\t\t\t\t\t\t\t\ttoolbarCollapsedIcon: ButtonIcon.ADD,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconsole.warn(\n\t\t\t\t\t\t\t\t`BX.UI.Toolbar: the button \"${button.getText()}\" doesn't have an icon for collapsed mode. `\n\t\t\t\t\t\t\t\t+ 'Use the \"data-toolbar-collapsed-icon\" attribute.',\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.buttons[buttonId] = button;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconsole.warn(`BX.UI.Toolbar: the button \"${buttonId}\" wasn't initialized.`);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.windowWidth = document.body.offsetWidth;\n\t\tthis.reduceItemsWidth();\n\n\t\tbind(window, 'resize', () => {\n\t\t\tif (this.isWindowIncreased())\n\t\t\t{\n\t\t\t\tthis.increaseItemsWidth();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.reduceItemsWidth();\n\t\t\t}\n\t\t});\n\n\t\tif (options.titleEditor?.active === true)\n\t\t{\n\t\t\tthis.#titleEditor = this.#initTitleEditor(options.titleEditor);\n\t\t}\n\t}\n\n\tgetButtons(): Object\n\t{\n\t\treturn this.buttons;\n\t}\n\n\tgetButton(id): any | null\n\t{\n\t\treturn id in this.buttons ? this.buttons[id] : null;\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.id;\n\t}\n\n\tisWindowIncreased(): boolean\n\t{\n\t\tconst previous = this.windowWidth;\n\t\tconst current = document.body.offsetWidth;\n\t\tthis.windowWidth = current;\n\n\t\treturn current > previous;\n\t}\n\n\tgetContainerSize(): number\n\t{\n\t\treturn this.toolbarContainer.offsetWidth;\n\t}\n\n\tgetInnerTotalWidth(): number\n\t{\n\t\treturn this.toolbarContainer.scrollWidth;\n\t}\n\n\treduceItemsWidth(): void\n\t{\n\t\tif (this.getInnerTotalWidth() <= this.getContainerSize())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst buttons = Object.values(this.getButtons()).reverse();\n\t\tfor (const button of buttons)\n\t\t{\n\t\t\tif (!button.getIcon() && !Type.isStringFilled(button.getDataSet()?.toolbarCollapsedIcon))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (button.isCollapsed())\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tbutton.setCollapsed(true);\n\n\t\t\tif (!button.getIcon())\n\t\t\t{\n\t\t\t\tbutton.setIcon(button.getDataSet().toolbarCollapsedIcon);\n\t\t\t}\n\n\t\t\tif (this.getInnerTotalWidth() <= this.getContainerSize())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tincreaseItemsWidth()\n\t{\n\t\tconst buttons = Object.values(this.getButtons());\n\t\tfor (const button of buttons)\n\t\t{\n\t\t\tconst item = button.getContainer();\n\t\t\tif (!button.isCollapsed())\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst newInnerWidth = this.titleMinWidth\n\t\t\t\t+ this.filterMinWidth\n\t\t\t\t+ (this.afterTitleButtons?.offsetWidth || 0)\n\t\t\t\t+ (this.filterButtons?.offsetWidth || 0)\n\t\t\t\t+ (this.rightButtons?.offsetWidth || 0)\n\t\t\t\t+ (item.originalWidth - item.offsetWidth);\n\n\t\t\tif (newInnerWidth > this.getContainerSize())\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tbutton.setCollapsed(false);\n\t\t\tif (button.getIcon() === button.getDataSet().toolbarCollapsedIcon)\n\t\t\t{\n\t\t\t\tconst icon = Type.isStringFilled(button.options.icon) ? button.options.icon : null;\n\t\t\t\tbutton.setIcon(icon);\n\t\t\t}\n\t\t}\n\t}\n\n\tsetTitle(title: string): void\n\t{\n\t\tif (!this.titleContainer)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst pagetitle = this.titleContainer.querySelector('#pagetitle');\n\t\tif (pagetitle)\n\t\t{\n\t\t\tpagetitle.textContent = title;\n\t\t}\n\t}\n\n\tgetContainer(): ?HTMLElement\n\t{\n\t\treturn this.toolbarContainer;\n\t}\n\n\tgetRightButtonsContainer(): ?HTMLElement\n\t{\n\t\treturn this.rightButtons;\n\t}\n\n\tgetTitleEditor(): ?TitleEditor\n\t{\n\t\treturn this.#titleEditor;\n\t}\n\n\t#getClickOnCopyLinkButtonHandler(): Function\n\t{\n\t\tlet popup: ?Popup = null;\n\n\t\treturn () => {\n\t\t\tif (popup !== null)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst dataLink = Dom.attr(this.#copyLinkButton, 'data-link');\n\t\t\tconst currentPageLink = window.location.href;\n\t\t\tlet linkToCopy = Type.isStringFilled(dataLink) ? dataLink : currentPageLink;\n\t\t\tlinkToCopy = Uri.removeParam(linkToCopy, ['IFRAME', 'IFRAME_TYPE']);\n\n\t\t\tconst message = Dom.attr(this.#copyLinkButton, 'data-message');\n\n\t\t\tpopup = new Popup({\n\t\t\t\tbindElement: this.#copyLinkButton,\n\t\t\t\tangle: true,\n\t\t\t\tdarkMode: true,\n\t\t\t\tcontent: message,\n\t\t\t\tautoHide: true,\n\t\t\t\tcacheable: false,\n\t\t\t});\n\n\t\t\tpopup.setOffset({\n\t\t\t\toffsetLeft: Dom.getPosition(this.#copyLinkButton).width / 2,\n\t\t\t});\n\n\t\t\tpopup.show();\n\n\t\t\tBX.clipboard.copy(linkToCopy);\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tpopup = null;\n\t\t\t}, 1000);\n\t\t};\n\t}\n\n\t#initTitleEditor(options: ?TitleEditorOptions): TitleEditor\n\t{\n\t\tconst titleEditorOptions = Type.isPlainObject(options) ? options : {};\n\t\tconst titleEditor = new TitleEditor({ ...titleEditorOptions });\n\n\t\ttitleEditor.subscribe(TitleEditorEvents.beforeStartEditing, (editorEvent: BaseEvent) => {\n\t\t\tconst toolbarEvent: BaseEvent = new Event.BaseEvent();\n\n\t\t\tthis.emit(TitleEditorEvents.beforeStartEditing, toolbarEvent);\n\t\t\tif (toolbarEvent.isDefaultPrevented())\n\t\t\t{\n\t\t\t\teditorEvent.preventDefault();\n\t\t\t}\n\t\t});\n\n\t\ttitleEditor.subscribe(TitleEditorEvents.startEditing, () => {\n\t\t\tthis.emit(TitleEditorEvents.startEditing);\n\t\t});\n\n\t\ttitleEditor.subscribe(TitleEditorEvents.finishEditing, (event: BaseEvent) => {\n\t\t\tconst updatedTitle = event.getData().updatedTitle;\n\n\t\t\tthis.emit(TitleEditorEvents.finishEditing, {\n\t\t\t\tupdatedTitle,\n\t\t\t});\n\t\t});\n\n\t\treturn titleEditor;\n\t}\n}\n","import { Toolbar, type ToolbarOptions } from './toolbar';\n\nclass Manager\n{\n\ttoolbars: {[id: string]: Toolbar };\n\n\tconstructor()\n\t{\n\t\tthis.toolbars = {};\n\t}\n\n\tcreate(options: ToolbarOptions): Toolbar\n\t{\n\t\tconst toolbar = new Toolbar(options);\n\n\t\tif (this.get(toolbar.getId()))\n\t\t{\n\t\t\tthrow new Error(\"The toolbar instance with the same 'id' already exists.\");\n\t\t}\n\n\t\tthis.toolbars[toolbar.getId()] = toolbar;\n\n\t\treturn toolbar;\n\t}\n\n\tgetDefaultToolbar(): Toolbar | null\n\t{\n\t\treturn this.get('default-toolbar');\n\t}\n\n\tget(id: string): Toolbar | null\n\t{\n\t\treturn id in this.toolbars ? this.toolbars[id] : null;\n\t}\n}\n\nexport const ToolbarManager = new Manager();\n"],"names":["TitleEditorEvents","beforeStartEditing","startEditing","finishEditing","TitleEditor","options","setEventNamespace","isDisable","changeDisplay","textContent","enable","event","key","finishEdit","preventDefault","Event","BaseEvent","emit","isDefaultPrevented","value","Dom","addClass","focus","removeClass","updatedTitle","node","isShow","displayValue","style","EventEmitter","params","document","getElementById","querySelector","defaultTitle","bind","startEdit","onKeyUp","relatedTarget","cancelEdit","disabled","ToolbarStar","initialized","currentPageInMenu","starContNode","ready","init","subscribe","currentFullPath","attr","Type","isStringFilled","location","pathname","search","Uri","removeParam","top","BX","addCustomEvent","processMenuItemData","onStandardItemChangedSuccess","onCustomEvent","context","window","isObjectLike","title","Loc","getMessage","hasClass","isDomNode","showMessage","pageTitle","innerText","titleTemplate","getAttribute","replace","pageLink","isActive","isBoolean","message","popup","PopupWindowManager","create","content","darkMode","offsetTop","offsetLeft","angle","autoHide","events","onPopupClose","destroy","show","setTimeout","ToolbarEvents","Toolbar","_classPrivateMethodInitSpec","_classPrivateFieldInitSpec","titleMinWidth","isNumber","titleMaxWidth","filterMinWidth","filterMaxWidth","id","Text","getRandom","toolbarContainer","target","Error","titleContainer","filterContainer","filterButtons","rightButtons","afterTitleButtons","buttons","Object","buttonIds","isArray","length","forEach","buttonId","button","ButtonManager","createByUniqId","container","getContainer","originalWidth","offsetWidth","getIcon","getDataSet","toolbarCollapsedIcon","getColor","ButtonColor","PRIMARY","setDataSet","ButtonIcon","ADD","console","warn","getText","windowWidth","body","reduceItemsWidth","isWindowIncreased","increaseItemsWidth","titleEditor","active","previous","current","scrollWidth","getInnerTotalWidth","getContainerSize","values","getButtons","reverse","isCollapsed","setCollapsed","setIcon","item","newInnerWidth","icon","pagetitle","dataLink","currentPageLink","href","linkToCopy","Popup","bindElement","cacheable","setOffset","getPosition","width","clipboard","copy","titleEditorOptions","isPlainObject","editorEvent","toolbarEvent","getData","Manager","toolbars","toolbar","get","getId","ToolbarManager"],"mappings":"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"}