(function(t,e,a,n,i,l){"use strict";var s,r,o,c,d,v,u,p,b,h,g,f;function E(t,e){C(t,e);e.add(t)}function T(t,e,a){C(t,e);e.set(t,a)}function C(t,e){if(e.has(t)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function m(t,e,a){if(!e.has(t)){throw new TypeError("attempted to get private field on non-instance")}return a}var w=new WeakMap;var H=new WeakMap;var N=new WeakMap;var S=new WeakMap;var _=new WeakSet;var F=new WeakSet;var P=new WeakSet;var L=new WeakSet;var I=new WeakSet;var k=new WeakSet;var y=new WeakSet;var G=new WeakSet;var O=new WeakSet;var A=new WeakSet;var D=new WeakSet;var B=new WeakSet;var x=function(){function t(e){babelHelpers.classCallCheck(this,t);E(this,B);E(this,D);E(this,A);E(this,O);E(this,G);E(this,y);E(this,k);E(this,I);E(this,L);E(this,P);E(this,F);E(this,_);T(this,w,{writable:true,value:void 0});T(this,H,{writable:true,value:void 0});T(this,N,{writable:true,value:void 0});T(this,S,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(this,H,e);m(this,_,X).call(this)}babelHelpers.createClass(t,[{key:"onClickSave",value:function t(){var a=this;var n=i.ButtonManager.createFromNode(document.querySelector("#connection-button-save"));n.setWaiting(true);var l=m(this,O,K).call(this);if(babelHelpers.classPrivateFieldGet(this,H).sourceFields.id){l.id=babelHelpers.classPrivateFieldGet(this,H).sourceFields.id}m(this,A,Y).call(this).then((function(){return e.ajax.runAction("biconnector.externalsource.source.save",{data:{data:l}})})).then((function(t){BX.SidePanel.Instance.postMessage(window,"BIConnector:ExternalConnection:onConnectionSave",{connection:t.data.connection});if(babelHelpers.classPrivateFieldGet(a,H).closeAfterCreate){m(a,B,J).call(a)}else{m(a,D,V).call(a,t.data.connection);n.setWaiting(false)}}))["catch"]((function(t){var e;n.setWaiting(false);if(((e=t.errors)===null||e===void 0?void 0:e.length)>0){BX.UI.Notification.Center.notify({content:t.errors[0].message})}else{console.error(t)}BX.SidePanel.Instance.postMessage(window,"BIConnector:ExternalConnection:onConnectionCreationError")}))}}]);return t}();function X(){babelHelpers.classPrivateFieldSet(this,w,document.querySelector("#connection-form"));m(this,F,M).call(this);var t=e.Tag.render(s||(s=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="fields-wrapper"></div>\n\t\t'])));e.Dom.append(t,babelHelpers.classPrivateFieldGet(this,w));m(this,P,W).call(this);var a=e.Tag.render(r||(r=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="db-connection-button-block">\n\t\t\t\t<div class="db-connection-button"></div>\n\t\t\t\t<div class="db-connection-status"></div>\n\t\t\t</div>\n\t\t'])));e.Dom.append(a,babelHelpers.classPrivateFieldGet(this,w));m(this,I,q).call(this);m(this,k,U).call(this)}function M(){var t=e.Tag.render(o||(o=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="db-connection-hint">\n\t\t\t\t',"\n\t\t\t</div>\n\t\t"])),e.Loc.getMessage("EXTERNAL_CONNECTION_HINT",{"[link]":'<a class="ui-link" onclick="top.BX.Helper.show(`redirect=detail&code=23508958`)">',"[/link]":"</a>"}));e.Dom.append(t,babelHelpers.classPrivateFieldGet(this,w))}function W(){var t,a,n,i=this;var l=babelHelpers.classPrivateFieldGet(this,w).querySelector(".fields-wrapper");var s=(t=babelHelpers.classPrivateFieldGet(this,H).sourceFields)!==null&&t!==void 0?t:{};var r=e.Tag.render(c||(c=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="form-fields">\n\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t<div class="ui-form-label">\n\t\t\t\t\t\t<div class="ui-ctl-label-text">','</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="ui-ctl ui-ctl-after-icon ui-ctl-dropdown ui-ctl-w100">\n\t\t\t\t\t\t<div class="ui-ctl-after ui-ctl-icon-angle"></div>\n\t\t\t\t\t\t<select class="ui-ctl-element" data-code="type"></select>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t<div class="ui-form-label">\n\t\t\t\t\t\t<div class="ui-ctl-label-text">','</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="ui-form-content">\n\t\t\t\t\t\t<div class="ui-ctl ui-ctl-textbox ui-ctl-w100">\n\t\t\t\t\t\t\t<input \n\t\t\t\t\t\t\t\ttype="text" \n\t\t\t\t\t\t\t\tclass="ui-ctl-element" \n\t\t\t\t\t\t\t\tplaceholder="','" \n\t\t\t\t\t\t\t\tdata-code="title"\n\t\t\t\t\t\t\t\tvalue="','"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t'])),e.Loc.getMessage("EXTERNAL_CONNECTION_FIELD_TYPE"),e.Loc.getMessage("EXTERNAL_CONNECTION_FIELD_NAME"),e.Loc.getMessage("EXTERNAL_CONNECTION_FIELD_NAME_PLACEHOLDER"),(a=s.title)!==null&&a!==void 0?a:"");e.Dom.append(r,l);var o=l.querySelector('[data-code="type"]');babelHelpers.classPrivateFieldGet(this,H).supportedDatabases.forEach((function(t){e.Dom.append(e.Tag.render(d||(d=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<option \n\t\t\t\t\t\tvalue="','" \n\t\t\t\t\t\t',"\n\t\t\t\t\t>\n\t\t\t\t\t\t","\n\t\t\t\t\t</option>\n\t\t\t\t"])),t.code,s.type===t.code?"selected":"",t.name),o)}));e.Event.bind(o,"input",m(this,L,R).bind(this));if(s.id){var p=e.Tag.render(v||(v=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<input hidden value="','" data-code="id">\n\t\t\t'])),s.id);e.Dom.append(p,r);e.Dom.attr(o,"disabled",true)}var b=babelHelpers.classPrivateFieldGet(this,H).fieldsConfig;var h=(n=s.type)!==null&&n!==void 0?n:babelHelpers.classPrivateFieldGet(this,H).supportedDatabases[0].code;b[h].forEach((function(t){var a;var n=t.type;if(t.code==="password"){n="password"}var l=e.Tag.render(u||(u=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t<div class="ui-form-label">\n\t\t\t\t\t\t<div class="ui-ctl-label-text">','</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="ui-form-content">\n\t\t\t\t\t\t<div class="ui-ctl ui-ctl-textbox ui-ctl-w100">\n\t\t\t\t\t\t\t<input \n\t\t\t\t\t\t\t\ttype="','" \n\t\t\t\t\t\t\t\tclass="ui-ctl-element" \n\t\t\t\t\t\t\t\tdata-code="','"\n\t\t\t\t\t\t\t\tplaceholder="','" \n\t\t\t\t\t\t\t\tvalue="','"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t'])),t.name,n,t.code,t.placeholder,(a=s[t.code])!==null&&a!==void 0?a:"");e.Dom.append(l,r);e.Event.bind(l,"input",(function(){return m(i,y,j).call(i)}))}))}function R(t){babelHelpers.classPrivateFieldGet(this,H).sourceFields.type=t.target.value;e.Dom.clean(babelHelpers.classPrivateFieldGet(this,w).querySelector(".fields-wrapper"));m(this,P,W).call(this);m(this,y,j).call(this)}function q(){var t=this;var a=new i.Button({text:e.Loc.getMessage("EXTERNAL_CONNECTION_CHECK_BUTTON"),color:i.ButtonColor.PRIMARY,onclick:function e(a,n){n.preventDefault();m(t,A,Y).call(t)["catch"]((function(){}))},noCaps:true});a.renderTo(babelHelpers.classPrivateFieldGet(this,w).querySelector(".db-connection-button"));babelHelpers.classPrivateFieldSet(this,N,a)}function U(){babelHelpers.classPrivateFieldSet(this,S,babelHelpers.classPrivateFieldGet(this,w).querySelector(".db-connection-status"))}function j(){e.Dom.clean(babelHelpers.classPrivateFieldGet(this,S))}function z(t,a){e.Dom.clean(babelHelpers.classPrivateFieldGet(this,S));var n=null;if(t){n=e.Tag.render(p||(p=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="db-connection-success">\n\t\t\t\t\t<div class="ui-icon-set --check" style="--ui-icon-set__icon-size: 18px; --ui-icon-set__icon-color: var(--ui-color-palette-green-50);"></div>\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t"])),e.Loc.getMessage("EXTERNAL_CONNECTION_CHECK_SUCCESS"))}else{n=e.Tag.render(b||(b=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="db-connection-error">\n\t\t\t\t\t<div class="ui-icon-set --warning" style="--ui-icon-set__icon-size: 18px; --ui-icon-set__icon-color: var(--ui-color-palette-red-60);"></div>\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t"])),a.replaceAll(/\s+/g," "))}e.Dom.append(n,babelHelpers.classPrivateFieldGet(this,S))}function K(){var t={};babelHelpers.classPrivateFieldGet(this,w).querySelectorAll("[data-code]").forEach((function(e){t[e.getAttribute("data-code")]=e.value}));return t}function Y(){var t=this;babelHelpers.classPrivateFieldGet(this,N).setState(i.ButtonState.WAITING);return new Promise((function(a,n){e.ajax.runAction("biconnector.externalsource.source.checkConnectionByData",{data:{data:m(t,O,K).call(t)}}).then((function(e){m(t,G,z).call(t,true);babelHelpers.classPrivateFieldGet(t,N).setState(null);a(e)}))["catch"]((function(e){m(t,G,z).call(t,false,e.errors[0].message);babelHelpers.classPrivateFieldGet(t,N).setState(null);n()}))}))}function V(t){var a=this,i;var s=null;var r=!Object.hasOwn(babelHelpers.classPrivateFieldGet(this,H).sourceFields,"id")||babelHelpers.classPrivateFieldGet(this,H).sourceFields.active;var o=r?e.Tag.render(h||(h=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<a class="ui-btn ui-btn-md ui-btn-primary">\n\t\t\t\t',"\n\t\t\t</a>\n\t\t"])),e.Loc.getMessage("EXTERNAL_CONNECTION_CREATE_DATASET")):false;var c=e.Tag.render(g||(g=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<a class="ui-btn ui-btn-md ui-btn-light-border">\n\t\t\t\t',"\n\t\t\t</a>\n\t\t"])),e.Loc.getMessage("EXTERNAL_CONNECTION_CLOSE"));var d=function t(){m(a,B,J).call(a)};var v=(i=babelHelpers.classPrivateFieldGet(this,H).sourceFields.type)!==null&&i!==void 0?i:babelHelpers.classPrivateFieldGet(this,H).supportedDatabases[0].code;e.Event.bind(o,"click",(function(){d();l.Slider.open(v,0,{connectionId:t.id,connectionType:t.type})}));e.Event.bind(c,"click",(function(){d()}));var u=Boolean(babelHelpers.classPrivateFieldGet(this,H).sourceFields.id);var p=u?"EXTERNAL_CONNECTION_EDIT_SUCCESS":"EXTERNAL_CONNECTION_SAVE_SUCCESS";var b=e.Loc.getMessage(p,{"#CONNECTION_TITLE#":e.Text.encode(m(this,O,K).call(this).title)});var E=e.Tag.render(f||(f=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="biconnector-popup--full-height">\n\t\t\t\t<div class="biconnector-save-progress-popup">\n\t\t\t\t\t<div class="biconnector-save-progress-popup__content">\n\t\t\t\t\t\t<div class="biconnector-save-progress-popup__success-logo"></div>\n\t\t\t\t\t\t<div class="biconnector-save-progress-popup__texts">\n\t\t\t\t\t\t\t<h3 class="biconnector-save-progress-popup__header">','</h3>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="biconnector-save-progress-popup__buttons">\n\t\t\t\t\t\t\t',"\n\t\t\t\t\t\t\t","\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"])),b,o,c);s=new n.Popup({content:E,autoHide:true,events:{onPopupClose:d,onPopupDestroy:d},fixed:true,width:500,minHeight:299,closeIcon:true,noAllPaddings:true,overlay:true});s.show()}function J(){BX.SidePanel.Instance.postMessage(window,"BIConnector:ExternalConnection:onConnectionSliderClose");BX.SidePanel.Instance.getTopSlider().close()}e.Reflection.namespace("BX.BIConnector").ExternalConnectionForm=x})(this.window=this.window||{},BX,BX.Event,BX.Main,BX.UI,BX.BIConnector.DatasetImport);
//# sourceMappingURL=script.map.js