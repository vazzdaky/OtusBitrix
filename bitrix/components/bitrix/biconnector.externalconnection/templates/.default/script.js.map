{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import { ajax as Ajax, Dom, Event, Loc, Tag, Text, Reflection } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\nimport { Popup } from 'main.popup';\nimport { Button, ButtonColor, ButtonManager, ButtonState } from 'ui.buttons';\nimport { Slider as ImportSlider } from 'biconnector.dataset-import';\n\ntype SettingField = {\n\tname: string,\n\ttype: string,\n\tcode: string,\n\tplaceholder: string,\n}\n\ntype Props = {\n\tsourceFields: { id: number, title: string, type: string, active: boolean },\n\tfieldsConfig: { [key: string]: SettingField[] },\n\tsupportedDatabases: { code: string; name: string }[],\n\tcloseAfterCreate: boolean,\n}\n\nclass ExternalConnectionForm\n{\n\t#node: HTMLElement;\n\t#props: Props;\n\t#checkConnectButton: Button;\n\t#connectionStatusNode: HTMLElement;\n\n\tconstructor(props: Props)\n\t{\n\t\tthis.#props = props;\n\t\tthis.#initForm();\n\t}\n\n\t#initForm()\n\t{\n\t\tthis.#node = document.querySelector('#connection-form');\n\n\t\tthis.#initHint();\n\t\tconst fieldsNode = Tag.render`\n\t\t\t<div class=\"fields-wrapper\"></div>\n\t\t`;\n\t\tDom.append(fieldsNode, this.#node);\n\t\tthis.#initFields();\n\n\t\tconst buttonBlock = Tag.render`\n\t\t\t<div class=\"db-connection-button-block\">\n\t\t\t\t<div class=\"db-connection-button\"></div>\n\t\t\t\t<div class=\"db-connection-status\"></div>\n\t\t\t</div>\n\t\t`;\n\t\tDom.append(buttonBlock, this.#node);\n\n\t\tthis.#initCheckConnectButton();\n\t\tthis.#initConnectionStatusBlock();\n\t}\n\n\t#initHint()\n\t{\n\t\tconst hint = Tag.render`\n\t\t\t<div class=\"db-connection-hint\">\n\t\t\t\t${Loc.getMessage('EXTERNAL_CONNECTION_HINT', {\n\t\t\t\t\t'[link]': '<a class=\"ui-link\" onclick=\"top.BX.Helper.show(`redirect=detail&code=23508958`)\">',\n\t\t\t\t\t'[/link]': '</a>',\n\t\t\t\t})}\n\t\t\t</div>\n\t\t`;\n\t\tDom.append(hint, this.#node);\n\t}\n\n\t#initFields()\n\t{\n\t\tconst fieldsNode = this.#node.querySelector('.fields-wrapper');\n\t\tconst sourceFields = this.#props.sourceFields ?? {};\n\t\tconst fields = Tag.render`\n\t\t\t<div class=\"form-fields\">\n\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t<div class=\"ui-form-label\">\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">${Loc.getMessage('EXTERNAL_CONNECTION_FIELD_TYPE')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown ui-ctl-w100\">\n\t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t\t\t<select class=\"ui-ctl-element\" data-code=\"type\"></select>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t<div class=\"ui-form-label\">\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">${Loc.getMessage('EXTERNAL_CONNECTION_FIELD_NAME')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ui-form-content\">\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-w100\">\n\t\t\t\t\t\t\t<input \n\t\t\t\t\t\t\t\ttype=\"text\" \n\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\" \n\t\t\t\t\t\t\t\tplaceholder=\"${Loc.getMessage('EXTERNAL_CONNECTION_FIELD_NAME_PLACEHOLDER')}\" \n\t\t\t\t\t\t\t\tdata-code=\"title\"\n\t\t\t\t\t\t\t\tvalue=\"${sourceFields.title ?? ''}\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t\tDom.append(fields, fieldsNode);\n\n\t\tconst typeSelector = fieldsNode.querySelector('[data-code=\"type\"]');\n\t\tthis.#props.supportedDatabases.forEach((database) => {\n\t\t\tDom.append(\n\t\t\t\tTag.render`\n\t\t\t\t\t<option \n\t\t\t\t\t\tvalue=\"${database.code}\" \n\t\t\t\t\t\t${sourceFields.type === database.code ? 'selected' : ''}\n\t\t\t\t\t>\n\t\t\t\t\t\t${database.name}\n\t\t\t\t\t</option>\n\t\t\t\t`,\n\t\t\t\ttypeSelector,\n\t\t\t);\n\t\t});\n\t\tEvent.bind(typeSelector, 'input', this.#onChangeType.bind(this));\n\n\t\tif (sourceFields.id)\n\t\t{\n\t\t\tconst fieldId = Tag.render`\n\t\t\t\t<input hidden value=\"${sourceFields.id}\" data-code=\"id\">\n\t\t\t`;\n\t\t\tDom.append(fieldId, fields);\n\n\t\t\tDom.attr(typeSelector, 'disabled', true);\n\t\t}\n\n\t\tconst fieldConfig = this.#props.fieldsConfig;\n\t\tconst connectionType = sourceFields.type ?? this.#props.supportedDatabases[0].code;\n\t\tfieldConfig[connectionType].forEach((field: SettingField) => {\n\t\t\tlet fieldType = field.type;\n\t\t\tif (field.code === 'password')\n\t\t\t{\n\t\t\t\tfieldType = 'password';\n\t\t\t}\n\t\t\tconst fieldNode = Tag.render`\n\t\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t\t<div class=\"ui-form-label\">\n\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">${field.name}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ui-form-content\">\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-w100\">\n\t\t\t\t\t\t\t<input \n\t\t\t\t\t\t\t\ttype=\"${fieldType}\" \n\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\" \n\t\t\t\t\t\t\t\tdata-code=\"${field.code}\"\n\t\t\t\t\t\t\t\tplaceholder=\"${field.placeholder}\" \n\t\t\t\t\t\t\t\tvalue=\"${sourceFields[field.code] ?? ''}\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t\tDom.append(fieldNode, fields);\n\t\t\tEvent.bind(fieldNode, 'input', () => this.#clearConnectionStatus());\n\t\t});\n\t}\n\n\t#onChangeType(event)\n\t{\n\t\tthis.#props.sourceFields.type = event.target.value;\n\t\tDom.clean(this.#node.querySelector('.fields-wrapper'));\n\t\tthis.#initFields();\n\t\tthis.#clearConnectionStatus();\n\t}\n\n\t#initCheckConnectButton()\n\t{\n\t\tconst connectButton = new Button({\n\t\t\ttext: Loc.getMessage('EXTERNAL_CONNECTION_CHECK_BUTTON'),\n\t\t\tcolor: ButtonColor.PRIMARY,\n\t\t\tonclick: (button: Button, event: BaseEvent) => {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tthis.#onCheckConnectClick()\n\t\t\t\t\t.catch(() => {});\n\t\t\t},\n\t\t\tnoCaps: true,\n\t\t});\n\t\tconnectButton.renderTo(this.#node.querySelector('.db-connection-button'));\n\t\tthis.#checkConnectButton = connectButton;\n\t}\n\n\t#initConnectionStatusBlock()\n\t{\n\t\tthis.#connectionStatusNode = this.#node.querySelector('.db-connection-status');\n\t}\n\n\t#clearConnectionStatus()\n\t{\n\t\tDom.clean(this.#connectionStatusNode);\n\t}\n\n\t#updateConnectionStatus(succedeed: boolean, errorMessage: string)\n\t{\n\t\tDom.clean(this.#connectionStatusNode);\n\t\tlet status = null;\n\t\tif (succedeed)\n\t\t{\n\t\t\tstatus = Tag.render`\n\t\t\t\t<div class=\"db-connection-success\">\n\t\t\t\t\t<div class=\"ui-icon-set --check\" style=\"--ui-icon-set__icon-size: 18px; --ui-icon-set__icon-color: var(--ui-color-palette-green-50);\"></div>\n\t\t\t\t\t${Loc.getMessage('EXTERNAL_CONNECTION_CHECK_SUCCESS')}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tstatus = Tag.render`\n\t\t\t\t<div class=\"db-connection-error\">\n\t\t\t\t\t<div class=\"ui-icon-set --warning\" style=\"--ui-icon-set__icon-size: 18px; --ui-icon-set__icon-color: var(--ui-color-palette-red-60);\"></div>\n\t\t\t\t\t${errorMessage.replaceAll(/\\s+/g, ' ')}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\t\tDom.append(status, this.#connectionStatusNode);\n\t}\n\n\t#getConnectionValues(): Object\n\t{\n\t\tconst result = {};\n\t\tthis.#node.querySelectorAll('[data-code]').forEach((field) => {\n\t\t\tresult[field.getAttribute('data-code')] = field.value;\n\t\t});\n\n\t\treturn result;\n\t}\n\n\t#onCheckConnectClick(): Promise\n\t{\n\t\tthis.#checkConnectButton.setState(ButtonState.WAITING);\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tAjax.runAction('biconnector.externalsource.source.checkConnectionByData', {\n\t\t\t\tdata: {\n\t\t\t\t\tdata: this.#getConnectionValues(),\n\t\t\t\t},\n\t\t\t})\n\t\t\t\t.then((response) => {\n\t\t\t\t\tthis.#updateConnectionStatus(true);\n\t\t\t\t\tthis.#checkConnectButton.setState(null);\n\n\t\t\t\t\tresolve(response);\n\t\t\t\t})\n\t\t\t\t.catch((response) => {\n\t\t\t\t\tthis.#updateConnectionStatus(false, response.errors[0].message);\n\t\t\t\t\tthis.#checkConnectButton.setState(null);\n\n\t\t\t\t\treject();\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\t}\n\n\tonClickSave()\n\t{\n\t\tconst saveButton = ButtonManager.createFromNode(document.querySelector('#connection-button-save'));\n\t\tsaveButton.setWaiting(true);\n\t\tconst connectionValues = this.#getConnectionValues();\n\t\tif (this.#props.sourceFields.id)\n\t\t{\n\t\t\tconnectionValues.id = this.#props.sourceFields.id;\n\t\t}\n\n\t\tthis.#onCheckConnectClick()\n\t\t\t.then(() => {\n\t\t\t\treturn Ajax.runAction('biconnector.externalsource.source.save', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tdata: connectionValues,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tBX.SidePanel.Instance.postMessage(window, 'BIConnector:ExternalConnection:onConnectionSave', {\n\t\t\t\t\tconnection: response.data.connection,\n\t\t\t\t});\n\t\t\t\tif (this.#props.closeAfterCreate)\n\t\t\t\t{\n\t\t\t\t\tthis.#closeSlider();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.#showSaveSuccessPopup(response.data.connection);\n\t\t\t\t\tsaveButton.setWaiting(false);\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tsaveButton.setWaiting(false);\n\t\t\t\tif (response.errors?.length > 0)\n\t\t\t\t{\n\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: response.errors[0].message,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconsole.error(response);\n\t\t\t\t}\n\t\t\t\tBX.SidePanel.Instance.postMessage(window, 'BIConnector:ExternalConnection:onConnectionCreationError');\n\t\t\t});\n\t}\n\n\t#showSaveSuccessPopup(connection: { id: any, name: string, type: string })\n\t{\n\t\tlet popup: ?Popup = null;\n\n\t\t// show for new or active sources only\n\t\tconst showCreateDatasetButton = !(Object.hasOwn(this.#props.sourceFields, 'id')) || this.#props.sourceFields.active;\n\t\tconst createDatasetButton = showCreateDatasetButton ? Tag.render`\n\t\t\t<a class=\"ui-btn ui-btn-md ui-btn-primary\">\n\t\t\t\t${Loc.getMessage('EXTERNAL_CONNECTION_CREATE_DATASET')}\n\t\t\t</a>\n\t\t` : false;\n\n\t\tconst closeButton = Tag.render`\n\t\t\t<a class=\"ui-btn ui-btn-md ui-btn-light-border\">\n\t\t\t\t${Loc.getMessage('EXTERNAL_CONNECTION_CLOSE')}\n\t\t\t</a>\n\t\t`;\n\n\t\tconst onPopupClose = () => {\n\t\t\tthis.#closeSlider();\n\t\t};\n\n\t\tconst sourceType = this.#props.sourceFields.type ?? this.#props.supportedDatabases[0].code;\n\n\t\tEvent.bind(createDatasetButton, 'click', () => {\n\t\t\tonPopupClose();\n\t\t\tImportSlider.open(sourceType, 0, {\n\t\t\t\tconnectionId: connection.id,\n\t\t\t\tconnectionType: connection.type,\n\t\t\t});\n\t\t});\n\n\t\tEvent.bind(closeButton, 'click', () => {\n\t\t\tonPopupClose();\n\t\t});\n\n\t\tconst isEditMode = Boolean(this.#props.sourceFields.id);\n\t\tconst popupMessageCode = isEditMode ? 'EXTERNAL_CONNECTION_EDIT_SUCCESS' : 'EXTERNAL_CONNECTION_SAVE_SUCCESS';\n\t\tconst popupText = Loc.getMessage(\n\t\t\tpopupMessageCode,\n\t\t\t{ '#CONNECTION_TITLE#': Text.encode(this.#getConnectionValues().title) },\n\t\t);\n\n\t\tconst popupContent = Tag.render`\n\t\t\t<div class=\"biconnector-popup--full-height\">\n\t\t\t\t<div class=\"biconnector-save-progress-popup\">\n\t\t\t\t\t<div class=\"biconnector-save-progress-popup__content\">\n\t\t\t\t\t\t<div class=\"biconnector-save-progress-popup__success-logo\"></div>\n\t\t\t\t\t\t<div class=\"biconnector-save-progress-popup__texts\">\n\t\t\t\t\t\t\t<h3 class=\"biconnector-save-progress-popup__header\">${popupText}</h3>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"biconnector-save-progress-popup__buttons\">\n\t\t\t\t\t\t\t${createDatasetButton}\n\t\t\t\t\t\t\t${closeButton}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tpopup = new Popup({\n\t\t\tcontent: popupContent,\n\t\t\tautoHide: true,\n\t\t\tevents: {\n\t\t\t\tonPopupClose,\n\t\t\t\tonPopupDestroy: onPopupClose,\n\t\t\t},\n\t\t\tfixed: true,\n\t\t\twidth: 500,\n\t\t\tminHeight: 299,\n\t\t\tcloseIcon: true,\n\t\t\tnoAllPaddings: true,\n\t\t\toverlay: true,\n\t\t});\n\n\t\tpopup.show();\n\t}\n\n\t#closeSlider()\n\t{\n\t\tBX.SidePanel.Instance.postMessage(window, 'BIConnector:ExternalConnection:onConnectionSliderClose');\n\t\tBX.SidePanel.Instance.getTopSlider().close();\n\t}\n}\n\nReflection.namespace('BX.BIConnector').ExternalConnectionForm = ExternalConnectionForm;\n"],"names":["ExternalConnectionForm","props","saveButton","ButtonManager","createFromNode","document","querySelector","setWaiting","connectionValues","sourceFields","id","then","Ajax","runAction","data","response","BX","SidePanel","Instance","postMessage","window","connection","closeAfterCreate","errors","length","UI","Notification","Center","notify","content","message","console","error","fieldsNode","Tag","render","Dom","append","buttonBlock","hint","Loc","getMessage","fields","title","typeSelector","supportedDatabases","forEach","database","code","type","name","Event","bind","fieldId","attr","fieldConfig","fieldsConfig","connectionType","field","fieldType","fieldNode","placeholder","event","target","value","clean","connectButton","Button","text","color","ButtonColor","PRIMARY","onclick","button","preventDefault","noCaps","renderTo","succedeed","errorMessage","status","replaceAll","result","querySelectorAll","getAttribute","setState","ButtonState","WAITING","Promise","resolve","reject","popup","showCreateDatasetButton","Object","hasOwn","active","createDatasetButton","closeButton","onPopupClose","sourceType","ImportSlider","open","connectionId","isEditMode","Boolean","popupMessageCode","popupText","Text","encode","popupContent","Popup","autoHide","events","onPopupDestroy","fixed","width","minHeight","closeIcon","noAllPaddings","overlay","show","getTopSlider","close","Reflection","namespace"],"mappings":"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"}