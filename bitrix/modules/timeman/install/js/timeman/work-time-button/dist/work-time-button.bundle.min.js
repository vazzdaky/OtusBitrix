this.BX=this.BX||{};(function(e,t,i,s){"use strict";function a(e,t){n(e,t);t.add(e)}function l(e,t,i){n(e,t);t.set(e,i)}function n(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function r(e,t,i){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return i}var o=Object.freeze({Closed:"CLOSED",Opened:"OPENED",Paused:"PAUSED",Expired:"EXPIRED"});var h=Object.freeze({Open:"OPEN",Reopen:"REOPEN"});var c=new WeakMap;var u=new WeakMap;var v=new WeakMap;var d=new WeakMap;var p=new WeakSet;var T=new WeakSet;var b=new WeakSet;var f=new WeakSet;var E=new WeakSet;var w=new WeakSet;var I=new WeakSet;var S=new WeakSet;var M=new WeakSet;var P=new WeakSet;var O=new WeakSet;var B=new WeakSet;var _=new WeakSet;var k=new WeakSet;var N=new WeakSet;var F=function(){function e(){babelHelpers.classCallCheck(this,e);a(this,N);a(this,k);a(this,_);a(this,B);a(this,O);a(this,P);a(this,M);a(this,S);a(this,I);a(this,w);a(this,E);a(this,f);a(this,b);a(this,T);a(this,p);l(this,c,{writable:true,value:{}});l(this,u,{writable:true,value:void 0});l(this,v,{writable:true,value:void 0});l(this,d,{writable:true,value:void 0});var n=t.Extension.getSettings("timeman.work-time-button");babelHelpers.classPrivateFieldGet(this,c).workReport=n.get("workReport");babelHelpers.classPrivateFieldGet(this,c).info=n.get("info");babelHelpers.classPrivateFieldGet(this,c).siteId=n.get("siteId");babelHelpers.classPrivateFieldSet(this,u,new s.Button({size:s.Button.Size.MEDIUM,text:r(this,S,X).call(this),icon:r(this,M,C).call(this),useAirDesign:true,style:r(this,P,D).call(this),noCaps:true,wide:true,events:{click:r(this,I,G).bind(this)},className:"timeman-work-time-button"}));babelHelpers.classPrivateFieldSet(this,v,babelHelpers.classPrivateFieldGet(this,u).render());i.EventEmitter.subscribe("onTimemanInit",r(this,E,R).bind(this));i.EventEmitter.subscribe("onTimeManDataRecieved",r(this,w,g).bind(this));window.BX.timeman("bx_tm",babelHelpers.classPrivateFieldGet(this,c).info,babelHelpers.classPrivateFieldGet(this,c).siteId)}babelHelpers.createClass(e,[{key:"render",value:function e(){return babelHelpers.classPrivateFieldGet(this,v)}}]);return e}();function m(){return babelHelpers.classPrivateFieldGet(this,c).info.STATE}function A(){var e,t;return(e=(t=babelHelpers.classPrivateFieldGet(this,c).info)===null||t===void 0?void 0:t.CAN_OPEN)!==null&&e!==void 0?e:null}function H(){return babelHelpers.classPrivateFieldGet(this,c).info.INFO.DATE_START}function W(){return babelHelpers.classPrivateFieldGet(this,c).info.INFO.TIME_LEAKS}function R(){r(this,O,y).call(this);window.BXTIMEMAN.initFormWeekly(babelHelpers.classPrivateFieldGet(this,c).workReport)}function g(e){var t=e.getCompatData(),i=babelHelpers.slicedToArray(t,1),s=i[0];babelHelpers.classPrivateFieldGet(this,c).info=s;babelHelpers.classPrivateFieldGet(this,u).setText(r(this,S,X).call(this));babelHelpers.classPrivateFieldGet(this,u).setIcon(r(this,M,C).call(this));babelHelpers.classPrivateFieldGet(this,u).setStyle(r(this,P,D).call(this));r(this,O,y).call(this)}function G(e,t){t.stopPropagation();window.BXTIMEMAN.setBindOptions({node:babelHelpers.classPrivateFieldGet(this,v),mode:"popup",popupOptions:{autoHide:true,angle:false,offsetTop:-40,closeByEsc:true,bindOptions:{forceBindPosition:true,forceTop:true,forceLeft:false},events:{onClose:function e(){},onDestroy:function e(){}}}});window.BXTIMEMAN.Open()}function X(){if(r(this,p,m).call(this)===o.Closed&&r(this,T,A).call(this)===h.Open){return t.Loc.getMessage("TIMEMAN_WORK_TIME_BUTTON_TEXT_START")}if(r(this,p,m).call(this)===o.Opened){return r(this,k,x).call(this)}if(r(this,p,m).call(this)===o.Paused){return t.Loc.getMessage("TIMEMAN_WORK_TIME_BUTTON_TEXT_CONTINUE")}if(r(this,p,m).call(this)===o.Closed&&r(this,T,A).call(this)===h.Reopen){return t.Loc.getMessage("TIMEMAN_WORK_TIME_BUTTON_TEXT_CONTINUE")}if(r(this,p,m).call(this)===o.Expired){return t.Loc.getMessage("TIMEMAN_WORK_TIME_BUTTON_TEXT_EXPIRED")}return""}function C(){if(r(this,p,m).call(this)===o.Closed&&r(this,T,A).call(this)===h.Open){return s.ButtonIcon.START}if(r(this,p,m).call(this)===o.Opened){return s.ButtonIcon.START}if(r(this,p,m).call(this)===o.Paused){return s.ButtonIcon.START}if(r(this,p,m).call(this)===o.Closed&&r(this,T,A).call(this)===h.Reopen){return s.ButtonIcon.REFRESH}if(r(this,p,m).call(this)===o.Expired){return s.ButtonIcon.ALERT}return null}function D(){if(r(this,p,m).call(this)===o.Opened){return s.AirButtonStyle.TINTED}if(r(this,p,m).call(this)===o.Paused){return s.AirButtonStyle.FILLED}if(r(this,p,m).call(this)===o.Closed&&r(this,T,A).call(this)===h.Reopen){return s.AirButtonStyle.TINTED}if(r(this,p,m).call(this)===o.Expired){return s.AirButtonStyle.TINTED_ALERT}return s.AirButtonStyle.FILLED}function y(){r(this,_,U).call(this);if(r(this,p,m).call(this)===o.Opened){r(this,B,L).call(this)}}function L(){var e=this;babelHelpers.classPrivateFieldSet(this,d,setInterval((function(){babelHelpers.classPrivateFieldGet(e,u).setText(r(e,k,x).call(e))}),1e3))}function U(){clearInterval(babelHelpers.classPrivateFieldGet(this,d))}function x(){var e=Math.floor(Date.now()/1e3);var t=e-r(this,b,H).call(this)-(r(this,f,W).call(this)||0);if(t<0){return r(this,N,K).call(this,0,0,0)}var i=Math.floor(t/3600);var s=Math.floor(t%3600/60);var a=t%60;return r(this,N,K).call(this,i,s,a)}function K(e,i,s){var a=function e(t){return(t!==null&&t!==void 0?t:0).toString().padStart(2,"0")};return t.Loc.getMessage("TIMEMAN_WORK_TIME_BUTTON_TEXT_WORKING").replace("#time#","".concat(a(e),":").concat(a(i),":").concat(a(s)))}e.WorkTimeButton=F})(this.BX.Timeman=this.BX.Timeman||{},BX,BX.Event,BX.UI);
//# sourceMappingURL=work-time-button.bundle.map.js