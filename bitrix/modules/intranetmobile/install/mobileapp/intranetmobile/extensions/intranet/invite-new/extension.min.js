jn.define("intranet/invite-new",((t,e,n)=>{const{PureComponent:i}=t("layout/pure-component");const{Loc:s}=t("loc");const{Box:r}=t("ui-system/layout/box");const{BoxFooter:a}=t("ui-system/layout/dialog-footer");const{AnalyticsEvent:o,IntranetInviteAnalytics:c}=t("intranet/invite-new/src/analytics");const{Indent:l}=t("tokens");const{Button:u,ButtonDesign:I,ButtonSize:h}=t("ui-system/form/buttons/button");const{UIMenu:d}=t("layout/ui/menu");const{ContentStatusBlock:v}=t("intranet/invite-new/src/content-status-block");const{InviterFactory:p}=t("intranet/invite-new/src/inviter/factory");const{InviteCases:m}=t("intranet/invite-new/src/inviter/type");const{getSmartphoneContacts:g}=t("layout/ui/smartphone-contact-selector");const{createTestIdGenerator:y}=t("utils/test");class C extends i{static getAjaxErrorText(t){return t.map((t=>{if(t.message){return t.message.replace("<br/>:","\n").replace("<br/>","\n")}return t.replace("<br/>:","\n").replace("<br/>","\n")})).filter((t=>t.length>0)).join("\n")}constructor(t){super(t);this.smartphoneContacts=null;this.getTestId=y({prefix:"invite"});this.#t(t)}async componentDidMount(){const{department:t=null}=this.state;this.updateDepartmentInInviters(t);this.smartphoneContacts=await g()}#t(t){const{department:e=null}=t;this.state={department:e};this.inviters=Object.values(m).map((t=>p.createInviterByCase(t,this.#e()))).sort(((t,e)=>t.getSortOrder()-e.getSortOrder()))}updateDepartmentInInviters(t){this.inviters.forEach((e=>e.updateDepartment(t)))}#e=()=>{const{canInviteByLink:t,canInviteByEmail:e,canInviteBySMS:n,adminConfirm:i,analytics:s,layout:r,isBitrix24Included:a,isInviteWithLocalEmailAppEnabled:o,creatorEmailConfirmed:c=false,multipleInvite:l=true,onInviteSentHandler:u=null,onInviteError:I=null}=this.props;return{canInviteByLink:t,canInviteByEmail:e,canInviteBySMS:n,adminConfirm:i,analytics:s,layout:r,isBitrix24Included:a,isInviteWithLocalEmailAppEnabled:o,creatorEmailConfirmed:c,multipleInvite:l,onInviteSentHandler:u,onInviteError:I,selectedDepartmentChanged:this.#n,initialContacts:this.smartphoneContacts,onUIMenuItemSelected:this.onUIMenuItemSelected,getDepartment:this.getDepartment,onInviteLinkChanged:this.onInviteLinkChanged}};onUIMenuItemSelected=()=>{this.menu.hide()};onInviteLinkChanged=t=>{this.inviters.filter((t=>t.shouldUpdateInviteLink())).forEach((e=>{e.setInviteLink?.(t)}))};getDepartment=()=>this.state.department;render(){const{analytics:t,layout:e}=this.props;const{department:n}=this.state;return r({footer:this.#i(),style:{paddingVertical:l.XL3.toNumber()}},v({testId:this.getTestId("status-block"),analytics:t,layout:e,department:n,selectedDepartmentChanged:this.#n,graphicsUri:this.#s().getGraphicsUri()}))}#n=t=>{const{analytics:e}=this.props;e.setDepartmentParam(t!==null);this.setState({department:t},(()=>{this.updateDepartmentInInviters(t)}))};#i(){const{isBitrix24Included:t}=this.props;return a({safeArea:true,testId:this.getTestId("buttons")},this.#s().renderMainButton(),t&&u({testId:this.getTestId("by-other-button"),forwardRef:this.#r,text:s.getMessage("INTRANET_INVITE_BY_OTHER_BUTTON_TEXT"),size:h.M,design:I.PLAN_ACCENT,stretched:true,onClick:()=>{this.#a()}}))}#o(){return this.inviters.filter((t=>t.isAvailableInviteMethod()))}#s(){const t=this.#o().filter((t=>!t.isDisabledInviteMethod()));if(t.length>0){return t[0]}return this.inviters[0]}#r=t=>{this.inviteCasesButtonRef=t};#a=()=>{this.menu=new d(this.#c());this.menu.show({target:this.inviteCasesButtonRef})};#c=()=>{const t=this.#s().getInviteCase();return this.#o().filter((e=>e.getInviteCase()!==t)).map((t=>t.getItemForUIMenu()))}}n.exports={Invite:C,AnalyticsEvent:o,IntranetInviteAnalytics:c}}));
//# sourceMappingURL=extension.map.js