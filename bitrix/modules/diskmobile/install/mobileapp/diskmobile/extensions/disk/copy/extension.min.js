jn.define("disk/copy",((e,t,s)=>{const{Loc:o}=e("loc");const{DirectorySelector:n}=e("selector/widget/entity/tree-selectors/directory-selector");const a=e("statemanager/redux/store");const{dispatch:c}=a;const{copy:r}=e("disk/statemanager/redux/slices/files/thunk");const{selectById:i}=e("disk/statemanager/redux/slices/files/selector");const{selectById:d}=e("disk/statemanager/redux/slices/storages");const{showToast:l}=e("toast");const{openFolder:g}=e("disk/opener/folder");const{fetchObjectWithRights:S}=e("disk/rights");function _(e,t,s,c=PageManager){const r=i(a.getState(),e);const d=new n({widgetParams:{backdrop:{mediumPositionPercent:70,horizontalSwipeAllowed:false},sendButtonName:o.getMessage("M_DISK_COPY_SELECTOR_BUTTON")},allowMultipleSelection:false,closeOnSelect:false,events:{onClose:({parentItem:t})=>{const o=t.rootObjectId||t.id;p(e,o,{context:s,parentWidget:c})}},provider:{storageId:s.storageId||r.storageId,options:{showDirectoriesOnly:false,canSelectFiles:false,order:t,context:s}}});d.getSelector().show({},c)}async function p(e,t,s){const n=i(a.getState(),e);const _=await S(t);if(!_||n.parentId===t){return}let p=_.name;if(_.parentId===0){const e=d(a.getState(),_.storageId);if(e.type==="user"){p=o.getMessage("M_DISK_COPY_MY_STORAGE_NAME")}}if(_.rights.canAdd===false){l({message:o.getMessage("M_DISK_COPY_ACCESS_DENIED_TOAST_MESSAGE",{"#FOLDER#":p})},s.parentWidget);return}c(r({objectId:e,targetId:_.id,onFulfilledSuccess:()=>{const e=n.typeFile?"M_DISK_COPY_FILE_TOAST_MESSAGE":"M_DISK_COPY_FOLDER_TOAST_MESSAGE";l({message:o.getMessage(e,{"#FOLDER#":p}),buttonText:o.getMessage("M_DISK_COPY_TOAST_BUTTON"),onButtonTap:()=>{g(_.id,s.context,s.parentWidget).catch((e=>console.error(e)))}},s.parentWidget)}}))}s.exports={copyObject:_}}));
//# sourceMappingURL=extension.map.js