{"version":3,"file":"script.js","sources":["src/options.js","src/controllers/default-controller.js","src/controllers/preset-custom-controller.js","src/utils.js","src/controllers/preset-default-controller.js","src/controllers/settings-controller.js","src/backend.js","src/items/item.js","src/items/item-user-favorites.js","src/items/item-user-self.js","src/items/item-admin-shared.js","src/items/item-admin-custom.js","src/items/item-main-page.js","src/items/item-system.js","src/items/item-group.js","src/items/item-group-system.js","src/items/index.js","src/items/item-active.js","src/controllers/items-controller.js","src/controllers/item-director.js","src/analytics.js","src/group-panel.js","src/menu.js"],"sourcesContent":["import { Type } from 'main.core';\n\nexport default class Options\n{\n\tstatic version = '2021.10';\n\tstatic eventNameSpace = 'BX.Intranet.LeftMenu:';\n\n\tstatic eventName(name): string\n\t{\n\t\treturn ['BX.Intranet.LeftMenu:', ...(Type.isStringFilled(name) ? [name] : name)].join(':');\n\t}\n\n\tstatic isExtranet = false;\n\tstatic isAdmin = false;\n\tstatic isCustomPresetRestricted = false;\n\tstatic settingsPath = null;\n\tstatic isMainPageEnabled = false;\n\n\tstatic availablePresetTools = null;\n\tstatic inviteDialogLink = null;\n\tstatic showMarta = null;\n\tstatic showSitemapMenuItem = null;\n}\n","import {Loc} from 'main.core';\nimport {Menu, MenuItem} from 'main.popup';\nimport {EventEmitter, BaseEvent} from 'main.core.events';\nimport Options from '../options';\n\nexport default class DefaultController\n{\n\tcontainer;\n\t#popup = null;\n\n\tconstructor(\n\t\tcontainer, {\n\t\t\tevents\n\t\t}\n\t)\n\t{\n\t\tthis.container = container;\n\t\tif (events)\n\t\t{\n\t\t\tArray\n\t\t\t\t.from(Object.keys(events))\n\t\t\t\t.forEach((key) => {\n\t\t\t\t\tEventEmitter.subscribe(this, Options.eventName(key), events[key])\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\t}\n\n\tgetContainer(): ?Element\n\t{\n\t\treturn this.container;\n\t}\n\n\tcreatePopup(): Popup\n\t{\n\n\t}\n\n\tgetPopup()\n\t{\n\t\treturn this.#popup;\n\t}\n\n\tshow()\n\t{\n\t\tif (this.#popup === null)\n\t\t{\n\t\t\tthis.#popup = this.createPopup(...arguments);\n\t\t\tEventEmitter.subscribe(this.#popup, 'onClose', () => {\n\t\t\t\tEventEmitter.emit(this, Options.eventName('onClose'));\n\t\t\t});\n\t\t\tEventEmitter.subscribe(this.#popup, 'onShow', () => {\n\t\t\t\tEventEmitter.emit(this, Options.eventName('onShow'));\n\t\t\t});\n\t\t\tEventEmitter.subscribe(this.#popup, 'onDestroy', () => {\n\t\t\t\tthis.#popup = null;\n\t\t\t});\n\t\t}\n\t\tthis.#popup.show()\n\t}\n\n\thide()\n\t{\n\t\tif (this.#popup)\n\t\t{\n\t\t\tthis.#popup.close();\n\t\t}\n\t}\n}\n","import { type Button } from 'ui.buttons';\nimport { Loc, Tag } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { PopupManager, type Popup } from 'main.popup';\nimport DefaultController from './default-controller';\nimport Options from '../options';\nimport { CancelButton, SaveButton } from 'ui.buttons';\n\nexport default class PresetCustomController extends DefaultController\n{\n\tisReady: boolean = true;\n\n\tcreatePopup(): Popup\n\t{\n\t\tconst form = Tag.render`\n\t\t\t<form id=\"customPresetForm\" style=\"min-width: 350px;\">\n\t\t\t\t<div style=\"margin: 15px 0 15px 9px;\">\n\t\t\t\t\t<input type=\"radio\" name=\"userScope\" id=\"customPresetCurrentUser\" value=\"currentUser\">\n\t\t\t\t\t<label for=\"customPresetCurrentUser\">${Loc.getMessage('MENU_CUSTOM_PRESET_CURRENT_USER')}</label>\n\t\t\t\t</div>\n\t\t\t\t<div style=\"margin: 0 0 38px 9px;\">\n\t\t\t\t\t<input type=\"radio\" name=\"userScope\" id=\"customPresetNewUser\" value=\"newUser\" checked>\n\t\t\t\t\t<label for=\"customPresetNewUser\">${Loc.getMessage('MENU_CUSTOM_PRESET_NEW_USER')}</label>\n\t\t\t\t</div>\n\t\t\t\t<hr style=\"background-color: #edeef0; border: none; color:  #edeef0; height: 1px;\">\n\t\t\t</form>\n\t\t`\n\t\t;\n\n\t\treturn PopupManager.create('custom-preset-form-popup', null, {\n\t\t\toverlay: true,\n\t\t\tcontentColor: 'white',\n\t\t\tcontentNoPaddings: true,\n\t\t\tlightShadow: true,\n\t\t\tdraggable: { restrict: true },\n\t\t\tcloseByEsc: true,\n\t\t\ttitleBar: Loc.getMessage('MENU_CUSTOM_PRESET_POPUP_TITLE'),\n\t\t\toffsetTop: 1,\n\t\t\toffsetLeft: 20,\n\t\t\tcacheable: false,\n\t\t\tcloseIcon: true,\n\t\t\tcontent: form,\n\t\t\tbuttons: [\n\t\t\t\t(new SaveButton({\n\t\t\t\t\tonclick: (button: Button) => {\n\t\t\t\t\t\tif (this.isReady === false)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbutton.setWaiting(true);\n\t\t\t\t\t\tthis.isReady = false;\n\t\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onPresetIsSet'), form.elements.userScope.value === 'newUser')\n\t\t\t\t\t\t\t.forEach((promise) => {\n\t\t\t\t\t\t\t\tpromise\n\t\t\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\t\t\tbutton.setWaiting(false);\n\t\t\t\t\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\t\t\t\t\tPopupManager.create('menu-custom-preset-success-popup', null, {\n\t\t\t\t\t\t\t\t\t\t\tcloseIcon: true,\n\t\t\t\t\t\t\t\t\t\t\tcontentColor: 'white',\n\t\t\t\t\t\t\t\t\t\t\ttitleBar: Loc.getMessage('MENU_CUSTOM_PRESET_POPUP_TITLE'),\n\t\t\t\t\t\t\t\t\t\t\tcontent: Loc.getMessage('MENU_CUSTOM_PRESET_SUCCESS'),\n\t\t\t\t\t\t\t\t\t\t}).show();\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t.catch(() => {\n\t\t\t\t\t\t\t\t\t\tconsole.log('Error!!');\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t;\n\t\t\t\t\t\tthis.isReady = true;\n\t\t\t\t\t},\n\t\t\t\t})),\n\t\t\t\tnew CancelButton({\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t],\n\t\t});\n\t}\n}\n","import { Loc, Reflection, Runtime, Uri } from 'main.core';\n\nexport default class Utils\n{\n\tstatic #curPage = null;\n\tstatic #curUri = null;\n\n\tstatic getCurPage(): ?String\n\t{\n\t\tif (this.#curPage === null)\n\t\t{\n\t\t\tthis.#curPage = document.location.pathname + document.location.search;\n\t\t}\n\n\t\treturn this.#curPage === '' ? null : this.#curPage;\n\t}\n\n\tstatic getCurUri(): Uri\n\t{\n\t\tif (this.#curUri === null)\n\t\t{\n\t\t\tthis.#curUri = new Uri(document.location.href);\n\t\t}\n\n\t\treturn this.#curUri;\n\t}\n\n\tstatic catchError(response): void\n\t{\n\t\tRuntime.loadExtension('ui.notification')\n\t\t\t.then(() => {\n\t\t\t\tconst notificationCenter = Reflection.getClass('BX.UI.Notification.Center');\n\t\t\t\tnotificationCenter.notify({\n\t\t\t\t\tcontent: [\n\t\t\t\t\t\tLoc.getMessage('MENU_ERROR_OCCURRED'),\n\t\t\t\t\t\t(response.errors ? `: ${response.errors[0].message}` : ''),\n\t\t\t\t\t].join(' '),\n\t\t\t\t\tposition: 'bottom-left',\n\t\t\t\t\tcategory: 'menu-self-item-popup',\n\t\t\t\t\tautoHideDelay: 3000,\n\t\t\t\t});\n\t\t\t})\n\t\t\t.catch(() => {\n\t\t\t\tconsole.log('LeftMenu: cannot load ui.notification.');\n\t\t\t})\n\t\t;\n\t}\n\n\tstatic refineUrl(originUrl: string): string\n\t{\n\t\tlet url = String(originUrl).trim();\n\t\tif (url !== '')\n\t\t{\n\t\t\tif (!/^https?:\\/\\//i.test(url) && !/^\\//i.test(url))\n\t\t\t{\n\t\t\t\t// for external links like \"google.com\" (without a protocol)\n\t\t\t\turl = `https://${url}`;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst link = document.createElement('a');\n\t\t\t\tlink.href = url;\n\n\t\t\t\tif (document.location.host === link.host)\n\t\t\t\t{\n\t\t\t\t\t// http://portal.com/path/ => /path/\n\t\t\t\t\turl = link.pathname + link.search + link.hash;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn url;\n\t}\n}\n","import {Loc, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {PopupManager} from 'main.popup';\nimport DefaultController from './default-controller';\nimport Options from \"../options\";\nimport Utils from \"../utils\";\nimport {CancelButton, CreateButton} from 'ui.buttons';\nimport {MessageBox, MessageBoxButtons} from \"ui.dialogs.messagebox\";\n\nexport default class PresetDefaultController extends DefaultController\n{\n\tisReady: boolean = true;\n\t#unavailableToolPopup: ?MessageBox;\n\t#mode: string;\n\n\tcreatePopup(mode): Popup\n\t{\n\t\tlet button;\n\t\tthis.#mode = mode;\n\t\tconst content = document.querySelector('#left-menu-preset-popup').cloneNode(true);\n\t\treturn PopupManager.create(\n\t\t\tthis.constructor.name.toString(), null, {\n\t\t\toverlay: true,\n\t\t\tcontentColor : \"white\",\n\t\t\tcontentNoPaddings : true,\n\t\t\tlightShadow: true,\n\t\t\tdraggable: {restrict: true},\n\t\t\tcloseByEsc: true,\n\t\t\toffsetTop: 1,\n\t\t\toffsetLeft: 20,\n\t\t\tcacheable: false,\n\t\t\tcloseIcon: true,\n\t\t\tcontent: content,\n\t\t\tevents: {\n\t\t\t\tonFirstShow: () => {\n\t\t\t\t\t[...content.querySelectorAll('.js-left-menu-preset-item')]\n\t\t\t\t\t\t.forEach((node) => {\n\t\t\t\t\t\t\tnode.addEventListener('click', () => {\n\t\t\t\t\t\t\t\t[...content.querySelectorAll('.js-left-menu-preset-item')]\n\t\t\t\t\t\t\t\t\t.forEach((otherNode) => {\n\t\t\t\t\t\t\t\t\t\totherNode.classList[otherNode === node ? 'add' : 'remove']('left-menu-popup-selected');\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t})\n\t\t\t\t\t;\n\t\t\t\t}\n\t\t\t},\n\t\t\tbuttons: [\n\t\t\t\t(button = new CreateButton({\n\t\t\t\t\ttext: Loc.getMessage('MENU_CONFIRM_BUTTON'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\tif (button.isWaiting())\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbutton.setWaiting(true);\n\t\t\t\t\tconst currentPreset = this.getSelectedPreset();\n\n\t\t\t\t\tif (!Options.isAdmin && Options.availablePresetTools && Options.availablePresetTools[currentPreset] === false)\n\t\t\t\t\t{\n\t\t\t\t\t\tbutton.setWaiting(false);\n\t\t\t\t\t\tthis.showUnavailableToolPopup();\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onPresetIsSet'),\n\t\t\t\t\t\t{presetId: currentPreset, mode})\n\t\t\t\t\t\t.forEach((promise) => {\n\t\t\t\t\t\t\tpromise\n\t\t\t\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\t\t\t\tbutton.setWaiting(false);\n\t\t\t\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\t\t\t\tif (response.data.hasOwnProperty(\"url\"))\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tdocument.location.href = response.data.url;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tdocument.location.reload();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch(Utils.catchError)\n\t\t\t\t\t\t\t;\n\t\t\t\t\t\t})\n\t\t\t\t\t;\n\t\t\t\t}})),\n\t\t\t\tnew CancelButton({\n\t\t\t\t\ttext: Loc.getMessage('MENU_DELAY_BUTTON'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onPresetIsPostponed'), {mode});\n\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t} }),\n\t\t\t]\n\t\t});\n\t}\n\n\tgetMode(): string\n\t{\n\t\treturn this.#mode;\n\t}\n\n\tgetSelectedPreset()\n\t{\n\t\tlet currentPreset = '';\n\t\tif (document.forms['left-menu-preset-form'])\n\t\t{\n\t\t\t[...document.forms['left-menu-preset-form']\n\t\t\t\t.elements['presetType']]\n\t\t\t\t.forEach((node) => {\n\t\t\t\t\tif (node.checked)\n\t\t\t\t\t{\n\t\t\t\t\t\tcurrentPreset = node.value;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\n\t\treturn currentPreset;\n\t}\n\n\tshowUnavailableToolPopup(): void\n\t{\n\t\tif (!(this.#unavailableToolPopup instanceof MessageBox))\n\t\t{\n\t\t\tthis.#unavailableToolPopup = MessageBox.create({\n\t\t\t\tmessage: Loc.getMessage('MENU_UNAVAILABLE_TOOL_POPUP_DESCRIPTION'),\n\t\t\t\tbuttons: MessageBoxButtons.OK,\n\t\t\t});\n\t\t}\n\n\t\tthis.#unavailableToolPopup.show();\n\t}\n}","import { Type } from 'main.core';\nimport { Menu, MenuItem, type MenuItemOptions, Popup } from 'main.popup';\nimport { EventEmitter } from 'main.core.events';\nimport Options from '../options';\nimport DefaultController from './default-controller';\n\nexport default class SettingsController extends DefaultController\n{\n\tmenuId = 'leftMenuSettingsPopup';\n\n\tcreatePopup(): Popup\n\t{\n\t\tconst menu = new Menu({\n\t\t\tbindElement: this.container,\n\t\t\ttargetContainer: document.querySelector('.js-app__left-menu'),\n\t\t\titems: this.getItems(),\n\t\t\tangle: true,\n\t\t\toffsetTop: 0,\n\t\t\toffsetLeft: 50,\n\t\t});\n\n\t\treturn menu.getPopupWindow();\n\t}\n\n\tgetItems(): Array\n\t{\n\t\tconst notHandledMenuItems = EventEmitter.emit(this, Options.eventName('onGettingSettingMenuItems'));\n\n\t\treturn this.#getMenuItems([...notHandledMenuItems][0]);\n\t}\n\n\t#getMenuItems(items: MenuItemOptions[]): MenuItemOptions[]\n\t{\n\t\tif (Type.isArray(items) === false)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\treturn items.map((item) => {\n\t\t\treturn this.#getMenuItem(item);\n\t\t});\n\t}\n\n\t#getMenuItem(data: MenuItemOptions): MenuItemOptions\n\t{\n\t\tif (!Type.isPlainObject(data))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst { text, html, onclick, className, items = [], delimiter = false } = data;\n\n\t\treturn {\n\t\t\thtml,\n\t\t\ttext: html ? undefined : text,\n\t\t\titems: this.#getMenuItems(items),\n\t\t\tdelimiter,\n\t\t\tclassName: `menu-popup-no-icon ${className}`,\n\t\t\tonclick: (event, item: MenuItem) => {\n\t\t\t\tif (!Type.isArrayFilled(items))\n\t\t\t\t{\n\t\t\t\t\titem.getMenuWindow().close();\n\t\t\t\t}\n\t\t\t\titem.getMenuWindow().getParentMenuItem()?.getMenuWindow()?.close();\n\n\t\t\t\tif (onclick)\n\t\t\t\t{\n\t\t\t\t\tonclick(event, item);\n\t\t\t\t}\n\t\t\t},\n\t\t};\n\t}\n}\n","import {ajax, Loc} from 'main.core';\nimport Options from './options';\n\nexport default class Backend\n{\n\tstatic toggleMenu(collapse)\n\t{\n\t\tif (Loc.getMessage('USER_ID') <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst siteDir = Loc.getMessage('SITE_DIR') || '/';\n\t\tconst context = window.location.pathname.toString().startsWith(`${siteDir}online/`) ? 'online' : '';\n\n\t\treturn ajax.runAction(`intranet.leftmenu.${collapse ? \"collapseMenu\" : \"expandMenu\"}`, {\n\t\t\tdata: {\n\t\t\t\tcontext,\n\t\t\t},\n\t\t\tanalyticsLabel: { leftmenu: {action: collapse ? \"collapseMenu\" : \"expandMenu\"} }\n\t\t});\n\t}\n\n\tstatic saveSelfItemMenu(itemData) {\n\t\tconst action =  itemData.id > 0 ? \"update\" : \"add\";\n\t\treturn ajax.runAction(`intranet.leftmenu.${action}SelfItem`, {\n\t\t\tdata: {itemData: itemData },\n\t\t\tanalyticsLabel: { leftmenu: {action: 'selfItemAddOrUpdate'} }\n\t\t});\n\t}\n\n\tstatic deleteSelfITem(id) {\n\t\treturn ajax.runAction('intranet.leftmenu.deleteSelfItem', {\n\t\t\tdata: {menuItemId: id},\n\t\t\tanalyticsLabel: {leftmenu: {action: 'selfItemDelete'}}\n\t\t});\n\t}\n\n\tstatic addFavoritesItemMenu(itemData) {\n\t\treturn ajax.runAction('intranet.leftmenu.addStandartItem', {\n\t\t\tdata: { itemData: itemData },\n\t\t\tanalyticsLabel: {leftmenu: {action: 'standardItemAdd'}}\n\t\t});\n\t}\n\n\tstatic deleteFavoritesItemMenu(itemData) {\n\t\treturn ajax.runAction('intranet.leftmenu.deleteStandartItem', {\n\t\t\tdata: { itemData: itemData },\n\t\t\tanalyticsLabel: {leftmenu: {action: 'standardItemDelete'}}\n\t\t});\n\t}\n\n\tstatic updateFavoritesItemMenu(itemData) {\n\t\treturn ajax.runAction('intranet.leftmenu.updateStandartItem', {\n\t\t\tdata: {\n\t\t\t\titemText: itemData.text,\n\t\t\t\titemId: itemData.id,\n\t\t\t},\n\t\t\tanalyticsLabel: {leftmenu: {action: 'standardItemUpdate'}}\n\t\t})\n\t}\n\tstatic addAdminSharedItemMenu(itemData) {\n\t\treturn ajax.runAction('intranet.leftmenu.addItemToAll', {\n\t\t\tdata: { itemInfo: itemData },\n\t\t\tanalyticsLabel: {leftmenu: {action: 'adminItemAdd'}}\n\t\t});\n\t}\n\n\tstatic deleteAdminSharedItemMenu(id) {\n\t\treturn ajax.runAction('intranet.leftmenu.deleteItemFromAll', {\n\t\t\tdata: { menu_item_id: id},\n\t\t\tanalyticsLabel: {leftmenu: {action: 'adminItemDelete'}}\n\t\t});\n\t}\n\n\tstatic saveItemsSort(menuItems, firstItemLink, analyticsLabel)\n\t{\n\t\treturn ajax.runAction('intranet.leftmenu.saveItemsSort', {\n\t\t\tdata: {\n\t\t\t\titems: menuItems,\n\t\t\t\tfirstItemLink: firstItemLink,\n\t\t\t\tversion: Options.version\n\t\t\t},\n\t\t\tanalyticsLabel: {leftmenu: analyticsLabel}\n\t\t});\n\t}\n\n\tstatic setFirstPage(firstPageLink)\n\t{\n\t\treturn ajax.runAction('intranet.leftmenu.setFirstPage', {\n\t\t\tdata: {firstPageUrl: firstPageLink},\n\t\t\tanalyticsLabel: {leftmenu: {action: 'mainPageIsSet'}}\n\t\t})\n\t}\n\n\tstatic setDefaultPreset()\n\t{\n\t\treturn ajax.runAction('intranet.leftmenu.setDefaultMenu', {\n\t\t\tdata: {},\n\t\t\tanalyticsLabel: {leftmenu: {action: 'defaultMenuIsSet'}}\n\t\t});\n\t}\n\n\tstatic setCustomPreset(forNewUsersOnly, itemsSort, customItems, firstItemLink)\n\t{\n\t\treturn ajax.runAction('intranet.leftmenu.saveCustomPreset', {\n\t\t\tdata: {\n\t\t\t\tuserApply: forNewUsersOnly === true ? 'newUser' : 'currentUser',\n\t\t\t\titemsSort: itemsSort,\n\t\t\t\tcustomItems: customItems,\n\t\t\t\tfirstItemLink: firstItemLink,\n\t\t\t\tversion: Options.version\n\t\t\t},\n\t\t\tanalyticsLabel: { leftmenu: {action: 'customPresetIsSet'} }\n\t\t});\n\t}\n\n\tstatic deleteCustomItem(id)\n\t{\n\t\treturn ajax.runAction('intranet.leftmenu.deleteCustomItemFromAll', {\n\t\t\tdata: {menu_item_id: id},\n\t\t\tanalyticsLabel: {leftmenu: {action: 'customItemDelete'}}\n\t\t});\n\t}\n\n\tstatic setSystemPreset(mode, presetId)\n\t{\n\t\treturn ajax.runAction('intranet.leftmenu.setPreset', {\n\t\t\tdata: {\n\t\t\t\tpreset: presetId,\n\t\t\t\tmode: mode === 'global' ? 'global' : 'personal'\n\t\t\t},\n\t\t\tanalyticsLabel: {\n\t\t\t\tleftmenu: {\n\t\t\t\t\taction: 'systemPresetIsSet',\n\t\t\t\t\tpresetId: presetId,\n\t\t\t\t\tmode: mode,\n\t\t\t\t\tanalyticsFirst: mode === 'global' ? 'y' : 'n'\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic postponeSystemPreset(mode)\n\t{\n\t\treturn ajax.runAction('intranet.leftmenu.delaySetPreset', {\n\t\t\tdata: {},\n\t\t\tanalyticsLabel: {\n\t\t\t\tleftmenu: {\n\t\t\t\t\taction: 'systemPresetIsPostponed',\n\t\t\t\t\tmode: mode,\n\t\t\t\t\tanalyticsFirst: mode === 'global' ? 'y' : 'n'\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic clearCache()\n\t{\n\t\treturn ajax.runAction('intranet.leftmenu.clearCache', {\n\t\t\tdata: {},\n\t\t\tanalyticsLabel: { leftmenu: {action: 'clearCache'} }\n\t\t});\n\t}\n\n\tstatic expandGroup(id)\n\t{\n\t\tif (Loc.getMessage('USER_ID') <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\treturn ajax.runAction('intranet.leftmenu.expandMenuGroup', {\n\t\t\tdata: {id},\n\t\t\tanalyticsLabel: { leftmenu: {action: 'expandMenuGroup' }}\n\t\t});\n\t}\n\n\tstatic collapseGroup(id)\n\t{\n\t\tif (Loc.getMessage('USER_ID') <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\treturn ajax.runAction('intranet.leftmenu.collapseMenuGroup', {\n\t\t\tdata: {id},\n\t\t\tanalyticsLabel: { leftmenu: {action: 'collapseMenuGroup' }}\n\t\t});\n\t}\n}\n","import {Event, Uri, Type, Loc, Text, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {PopupManager, Menu, MenuItem} from 'main.popup';\nimport Options from \"../options\";\nimport Utils from \"../utils\";\nimport {SaveButton, CancelButton} from 'ui.buttons';\n\nexport default class Item\n{\n\tstatic code = 'abstract';\n\n\tparentContainer: Element;\n\tcontainer: Element;\n\tlinks = [];\n\tisDraggable = true;\n\tstorage: Array = [];\n\n\tconstructor(parentContainer, container)\n\t{\n\t\tthis.parentContainer = parentContainer;\n\t\tthis.container = container;\n\t\tthis.init();\n\n\t\tthis.onDeleteAsFavorites = this.onDeleteAsFavorites.bind(this);\n\t\tsetTimeout(() => {\n\t\t\tEventEmitter.subscribe(EventEmitter.GLOBAL_TARGET, Options.eventName('onItemDeleteAsFavorites'), this.onDeleteAsFavorites);\n\t\t\tEventEmitter.incrementMaxListeners(EventEmitter.GLOBAL_TARGET, Options.eventName('onItemDeleteAsFavorites'));\n\t\t\tEventEmitter.subscribe(this, Options.eventName('onItemDelete'), this.destroy.bind(this));\n\t\t}, 0);\n\t\tthis.showError = this.showError.bind(this);\n\t\tthis.showMessage = this.showMessage.bind(this);\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.container.dataset.id;\n\t}\n\n\tgetCode(): string\n\t{\n\t\treturn this.constructor.code;\n\t}\n\n\tgetName()\n\t{\n\t\treturn this.container.querySelector(\"[data-role='item-text']\").textContent;\n\t}\n\n\tcanDelete(): boolean\n\t{\n\t\treturn false;\n\t}\n\n\tdelete()\n\t{\n\t\t// Just do it.\n\t}\n\n\tinit()\n\t{\n\t\tthis.links = [];\n\t\tif (\n\t\t\tthis.container.hasAttribute('data-link')\n\t\t\t&& Type.isStringFilled(this.container.getAttribute(\"data-link\"))\n\t\t)\n\t\t{\n\t\t\tthis.links.push(\n\t\t\t\tthis.container.getAttribute(\"data-link\")\n\t\t\t);\n\t\t}\n\n\t\tif (this.container\n\t\t\t.hasAttribute(\"data-all-links\"))\n\t\t{\n\t\t\tthis.container\n\t\t\t\t.getAttribute(\"data-all-links\")\n\t\t\t\t.split(\",\")\n\t\t\t\t.forEach((link) => {\n\t\t\t\t\tlink = String(link).trim();\n\t\t\t\t\tif (Type.isStringFilled(link))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.links.push(\n\t\t\t\t\t\t\tlink\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\t\tthis.makeTextIcons();\n\t\tthis.storage = this.container.dataset.storage.split(',');\n\t}\n\n\tupdate({link, openInNewPage, text})\n\t{\n\t\topenInNewPage = (openInNewPage === 'Y' ? 'Y' : 'N');\n\n\t\tif (this.container.hasAttribute('data-link'))\n\t\t{\n\t\t\tthis.container.setAttribute('data-link', Text.encode(link));\n\t\t\tthis.container.setAttribute('data-new-page', openInNewPage);\n\t\t}\n\n\t\tconst linkNode = this.container.querySelector('a');\n\t\tif (linkNode)\n\t\t{\n\t\t\tif (Type.isString(link))\n\t\t\t{\n\t\t\t\tlinkNode.setAttribute('href', Text.encode(link));\n\t\t\t}\n\n\t\t\tlinkNode.setAttribute('target', openInNewPage === 'Y' ? '_blank' : '_self');\n\t\t}\n\t\tthis.container.querySelector(\"[data-role='item-text']\").innerHTML = Text.encode(text);\n\t\tthis.init();\n\t}\n\n\tdestroy()\n\t{\n\t\tEventEmitter.unsubscribe(EventEmitter.GLOBAL_TARGET, Options.eventName('onItemDeleteAsFavorites'), this.onDeleteAsFavorites);\n\t\tEventEmitter.decrementMaxListeners(EventEmitter.GLOBAL_TARGET, 'onItemDeleteAsFavorites');\n\t}\n\n\tgetSimilarToUrl(currentUri: Uri): Array\n\t{\n\t\tconst result = [];\n\n\t\tthis.links.forEach((link, index) => {\n\t\t\tif (areUrlsEqual(link, currentUri))\n\t\t\t{\n\t\t\t\tlet priority = 0;\n\t\t\t\tif (index === 0) // main link is in higher priority\n\t\t\t\t{\n\t\t\t\t\tpriority = this.getCode() === 'default' ? 2 : 1;\n\t\t\t\t}\n\n\t\t\t\tresult.push({\n\t\t\t\t\tpriority,\n\t\t\t\t\turl: link,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tmakeTextIcons()\n\t{\n\t\tif (!this.container.classList.contains(\"menu-item-no-icon-state\"))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst icon = this.container.querySelector(\".menu-item-icon\");\n\t\tconst text = this.container.querySelector(\".menu-item-link-text\");\n\n\t\tif (icon && text)\n\t\t{\n\t\t\ticon.textContent = getShortName(text.textContent);\n\t\t}\n\t}\n\n\tgetCounterValue(): ?number\n\t{\n\t\tconst node = this.container.querySelector('[data-role=\"counter\"]');\n\t\tif (!node)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\treturn parseInt(node.dataset.counterValue);\n\t}\n\n\tupdateCounter(counterValue)\n\t{\n\t\tconst node = this.container.querySelector('[data-role=\"counter\"]');\n\t\tif (!node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst oldValue = parseInt(node.dataset.counterValue) || 0;\n\t\tnode.dataset.counterValue = counterValue;\n\n\t\tif (counterValue > 0)\n\t\t{\n\t\t\tnode.innerHTML = (counterValue > 99 ? '99+' : counterValue);\n\t\t\tthis.container.classList.add('menu-item-with-index');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnode.innerHTML = '';\n\t\t\tthis.container.classList.remove('menu-item-with-index');\n\t\t\tif (counterValue < 0) // TODO need to know what it means\n\t\t\t{\n\t\t\t\tconst warning = BX('menu-counter-warning-' + this.getId());\n\t\t\t\tif (warning)\n\t\t\t\t{\n\t\t\t\t\twarning.style.display = 'inline-block';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn {oldValue, newValue: counterValue};\n\t}\n\n\tmarkAsActive()\n\t{\n\t\tconsole.error('This action is only for the group');\n\t}\n\n\tshowWarning(title, events)\n\t{\n\t\tthis.removeWarning();\n\t\tconst link = this.container.querySelector(\"a.menu-item-link\");\n\t\tif (!link)\n\t\t{\n\t\t\treturn\n\t\t}\n\t\ttitle = title ? Text.encode(title) : '';\n\t\tconst node = Tag.render`<a class=\"menu-post-warn-icon\" title=\"${title}\"></a>`;\n\t\tif (events)\n\t\t{\n\t\t\tObject.keys(events).forEach((key) => {\n\t\t\t\tEvent.bind(node, key, events[key]);\n\t\t\t});\n\t\t}\n\t\tthis.container.classList.add(\"menu-item-warning-state\");\n\t\tlink.appendChild(node);\n\t}\n\n\tremoveWarning()\n\t{\n\t\tif (!this.container.classList.contains('menu-item-warning-state'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.container.classList.remove('menu-item-warning-state');\n\t\tlet node;\n\t\twhile (node = this.container.querySelector(\"a.menu-post-warn-icon\"))\n\t\t{\n\t\t\tnode.parentNode.removeChild(node);\n\t\t}\n\t}\n\n\tshowMessagePopup;\n\tshowMessage(message)\n\t{\n\t\tif (this.showMessagePopup)\n\t\t{\n\t\t\tthis.showMessagePopup.close();\n\t\t}\n\t\tthis.showMessagePopup = PopupManager.create(\"left-menu-message\", this.container,\n\t\t\t{\n\t\t\t\tcontent: '<div class=\"left-menu-message-popup\">' + message + '</div>',\n\t\t\t\tdarkMode: true,\n\t\t\t\toffsetTop: 2,\n\t\t\t\toffsetLeft: 0,\n\t\t\t\tangle: true,\n\t\t\t\tevents: {\n\t\t\t\t\tonClose: () => { this.showMessagePopup = null;}\n\t\t\t\t},\n\t\t\t\tautoHide: true\n\t\t\t});\n\n\t\tthis.showMessagePopup.show();\n\n\t\tsetTimeout(() => { if (this.showMessagePopup) {this.showMessagePopup.close()} }, 3000);\n\t}\n\n\tshowError(response)\n\t{\n\t\tconst errors = [];\n\t\tif (response.errors)\n\t\t{\n\t\t\terrors.push(response.errors[0].message);\n\t\t}\n\t\telse if (response instanceof TypeError)\n\t\t{\n\t\t\terrors.push(response.message);\n\t\t}\n\n\t\tconst message = [Loc.getMessage(\"MENU_ERROR_OCCURRED\"), ...errors].join(' ');\n\t\tthis.showMessage(message);\n\t}\n\n\tgetDropDownActions(): Array\n\t{\n\t\treturn [];\n\t}\n\n\tgetEditFields(): Object\n\t{\n\t\treturn {id: this.getId(), text: this.getName()};\n\t}\n\n\tonDeleteAsFavorites({data})\n\t{\n\t\tif (String(data.id) === String(this.getId()))\n\t\t{\n\t\t\tif (this.getCode() === 'standard'/* instanceof ItemUserFavorites*/)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(this, Options.eventName('onItemDelete'), {\n\t\t\t\t\titem: this,\n\t\t\t\t\tanimate: true\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.storage = [...this.storage].filter((v) => {return v !== 'standard'});\n\t\t\t\tthis.container.dataset.storage = this.storage.join(',');\n\t\t\t}\n\t\t\tEventEmitter.unsubscribe(EventEmitter.GLOBAL_TARGET, Options.eventName('onItemDeleteAsFavorites'), this.onDeleteAsFavorites);\n\t\t\tEventEmitter.decrementMaxListeners(EventEmitter.GLOBAL_TARGET, Options.eventName('onItemDeleteAsFavorites'));\n\t\t\t}\n\t}\n\n\tstatic detect(node)\n\t{\n\t\treturn node.getAttribute(\"data-role\") !== 'group' &&\n\t\t\tnode.getAttribute(\"data-type\") === this.code;\n\t}\n\n\tstatic createNode({id, text, link, openInNewPage, counterId, counterValue, topMenuId})\n\t{\n\t\tid = Text.encode(id);\n\t\ttext = Text.encode(text);\n\t\tlink = Text.encode(link);\n\t\tcounterId = counterId ? Text.encode(counterId) : '';\n\t\tcounterValue = counterValue ? parseInt(counterValue) : 0;\n\t\topenInNewPage = openInNewPage === 'Y' ? 'Y' : 'N';\n\t\treturn Tag.render`<li \n\t\t\tid=\"bx_left_menu_${id}\" \n\t\t\tdata-status=\"show\" \n\t\t\tdata-id=\"${id}\" \n\t\t\tdata-role=\"item\"\n\t\t\tdata-storage=\"\" \n\t\t\tdata-counter-id=\"${counterId}\" \n\t\t\tdata-link=\"${link}\" \n\t\t\tdata-all-links=\"\" \n\t\t\tdata-type=\"${this.code}\" \n\t\t\tdata-delete-perm=\"Y\" \n\t\t\t${topMenuId ? `data-top-menu-id=\"${Text.encode(topMenuId)}\"` : \"\"}\n\t\t\tdata-new-page=\"${openInNewPage}\" \n\t\t\tclass=\"menu-item-block menu-item-no-icon-state\">\n\t\t\t\t<span class=\"menu-favorites-btn menu-favorites-draggable\">\n\t\t\t\t\t<span class=\"menu-fav-draggable-icon\"></span>\n\t\t\t\t</span>\n\t\t\t\t<a class=\"menu-item-link\" data-slider-ignore-autobinding=\"true\" href=\"${link}\" target=\"${openInNewPage === 'Y' ? '_blank' : '_self'}\">\n\t\t\t\t\t<span class=\"menu-item-icon-box\">\n\t\t\t\t\t\t<span class=\"menu-item-icon\">W</span>\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class=\"menu-item-link-text \" data-role=\"item-text\">${text}</span>\n\t\t\t\t\t${counterId ? \n\t\t\t\t\t`<span class=\"menu-item-index-wrap\">\n\t\t\t\t\t\t<span data-role=\"counter\"\n\t\t\t\t\t\t\tdata-counter-value=\"${counterValue}\" class=\"menu-item-index\" id=\"menu-counter-${counterId}\">${counterValue}</span>\n\t\t\t\t\t</span>` : '' }\n\t\t\t\t</a>\n\t\t\t\t<span data-role=\"item-edit-control\" class=\"menu-fav-editable-btn menu-favorites-btn\">\n\t\t\t\t\t<span class=\"menu-favorites-btn-icon\"></span>\n\t\t\t\t</span>\n\t\t\t</li>`;\n\t}\n\n\t//region Edition for siblings\n\tstatic backendSaveItem(itemInfo): Promise\n\t{\n\t\tthrow 'Function backendSaveItem must be replaced';\n\t}\n\tstatic popup: Popup;\n\tstatic showUpdate(item: Item)\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.showForm(item.container, item.getEditFields(), resolve, reject);\n\t\t});\n\t}\n\tstatic checkForm(form: HTMLFormElement): boolean\n\t{\n\t\tif (String(form.elements[\"text\"].value).trim().length <= 0)\n\t\t{\n\t\t\tform.elements[\"text\"].classList.add('menu-form-input-error');\n\t\t\tform.elements[\"text\"].focus();\n\t\t\treturn false;\n\t\t}\n\t\tif (form.elements[\"link\"])\n\t\t{\n\t\t\tif (String(form.elements[\"link\"].value).trim().length <= 0 ||\n\t\t\t\tUtils.refineUrl(form.elements[\"link\"].value).length <= 0)\n\t\t\t{\n\t\t\t\tform.elements[\"link\"].classList.add('menu-form-input-error');\n\t\t\t\tform.elements[\"link\"].focus();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tform.elements[\"link\"].value = Utils.refineUrl(form.elements[\"link\"].value);\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\tstatic showForm(bindElement, itemInfo, resolve, reject)\n\t{\n\t\tif (this.popup)\n\t\t{\n\t\t\tthis.popup.close();\n\t\t}\n\n\t\tconst isEditMode = itemInfo.id !== '';\n\t\tconst form = Tag.render`\n<form name=\"menuAddToFavoriteForm\">\n\t<input type=\"hidden\" name=\"id\" value=\"${Text.encode(itemInfo.id || '')}\">\n\t<label for=\"menuPageToFavoriteName\" class=\"menu-form-label\">${Loc.getMessage(\"MENU_ITEM_NAME\")}</label>\n\t<input name=\"text\" type=\"text\" id=\"menuPageToFavoriteName\" class=\"menu-form-input\" value=\"${Text.encode(itemInfo.text || '')}\" >\n\t${itemInfo['link'] !== undefined ? `<br><br>\n\t<label for=\"menuPageToFavoriteLink\" class=\"menu-form-label\">${Loc.getMessage(\"MENU_ITEM_LINK\")}</label>\n\t<input name=\"link\" id=\"menuPageToFavoriteLink\" type=\"text\" class=\"menu-form-input\" value=\"${Text.encode(itemInfo.link)}\" >` : ''}\n\t${itemInfo['openInNewPage'] !== undefined ? `<br><br>\n\t<input name=\"openInNewPage\" id=\"menuOpenInNewPage\" type=\"checkbox\" value=\"Y\" ${itemInfo.openInNewPage === 'Y' ? 'checked' : ''} >\n\t<label for=\"menuOpenInNewPage\" class=\"menu-form-label\">${Loc.getMessage(\"MENU_OPEN_IN_NEW_PAGE\")}</label>` : ''}\n</form>`;\n\t\tObject.keys(itemInfo)\n\t\t\t.forEach((key) => {\n\t\t\t\tif (['id', 'text', 'link', 'openInNewPage'].indexOf(key) < 0)\n\t\t\t\t{\n\t\t\t\t\tconst name = Text.encode(key);\n\t\t\t\t\tconst value = Text.encode(itemInfo[key]);\n\t\t\t\t\tform.appendChild(\n\t\t\t\t\t\tTag.render`<input type=\"hidden\" name=\"${name}\" value=\"${value}\">`\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\n\t\tthis.popup = PopupManager.create('menu-self-item-popup', bindElement, {\n\t\t\tclassName: 'menu-self-item-popup',\n\t\t\ttitleBar: (itemInfo['link'] === undefined ? Loc.getMessage(\"MENU_RENAME_ITEM\") : (\n\t\t\t\tisEditMode ? Loc.getMessage(\"MENU_EDIT_SELF_PAGE\") : Loc.getMessage(\"MENU_ADD_SELF_PAGE\")\n\t\t\t)),\n\t\t\toffsetTop: 1,\n\t\t\toffsetLeft: 20,\n\t\t\tcacheable: false,\n\t\t\tcloseIcon: true,\n\t\t\tlightShadow: true,\n\t\t\tdraggable: {restrict: true},\n\t\t\tcloseByEsc: true,\n\t\t\tcontent: form,\n\t\t\tbuttons: [\n\t\t\t\tnew SaveButton({ onclick: () => {\n\t\t\t\t\t\tif (this.checkForm(form))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst itemInfoToSave = {};\n\t\t\t\t\t\t\t[...form.elements].forEach((node) => {\n\t\t\t\t\t\t\t\titemInfoToSave[node.name] = node.value;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (form.elements['openInNewPage'])\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\titemInfoToSave['openInNewPage'] = form.elements[\"openInNewPage\"].checked ? 'Y' : 'N';\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tthis\n\t\t\t\t\t\t\t\t.backendSaveItem(itemInfoToSave)\n\t\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\t\tresolve(itemInfoToSave);\n\t\t\t\t\t\t\t\t\tthis.popup.close();\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch(Utils.catchError);\n\t\t\t\t\t\t}\n\t\t\t\t\t} } ),\n\t\t\t\tnew CancelButton({ onclick: () => { this.popup.close();} }),\n\t\t\t]\n\t\t});\n\t\tthis.popup.show();\n\t}\n\t//endregion\n}\n\nfunction areUrlsEqual(url, currentUri: Uri)\n{\n\tconst checkedUri = new Uri(url);\n\tconst checkedUrlBrief = checkedUri.getPath().replace('/index.php', '').replace('/index.html', '');\n\n\tconst currentUrlBrief = currentUri.getPath().replace('/index.php', '').replace('/index.html', '');\n\n\tif (\n\t\tcheckedUri.getHost() !== ''\n\t\t&&\n\t\tcheckedUri.getHost() !== currentUri.getHost()\n\t)\n\t{\n\t\treturn false;\n\t}\n\tif (currentUrlBrief.indexOf(checkedUrlBrief) !== 0)\n\t{\n\t\treturn false;\n\t}\n\treturn true;\n}\n\nfunction getShortName(name)\n{\n\tif (!Type.isStringFilled(name))\n\t{\n\t\treturn \"...\";\n\t}\n\n\tname = name.replace(/['`\".,:;~|{}*^$#@&+\\-=?!()[\\]<>\\n\\r]+/g, \"\").trim();\n\tif (name.length <= 0)\n\t{\n\t\treturn '...';\n\t}\n\n\tlet shortName;\n\tlet words = name.split(/[\\s,]+/);\n\tif (words.length <= 1)\n\t{\n\t\tshortName = name.substring(0, 1);\n\t}\n\telse if (words.length === 2)\n\t{\n\t\tshortName = words[0].substring(0, 1) + words[1].substring(0, 1);\n\t}\n\telse\n\t{\n\t\tlet firstWord = words[0];\n\t\tlet secondWord = words[1];\n\n\t\tfor (let i = 1; i < words.length; i++)\n\t\t{\n\t\t\tif (words[i].length > 3)\n\t\t\t{\n\t\t\t\tsecondWord = words[i];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tshortName = firstWord.substring(0, 1) + secondWord.substring(0, 1);\n\t}\n\n\treturn shortName.toUpperCase();\n}\n","import {Loc, Text, Tag} from 'main.core';\nimport {EventEmitter, BaseEvent} from 'main.core.events';\nimport {PopupManager} from 'main.popup'\nimport Item from './item';\nimport Utils from '../utils';\nimport Backend from '../backend';\nimport Options from \"../options\";\nimport ItemAdminShared from \"./item-admin-shared\";\n\nexport default class ItemUserFavorites extends Item\n{\n\tstatic code = 'standard';\n\tstatic #currentPageInTopMenu = null;\n\n\tcanDelete(): boolean\n\t{\n\t\treturn true;\n\t}\n\n\tdelete()\n\t{\n\t\tBackend\n\t\t\t.deleteFavoritesItemMenu({id: this.getId(), storage: this.storage})\n\t\t\t.then(() => {\n\t\t\t\tthis.destroy();\n\t\t\t\tEventEmitter.emit(this, Options.eventName('onItemDelete'), {animate: true});\n\t\t\t\tconst context = this.getSimilarToUrl(\n\t\t\t\t\tUtils.getCurUri()\n\t\t\t\t).length > 0 ? window : {'doesnotmatter': ''};\n\n\t\t\t\tBX.onCustomEvent(\"BX.Bitrix24.LeftMenuClass:onMenuItemDeleted\", [{id: this.getId()}, this]);\n\t\t\t\tBX.onCustomEvent('BX.Bitrix24.LeftMenuClass:onStandardItemChangedSuccess', [{\n\t\t\t\t\tisActive: false,\n\t\t\t\t\tcontext: context\n\t\t\t\t}]);\n\t\t\t});\n\t}\n\n\tgetDropDownActions(): Array\n\t{\n\t\tconst contextMenuItems = [];\n\t\tcontextMenuItems.push({\n\t\t\ttext: Loc.getMessage(\"MENU_RENAME_ITEM\"),\n\t\t\tonclick: () => {\n\t\t\t\tthis.constructor\n\t\t\t\t\t.showUpdate(this)\n\t\t\t\t\t.then(this.update.bind(this))\n\t\t\t\t\t.catch(this.showError);\n\t\t\t}\n\t\t});\n\t\tcontextMenuItems.push({\n\t\t\ttext: Loc.getMessage(\"MENU_REMOVE_STANDARD_ITEM\"),\n\t\t\tonclick: () => {\n\t\t\t\tthis.delete();\n\t\t\t}\n\t\t});\n\n\t\tif (Options.isAdmin)\n\t\t{\n\t\t\tcontextMenuItems.push({\n\t\t\t\ttext: Loc.getMessage(\"MENU_ADD_ITEM_TO_ALL\"),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tconst itemLinkNode = this.container.querySelector('a');\n\t\t\t\t\tBackend\n\t\t\t\t\t\t.addAdminSharedItemMenu({\n\t\t\t\t\t\t\tid: this.getId(),\n\t\t\t\t\t\t\tlink: this.links[0],\n\t\t\t\t\t\t\ttext: this.getName(),\n\t\t\t\t\t\t\tcounterId: this.container.dataset.counterId,\n\t\t\t\t\t\t\topenInNewPage: itemLinkNode && itemLinkNode.getAttribute(\"target\") === \"_blank\" ? \"Y\" : \"N\"\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tthis.showMessage(Loc.getMessage('MENU_ITEM_WAS_ADDED_TO_ALL'));\n\t\t\t\t\t\t\tthis.container.dataset.type = ItemAdminShared.code;\n\t\t\t\t\t\t\tthis.storage.push(ItemUserFavorites.code);\n\t\t\t\t\t\t\tthis.container.dataset.storage = this.storage.join(',');\n\t\t\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onItemConvert'), this);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(this.showError);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn contextMenuItems;\n\t}\n\n\tstatic backendSaveItem(itemInfoToSave): Promise\n\t{\n\t\treturn Backend.updateFavoritesItemMenu(itemInfoToSave);\n\t}\n\n\tstatic getActiveTopMenuItem()\n\t{\n\t\tif (this.#currentPageInTopMenu)\n\t\t{\n\t\t\treturn this.#currentPageInTopMenu;\n\t\t}\n\n\t\tif (!BX.Main\n\t\t\t|| !BX.Main.interfaceButtonsManager)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst firstTopMenuInstance = Array.from(\n\t\t\tObject.values(\n\t\t\t\tBX.Main.interfaceButtonsManager\n\t\t\t\t\t.getObjects()\n\t\t\t)\n\t\t).shift();\n\n\t\tif (firstTopMenuInstance)\n\t\t{\n\t\t\tconst topMenuItem = firstTopMenuInstance.getActive();\n\n\t\t\tif (topMenuItem && typeof topMenuItem === \"object\")\n\t\t\t{\n\t\t\t\tconst link = document.createElement(\"a\");\n\t\t\t\tlink.href = topMenuItem['URL'];\n\t\t\t\t//IE11 omits slash in the pathname\n\t\t\t\tconst path = link.pathname[0] !== \"/\" ? (\"/\" + link.pathname) : link.pathname;\n\n\t\t\t\tthis.#currentPageInTopMenu = {\n\t\t\t\t\tID: topMenuItem['ID'] || null,\n\t\t\t\t\tNODE: topMenuItem['NODE'] || null,\n\t\t\t\t\tURL: path + link.search,\n\t\t\t\t\tTEXT: topMenuItem['TEXT'],\n\t\t\t\t\tDATA_ID: topMenuItem['DATA_ID'],\n\t\t\t\t\tCOUNTER_ID: topMenuItem['COUNTER_ID'],\n\t\t\t\t\tCOUNTER: topMenuItem['COUNTER'],\n\t\t\t\t\tSUB_LINK: topMenuItem['SUB_LINK'],\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\treturn this.#currentPageInTopMenu;\n\t}\n\n\tstatic isCurrentPageStandard(topMenuPoint): boolean\n\t{\n\t\tif (topMenuPoint && topMenuPoint['URL'])\n\t\t{\n\t\t\tconst currentFullPath = document.location.pathname + document.location.search;\n\t\t\treturn topMenuPoint.URL === currentFullPath && topMenuPoint.URL.indexOf('workgroups') < 0;\n\t\t}\n\t\treturn false;\n\t}\n\n\tstatic saveCurrentPage({pageTitle, pageLink})\n\t{\n\t\tconst topMenuPoint = this.getActiveTopMenuItem();\n\t\tlet itemInfo, startX, startY;\n\n\t\tif (topMenuPoint\n\t\t\t&& topMenuPoint.NODE\n\t\t\t&& this.isCurrentPageStandard(topMenuPoint)\n\t\t\t&& (pageLink === Utils.getCurPage() || pageLink === topMenuPoint.URL || !pageLink)\n\t\t)\n\t\t{\n\t\t\tconst menuNodeCoord = topMenuPoint.NODE.getBoundingClientRect();\n\t\t\tstartX = menuNodeCoord.left;\n\t\t\tstartY = menuNodeCoord.top;\n\n\t\t\titemInfo = {\n\t\t\t\tid: topMenuPoint.DATA_ID,\n\t\t\t\ttext: pageTitle || topMenuPoint.TEXT,\n\t\t\t\tlink: Utils.getCurPage() || topMenuPoint.URL,\n\t\t\t\tcounterId: topMenuPoint.COUNTER_ID,\n\t\t\t\tcounterValue: topMenuPoint.COUNTER,\n\t\t\t\tisStandardItem: true,\n\t\t\t\tsubLink: topMenuPoint.SUB_LINK\n\t\t\t};\n\t\t}\n\t\telse\n\t\t{\n\t\t\titemInfo = {\n\t\t\t\ttext: pageTitle || document.getElementById('pagetitle').innerText,\n\t\t\t\tlink: pageLink || Utils.getCurPage(),\n\t\t\t\tisStandardItem: pageLink === Utils.getCurPage()\n\t\t\t};\n\t\t\tconst titleCoord = BX(\"pagetitle\").getBoundingClientRect();\n\t\t\tstartX = titleCoord.left;\n\t\t\tstartY = titleCoord.top\n\t\t}\n\n\t\treturn Backend\n\t\t\t.addFavoritesItemMenu(itemInfo)\n\t\t\t.then(({data: {itemId}}) => {\n\t\t\t\titemInfo.id = itemId;\n\t\t\t\titemInfo.topMenuId = itemInfo.id;\n\t\t\t\treturn {node: this.createNode(itemInfo), animateFromPoint: {startX, startY}, itemInfo: itemInfo};\n\t\t\t})\n\t\t;\n\t}\n\n\tstatic deleteCurrentPage({pageLink})\n\t{\n\t\tconst topPoint = this.getActiveTopMenuItem();\n\n\t\tvar itemInfo = {}, startX, startY;\n\n\t\tif (topPoint && this.isCurrentPageStandard(topPoint))\n\t\t{\n\t\t\titemInfo['id'] = topPoint.DATA_ID;\n\n\t\t\tconst menuNodeCoord = topPoint.NODE.getBoundingClientRect();\n\t\t\tstartX = menuNodeCoord.left;\n\t\t\tstartY = menuNodeCoord.top;\n\t\t}\n\t\telse\n\t\t{\n\t\t\titemInfo['link'] = pageLink || Utils.getCurPage();\n\t\t\tconst titleCoord = BX(\"pagetitle\").getBoundingClientRect();\n\t\t\tstartX = titleCoord.left;\n\t\t\tstartY = titleCoord.top\n\t\t}\n\t\treturn Backend\n\t\t\t.deleteFavoritesItemMenu(itemInfo)\n\t\t\t.then(({data}) => {\n\t\t\t\tif (!itemInfo.id && data && data['itemId'])\n\t\t\t\t{\n\t\t\t\t\titemInfo.id = data['itemId'];\n\t\t\t\t}\n\t\t\t\tEventEmitter.emit(EventEmitter.GLOBAL_TARGET, Options.eventName('onItemDeleteAsFavorites'), {id: itemInfo.id});\n\t\t\t\treturn {itemInfo: itemInfo, animateToPoint: {startX, startY}};\n\t\t\t});\n\t}\n\n\tstatic saveStandardPage({DATA_ID, TEXT, SUB_LINK, COUNTER_ID, COUNTER, NODE, URL})\n\t{\n\t\tconst itemInfo = {\n\t\t\tid: DATA_ID,\n\t\t\ttext: TEXT,\n\t\t\tlink: URL,\n\t\t\tsubLink: SUB_LINK,\n\t\t\tcounterId: COUNTER_ID,\n\t\t\tcounterValue: COUNTER\n\t\t};\n\n\t\tconst pos = NODE.getBoundingClientRect();\n\t\tconst startX = pos.left;\n\t\tconst startY = pos.top\n\t\treturn Backend\n\t\t\t.addFavoritesItemMenu(itemInfo)\n\t\t\t.then(({data: {itemId}}) => {\n\t\t\t\titemInfo.id = itemId;\n\t\t\t\titemInfo.topMenuId = itemInfo.id;\n\n\t\t\t\tconst topPoint = this.getActiveTopMenuItem();\n\t\t\t\tBX.onCustomEvent(\"BX.Bitrix24.LeftMenuClass:onMenuItemAdded\", [itemInfo, this]);\n\t\t\t\tBX.onCustomEvent('BX.Bitrix24.LeftMenuClass:onStandardItemChangedSuccess', [{\n\t\t\t\t\tisActive: true,\n\t\t\t\t\tcontext: topPoint && topPoint.DATA_ID === DATA_ID ? window : null,\n\t\t\t\t}]);\n\n\t\t\t\treturn {node: this.createNode(itemInfo), animateFromPoint: {startX, startY}};\n\t\t\t})\n\t\t;\n\t}\n\n\tstatic deleteStandardPage({DATA_ID})\n\t{\n\t\tconst itemInfo = {id: DATA_ID};\n\t\treturn Backend\n\t\t\t.deleteFavoritesItemMenu(itemInfo)\n\t\t\t.then(() => {\n\t\t\t\tEventEmitter.emit(EventEmitter.GLOBAL_TARGET, Options.eventName('onItemDeleteAsFavorites'), {id: itemInfo.id});\n\t\t\t\tBX.onCustomEvent(\"BX.Bitrix24.LeftMenuClass:onMenuItemDeleted\", [itemInfo, this]);\n\t\t\t\tBX.onCustomEvent('BX.Bitrix24.LeftMenuClass:onStandardItemChangedSuccess', [{\n\t\t\t\t\tisActive: false,\n\t\t\t\t}]);\n\t\t\t\treturn {itemInfo: itemInfo};\n\t\t\t});\n\t}\n}\n","import {Loc, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport Item from './item';\nimport Backend from \"../backend\";\nimport Options from \"../options\";\nimport {MessageBox} from 'ui.dialogs.messagebox';\nimport ItemUserFavorites from \"./item-user-favorites\";\nimport ItemAdminShared from \"./item-admin-shared\";\n\nexport default class ItemUserSelf extends Item\n{\n\tstatic code = 'self';\n\n\tcanDelete(): boolean\n\t{\n\t\treturn true;\n\t}\n\n\tdelete()\n\t{\n\t\treturn Backend\n\t\t\t.deleteSelfITem(this.getId())\n\t\t\t.then(() => {\n\t\t\t\tif (this.storage.indexOf(ItemUserFavorites.code) >= 0)\n\t\t\t\t{\n\t\t\t\t\tBackend.deleteFavoritesItemMenu({id: this.getId()});\n\t\t\t\t}\n\t\t\t\tEventEmitter.emit(this, Options.eventName('onItemDelete'), {animate: true});\n\t\t\t})\n\t\t\t.catch(this.showError)\n\t\t;\n\t}\n\n\tgetDropDownActions(): Array\n\t{\n\t\tconst contextMenuItems = [];\n\t\tcontextMenuItems.push({\n\t\t\ttext: Loc.getMessage(\"MENU_EDIT_ITEM\"),\n\t\t\tonclick: () => {\n\t\t\t\tthis.constructor\n\t\t\t\t\t.showUpdate(this)\n\t\t\t\t\t.then(this.update.bind(this))\n\t\t\t\t\t.catch(this.showError);\n\t\t\t}\n\t\t});\n\t\tcontextMenuItems.push({\n\t\t\ttext: Loc.getMessage('MENU_DELETE_SELF_ITEM'),\n\t\t\tonclick: () => {\n\t\t\t\tMessageBox.confirm(\n\t\t\t\t\tLoc.getMessage('MENU_DELETE_SELF_ITEM_CONFIRM'),\n\t\t\t\t\tLoc.getMessage('MENU_DELETE_SELF_ITEM'),\n\t\t\t\t\t(messageBox) => {\n\t\t\t\t\t\tthis.delete();\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t},\n\t\t\t\t\tLoc.getMessage('MENU_DELETE'),\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\t\tif (Options.isAdmin)\n\t\t{\n\t\t\tcontextMenuItems.push({\n\t\t\t\ttext: Loc.getMessage(\"MENU_ADD_ITEM_TO_ALL\"),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tconst itemLinkNode = this.container.querySelector('a');\n\t\t\t\t\tBackend\n\t\t\t\t\t\t.addAdminSharedItemMenu({\n\t\t\t\t\t\t\tid: this.getId(),\n\t\t\t\t\t\t\tlink: this.links[0],\n\t\t\t\t\t\t\ttext: this.getName(),\n\t\t\t\t\t\t\tcounterId: this.container.dataset.counterId,\n\t\t\t\t\t\t\topenInNewPage: itemLinkNode && itemLinkNode.getAttribute(\"target\") === \"_blank\" ? \"Y\" : \"N\"\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tthis.showMessage(Loc.getMessage('MENU_ITEM_WAS_ADDED_TO_ALL'));\n\t\t\t\t\t\t\tthis.container.dataset.type = ItemAdminShared.code;\n\t\t\t\t\t\t\tthis.storage.push(ItemUserSelf.code);\n\t\t\t\t\t\t\tthis.container.dataset.storage = this.storage.join(',');\n\t\t\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onItemConvert'), this);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(this.showError);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn contextMenuItems;\n\t}\n\n\tgetEditFields(): Object\n\t{\n\t\treturn {id: this.getId(), text: this.getName(), link: this.links[0],  openInNewPage: this.container.getAttribute('data-new-page')};\n\t}\n\n\tstatic backendSaveItem(itemInfo): Promise\n\t{\n\t\treturn Backend.saveSelfItemMenu(itemInfo)\n\t\t\t.then(({data}) => {\n\t\t\t\tif (data && data['itemId'])\n\t\t\t\t{\n\t\t\t\t\titemInfo.id = data['itemId'];\n\t\t\t\t}\n\t\t\t\treturn itemInfo;\n\t\t\t});\n\t}\n\n\tstatic showAdd(bindElement)\n\t{\n\t\treturn new Promise((resolve1, reject2) => {\n\t\t\tthis.showForm(\n\t\t\t\tbindElement,\n\t\t\t\t{id: 0, name: '', link: '', openInNewPage: 'Y'},\n\t\t\t\tresolve1, reject2\n\t\t\t)\n\t\t})\n\t\t.then((itemInfo) => {\n\t\t\treturn {node: this.createNode(itemInfo)}\n\t\t});\n\t}\n}\n\n","import {Tag, Loc} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport Item from './item';\nimport Backend from \"../backend\";\nimport Options from \"../options\";\nimport ItemUserFavorites from \"./item-user-favorites\";\nimport ItemUserSelf from \"./item-user-self\";\nimport Utils from \"../utils\";\n\nexport default class ItemAdminShared extends Item\n{\n\tstatic code = 'admin';\n\n\tcanDelete(): boolean\n\t{\n\t\treturn this.container.dataset.deletePerm === 'Y';\n\t}\n\n\tdelete()\n\t{\n\t\tBackend\n\t\t\t.deleteAdminSharedItemMenu(this.getId())\n\t\t\t.then(() => {\n\t\t\t\tif (this.storage.indexOf(ItemUserFavorites.code) >= 0)\n\t\t\t\t{\n\t\t\t\t\tBackend.deleteFavoritesItemMenu({id: this.getId()});\n\t\t\t\t}\n\t\t\t\tif (this.storage.indexOf(ItemUserSelf.code) >= 0)\n\t\t\t\t{\n\t\t\t\t\tBackend.deleteSelfITem(this.getId());\n\t\t\t\t}\n\t\t\t\tEventEmitter.emit(this, Options.eventName('onItemDelete'), {animate: true});\n\t\t\t})\n\t\t\t.catch(this.showError)\n\t\t;\n\t}\n\n\tgetDropDownActions(): Array\n\t{\n\t\tif (!this.canDelete())\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tconst contextMenuItems = [];\n/*\t\tcontextMenuItems.push({\n\t\t\ttext: Loc.getMessage(\"MENU_RENAME_ITEM\"),\n\t\t\tonclick: () => {\n\t\t\t\tthis.constructor\n\t\t\t\t\t.showUpdate(this)\n\t\t\t\t\t.then(this.update.bind(this))\n\t\t\t\t\t.catch(this.showError.bind(this));\n\t\t\t}\n\t\t});\n*/\n\n\t\tif (this.storage.filter((value) => {return value === ItemUserFavorites.code || value === ItemUserSelf.code;}).length > 0)\n\t\t{\n\t\t\tcontextMenuItems.push({\n\t\t\t\ttext: Loc.getMessage('MENU_REMOVE_STANDARD_ITEM'),\n\t\t\t\tonclick: this.delete.bind(this)\n\t\t\t});\n\t\t\tcontextMenuItems.push({\n\t\t\t\ttext: Loc.getMessage('MENU_DELETE_CUSTOM_ITEM_FROM_ALL'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tBackend\n\t\t\t\t\t\t.deleteAdminSharedItemMenu(this.getId())\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tthis.showMessage(Loc.getMessage('MENU_ITEM_WAS_DELETED_FROM_ALL'));\n\t\t\t\t\t\t\tconst codeToConvert = this.storage.indexOf(ItemUserSelf.code) >= 0 ? ItemUserSelf.code : ItemUserFavorites.code;\n\t\t\t\t\t\t\tthis.container.dataset.type = codeToConvert;\n\t\t\t\t\t\t\tthis.container.dataset.storage = this.storage.filter((v) => {return v !== codeToConvert}).join(',');\n\t\t\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onItemConvert'), this);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(this.showError);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcontextMenuItems.push({\n\t\t\t\ttext: Loc.getMessage(\"MENU_DELETE_CUSTOM_ITEM_FROM_ALL\"),\n\t\t\t\tonclick: this.delete.bind(this)\n\t\t\t});\n\t\t}\n\t\treturn contextMenuItems;\n\t}\n}","import {Loc} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport Item from './item';\nimport Backend from \"../backend\";\nimport Options from \"../options\";\nimport ItemUserFavorites from \"./item-user-favorites\";\n\nexport default class ItemAdminCustom extends Item\n{\n\tstatic code = 'custom';\n\n\tcanDelete(): boolean\n\t{\n\t\treturn this.container.dataset.deletePerm === 'Y';\n\t}\n\n\tdelete()\n\t{\n\t\tif (this.canDelete())\n\t\t{\n\t\t\tBackend\n\t\t\t\t.deleteCustomItem(this.getId())\n\t\t\t\t.then(() => {\n\t\t\t\t\tif (this.storage.indexOf(ItemUserFavorites.code) >= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tBackend.deleteFavoritesItemMenu({id: this.getId()});\n\t\t\t\t\t}\n\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onItemDelete'), {animate: true});\n\t\t\t\t})\n\t\t\t\t.catch(this.showError)\n\t\t\t;\n\t\t}\n\t}\n\n\tgetDropDownActions(): Array\n\t{\n\t\tconst actions = [];\n\t\tif (this.canDelete())\n\t\t{\n\t\t\tactions.push({\n\t\t\t\ttext: Loc.getMessage(\"MENU_DELETE_ITEM_FROM_ALL\"),\n\t\t\t\tonclick: this.delete.bind(this)\n\t\t\t});\n\t\t}\n\t\treturn actions;\n\t}\n}","import { Loc } from 'main.core';\nimport Item from './item';\n\nexport class ItemMainPage extends Item\n{\n\tstatic code = 'main';\n\n\tcanDelete(): boolean\n\t{\n\t\treturn false;\n\t}\n\n\topenSettings(): void\n\t{\n\t\tconst url = `${Loc.getMessage('mainpage_settings_path')}&analyticContext=left_menu`;\n\t\tBX.SidePanel.Instance.open(url);\n\t}\n}\n","import Item from './item';\n\nexport default class ItemSystem extends Item\n{\n\tstatic code = 'default';\n\n\tcanDelete(): boolean\n\t{\n\t\treturn false;\n\t}\n}\n","import Item from './item';\nimport Backend from '../backend';\nimport { Dom, Text } from 'main.core';\n\nexport default class ItemGroup extends Item\n{\n\tstatic code = 'group';\n\tgroupContainer: Element;\n\n\tconstructor()\n\t{\n\t\tsuper(...arguments);\n\t\tthis.container.addEventListener('click', this.toggleAndSave.bind(this), true);\n\t\tthis.container.addEventListener('mouseleave', () => {\n\t\t\tDom.removeClass(this.container, 'menu-item-group-actioned');\n\t\t});\n\t\tthis.groupContainer = this.container.parentNode.querySelector(`[data-group-id=\"${this.getId()}\"]`);\n\t\tif (this.container.getAttribute('data-collapse-mode') === 'collapsed')\n\t\t{\n\t\t\tthis.groupContainer.style.display = 'none';\n\t\t}\n\t\tsetTimeout(() => {\n\t\t\tthis.updateCounter();\n\t\t}, 0);\n\t}\n\n\ttoggleAndSave(event)\n\t{\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\t\tif (this.container.getAttribute('data-collapse-mode') === 'collapsed')\n\t\t{\n\t\t\tBackend.expandGroup(this.getId());\n\t\t\tthis\n\t\t\t\t.expand()\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis.container.setAttribute('data-collapse-mode', 'expanded');\n\t\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBackend.collapseGroup(this.getId());\n\t\t\tthis\n\t\t\t\t.collapse()\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis.container.setAttribute('data-collapse-mode', 'collapsed');\n\t\t\t\t});\n\t\t}\n\t\treturn false;\n\t}\n\n\tcheckAndCorrect(): ItemGroup\n\t{\n\t\tconst groupContainer = this.groupContainer;\n\n\t\tif (groupContainer.parentNode === this.container)\n\t\t{\n\t\t\tDom.insertAfter(groupContainer, this.container);\n\t\t}\n\t\t[...groupContainer\n\t\t\t.querySelectorAll(`.menu-item-block`)\n\t\t].forEach((node) => {\n\t\t\tnode.setAttribute('data-status', this.container.getAttribute(\"data-status\"));\n\t\t});\n\t\treturn this;\n\t}\n\n\t#collapsingAnimation;\n\tcollapse(hideGroupContainer): Promise\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tconst groupContainer = this.groupContainer;\n\n\t\t\tif (this.#collapsingAnimation)\n\t\t\t{\n\t\t\t\tthis.#collapsingAnimation.stop();\n\t\t\t}\n\n\t\t\tgroupContainer.style.overflow = 'hidden';\n\t\t\tDom.addClass(this.container, 'menu-item-group-collapsing');\n\t\t\tDom.addClass(this.container, 'menu-item-group-actioned');\n\t\t\tDom.addClass(groupContainer, 'menu-item-group-collapsing');\n\t\t\tconst slideParams = {\n\t\t\t\theight: groupContainer.offsetHeight,\n\t\t\t\tdisplay: groupContainer.style.display\n\t\t\t};\n\n\t\t\tthis.#collapsingAnimation = (new BX.easing({\n\t\t\t\tduration: 500,\n\t\t\t\tstart: {height: slideParams.height, opacity: 100},\n\t\t\t\tfinish: {height: 0, opacity: 0},\n\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\tstep: function (state) {\n\t\t\t\t\tgroupContainer.style.height = state.height + 'px';\n\t\t\t\t\tgroupContainer.style.opacity = state.opacity / 100;\n\t\t\t\t},\n\t\t\t\tcomplete: () => {\n\t\t\t\t\tgroupContainer.style.display = 'none';\n\t\t\t\t\tgroupContainer.style.opacity = 'auto';\n\t\t\t\t\tgroupContainer.style.height = 'auto';\n\t\t\t\t\tDom.style(groupContainer, 'overflow', null);\n\n\t\t\t\t\tif (this.container.getAttribute('data-contains-active-item') === 'Y')\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.addClass(this.container, 'menu-item-active');\n\t\t\t\t\t}\n\t\t\t\t\tDom.removeClass(this.container, 'menu-item-group-collapsing');\n\t\t\t\t\tDom.removeClass(groupContainer, 'menu-item-group-collapsing');\n\t\t\t\t\tthis.#collapsingAnimation = null;\n\t\t\t\t\tif (hideGroupContainer === true)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.container.appendChild(groupContainer);\n\t\t\t\t\t}\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t}));\n\t\t\tthis.#collapsingAnimation.animate();\n\t\t});\n\t}\n\n\texpand(checkAttribute): Promise\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tconst container = this.container;\n\t\t\tconst groupContainer = this.groupContainer;\n\n\t\t\tif (checkAttribute === true\n\t\t\t\t&& container.getAttribute('data-collapse-mode') === 'collapsed')\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tconst contentHeight = groupContainer.querySelectorAll('li').length * (container.offsetHeight + 4);\n\t\t\tDom.addClass(container, 'menu-item-group-expanding');\n\t\t\tDom.addClass(container, 'menu-item-group-actioned');\n\t\t\tDom.addClass(groupContainer, 'menu-item-group-expanding');\n\n\t\t\tif (groupContainer.parentNode === this.container)\n\t\t\t{\n\t\t\t\tDom.insertAfter(groupContainer, this.container);\n\t\t\t}\n\n\t\t\tgroupContainer.style.display = 'block';\n\t\t\tthis.#collapsingAnimation = (new BX.easing({\n\t\t\t\tduration: 500,\n\t\t\t\tstart: {height: 0, opacity: 0},\n\t\t\t\tfinish: {height: contentHeight, opacity: 100},\n\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\tstep: function (state) {\n\t\t\t\t\tgroupContainer.style.height = state.height + 'px';\n\t\t\t\t\tgroupContainer.style.opacity = state.opacity / 100;\n\t\t\t\t},\n\t\t\t\tcomplete: function () {\n\t\t\t\t\tDom.removeClass(container, 'menu-item-group-expanding menu-item-active');\n\t\t\t\t\tDom.removeClass(groupContainer, 'menu-item-group-expanding');\n\t\t\t\t\tgroupContainer.style.height = 'auto';\n\t\t\t\t\tgroupContainer.style.opacity = 'auto';\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t}));\n\t\t\tthis.#collapsingAnimation.animate();\n\t\t});\n\t}\n\n\tcanDelete(): boolean\n\t{\n\t\treturn false;\n\t}\n\n\tupdateCounter()\n\t{\n\t\tlet counterValue = 0;\n\t\t[...this.container\n\t\t\t.parentNode\n\t\t\t.querySelector(`[data-group-id=\"${this.getId()}\"]`)\n\t\t\t.querySelectorAll('[data-role=\"counter\"]')]\n\t\t\t.forEach((node) => {\n\t\t\t\tcounterValue += Text.toNumber(node.dataset.counterValue);\n\t\t\t});\n\t\tconst node = this.container.querySelector('[data-role=\"counter\"]');\n\n\t\tif (counterValue > 0)\n\t\t{\n\t\t\tnode.innerHTML = (counterValue > 99 ? '99+' : counterValue);\n\t\t\tthis.container.classList.add('menu-item-with-index');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnode.innerHTML = '';\n\t\t\tthis.container.classList.remove('menu-item-with-index');\n\t\t}\n\t}\n\n\tmarkAsActive()\n\t{\n\t\tthis.container.setAttribute('data-contains-active-item', 'Y');\n\t\tif (this.container.getAttribute('data-collapse-mode') === 'collapsed')\n\t\t\tDom.addClass(this.container, 'menu-item-active');\n\t}\n\n\tmarkAsInactive()\n\t{\n\t\tthis.container.removeAttribute('data-contains-active-item');\n\t\tDom.removeClass(this.container, 'menu-item-active');\n\t}\n\n\tisActive()\n\t{\n\t\treturn this.container.getAttribute('data-contains-active-item') === 'Y';\n\t}\n\n\tstatic detect(node)\n\t{\n\t\treturn node.getAttribute(\"data-role\") === 'group' &&\n\t\t\tnode.getAttribute(\"data-type\") === this.code;\n\t}\n}\n","import {Uri, Type} from 'main.core';\nimport {EventEmitter} from 'main.core.event';\nimport ItemGroup from './item-group';\n\nexport default class ItemGroupSystem extends ItemGroup\n{\n\tconstructor() {\n\t\tsuper(...arguments);\n\n\t\tthis.container\n\t\t\t.querySelector('[data-role=\"item-edit-control\"]')\n\t\t\t.style.display = 'none';\n\t}\n\tstatic code = 'system_group';\n}\n","import Item from './item';\nimport ItemAdminShared from './item-admin-shared';\nimport ItemAdminCustom from './item-admin-custom';\nimport { ItemMainPage } from './item-main-page';\nimport ItemUserFavorites from './item-user-favorites';\nimport ItemUserSelf from './item-user-self';\nimport ItemSystem from './item-system';\nimport ItemGroup from './item-group';\nimport ItemGroupSystem from './item-group-system';\n\nconst itemMappings = [\n\tItem,\n\tItemAdminShared,\n\tItemUserFavorites,\n\tItemAdminCustom,\n\tItemUserSelf,\n\tItemSystem,\n\tItemGroup,\n\tItemGroupSystem,\n\tItemMainPage,\n];\n\nexport default function getItem(itemData): Item\n{\n\tlet itemClassName = Item;\n\titemMappings.forEach((itemClass) => {\n\t\tif (itemClass.detect(itemData))\n\t\t{\n\t\t\titemClassName = itemClass;\n\t\t}\n\t});\n\treturn itemClassName;\n}","import {Runtime, Uri} from 'main.core';\nimport Item from './item'\nimport ItemSystem from './item-system'\ntype ActiveLink = {\n\tpriority: number,\n\turl: string,\n\turi: Uri\n};\nexport default class ItemActive\n{\n\titem: ?Item;\n\t#link: ?ActiveLink;\n\t#actualLink: Uri;\n\n\tconstructor()\n\t{\n\t\tthis.#actualLink = new Uri(window.location.href);\n\t}\n\n\tcheckAndSet(item: Item, links: Array): boolean\n\t{\n\t\t/*\n\t\tCustom items have more priority than standard items.\n\t\tExample:\n\t\t\tCalendar (standard item)\n\t\t\t\tdata-link=\"/company/personal/user/1/calendar/\"\n\t\t\t\tdata-all-links=\"/company/personal/user/1/calendar/,/calendar/\n\n\t\t\tCompany Calendar (custom item)\n\t\t\t\t data-link=\"/calendar/\"\n\n\t\tWe've got two items with the identical link /calendar/'.\n\t\t*/\n\t\tif (item === this.item)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet theMostOfTheLinks = this.#link;\n\t\tlinks.forEach((link) => {\n\t\t\tconst linkUri = new Uri(link.url);\n\t\t\tlet changeActiveItem = false;\n\t\t\tif (\n\t\t\t\t!theMostOfTheLinks\n\t\t\t\t|| theMostOfTheLinks.uri.getPath().length < linkUri.getPath().length\n\t\t\t)\n\t\t\t{\n\t\t\t\tchangeActiveItem = true;\n\t\t\t}\n\t\t\telse if (theMostOfTheLinks.uri.getPath().length === linkUri.getPath().length)\n\t\t\t{\n\t\t\t\tconst actualParams = this.#actualLink.getQueryParams();\n\t\t\t\tconst theMostOfTheLinkServiceData = {\n\t\t\t\t\tparams: theMostOfTheLinks.uri.getQueryParams(),\n\t\t\t\t\tmatches: 0,\n\t\t\t\t};\n\t\t\t\tconst comparedLinkParams = {\n\t\t\t\t\tparams: linkUri.getQueryParams(),\n\t\t\t\t\tmatches: 0,\n\t\t\t\t};\n\n\t\t\t\tfor (const key of Object.keys(actualParams))\n\t\t\t\t{\n\t\t\t\t\tif (\n\t\t\t\t\t\tkey in actualParams\n\t\t\t\t\t\t&& key in theMostOfTheLinkServiceData.params\n\t\t\t\t\t\t&& String(actualParams[key]) === String(theMostOfTheLinkServiceData.params[key])\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\ttheMostOfTheLinkServiceData.matches++;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tkey in actualParams\n\t\t\t\t\t\t&& key in comparedLinkParams.params\n\t\t\t\t\t\t&& String(actualParams[key]) === String(comparedLinkParams.params[key])\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tcomparedLinkParams.matches++;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\tcomparedLinkParams.matches > theMostOfTheLinkServiceData.matches\n\t\t\t\t\t|| (\n\t\t\t\t\t\tcomparedLinkParams.matches === theMostOfTheLinkServiceData.matches\n\t\t\t\t\t\t&& Object.keys(comparedLinkParams.params).length < Object.keys(theMostOfTheLinkServiceData.params).length\n\t\t\t\t\t)\n\t\t\t\t\t|| theMostOfTheLinks.priority < link.priority\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tchangeActiveItem = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (changeActiveItem)\n\t\t\t{\n\t\t\t\ttheMostOfTheLinks = {\n\t\t\t\t\tpriority: link.priority,\n\t\t\t\t\turl: link.url,\n\t\t\t\t\turi: linkUri,\n\t\t\t\t};\n\t\t\t}\n\t\t});\n\n\t\tif (theMostOfTheLinks !== this.#link)\n\t\t{\n\t\t\tif (this.item)\n\t\t\t{\n\t\t\t\tthis.unhighlight(this.item);\n\t\t\t}\n\t\t\tthis.#link = theMostOfTheLinks;\n\t\t\tthis.item = item;\n\n\t\t\tthis.highlight();\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tcheckAndUnset(item: Item)\n\t{\n\t\tif (item instanceof Item && item === this.item)\n\t\t{\n\t\t\tthis.unhighlight(this.item);\n\t\t\tthis.item = null;\n\t\t\tthis.#link = null;\n\t\t}\n\t}\n\n\thighlight()\n\t{\n\t\tif (this.item)\n\t\t{\n\t\t\tthis.item.container.classList.add('menu-item-active');\n\n\t\t\tlet parent = this.item.container.closest('[data-role=\"group-content\"]');\n\t\t\tlet parentContainer;\n\t\t\twhile (parent)\n\t\t\t{\n\t\t\t\tparentContainer = parent.parentNode.querySelector(`[data-id=\"${parent.getAttribute('data-group-id')}\"]`);\n\t\t\t\tif (parentContainer)\n\t\t\t\t{\n\t\t\t\t\tparentContainer.setAttribute('data-contains-active-item', 'Y');\n\t\t\t\t\tif (parentContainer.getAttribute('data-collapse-mode') === 'collapsed')\n\t\t\t\t\t{\n\t\t\t\t\t\tparentContainer.classList.add('menu-item-active');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tparent = parent.closest('[data-relo=\"group-content\"]');\n\t\t\t}\n\t\t}\n\t}\n\n\tunhighlight(item: ?Item): ?Item\n\t{\n\t\tif (!(item instanceof Item))\n\t\t{\n\t\t\titem = this.item;\n\t\t}\n\t\tif (item instanceof Item)\n\t\t{\n\t\t\titem.container.classList.remove('menu-item-active');\n\t\t\tlet parent = item.container.closest('[data-role=\"group-content\"]');\n\t\t\tlet parentContainer;\n\t\t\twhile (parent)\n\t\t\t{\n\t\t\t\tparentContainer = parent.parentNode.querySelector(`[data-id=\"${parent.getAttribute('data-group-id')}\"]`);\n\t\t\t\tif (parentContainer)\n\t\t\t\t{\n\t\t\t\t\tparentContainer.removeAttribute('data-contains-active-item');\n\t\t\t\t\tparentContainer.classList.remove('menu-item-active');\n\t\t\t\t}\n\t\t\t\tparent = parent.closest('[data-relo=\"group-content\"]');\n\t\t\t}\n\t\t\treturn item;\n\t\t}\n\t\treturn null;\n\t}\n}\n","import { Loc, Type, Dom, Text, Reflection } from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport getItem from '../items/index';\nimport Item from '../items/item';\nimport ItemActive from '../items/item-active';\nimport { ItemMainPage } from '../items/item-main-page';\nimport ItemUserSelf from '../items/item-user-self';\nimport ItemUserFavorites from '../items/item-user-favorites';\nimport Options from \"../options\";\nimport DefaultController from \"./default-controller\";\nimport Utils from \"../utils\";\nimport Backend from \"../backend\";\nimport ItemAdminCustom from \"../items/item-admin-custom\";\nimport {Menu, MenuItem} from 'main.popup';\nimport ItemGroup from \"../items/item-group\";\n\nexport default class ItemsController extends DefaultController{\n\tparentContainer: Element;\n\tcontainer: Element;\n\thiddenContainer: Element;\n\titems: Map = new Map();\n\t#activeItem: ItemActive = new ItemActive;\n\t#isEditMode = false;\n\n\tconstructor(container, {events})\n\t{\n\t\tsuper(container, {events});\n\t\tthis.parentContainer = container;\n\t\tthis.container = container.querySelector(\".menu-items\");\n\n\t\tthis.hiddenContainer = container\n\t\t\t.querySelector('#left-menu-hidden-items-block');\n\n\t\tcontainer\n\t\t\t.querySelectorAll('li.menu-item-block')\n\t\t\t.forEach(this.registerItem.bind(this))\n\t\t;\n\t\tcontainer\n\t\t\t.querySelector('#left-menu-hidden-separator')\n\t\t\t.addEventListener('click', this.toggleHiddenContainer.bind(this))\n\t\t;\n\n\t\tif (this.getActiveItem()\n\t\t\t&& this.getActiveItem().container\n\t\t\t\t.getAttribute('data-status') === 'hide'\n\t\t)\n\t\t{\n\t\t\tthis.#showHiddenContainer(false);\n\t\t}\n\t}\n\n\tregisterItem(node): Item\n\t{\n\t\tconst itemClass = getItem(node);\n\t\tconst item = new itemClass(this.container, node);\n\t\tthis.items.set(item.getId(), item);\n\n\t\tif (!(item instanceof ItemMainPage))\n\t\t{\n\t\t\tthis.#registerDND(item);\n\t\t}\n\n\t\tif (this.#activeItem.checkAndSet(\n\t\t\titem,\n\t\t\titem.getSimilarToUrl(\n\t\t\t\tUtils.getCurUri()\n\t\t\t)\n\t\t) === true)\n\t\t{\n\t\t\tlet parentItem = this.#getParentItemFor(item);\n\t\t\twhile (parentItem)\n\t\t\t{\n\t\t\t\tparentItem.markAsActive();\n\t\t\t\tparentItem = this.#getParentItemFor(parentItem);\n\t\t\t}\n\t\t}\n\n\t\tEventEmitter.subscribe(item, Options.eventName('onItemDelete'), ({data}) => {this.deleteItem(item, data)});\n\t\tEventEmitter.subscribe(item, Options.eventName('onItemConvert'), ({data}) => {this.convertItem(item, data)});\n\n\t\t[...item.container.querySelectorAll('a')]\n\t\t\t.forEach((node) => {\n\t\t\t\tnode.addEventListener('click', (event) => {\n\t\t\t\t\tif (this.#isEditMode === true)\n\t\t\t\t\t{\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}, true)\n\t\t\t})\n\t\t;\n\t\titem.container\n\t\t\t.querySelector('[data-role=\"item-edit-control\"]')\n\t\t\t?.addEventListener('click', (event) => {\n\t\t\t\tthis.openItemMenu(item, event.target, event.currentTarget);\n\t\t\t});\n\t\treturn item;\n\t}\n\n\tunregisterItem(item: Item)\n\t{\n\t\tif (!this.items.has(item.getId()))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.items.delete(item.getId());\n\n\t\tthis.#activeItem.checkAndUnset(\n\t\t\titem,\n\t\t\titem.getSimilarToUrl(\n\t\t\t\tUtils.getCurUri()\n\t\t\t)\n\t\t);\n\n\t\tEventEmitter.unsubscribeAll(item, Options.eventName('onItemDelete'));\n\t\tEventEmitter.unsubscribeAll(item, Options.eventName('onItemConvert'));\n\t\titem.container.parentNode.replaceChild(item.container.cloneNode(true), item.container);\n\t}\n\n\tget isEditMode()\n\t{\n\t\treturn this.#isEditMode;\n\t}\n\n\tswitchToEditMode()\n\t{\n\t\tif (this.#isEditMode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#isEditMode = true;\n\n\t\tEventEmitter.emit(\n\t\t\tthis,\n\t\t\tOptions.eventName('EditMode'),\n\t\t);\n\t}\n\n\tswitchToViewMode()\n\t{\n\t\tif (!this.#isEditMode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#isEditMode = false;\n\n\t\tEventEmitter.emit(\n\t\t\tthis,\n\t\t\tOptions.eventName('ViewMode'),\n\t\t);\n\t}\n\n\tisHiddenContainerVisible()\n\t{\n\t\treturn this.hiddenContainer.classList.contains('menu-item-favorites-more-open');\n\t}\n\n\ttoggleHiddenContainer(animate)\n\t{\n\t\tif (this.hiddenContainer.classList.contains('menu-item-favorites-more-open'))\n\t\t{\n\t\t\tthis.#hideHiddenContainer(animate);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#showHiddenContainer(animate);\n\t\t}\n\t}\n\n\t#showHiddenContainer(animate)\n\t{\n\t\tEventEmitter.emit(\n\t\t\tthis,\n\t\t\tOptions.eventName('onHiddenBlockIsVisible')\n\t\t);\n\t\tif (animate === false)\n\t\t{\n\t\t\treturn this.hiddenContainer.classList.add('menu-item-favorites-more-open');\n\t\t}\n\n\t\tthis.hiddenContainer.style.height = \"0px\";\n\t\tthis.hiddenContainer.style.opacity = 0;\n\t\tthis.#animation(true, this.hiddenContainer, this.hiddenContainer.scrollHeight);\n\t}\n\n\t#hideHiddenContainer(animate)\n\t{\n\t\tEventEmitter.emit(\n\t\t\tthis,\n\t\t\tOptions.eventName('onHiddenBlockIsHidden')\n\t\t);\n\t\tif (animate === false)\n\t\t{\n\t\t\treturn this.hiddenContainer.classList.remove('menu-item-favorites-more-open');\n\t\t}\n\t\tthis.#animation(false, this.hiddenContainer, this.hiddenContainer.offsetHeight);\n\t}\n\n\t#animation(opening, hiddenBlock, maxHeight)\n\t{\n\t\thiddenBlock.style.overflow = \"hidden\";\n\t\t(new BX.easing({\n\t\t\tduration: 200,\n\t\t\tstart: {opacity: opening ? 0 : 100, height: opening ? 0 : maxHeight},\n\t\t\tfinish: {opacity: opening ? 100 : 0, height: opening ? maxHeight : 0},\n\t\t\ttransition: BX.easing.transitions.linear,\n\t\t\tstep: function (state) {\n\t\t\t\thiddenBlock.style.opacity = state.opacity / 100;\n\t\t\t\thiddenBlock.style.height = state.height + \"px\";\n\t\t\t},\n\t\t\tcomplete: function () {\n\t\t\t\tif (opening)\n\t\t\t\t{\n\t\t\t\t\thiddenBlock.classList.add('menu-item-favorites-more-open');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\thiddenBlock.classList.remove('menu-item-favorites-more-open');\n\t\t\t\t}\n\t\t\t\thiddenBlock.style.opacity = \"\";\n\t\t\t\thiddenBlock.style.overflow = \"\";\n\t\t\t\thiddenBlock.style.height = \"\";\n\t\t\t}\n\n\t\t})).animate();\n\t}\n\n\tsetItemAsAMainPage(item: Item)\n\t{\n\t\tconst node = item.container;\n\t\tnode.setAttribute(\"data-status\", \"show\");\n\t\tconst startTop = node.offsetTop;\n\t\tconst dragElement = Dom.create(\"div\", {\n\t\t\tattrs: {className: \"menu-draggable-wrap\"},\n\t\t\tstyle: {top: startTop}\n\t\t});\n\n\t\tconst insertBeforeElement = node.nextElementSibling;\n\t\tif (insertBeforeElement)\n\t\t{\n\t\t\tnode.parentNode.insertBefore(dragElement, insertBeforeElement);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnode.parentNode.appendChild(dragElement);\n\t\t}\n\n\t\tdragElement.appendChild(node);\n\n\t\tDom.addClass(node, \"menu-item-draggable\");\n\n\t\t(new BX.easing({\n\t\t\tduration: 500,\n\t\t\tstart: {top: startTop},\n\t\t\tfinish: {top: 0},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: function (state) { dragElement.style.top = state.top + \"px\"; },\n\t\t\tcomplete: () => {\n\t\t\t\tthis.container.insertBefore(node, BX(\"left-menu-empty-item\").nextSibling);\n\t\t\t\tDom.removeClass(node, \"menu-item-draggable\");\n\t\t\t\tDom.remove(dragElement);\n\t\t\t\tthis.#saveItemsSort({\n\t\t\t\t\taction: 'mainPageIsSet',\n\t\t\t\t\titemId: item.getId()\n\t\t\t\t});\n\t\t\t}\n\t\t})).animate();\n\t}\n\n\tshowItem(item: Item)\n\t{\n\t\tconst oldParent = this.#getParentItemFor(item);\n\t\tconst container = this.container;\n\n\t\titem.container.setAttribute('data-status', 'show');\n\t\tif (this.#canChangePaternity(item))\n\t\t{\n\t\t\tcontainer.appendChild(item.container);\n\t\t\tthis.#refreshActivity(item, oldParent);\n\t\t}\n\t\telse if (oldParent)\n\t\t{\n\t\t\tcontainer.appendChild(oldParent.container);\n\t\t\toldParent.container.setAttribute('data-status', 'show');\n\t\t\tcontainer.appendChild(oldParent.groupContainer);\n\t\t}\n\n\t\tif (this.hiddenContainer.querySelector('.menu-item-block') === null)\n\t\t{\n\t\t\tEventEmitter.emit(this, Options.eventName('onHiddenBlockIsEmpty'));\n\t\t\tthis.#hideHiddenContainer(false);\n\t\t}\n\n\t\tthis.#recalculateCounters(item);\n\t\tthis.#saveItemsSort({\n\t\t\taction: 'showItem',\n\t\t\titemId: item.getId()\n\t\t});\n\t}\n\n\thideItem(item: Item)\n\t{\n\t\tconst oldParent = this.#getParentItemFor(item);\n\t\tconst container = this.hiddenContainer.querySelector('#left-menu-hidden-items-list');\n\t\tconst emitEvent = container.querySelector('.menu-item-block') === null;\n\n\t\titem.container.setAttribute('data-status', 'hide');\n\t\tif (this.#canChangePaternity(item))\n\t\t{\n\t\t\tcontainer.appendChild(item.container);\n\t\t\tthis.#refreshActivity(item, oldParent);\n\t\t}\n\t\telse if (oldParent)\n\t\t{\n\t\t\tcontainer.appendChild(oldParent.container);\n\t\t\toldParent.container.setAttribute('data-status', 'hide');\n\t\t\tcontainer.appendChild(oldParent.groupContainer);\n\t\t}\n\n\t\tif (emitEvent)\n\t\t{\n\t\t\tEventEmitter.emit(this, Options.eventName('onHiddenBlockIsNotEmpty'));\n\t\t}\n\n\t\tthis.#recalculateCounters(item);\n\n\t\tthis.#saveItemsSort({\n\t\t\taction: 'hideItem',\n\t\t\titemId: item.getId()\n\t\t});\n\t}\n\n\t#recalculateCounters(item: Item)\n\t{\n\t\tlet counterValue = 0;\n\t\tif (item.container.querySelector('[data-role=\"counter\"]'))\n\t\t{\n\t\t\tcounterValue = item.container.querySelector('[data-role=\"counter\"]').dataset.counterValue;\n\t\t}\n\t\tif (counterValue <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\t[...this.items.entries()]\n\t\t\t.forEach(([id, itemGroup]) => {\n\t\t\t\tif (itemGroup instanceof ItemGroup)\n\t\t\t\t{\n\t\t\t\t\titemGroup.updateCounter();\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\n\t\tlet hiddenCounterValue = 0;\n\t\t[...this.parentContainer\n\t\t\t.querySelectorAll(`.menu-item-block[data-status=\"hide\"][data-role='item']`)\n\t\t].forEach((node) => {\n\t\t\t\tconst counterNode = node.querySelector('[data-role=\"counter\"]');\n\t\t\t\tif (counterNode)\n\t\t\t\t{\n\t\t\t\t\thiddenCounterValue += parseInt(counterNode.dataset.counterValue);\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\n\t\tconst hiddenCounterNode = this.parentContainer.querySelector('#menu-hidden-counter');\n\t\thiddenCounterNode.dataset.counterValue = Math.max(0, hiddenCounterValue);\n\t\tif (hiddenCounterNode.dataset.counterValue > 0)\n\t\t{\n\t\t\thiddenCounterNode.classList.remove('menu-hidden-counter');\n\t\t\thiddenCounterNode.innerHTML = hiddenCounterNode.dataset.counterValue > 99 ? '99+' : hiddenCounterNode.dataset.counterValue;\n\t\t}\n\t\telse\n\t\t{\n\t\t\thiddenCounterNode.classList.add('menu-hidden-counter');\n\t\t\thiddenCounterNode.innerHTML = '';\n\t\t}\n\t}\n\n\t#refreshActivity(item: Item, oldParent:? ItemGroup)\n\t{\n\t\tif (this.getActiveItem() !== item)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst newParent = this.#getParentItemFor(item);\n\n\t\tif (oldParent !== newParent)\n\t\t{\n\t\t\tif (oldParent instanceof ItemGroup)\n\t\t\t{\n\t\t\t\toldParent.markAsInactive();\n\t\t\t}\n\t\t\tif (newParent instanceof ItemGroup)\n\t\t\t{\n\t\t\t\tnewParent.markAsActive();\n\t\t\t}\n\t\t}\n\t}\n\n\t#updateCountersLastValue = null\n\tupdateCounters(counters, send)\n\t{\n\t\tconst countersDynamic = {};\n\t\tsend = send !== false;\n\t\t[...Object.entries(counters)]\n\t\t\t.forEach(([counterId, counterValue]) => {\n\t\t\t\t[...this.#getItemsByCounterId(counterId)]\n\t\t\t\t\t.forEach((item) => {\n\t\t\t\t\t\tconst {oldValue, newValue} = item.updateCounter(counterValue);\n\t\t\t\t\t\tconst state = item.container.getAttribute('data-status');\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t(counterId.indexOf('crm_') < 0 || counterId.indexOf('crm_all') >= 0)\n\t\t\t\t\t\t\t&&\n\t\t\t\t\t\t\t(counterId.indexOf('tasks_') < 0 || counterId.indexOf('tasks_total') >= 0)\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcountersDynamic[state] = countersDynamic[state] || 0;\n\t\t\t\t\t\t\tcountersDynamic[state] += (newValue - oldValue);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlet parentItem = this.#getParentItemFor(item);\n\t\t\t\t\t\twhile (parentItem)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tparentItem.updateCounter();\n\t\t\t\t\t\t\tparentItem = this.#getParentItemFor(parentItem);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t;\n\n\t\t\t\tif (send)\n\t\t\t\t{\n\t\t\t\t\tBX.localStorage.set('lmc-' + counterId, counterValue, 5);\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\n\t\tif (countersDynamic['hide'] !== undefined && countersDynamic['hide'] !== 0)\n\t\t{\n\t\t\tconst hiddenCounterNode = this.parentContainer.querySelector('#menu-hidden-counter');\n\t\t\thiddenCounterNode.dataset.counterValue = Math.max(0, Number(hiddenCounterNode.dataset.counterValue) + Number(countersDynamic['hide']));\n\t\t\tif (hiddenCounterNode.dataset.counterValue > 0)\n\t\t\t{\n\t\t\t\thiddenCounterNode.classList.remove('menu-hidden-counter');\n\t\t\t\thiddenCounterNode.innerHTML = hiddenCounterNode.dataset.counterValue > 99 ? '99+' : hiddenCounterNode.dataset.counterValue;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\thiddenCounterNode.classList.add('menu-hidden-counter');\n\t\t\t\thiddenCounterNode.innerHTML = '';\n\t\t\t}\n\t\t}\n\n\t\tif (typeof BXIM !== 'undefined')\n\t\t{\n\t\t\tif (this.#updateCountersLastValue === null)\n\t\t\t{\n\t\t\t\tthis.#updateCountersLastValue = 0;\n\t\t\t\t[...this.items.entries()]\n\t\t\t\t\t.forEach(([id, item]) => {\n\t\t\t\t\t\tif (item instanceof ItemGroup)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst res = item.getCounterValue();\n\n\t\t\t\t\t\tif (res > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlet counterId = 'doesNotMatter';\n\t\t\t\t\t\t\tif (id.indexOf('menu_crm') >= 0 || id.indexOf('menu_tasks') >= 0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tconst counterNode = item.container.querySelector('[data-role=\"counter\"]');\n\t\t\t\t\t\t\t\tif (counterNode)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tcounterId = counterNode.id;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tcounterId === 'doesNotMatter'\n\t\t\t\t\t\t\t\t|| counterId.indexOf('crm_all') >= 0\n\t\t\t\t\t\t\t\t|| counterId.indexOf('tasks_total') >= 0\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.#updateCountersLastValue += res;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#updateCountersLastValue += (countersDynamic['show'] !== undefined ? countersDynamic['show'] : 0);\n\t\t\t\tthis.#updateCountersLastValue += (countersDynamic['hide'] !== undefined ? countersDynamic['hide'] : 0);\n\t\t\t}\n\t\t\tconst visibleValue = (this.#updateCountersLastValue > 99 ? '99+' : (\n\t\t\t\tthis.#updateCountersLastValue < 0 ? '0' : this.#updateCountersLastValue\n\t\t\t));\n\n\t\t\tconst DesktopApi = Reflection.getClass('BX.Messenger.v2.Lib.DesktopApi');\n\t\t\tif (DesktopApi && DesktopApi.isDesktop())\n\t\t\t{\n\t\t\t\tDesktopApi.setBrowserIconBadge(visibleValue);\n\t\t\t}\n\t\t}\n\n\t\t[...this.items.entries()]\n\t\t\t.forEach(([id, itemGroup]) => {\n\t\t\t\tif (itemGroup instanceof ItemGroup)\n\t\t\t\t{\n\t\t\t\t\titemGroup.updateCounter();\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\t}\n\n\tdecrementCounter(counters)\n\t{\n\t\t[...Object.entries(counters)]\n\t\t\t.forEach(([counterId, counterValue]) => {\n\t\t\t\tconst item = this.#getItemsByCounterId(counterId).shift();\n\t\t\t\tif (item)\n\t\t\t\t{\n\t\t\t\t\tconst value = item.getCounterValue();\n\t\t\t\t\tcounters[counterId] = value > counterValue ? (value - counterValue) : 0;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tdelete counters[counterId];\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\t\tthis.updateCounters(counters, false);\n\t}\n\n\t#getItemsByCounterId(counterId: string)\n\t{\n\t\tconst result = [];\n\t\t[...this.items.values()]\n\t\t\t.forEach((item: Item) => {\n\t\t\t\tconst node = item.container.querySelector('[data-role=\"counter\"]');\n\t\t\t\tif (node && node.id.indexOf(counterId) >= 0)\n\t\t\t\t{\n\t\t\t\t\tresult.push(item);\n\t\t\t\t}\n\t\t\t});\n\t\treturn result;\n\t}\n\n\t#getItemsToSave()\n\t{\n\t\tconst saveSortItems = {\n\t\t\tshow: [],\n\t\t\thide: [],\n\t\t};\n\t\tconst customItems = [];\n\n\t\tlet firstItemLink = null;\n\t\t['show', 'hide']\n\t\t\t.forEach((state) => {\n\t\t\t\tlet items = saveSortItems[state];\n\t\t\t\tlet currentGroupId = null;\n\t\t\t\tconst chain = [];\n\n\t\t\t\tArray.from(\n\t\t\t\t\tthis.parentContainer\n\t\t\t\t\t\t.querySelectorAll(`.menu-item-block[data-status=\"${state}\"]`)\n\t\t\t\t).forEach((node) =>\n\t\t\t\t{\n\t\t\t\t\tif (node.dataset.role === 'group')\n\t\t\t\t\t{\n\t\t\t\t\t\tconst groupId = node.parentNode.hasAttribute('data-group-id') ?\n\t\t\t\t\t\t\tnode.parentNode.getAttribute('data-group-id') : null;\n\t\t\t\t\t\titems = saveSortItems[state];\n\t\t\t\t\t\tlet groupItem\n\t\t\t\t\t\twhile (groupItem = chain.pop())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (groupItem['group_id'] === groupId)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tchain.push(groupItem);\n\t\t\t\t\t\t\t\titems = groupItem.items;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst item = {\n\t\t\t\t\t\t\tgroup_id: node.dataset.id,\n\t\t\t\t\t\t\titems: []\n\t\t\t\t\t\t};\n\t\t\t\t\t\titems.push(item);\n\t\t\t\t\t\tchain.push(item);\n\t\t\t\t\t\titems = item.items;\n\t\t\t\t\t\tcurrentGroupId = node.dataset.id;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tif ([ItemAdminCustom.code, ItemUserSelf.code, ItemUserFavorites.code]\n\t\t\t\t\t\t\t.indexOf(node.getAttribute('data-type')) >= 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst item = {\n\t\t\t\t\t\t\t\tID: node.getAttribute('data-id'),\n\t\t\t\t\t\t\t\tLINK: node.getAttribute('data-link'),\n\t\t\t\t\t\t\t\tTEXT: Text.decode(node.querySelector(\"[data-role='item-text']\").innerHTML)\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tif (node.getAttribute(\"data-new-page\") === \"Y\")\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\titem.NEW_PAGE = \"Y\";\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tcustomItems.push(item);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (firstItemLink === null && Type.isStringFilled(node.getAttribute(\"data-link\")))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfirstItemLink = node.getAttribute(\"data-link\");\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (node.closest(`[data-group-id=\"${currentGroupId}\"][data-role=\"group-content\"]`))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\titems.push(node.dataset.id);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst groupId = node.parentNode.hasAttribute('data-group-id') ?\n\t\t\t\t\t\t\t\tnode.parentNode.getAttribute('data-group-id') : null;\n\t\t\t\t\t\t\titems = saveSortItems[state];\n\t\t\t\t\t\t\tlet groupItem\n\t\t\t\t\t\t\twhile (groupItem = chain.pop())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (groupItem['group_id'] === groupId)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tchain.push(groupItem);\n\t\t\t\t\t\t\t\t\titems = groupItem.items;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\titems.push(node.dataset.id);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t})\n\t\t;\n\t\treturn {saveSortItems, firstItemLink, customItems};\n\t}\n\n\t#saveItemsSort(analyticsLabel)\n\t{\n\t\tconst {saveSortItems, firstItemLink} = this.#getItemsToSave();\n\t\tBackend.saveItemsSort(saveSortItems, firstItemLink, analyticsLabel || {action: 'sortItem'});\n\t}\n\n\taddItem({node, animateFromPoint})\n\t{\n\t\tif (!(node instanceof Element))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst styleValue = node.style.display;\n\t\tif (animateFromPoint)\n\t\t{\n\t\t\tnode.dataset.styleDisplay = node.style.display;\n\t\t\tnode.style.display = 'none';\n\t\t}\n\t\tif (this.items.has(node.dataset.id) && node.dataset.type === ItemUserFavorites.code)\n\t\t{\n\t\t\tconst item = this.items.get(node.dataset.id);\n\t\t\titem.storage.push(ItemUserFavorites.code);\n\t\t\titem.container.dataset.storage = item.storage.join(',');\n\t\t\tnode = item.container;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.container.appendChild(node);\n\t\t\tthis.registerItem(node);\n\t\t\tthis.#saveItemsSort();\n\t\t}\n\n\t\tif (animateFromPoint)\n\t\t{\n\t\t\tthis\n\t\t\t\t.#animateTopItemToLeft(node, animateFromPoint)\n\t\t\t\t.then(() => {\n\t\t\t\t\tnode.style.display = node.dataset.styleDisplay;\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\t}\n\n\tupdateItem(data)\n\t{\n\t\tlet {id} = data;\n\t\tif (this.items.has(id))\n\t\t{\n\t\t\tthis.items\n\t\t\t\t.get(id)\n\t\t\t\t.update(data)\n\t\t\t;\n\t\t}\n\t}\n\n\tdeleteItem(item: Item, {animate})\n\t{\n\t\tthis.items.delete(item.getId());\n\t\tthis.#activeItem.checkAndUnset(item);\n\n\t\tif (item instanceof ItemUserFavorites || animate)\n\t\t{\n\t\t\tthis\n\t\t\t\t.#animateTopItemFromLeft(item.container)\n\t\t\t\t.then(() => {\n\t\t\t\t\titem.container.parentNode.removeChild(item.container);\n\t\t\t\t\tthis.#saveItemsSort();\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\t\telse if (item.container)\n\t\t{\n\t\t\titem.container.parentNode.removeChild(item.container);\n\t\t\tthis.#saveItemsSort();\n\t\t}\n\t}\n\n\tconvertItem(item: Item)\n\t{\n\t\tthis.unregisterItem(item);\n\t\tthis.registerItem(this.parentContainer.querySelector(`li.menu-item-block[data-id=\"${item.getId()}\"]`));\n\t}\n\n\tgetActiveItem(): ?Item\n\t{\n\t\treturn this.#activeItem.item;\n\t}\n\n\t#getParentItemFor(item: Item): ?ItemGroup\n\t{\n\t\tif (!(item instanceof Item))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\tconst parentContainer = item.container.closest('[data-role=\"group-content\"]');\n\t\tif (parentContainer && this.items.has(parentContainer.getAttribute('data-group-id')))\n\t\t{\n\t\t\treturn this.items.get(parentContainer.getAttribute('data-group-id'));\n\t\t}\n\t\treturn null;\n\t}\n\n\t#canChangePaternity(item: Item): boolean\n\t{\n\t\tif (item instanceof ItemGroup)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\tconst oldParent = this.#getParentItemFor(item);\n\t\tif (oldParent instanceof ItemGroup\n\t\t\t&& item.container.parentNode.querySelectorAll('li.menu-item-block').length <= 1\n\t\t)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\texport()\n\t{\n\t\treturn this.#getItemsToSave();\n\t}\n\n\t//region DropdownActions\n\t#openItemMenuPopup;\n\topenItemMenu(item: Item, target: HTMLElement, currentTarget: HTMLElement)\n\t{\n\t\tif (currentTarget)\n\t\t{\n\t\t\tDom.addClass(currentTarget, '--open');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(target, '--open');\n\t\t}\n\n\t\tif (this.#openItemMenuPopup)\n\t\t{\n\t\t\tthis.#openItemMenuPopup.close();\n\t\t}\n\t\tconst contextMenuItems = [];\n\t\t// region hide/show item\n\n\t\tif (item instanceof ItemMainPage)\n\t\t{\n\t\t\tcontextMenuItems.push({\n\t\t\t\ttext: Loc.getMessage('MENU_OPEN_SETTINGS_MAIN_PAGE'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\titem.openSettings();\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t\telse if (item.container.getAttribute(\"data-status\") === \"show\")\n\t\t{\n\t\t\tcontextMenuItems.push({\n\t\t\t\ttext: Loc.getMessage(\"hide_item\"),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.hideItem(item);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcontextMenuItems.push({\n\t\t\t\ttext: Loc.getMessage(\"show_item\"),\n\t\t\t\tonclick: (target, contextMenuItem) => {\n\t\t\t\t\tthis.showItem(item);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t//endregion\n\n\t\t//region set as main page\n\t\tif (\n\t\t\t!Options.isExtranet\n\t\t\t&& !Options.isMainPageEnabled\n\t\t\t&& !(item instanceof ItemUserSelf)\n\t\t\t&& !(item instanceof ItemGroup)\n\t\t\t&& this.container.querySelector('li.menu-item-block[data-role=\"item\"]') !== item.container\n\t\t)\n\t\t{\n\t\t\tcontextMenuItems.push({\n\t\t\t\ttext: Loc.getMessage(\"MENU_SET_MAIN_PAGE\"),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.setItemAsAMainPage(item);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t//endregion\n\n\t\titem\n\t\t\t.getDropDownActions()\n\t\t\t.forEach((actionItem) => {\n\t\t\t\tcontextMenuItems.push(actionItem);\n\t\t\t});\n\n\t\tif (!(item instanceof ItemMainPage))\n\t\t{\n\t\t\tcontextMenuItems.push({\n\t\t\t\ttext: this.#isEditMode ? Loc.getMessage(\"MENU_EDIT_READY_FULL\") : Loc.getMessage(\"MENU_SETTINGS_MODE\"),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.#isEditMode ? this.switchToViewMode() : this.switchToEditMode();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tcontextMenuItems.forEach((item) => {\n\t\t\titem['className'] = [\"menu-popup-no-icon\", item['className'] ?? ''].join(' ');\n\t\t\tconst {onclick} = item;\n\t\t\titem['onclick'] = (event, item) => {\n\t\t\t\titem.getMenuWindow().close();\n\t\t\t\tonclick.call(event, item);\n\t\t\t};\n\t\t});\n\t\tconst targetPosition = Dom.getPosition(target);\n\t\tthis.#openItemMenuPopup = new Menu({\n\t\t\tbindElement: {\n\t\t\t\ttop: targetPosition.top - targetPosition.height,\n\t\t\t\tleft: targetPosition.right,\n\t\t\t},\n\t\t\titems: contextMenuItems,\n\t\t\toffsetTop: 0,\n\t\t\toffsetLeft: Dom.getPosition(target).width / 2,\n\t\t\tevents: {\n\t\t\t\tonClose: () => {\n\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onClose'));\n\t\t\t\t\titem.container.classList.remove('menu-item-block-hover');\n\t\t\t\t\tthis.#openItemMenuPopup = null;\n\t\t\t\t\tif (currentTarget)\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.removeClass(currentTarget, '--open');\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.removeClass(target, '--open');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonShow: () => {\n\t\t\t\t\titem.container.classList.add('menu-item-block-hover');\n\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onShow'));\n\t\t\t\t},\n\t\t\t}\n\t\t});\n\t\tthis.#openItemMenuPopup.show();\n\t}\n\t//endregion\n\n\t//region Visible sliding\n\t#animateTopItemToLeft(node, animateFromPoint)\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tlet {startX, startY} = animateFromPoint;\n\t\t\tconst topMenuNode = document.createElement('DIV');\n\t\t\ttopMenuNode.style = `position: absolute; z-index: 1000; top: ${startY + 25}px;`\n\n\t\t\tconst cloneNode = node.cloneNode(true);\n\t\t\tcloneNode.style.display = node.dataset.styleDisplay;\n\t\t\tdocument.body.appendChild(topMenuNode);\n\t\t\ttopMenuNode.appendChild(cloneNode);\n\n\t\t\tlet finishY = this.hiddenContainer.getBoundingClientRect().top;\n\n\t\t\t(new BX.easing({\n\t\t\t\tduration: 500,\n\t\t\t\tstart: {left: startX},\n\t\t\t\tfinish: {left: 30},\n\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\tstep: function (state) {\n\t\t\t\t\ttopMenuNode.style.left = state.left + \"px\";\n\t\t\t\t},\n\t\t\t\tcomplete: () => {\n\t\t\t\t\t(new BX.easing({\n\t\t\t\t\t\tduration: 500,\n\t\t\t\t\t\tstart: {top: startY + 25},\n\t\t\t\t\t\tfinish: {top: finishY},\n\t\t\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\t\t\tstep: function (state) {\n\t\t\t\t\t\t\ttopMenuNode.style.top = state.top + \"px\";\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomplete: () => {\n\t\t\t\t\t\t\tDom.remove(topMenuNode);\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t}\n\t\t\t\t\t})).animate();\n\t\t\t\t}\n\t\t\t})).animate();\n\t\t});\n\t}\n\t#animateTopItemFromLeft(node)\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\t(new BX.easing({\n\t\t\t\tduration: 700,\n\t\t\t\tstart: {left: node.offsetLeft, opacity: 1},\n\t\t\t\tfinish: {left: 400, opacity: 0},\n\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\tstep: function (state) {\n\t\t\t\t\tnode.style.paddingLeft = state.left + \"px\";\n\t\t\t\t\tnode.style.opacity = state.opacity;\n\t\t\t\t},\n\t\t\t\tcomplete: function () {\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t})).animate();\n\t\t});\n\t}\n\t//endregion\n\n\t/* region D&D */\n\t#registerDND(item)\n\t{\n\t\t//drag&drop\n\t\tjsDD.Enable();\n\t\titem.container.onbxdragstart = this.#menuItemDragStart.bind(this, item);\n\t\titem.container.onbxdrag = (x, y) => { this.#menuItemDragMove(/*item,*/ x, y); };\n\t\titem.container.onbxdraghover = (dest, x, y) => { this.#menuItemDragHover(/*item, */dest, x, y); };\n\t\titem.container.onbxdragstop = this.#menuItemDragStop.bind(this, item);\n\t\tjsDD.registerObject(item.container);\n\t}\n\n\t#menuItemDragStart(item)\n\t{\n\t\tEventEmitter.emit(EventEmitter.GLOBAL_TARGET, 'BX.Bitrix24.LeftMenuClass:onDragStart');\n\n\t\tif (!(item instanceof ItemGroup)\n\t\t\t&& item.container.parentNode.querySelectorAll('li.menu-item-block').length <= 1\n\t\t\t&& this.#getParentItemFor(item) !== null\n\t\t)\n\t\t{\n\t\t\titem = this.#getParentItemFor(item);\n\t\t}\n\n\t\tEventEmitter.emit(\n\t\t\tthis,\n\t\t\tOptions.eventName('onDragModeOn')\n\t\t);\n\n\t\tthis.dnd = {\n\t\t\tcontainer: this.container.parentNode,\n\t\t\titemDomBlank: Dom.create('div', {\n\t\t\t\tstyle: {\n\t\t\t\t\tdisplay: 'none',\n\t\t\t\t\t// border: '2px solid navy'\n\t\t\t\t}}),\n\t\t\titemMoveBlank: Dom.create('div', {\n\t\t\t\tstyle: {\n\t\t\t\t\theight: item.container.offsetHeight + 'px',\n\t\t\t\t\t// border: '2px solid red',\n\t\t\t\t}}\n\t\t\t),\n\t\t\tdraggableBlock: Dom.create('div', {             //div to move\n\t\t\t\tattrs: {\n\t\t\t\t\tclassName: \"menu-draggable-wrap\",\n\t\t\t\t},\n\t\t\t\tstyle: {\n\t\t\t\t\ttop: [(\n\t\t\t\t\t\titem.container.offsetTop - item.container.offsetHeight\n\t\t\t\t\t), 'px'].join(''),\n\t\t\t\t\t// border: '2px solid black'\n\t\t\t\t}\n\t\t\t}),\n\t\t\titem: item,\n\t\t\toldParent: this.#getParentItemFor(item),\n\t\t\tisHiddenContainerVisible: this.isHiddenContainerVisible()\n\t\t}\n\n\t\tthis.#showHiddenContainer(false);\n\n\t\tconst registerItems = () => {\n\t\t\t[...this.parentContainer\n\t\t\t\t.querySelectorAll('li.menu-item-block')]\n\t\t\t\t.forEach((node) => {\n\t\t\t\t\tif (item instanceof ItemGroup\n\t\t\t\t\t\t&& this.#getParentItemFor(\n\t\t\t\t\t\t\tthis.items.get(node.getAttribute('data-id'))\n\t\t\t\t\t\t) !== null)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tjsDD.registerDest(node, 100);\n\t\t\t\t});\n\n\t\t\tconst firstNode = this.parentContainer\n\t\t\t\t.querySelector(\"#left-menu-empty-item\");\n\t\t\tif (item instanceof ItemUserSelf)\n\t\t\t{\n\t\t\t\tjsDD.unregisterDest(firstNode);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tjsDD.registerDest(firstNode, 100);\n\t\t\t}\n\t\t\tjsDD.registerDest(this.parentContainer\n\t\t\t\t.querySelector(\"#left-menu-hidden-empty-item\"), 100);\n\t\t\tjsDD.registerDest(this.parentContainer\n\t\t\t\t.querySelector(\"#left-menu-hidden-separator\"), 100);\n\t\t};\n\n\t\tif (item instanceof ItemGroup)\n\t\t{\n\t\t\titem\n\t\t\t\t.collapse(true)\n\t\t\t\t.then(() => {\n\t\t\t\t\tif (this.dnd)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.dnd.pos = BX.pos(this.container.parentNode);\n\t\t\t\t\t\tregisterItems();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tregisterItems();\n\t\t}\n\n\t\tconst dragElement = item.container;\n\t\tDom.addClass(this.dnd.container, \"menu-drag-mode\")\n\t\tDom.addClass(dragElement, \"menu-item-draggable\");\n\t\tdragElement\n\t\t\t.parentNode\n\t\t\t.insertBefore(this.dnd.itemDomBlank, dragElement); //remember original item place\n\t\tdragElement\n\t\t\t.parentNode\n\t\t\t.insertBefore(this.dnd.itemMoveBlank, dragElement); //empty div\n\t\tthis.dnd.draggableBlock.appendChild(item.container);\n\n\t\tthis.dnd.container.style.position = 'relative';\n\t\tthis.dnd.container.appendChild(this.dnd.draggableBlock);\n\t\tthis.dnd.pos = BX.pos(this.container.parentNode);\n\t}\n\n\t#menuItemDragMove(/*item,*/ x, y)\n\t{\n\t\tconst item = this.dnd.item;\n\t\tvar menuItemsBlockHeight = this.dnd.pos.height;\n\t\ty = Math.max(0, y - this.dnd.pos.top);\n\t\tthis.dnd.draggableBlock.style.top = [\n\t\t\tMath.min(menuItemsBlockHeight - item.container.offsetHeight, y) - 5,\n\t\t\t'px'\n\t\t].join('');\n\t}\n\n\t#menuItemDragHover(/*item, */dest, x, y)\n\t{\n\t\tconst item = this.dnd.item;\n\t\tconst dragElement = item.container;\n\n\t\tif (dest === dragElement)\n\t\t{\n\t\t\tthis.dnd.itemDomBlank\n\t\t\t\t.parentNode.insertBefore(this.dnd.itemMoveBlank, this.dnd.itemDomBlank);\n\t\t\treturn;\n\t\t}\n\n\t\tif (dest.id === \"left-menu-empty-item\" &&\n\t\t\t(\n\t\t\t\tdragElement.getAttribute(\"data-type\") === \"self\"\n\t\t\t\t|| dragElement.getAttribute(\"data-disable-first-item\") === \"Y\"\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\treturn; // self-item cannot be moved on the first place\n\t\t}\n\n\t\tif (dest.getAttribute('data-role') === 'group')\n\t\t{\n\t\t\tconst groupHolder = dest.parentNode.querySelector(`[data-group-id=\"${dest.getAttribute('data-id')}\"]`);\n\t\t\tif (dest.getAttribute('data-collapse-mode') === 'collapsed')\n\t\t\t{\n\t\t\t\tDom.insertAfter(this.dnd.itemMoveBlank, groupHolder);\n\t\t\t}\n\t\t\telse if (item instanceof ItemGroup)\n\t\t\t{\n\t\t\t\tDom.insertBefore(this.dnd.itemMoveBlank, dest);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.prepend(this.dnd.itemMoveBlank, groupHolder.querySelector('ul'));\n\t\t\t}\n\t\t}\n\t\telse if (this.dnd.container.contains(dest))\n\t\t{\n\t\t\tlet itemPlaceHolder = dest;\n\t\t\tif (item instanceof ItemGroup &&\n\t\t\t\tdest.closest('[data-role=\"group-content\"]'))\n\t\t\t{\n\t\t\t\titemPlaceHolder = dest.closest('[data-role=\"group-content\"]');\n\t\t\t}\n\t\t\tDom.insertAfter(this.dnd.itemMoveBlank, itemPlaceHolder);\n\t\t}\n\t}\n\n\t#menuItemDragStop(/*item*/)\n\t{\n\t\tconst item = this.dnd.item;\n\t\tconst oldParent = this.dnd.oldParent;\n\n\t\tconst dragElement = item.container;\n\n\t\tDom.removeClass(this.dnd.container, \"menu-drag-mode\");\n\t\tDom.removeClass(dragElement, \"menu-item-draggable\");\n\t\tthis.dnd.container.style.position = '';\n\n\t\tlet error = null;\n\t\tlet onHiddenBlockIsEmptyEmitted = false;\n\t\tif (this.parentContainer.querySelector('.menu-item-block') === item.container)\n\t\t{\n\t\t\tif (item instanceof ItemUserSelf)\n\t\t\t{\n\t\t\t\terror = Loc.getMessage('MENU_SELF_ITEM_FIRST_ERROR');\n\t\t\t}\n\t\t\telse if (item.container.getAttribute(\"data-disable-first-item\") === \"Y\")\n\t\t\t{\n\t\t\t\terror = Loc.getMessage(\"MENU_FIRST_ITEM_ERROR\");\n\t\t\t}\n\t\t}\n\t\tif (error !== null)\n\t\t{\n\t\t\tthis.dnd.itemDomBlank.parentNode.replaceChild(dragElement, this.dnd.itemDomBlank);\n\t\t\titem.showMessage(error);\n\t\t}\n\t\telse if (!this.dnd.container.contains(this.dnd.itemMoveBlank))\n\t\t{\n\t\t\tthis.dnd.itemDomBlank.parentNode.replaceChild(dragElement, this.dnd.itemDomBlank);\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttry {\n\t\t\t\tthis.dnd.itemMoveBlank.parentNode.replaceChild(dragElement, this.dnd.itemMoveBlank);\n\n\t\t\t\tif (this.hiddenContainer.contains(dragElement))\n\t\t\t\t{\n\t\t\t\t\titem.container.setAttribute(\"data-status\", \"hide\");\n\t\t\t\t\tif (this.dnd.itemDomBlank.closest('#left-menu-hidden-items-block') === null\n\t\t\t\t\t\t&& this.hiddenContainer.querySelectorAll('.menu-item-block').length === 1)\n\t\t\t\t\t{\n\t\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onHiddenBlockIsNotEmpty'));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\titem.container.setAttribute(\"data-status\", \"show\");\n\t\t\t\t\tif (this.hiddenContainer.querySelectorAll('.menu-item-block').length <= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tonHiddenBlockIsEmptyEmitted = true;\n\t\t\t\t\t\tEventEmitter.emit(this, Options.eventName('onHiddenBlockIsEmpty'));\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (item instanceof ItemGroup)\n\t\t\t\t{\n\t\t\t\t\titem\n\t\t\t\t\t\t.checkAndCorrect()\n\t\t\t\t\t\t.expand(true);\n\t\t\t\t}\n\t\t\t\tthis.#refreshActivity(item, oldParent);\n\t\t\t\tthis.#recalculateCounters(item);\n\n\t\t\t\tconst analyticsLabel = {action: 'sortItem'};\n\t\t\t\tif (this.parentContainer.querySelector('.menu-item-block') === item.container\n\t\t\t\t\t&& !this.isExtranet)\n\t\t\t\t{\n\t\t\t\t\titem.showMessage(Loc.getMessage(\"MENU_ITEM_MAIN_PAGE\"));\n\t\t\t\t\tanalyticsLabel.action = 'mainPage';\n\t\t\t\t\tanalyticsLabel.itemId = item.getId();\n\t\t\t\t}\n\t\t\t\tthis.#saveItemsSort(analyticsLabel);\n\t\t\t}\n\t\t\tcatch(e)\n\t\t\t{\n\t\t\t\tthis.dnd.itemDomBlank.parentNode.replaceChild(dragElement, this.dnd.itemDomBlank);\n\t\t\t}\n\t\t}\n\n\t\tDom.remove(this.dnd.draggableBlock);\n\t\tDom.remove(this.dnd.itemDomBlank);\n\t\tDom.remove(this.dnd.itemMoveBlank);\n\n\t\tjsDD.enableDest(dragElement);\n\t\tthis.container.style.position = 'static';\n\t\tif (!this.dnd.isHiddenContainerVisible || onHiddenBlockIsEmptyEmitted === true)\n\t\t{\n\t\t\tthis.#hideHiddenContainer(false);\n\t\t}\n\t\tdelete this.dnd;\n\n\t\t[...this.parentContainer\n\t\t\t.querySelectorAll('li.menu-item-block')]\n\t\t\t.forEach((node) => {\n\t\t\t\tjsDD.registerDest(node);\n\t\t\t});\n\t\tconst firstNode = this.parentContainer\n\t\t\t.querySelector(\"#left-menu-empty-item\");\n\t\tjsDD.unregisterDest(firstNode);\n\t\tjsDD.unregisterDest(this.parentContainer\n\t\t\t.querySelector(\"#left-menu-hidden-empty-item\"));\n\t\tjsDD.unregisterDest(this.parentContainer\n\t\t\t.querySelector(\"#left-menu-hidden-separator\"));\n\t\tjsDD.refreshDestArea();\n\t\tEventEmitter.emit(\n\t\t\tthis,\n\t\t\tOptions.eventName('onDragModeOff')\n\t\t);\n\t}\n\t/*endregion*/\n}\n","import {Text, Tag, Loc} from 'main.core';\nimport {PopupManager, Popup} from 'main.popup';\nimport {EventEmitter} from 'main.core.events';\nimport Backend from '../backend';\nimport Options from '../options';\nimport DefaultController from './default-controller';\nimport ItemUserSelf from '../items/item-user-self';\nimport ItemUserFavorites from \"../items/item-user-favorites\";\nimport Utils from \"../utils\";\n\nexport default class ItemDirector extends DefaultController\n{\n\n\tconstructor(container, params)\n\t{\n\t\tsuper(container, params);\n\t}\n\n\tsaveCurrentPage(page: ?Object)\n\t{\n\t\treturn ItemUserFavorites\n\t\t\t.saveCurrentPage(page)\n\t\t\t.then((data) => {\n\t\t\t\tEventEmitter.emit(\n\t\t\t\t\tthis,\n\t\t\t\t\tOptions.eventName('onItemHasBeenAdded'),\n\t\t\t\t\tdata\n\t\t\t\t);\n\t\t\t\treturn data;\n\t\t\t})\n\t\t\t.catch(Utils.catchError);\n\t}\n\n\tsaveStandardPage(topItem)\n\t{\n\t\treturn ItemUserFavorites\n\t\t\t.saveStandardPage(topItem)\n\t\t\t.then((data) => {\n\t\t\t\tEventEmitter.emit(\n\t\t\t\t\tthis,\n\t\t\t\t\tOptions.eventName('onItemHasBeenAdded'),\n\t\t\t\t\tdata\n\t\t\t\t);\n\t\t\t\treturn data;\n\t\t\t})\n\t\t\t.catch(Utils.catchError);\n\t}\n\n\tdeleteCurrentPage({pageLink})\n\t{\n\t\treturn ItemUserFavorites\n\t\t\t.deleteCurrentPage({pageLink})\n\t\t\t.then((data) => {\n\n\t\t\t\tEventEmitter.emit(this,\n\t\t\t\t\tOptions.eventName('onItemHasBeenDeleted'),\n\t\t\t\t\tdata\n\t\t\t\t);\n\t\t\t\treturn data;\n\t\t\t})\n\t\t\t.catch(Utils.catchError);\n\t}\n\n\tdeleteStandardPage(topItem)\n\t{\n\t\treturn ItemUserFavorites\n\t\t\t.deleteStandardPage(topItem)\n\t\t\t.then((data) => {\n\t\t\t\tEventEmitter.emit(this,\n\t\t\t\t\tOptions.eventName('onItemHasBeenDeleted'),\n\t\t\t\t\tdata\n\t\t\t\t);\n\t\t\t\treturn data;\n\t\t\t})\n\t\t\t.catch(Utils.catchError);\n\t}\n\n\tshowAddToSelf(bindElement)\n\t{\n\t\tItemUserSelf\n\t\t\t.showAdd(bindElement)\n\t\t\t.then((data) => {\n\t\t\t\tEventEmitter.emit(this,\n\t\t\t\t\tOptions.eventName('onItemHasBeenAdded'),\n\t\t\t\t\tdata\n\t\t\t\t);\n\t\t\t}).catch(Utils.catchError);\n\t}\n}\n","import { sendData } from 'ui.analytics';\n\nexport class Analytics\n{\n\t#isAdmin: boolean;\n\n\tconstructor(isAdmin: boolean) {\n\t\tthis.#isAdmin = isAdmin ? AnalyticUserRole.ADMIN : AnalyticUserRole.NOT_ADMIN;\n\t}\n\n\tsendSetCustomPreset()\n\t{\n\t\tsendData({\n\t\t\ttool: AnalyticTool,\n\t\t\tcategory: AnalyticCategory.MENU,\n\t\t\tevent: AnalyticEvent.SET,\n\t\t\ttype: 'custom',\n\t\t\tc_section: AnalyticSection.MENU,\n\t\t\tp1: this.#isAdmin,\n\t\t});\n\t}\n\n\tsendSetPreset(presetId: string, isPersonal: boolean, action)\n\t{\n\t\tsendData({\n\t\t\ttype: presetId,\n\t\t\tevent: isPersonal ? AnalyticEvent.CHANGE : AnalyticEvent.SELECT,\n\t\t\ttool: AnalyticTool,\n\t\t\tcategory: isPersonal ? AnalyticCategory.MENU : AnalyticCategory.TOOL,\n\t\t\tc_section: isPersonal ? AnalyticSection.MENU : AnalyticSection.POPUP,\n\t\t\tc_element: action,\n\t\t\tp1: this.#isAdmin,\n\t\t});\n\t}\n\n\tsendClose()\n\t{\n\t\tsendData({\n\t\t\tevent: AnalyticEvent.SHOW,\n\t\t\ttool: AnalyticTool,\n\t\t\tcategory: AnalyticCategory.TOOL,\n\t\t\tc_section: AnalyticSection.POPUP,\n\t\t});\n\t}\n}\n\nconst AnalyticCategory = {\n\tTOOL: 'main_tool',\n\tMENU: 'main_menu',\n};\n\nconst AnalyticEvent = {\n\tSHOW: 'window_show',\n\tSELECT: 'select',\n\tCHANGE: 'change',\n\tSET: 'menu_set',\n};\n\nconst AnalyticUserRole = {\n\tADMIN: 'isAdmin_Y',\n\tNOT_ADMIN: 'isAdmin_N',\n};\n\nconst AnalyticSection = {\n\tPOPUP: 'menu_popup',\n\tPRESET: 'preset',\n\tQUALIFICATION: 'qualification',\n\tSETTINGS: 'settings',\n\tMENU: 'main_menu',\n};\n\nexport const AnalyticActions = {\n\tCONFIRM: 'confirm',\n\tLATER: 'later',\n\tCLOSE: 'close',\n\tSAVE: 'save',\n\tSKIP: 'skip',\n};\n\nconst AnalyticTool = 'intranet';\n","import { Loc, Text, Dom, ajax as Ajax, Tag, Event, Runtime, Type } from 'main.core';\nimport { MemoryCache, type BaseCache } from 'main.core.cache';\nimport { SidePanel } from 'main.sidepanel';\n\nexport class GroupPanel\n{\n\t#refs: BaseCache<HTMLElement> = new MemoryCache();\n\t#status: 'initial' | 'loading' | 'loaded' = 'initial';\n\t#xhr = null;\n\t#isExtranetInstalled: boolean = true;\n\n\tconstructor(options)\n\t{\n\t\tconst groupsLink = document.getElementById('menu-all-groups-link');\n\t\tEvent.bind(groupsLink, 'click', this.#handleGroupsLinkClick.bind(this));\n\n\t\tthis.#isExtranetInstalled = (\n\t\t\tType.isBoolean(options.isExtranetInstalled)\n\t\t\t\t? options.isExtranetInstalled\n\t\t\t\t: this.#isExtranetInstalled\n\t\t);\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\treturn this.#refs.remember('container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"group-panel-content\">\n\t\t\t\t\t<div class=\"group-panel-header\">\n\t\t\t\t\t\t${this.getFilterContainer()}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.getItemsContainer()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetItemsContainer(): HTMLElement\n\t{\n\t\treturn this.#refs.remember('items-container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"group-panel-items\" onclick=\"${this.#handleItemsClick.bind(this)}\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetFilterContainer(): HTMLElement\n\t{\n\t\treturn this.#refs.remember('filter-container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<span class=\"group-panel-header-filters\">${[\n\t\t\t\t\tTag.render`\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclass=\"group-panel-header-filter group-panel-header-filter-all\"\n\t\t\t\t\t\t\tdata-filter=\"all\"\n\t\t\t\t\t\t\tonclick=\"${this.#handleFilterClick.bind(this)}\"\n\t\t\t\t\t\t>${Loc.getMessage('MENU_MY_WORKGROUPS')}</span>\n\t\t\t\t\t`,\n\t\t\t\t\t(\n\t\t\t\t\t\tthis.#isExtranetInstalled\n\t\t\t\t\t\t\t? Tag.render`\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\tclass=\"group-panel-header-filter group-panel-header-filter-extranet\"\n\t\t\t\t\t\t\t\t\tdata-filter=\"extranet\"\n\t\t\t\t\t\t\t\t\tonclick=\"${this.#handleFilterClick.bind(this)}\"\n\t\t\t\t\t\t\t\t>${Loc.getMessage('MENU_MY_WORKGROUPS_EXTRANET')}</span>\n\t\t\t\t\t\t\t`\n\t\t\t\t\t\t\t: null\n\t\t\t\t\t),\n\t\t\t\t\tTag.render`\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclass=\"group-panel-header-filter group-panel-header-filter-favorites\"\n\t\t\t\t\t\t\tdata-filter=\"favorites\"\n\t\t\t\t\t\t\tonclick=\"${this.#handleFilterClick.bind(this)}\"\n\t\t\t\t\t\t>${Loc.getMessage('MENU_MY_WORKGROUPS_FAVORITES')}${this.getCounterContainer()}</span>\n\t\t\t\t\t`,\n\t\t\t\t]}\n\t\t\t\t</span>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetCounterContainer(): HTMLElement\n\t{\n\t\treturn this.#refs.remember('counter-container', () => {\n\t\t\treturn Tag.render`<span class=\"group-panel-header-filter-counter\"></span>`;\n\t\t});\n\t}\n\n\t#handleGroupsLinkClick(event): void\n\t{\n\t\tSidePanel.Instance.open('my-groups', {\n\t\t\tcacheable: false,\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn Runtime.loadExtension('ui.sidepanel.layout').then((exports) => {\n\t\t\t\t\tconst { Layout } = exports;\n\n\t\t\t\t\treturn Layout.createContent({\n\t\t\t\t\t\ttitle: Loc.getMessage('MENU_MY_WORKGROUPS'),\n\t\t\t\t\t\tdesign: {\n\t\t\t\t\t\t\tsection: true,\n\t\t\t\t\t\t\tmargin: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tbuttons: () => [],\n\t\t\t\t\t\tcontent: () => {\n\t\t\t\t\t\t\tif (this.#status === 'loaded')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn this.getContainer();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn this.#loadContent();\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tonClose: () => {\n\t\t\t\t\tif (this.#xhr && this.#status !== 'loaded')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#status = 'initial';\n\t\t\t\t\t\tthis.#xhr.abort();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\tasync #loadContent(): Promise<HTMLElement>\n\t{\n\t\tthis.#status = 'loading';\n\n\t\tconst response = await Ajax.runAction('intranet.leftmenu.getGroups', {\n\t\t\tonrequeststart: (xhr): void => {\n\t\t\t\tthis.#xhr = xhr;\n\t\t\t},\n\t\t});\n\n\t\tconst { groups, filter } = response.data;\n\t\tfor (const group of groups)\n\t\t{\n\t\t\tconst classes = ['group-panel-item'];\n\t\t\tclasses.push(group.extranet ? 'group-panel-item-extranet' : 'group-panel-item-intranet');\n\t\t\tif (group.favorite)\n\t\t\t{\n\t\t\t\tclasses.push('group-panel-item-favorite');\n\t\t\t}\n\n\t\t\tconst dom = Tag.render`\n\t\t\t\t<a href=\"${encodeURI(group.url)}\" \n\t\t\t\t\tclass=\"${classes.join(' ')}\" \n\t\t\t\t\tdata-id=\"${group.id}\" \n\t\t\t\t\tdata-slider-ignore-autobinding=\"true\"\n\t\t\t\t>\n\t\t\t\t\t<span class=\"group-panel-item-text\" title=\"${Text.encode(group.title)}\">${Text.encode(group.title)}</span>\n\t\t\t\t\t<span class=\"group-panel-item-star\"></span>\n\t\t\t\t</a>\n\t\t\t`;\n\n\t\t\tDom.append(dom, this.getItemsContainer());\n\t\t}\n\n\t\tDom.addClass(this.getContainer(), `group-panel-content-${filter}`);\n\t\tDom.attr(this.getContainer(), { 'data-filter': filter });\n\n\t\tthis.#status = 'loaded';\n\n\t\treturn this.getContainer();\n\t}\n\n\t#handleFilterClick(event): void\n\t{\n\t\tconst filterElement = event.target;\n\n\t\tconst currentFilter = this.getContainer().dataset.filter || 'all';\n\t\tconst newFilter = filterElement.dataset.filter || 'all';\n\n\t\tif (currentFilter !== newFilter)\n\t\t{\n\t\t\tthis.getContainer().dataset.filter = newFilter;\n\t\t\tthis.saveFilter(newFilter);\n\n\t\t\tnew BX.easing({\n\t\t\t\tduration: 50,\n\t\t\t\tstart: { opacity: 1 },\n\t\t\t\tfinish: { opacity: 0 },\n\t\t\t\ttransition: BX.easing.transitions.linear,\n\n\t\t\t\tstep: (state) => {\n\t\t\t\t\tDom.style(this.getItemsContainer(), 'opacity', state.opacity / 100);\n\t\t\t\t},\n\n\t\t\t\tcomplete: () => {\n\t\t\t\t\tDom.removeClass(this.getContainer(), `group-panel-content-${currentFilter}`);\n\t\t\t\t\tDom.addClass(this.getContainer(), `group-panel-content-${newFilter}`);\n\n\t\t\t\t\tnew BX.easing({\n\t\t\t\t\t\tduration: 50,\n\t\t\t\t\t\tstart: { opacity: 0 },\n\t\t\t\t\t\tfinish: { opacity: 1 },\n\t\t\t\t\t\ttransition: BX.easing.transitions.linear,\n\t\t\t\t\t\tstep: (state) => {\n\t\t\t\t\t\t\tDom.style(this.getItemsContainer(), 'opacity', state.opacity / 100);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomplete: () => {\n\t\t\t\t\t\t\tDom.style(this.getItemsContainer(), 'opacity', null);\n\t\t\t\t\t\t},\n\t\t\t\t\t}).animate();\n\t\t\t\t},\n\t\t\t}).animate();\n\t\t}\n\n\t\tevent.stopPropagation();\n\t}\n\n\t#handleItemsClick(event): void\n\t{\n\t\tif (!Dom.hasClass(event.target, 'group-panel-item-star'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst star = event.target;\n\t\tconst item = star.parentNode;\n\t\tconst groupId = item.dataset.id;\n\n\t\tconst action = Dom.hasClass(item, 'group-panel-item-favorite') ? 'removeFromFavorites' : 'addToFavorites';\n\t\tDom.toggleClass(item, 'group-panel-item-favorite');\n\n\t\tthis.#animateStart(star);\n\t\tthis.#animateCounter(action === 'addToFavorites');\n\n\t\tvoid Ajax.runAction(`intranet.leftmenu.${action}`, {\n\t\t\tdata: {\n\t\t\t\tgroupId,\n\t\t\t},\n\t\t});\n\n\t\tevent.preventDefault();\n\t}\n\n\t#animateStart(star): void\n\t{\n\t\tconst flyingStar = star.cloneNode();\n\t\tDom.style(flyingStar, 'margin-left', `-${star.offsetWidth}px`);\n\t\tDom.append(flyingStar, star.parentNode);\n\n\t\tnew BX.easing({\n\t\t\tduration: 200,\n\t\t\tstart: { opacity: 100, scale: 100 },\n\t\t\tfinish: { opacity: 0, scale: 300 },\n\t\t\tstep: (state) => {\n\t\t\t\tDom.style(flyingStar, 'transform', `scale(${state.scale / 100})`);\n\t\t\t\tDom.style(flyingStar, 'opacity', state.opacity / 100);\n\t\t\t},\n\t\t\tcomplete: () => {\n\t\t\t\tflyingStar.parentNode.removeChild(flyingStar);\n\t\t\t},\n\t\t}).animate();\n\t}\n\n\t#animateCounter(positive): void\n\t{\n\t\tthis.getCounterContainer().innerHTML = positive === false ? '-1' : '+1';\n\n\t\tnew BX.easing({\n\t\t\tduration: 400,\n\t\t\tstart: { opacity: 100, top: 0 },\n\t\t\tfinish: { opacity: 0, top: -20 },\n\t\t\ttransition: BX.easing.transitions.linear,\n\t\t\tstep: (state) => {\n\t\t\t\tDom.style(this.getCounterContainer(), 'top', `${state.top}px`);\n\t\t\t\tDom.style(this.getCounterContainer(), 'opacity', state.opacity / 100);\n\t\t\t},\n\t\t\tcomplete: () => {\n\t\t\t\tDom.style(this.getCounterContainer(), 'top', null);\n\t\t\t\tDom.style(this.getCounterContainer(), 'opacity', null);\n\t\t\t},\n\t\t}).animate();\n\t}\n\n\tsaveFilter(filter)\n\t{\n\t\tvoid Ajax.runAction('intranet.leftmenu.setGroupFilter', {\n\t\t\tdata: {\n\t\t\t\tfilter,\n\t\t\t},\n\t\t});\n\t}\n}\n","import { Cache, Loc, ajax, Type, Dom, Reflection } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { PopupManager, MenuItem } from 'main.popup';\nimport PresetCustomController from './controllers/preset-custom-controller';\nimport PresetDefaultController from './controllers/preset-default-controller';\nimport SettingsController from './controllers/settings-controller';\nimport Options from './options';\nimport Backend from './backend';\nimport ItemsController from './controllers/items-controller';\nimport ItemDirector from './controllers/item-director';\nimport Item from './items/item';\nimport ItemSystem from './items/item-system';\nimport ItemUserFavorites from './items/item-user-favorites';\nimport { MessageBox, MessageBoxButtons } from 'ui.dialogs.messagebox';\nimport { BannerDispatcher } from 'ui.banner-dispatcher';\nimport { Analytics, AnalyticActions } from './analytics';\nimport { GroupPanel } from './group-panel';\n\nexport default class Menu\n{\n\tmenuContainer;\n\tmenuHeader;\n\tmenuBody;\n\tmainTable;\n\tupButton;\n\tmenuMoreButton;\n\n\tcache = new Cache.MemoryCache();\n\n\tscrollModeThreshold = 20;//\n\tlastScrollOffset = 0;\n\tslidingModeTimeoutId = 0;\n\n\tisMenuMouseEnterBlocked = false;\n\tisMenuMouseLeaveBlocked = [];\n\tisCollapsedMode = false;\n\n\tconstructor(params)\n\t{\n\t\tthis.menuContainer = document.getElementById(\"menu-items-block\");\n\t\tif (!this.menuContainer)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tparams = typeof params === \"object\" ? params : {};\n\n\t\tOptions.isExtranet = params.isExtranet === 'Y';\n\t\tOptions.isMainPageEnabled = params.isMainPageEnabled === 'Y';\n\t\tOptions.isAdmin = params.isAdmin;\n\t\tOptions.isCustomPresetRestricted = params.isCustomPresetAvailable !== 'Y';\n\t\tOptions.availablePresetTools = params.availablePresetTools;\n\t\tOptions.settingsPath = params.settingsPath;\n\t\tOptions.inviteDialogLink = params.inviteDialogLink;\n\t\tOptions.showMarta = params.showMarta;\n\t\tOptions.showSitemapMenuItem = params.showSitemapMenuItem;\n\n\t\tthis.isCollapsedMode = params.isCollapsedMode;\n\t\tthis.analytics = new Analytics(params.isAdmin);\n\n\t\tthis.initAndBindNodes();\n\t\tthis.bindEvents();\n\t\tthis.getItemsController();\n\n\t\tthis.groupPanel = new GroupPanel({\n\t\t\tisExtranetInstalled: params.isExtranetInstalled !== 'N',\n\t\t});\n\n\t\t// Emulate document scroll because init() can be invoked after page load scroll\n\t\t// (a hard reload with script at the bottom).\n\t\t// this.handleDocumentScroll();\n\t}\n\n\tinitAndBindNodes()\n\t{\n\t\tthis.menuContainer.addEventListener(\"dblclick\", this.handleMenuDoubleClick.bind(this));\n\t\tthis.menuContainer.addEventListener(\"mouseenter\", this.handleMenuMouseEnter.bind(this));\n\t\tthis.menuContainer.addEventListener(\"mouseleave\", this.handleMenuMouseLeave.bind(this));\n\t\tthis.menuContainer.addEventListener(\"transitionend\", this.handleSlidingTransitionEnd.bind(this));\n\n\t\tthis.menuHeader = this.menuContainer.querySelector(\".menu-items-header\");\n\t\tthis.menuBody = this.menuContainer.querySelector(\".menu-items-body\");\n\t\tthis.menuItemsBlock = this.menuContainer.querySelector(\".menu-items\");\n\n\t\t// document.addEventListener(\"scroll\", this.handleDocumentScroll.bind(this));\n\n\t\tthis.mainTable = document.querySelector(\".js-app\");\n\t\tthis.menuHeaderBurger = this.menuHeader.querySelector(\".menu-switcher\");\n\t\tthis.menuHeaderBurger.addEventListener('click', this.handleBurgerClick.bind(this));\n\t\tthis.menuHeader.querySelector(\".menu-items-header-title\")\n\t\t\t.addEventListener('click', this.handleBurgerClick.bind(this, true));\n\n\t\t// this.upButton = this.menuContainer.querySelector(\".menu-btn-arrow-up\");\n\t\t// this.upButton.addEventListener(\"click\", this.handleUpButtonClick.bind(this));\n\t\tthis.menuMoreButton = this.menuContainer.querySelector(\".menu-item-block.menu-expand\");\n\t\tthis.menuMoreButton = this.menuContainer.querySelector('[data-role=\"expand-menu-item\"]');\n\t\tthis.menuMoreButton.addEventListener(\"click\", this.handleShowHiddenClick.bind(this));\n\n\t\tconst siteMapItem = this.menuContainer.querySelector(\".menu-sitemap-btn\");\n\t\tif (siteMapItem)\n\t\t{\n\t\t\tsiteMapItem.addEventListener('click', this.handleSiteMapClick.bind(this));\n\t\t}\n\n\t\tconst settingsSaveBtn = this.menuContainer.querySelector(\".menu-settings-save-btn\");\n\t\tif (settingsSaveBtn)\n\t\t{\n\t\t\tsettingsSaveBtn.addEventListener('click', this.handleViewMode.bind(this));\n\t\t}\n\n\t\t// this.menuContainer.querySelector(\".menu-settings-btn\")?.addEventListener('click', () => {\n\t\t// \tthis.getSettingsController().show();\n\t\t// });\n\t\tthis.menuContainer.querySelector('[data-role=\"menu-settings-item\"]')?.addEventListener('click', () => {\n\t\t\tthis.getSettingsController().show();\n\t\t});\n\t}\n\n\t// region Controllers\n\tgetItemsController(): ItemsController\n\t{\n\t\treturn this.cache.remember('itemsController', () => {\n\t\t\treturn new ItemsController(\n\t\t\t\tthis.menuContainer,\n\t\t\t\t{\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tEditMode: () => {\n\t\t\t\t\t\t\tthis.toggle(true);\n\t\t\t\t\t\t\tthis.menuContainer.classList.add('menu-items-edit-mode');\n\t\t\t\t\t\t\tthis.menuContainer.classList.remove('menu-items-view-mode');\n\t\t\t\t\t\t},\n\t\t\t\t\t\tViewMode: () => {\n\t\t\t\t\t\t\tthis.toggle(true);\n\t\t\t\t\t\t\tthis.menuContainer.classList.add('menu-items-view-mode');\n\t\t\t\t\t\t\tthis.menuContainer.classList.remove('menu-items-edit-mode');\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonDragModeOn: ({target}) => {\n\t\t\t\t\t\t\tthis.switchToSlidingMode(true);\n\t\t\t\t\t\t\tthis.isMenuMouseLeaveBlocked.push('drag');\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonDragModeOff: ({target}) => {\n\t\t\t\t\t\t\tthis.isMenuMouseLeaveBlocked.pop();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonHiddenBlockIsVisible: this.onHiddenBlockIsVisible.bind(this),\n\t\t\t\t\t\tonHiddenBlockIsHidden: this.onHiddenBlockIsHidden.bind(this),\n\t\t\t\t\t\tonHiddenBlockIsEmpty: this.onHiddenBlockIsEmpty.bind(this),\n\t\t\t\t\t\tonHiddenBlockIsNotEmpty: this.onHiddenBlockIsNotEmpty.bind(this),\n\t\t\t\t\t\tonShow: () => { this.isMenuMouseLeaveBlocked.push('items'); },\n\t\t\t\t\t\tonClose: () => { this.isMenuMouseLeaveBlocked.pop(); },\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t}\n\n\tgetItemDirector(): ItemDirector\n\t{\n\t\treturn this.cache.remember('itemsCreator', () => {\n\t\t\treturn new ItemDirector(\n\t\t\t\tthis.menuContainer,\n\t\t\t\t{\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonItemHasBeenAdded: ({data}) => {\n\t\t\t\t\t\t\tthis.getItemsController().addItem(data);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t}\n\n\tgetSettingsController(): ?SettingsController\n\t{\n\t\treturn this.cache.remember('presetController', () => {\n\t\t\tconst node = this.menuContainer.querySelector('[data-role=\"menu-settings-item\"]');\n\n\t\t\tif (!node)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn new SettingsController(\n\t\t\t\tnode,\n\t\t\t\t{\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonGettingSettingMenuItems: this.onGettingSettingMenuItems.bind(this),\n\t\t\t\t\t\tonShow: () => { this.isMenuMouseLeaveBlocked.push('settings'); },\n\t\t\t\t\t\tonClose: () => { this.isMenuMouseLeaveBlocked.pop(); },\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t}\n\n\tgetCustomPresetController(): PresetCustomController\n\t{\n\t\treturn this.cache.remember('customPresetController', () => {\n\t\t\treturn new PresetCustomController(\n\t\t\t\tthis.menuContainer,\n\t\t\t\t{\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonPresetIsSet: ({ data }) => {\n\t\t\t\t\t\t\tconst { saveSortItems, firstItemLink, customItems } = this.getItemsController().export();\n\n\t\t\t\t\t\t\tif (!data)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.analytics.sendSetCustomPreset();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn Backend.setCustomPreset(data, saveSortItems, customItems, firstItemLink)\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonShow: () => { this.isMenuMouseLeaveBlocked.push('presets'); },\n\t\t\t\t\t\tonClose: () => { this.isMenuMouseLeaveBlocked.pop(); },\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t}\n\n\tgetDefaultPresetController(): PresetDefaultController\n\t{\n\t\tlet closeEventWasProcessed = false;\n\t\tconst postponeHandler = (mode: String): Promise => {\n\t\t\tconst result = Backend.postponeSystemPreset(mode);\n\t\t\tEventEmitter.emit(this, Options.eventName('onPresetIsPostponed'));\n\n\t\t\treturn result;\n\t\t};\n\n\t\treturn this.cache.remember('defaultPresetController', () => {\n\t\t\tconst presetController = new PresetDefaultController(\n\t\t\t\tthis.menuContainer,\n\t\t\t\t{\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonPresetIsSet: ({ data: { mode, presetId } }) => {\n\t\t\t\t\t\t\tthis.analytics.sendSetPreset(\n\t\t\t\t\t\t\t\tpresetId,\n\t\t\t\t\t\t\t\tmode === 'personal',\n\t\t\t\t\t\t\t\tAnalyticActions.CONFIRM,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tcloseEventWasProcessed = true;\n\n\t\t\t\t\t\t\treturn Backend.setSystemPreset(mode, presetId);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonPresetIsPostponed: ({ data: { mode } }) => {\n\t\t\t\t\t\t\tthis.analytics.sendSetPreset(\n\t\t\t\t\t\t\t\tpresetController.getSelectedPreset(),\n\t\t\t\t\t\t\t\tmode === 'personal',\n\t\t\t\t\t\t\t\tAnalyticActions.LATER,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tcloseEventWasProcessed = true;\n\n\t\t\t\t\t\t\treturn postponeHandler(mode);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonShow: () => {\n\t\t\t\t\t\t\tthis.analytics.sendClose();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\t\tif (closeEventWasProcessed !== true)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.analytics.sendSetPreset(\n\t\t\t\t\t\t\t\t\tpresetController.getSelectedPreset(),\n\t\t\t\t\t\t\t\t\tpresetController.getMode() === 'personal',\n\t\t\t\t\t\t\t\t\tAnalyticActions.CLOSE,\n\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\tpostponeHandler(presetController.getMode());\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcloseEventWasProcessed = false;\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t);\n\n\t\t\treturn presetController;\n\t\t});\n\t}\n\t// endregion\n\n\tbindEvents(): void\n\t{\n\t\t// All Counters from IM\n\t\tEventEmitter.subscribe('onImUpdateCounter', (event: BaseEvent) => {\n\t\t\tconst [counters] = event.getCompatData();\n\t\t\tthis.updateCounters(counters, false);\n\t\t});\n\n\t\t// Messenger counter\n\t\tEventEmitter.subscribe('onImUpdateCounterMessage', (event: BaseEvent) => {\n\t\t\tconst [counter] = event.getCompatData();\n\t\t\tthis.updateCounters({ 'im-message': counter }, false);\n\t\t});\n\n\t\t// Live Feed Counter\n\t\tEventEmitter.subscribe('onCounterDecrement', (event: BaseEvent) => {\n\t\t\tconst [decrement] = event.getCompatData();\n\t\t\tthis.decrementCounter(document.getElementById('menu-counter-live-feed'), decrement);\n\t\t});\n\n\t\t// All Counters\n\t\tEventEmitter.subscribe('onPullEvent-main', (event: BaseEvent) => {\n\t\t\tconst [command, params] = event.getCompatData();\n\t\t\tif (command === 'user_counter' && params[Loc.getMessage('SITE_ID')])\n\t\t\t{\n\t\t\t\tconst counters = { ...params[Loc.getMessage('SITE_ID')] };\n\t\t\t\tthis.updateCounters(counters, false);\n\t\t\t}\n\t\t});\n\n\t\t// just to hold opened menu in collapsing mode when groups are shown\n\t\tBX.addCustomEvent(\"BX.Bitrix24.GroupPanel:onOpen\", this.handleGroupPanelOpen.bind(this));\n\t\tBX.addCustomEvent(\"BX.Bitrix24.GroupPanel:onClose\", this.handleGroupPanelClose.bind(this));\n\n\t\t// region Top menu integration\n\t\tBX.addCustomEvent('BX.Main.InterfaceButtons:onFirstItemChange', (firstPageLink, firstNode) => {\n\t\t\tif (!firstPageLink || !Type.isDomNode(firstNode))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst topMenuId = firstNode.getAttribute('data-top-menu-id');\n\t\t\tconst leftMenuNode = this.menuBody.querySelector(`[data-top-menu-id=\"${topMenuId}\"]`);\n\t\t\tif (leftMenuNode)\n\t\t\t{\n\t\t\t\tleftMenuNode.setAttribute('data-link', firstPageLink);\n\t\t\t\tconst leftMenuLink = leftMenuNode.querySelector('a.menu-item-link');\n\t\t\t\tif (leftMenuLink)\n\t\t\t\t{\n\t\t\t\t\tleftMenuLink.setAttribute('href', firstPageLink);\n\t\t\t\t}\n\n\t\t\t\tif (leftMenuNode.previousElementSibling === this.menuContainer.querySelector('#left-menu-empty-item'))\n\t\t\t\t{\n\t\t\t\t\tBackend.setFirstPage(firstPageLink);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tBackend.clearCache();\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.showMessage(firstNode, Loc.getMessage('MENU_ITEM_MAIN_SECTION_PAGE'));\n\t\t});\n\n\t\tBX.addCustomEvent('BX.Main.InterfaceButtons:onHideLastVisibleItem', (bindElement) => {\n\t\t\tthis.showMessage(bindElement, Loc.getMessage('MENU_TOP_ITEM_LAST_HIDDEN'));\n\t\t});\n\n\t\t// when we edit top menu item\n\t\tBX.addCustomEvent('BX.Main.InterfaceButtons:onBeforeCreateEditMenu', (contextMenu, dataItem, topMenu) => {\n\t\t\tlet item = this.#getLeftMenuItemByTopMenuItem(dataItem);\n\t\t\tif (!item && dataItem && Type.isStringFilled(dataItem.URL) && !dataItem.URL.match(/javascript:/))\n\t\t\t{\n\t\t\t\tcontextMenu.addMenuItem({\n\t\t\t\t\ttext: Loc.getMessage('MENU_ADD_TO_LEFT_MENU'),\n\t\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\t\tthis.getItemDirector()\n\t\t\t\t\t\t\t.saveStandardPage(dataItem)\n\t\t\t\t\t\t;\n\t\t\t\t\t\titem.getMenuWindow().close();\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (item instanceof ItemUserFavorites)\n\t\t\t{\n\t\t\t\tcontextMenu.addMenuItem({\n\t\t\t\t\ttext: Loc.getMessage('MENU_DELETE_FROM_LEFT_MENU'),\n\t\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\t\tthis.getItemDirector().deleteStandardPage(dataItem);\n\t\t\t\t\t\titem.getMenuWindow().close();\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\t// endregion\n\n\t\t// service event for UI.Toolbar\n\t\ttop.BX.addCustomEvent('UI.Toolbar:onRequestMenuItemData', ({ currentFullPath, context }) => {\n\t\t\tif (Type.isStringFilled(currentFullPath))\n\t\t\t{\n\t\t\t\tBX.onCustomEvent('BX.Bitrix24.LeftMenuClass:onSendMenuItemData', [{\n\t\t\t\t\tcurrentPageInMenu: this.menuContainer.querySelector(`.menu-item-block[data-link=\"${currentFullPath}\"]`),\n\t\t\t\t\tcontext,\n\t\t\t\t}]);\n\t\t\t}\n\t\t});\n\n\t\t// When clicked on a start Favorites like\n\t\tEventEmitter.subscribe('UI.Toolbar:onStarClick', ({compatData: [params]}) => {\n\t\t\tif (params.isActive)\n\t\t\t{\n\t\t\t\tthis.getItemDirector().deleteCurrentPage({\n\t\t\t\t\tcontext: params.context,\n\t\t\t\t\tpageLink: params.pageLink,\n\t\t\t\t}).then(({itemInfo}) => {\n\t\t\t\t\tBX.onCustomEvent('BX.Bitrix24.LeftMenuClass:onMenuItemDeleted', [itemInfo, this]);\n\t\t\t\t\tBX.onCustomEvent('BX.Bitrix24.LeftMenuClass:onStandardItemChangedSuccess', [{\n\t\t\t\t\t\tisActive: false,\n\t\t\t\t\t\tcontext: params.context,\n\t\t\t\t\t}]);\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.getItemDirector()\n\t\t\t\t\t.saveCurrentPage({\n\t\t\t\t\t\tpageTitle: params.pageTitle,\n\t\t\t\t\t\tpageLink: params.pageLink,\n\t\t\t\t\t}).then(({itemInfo}) => {\n\t\t\t\t\t\tBX.onCustomEvent('BX.Bitrix24.LeftMenuClass:onMenuItemAdded', [itemInfo, this]);\n\t\t\t\t\t\tBX.onCustomEvent('BX.Bitrix24.LeftMenuClass:onStandardItemChangedSuccess', [{\n\t\t\t\t\t\t\tisActive: true,\n\t\t\t\t\t\t\tcontext: params.context,\n\t\t\t\t\t\t}]);\n\t\t\t\t\t})\n\t\t\t\t;\n\t\t\t}\n\t\t});\n\n\t\tEventEmitter.subscribe('BX.Main.InterfaceButtons:onBeforeResetMenu', ({compatData: [promises]}) => {\n\t\t\tpromises.push(() => {\n\t\t\t\tconst p = new BX.Promise();\n\t\t\t\tBackend\n\t\t\t\t\t.clearCache()\n\t\t\t\t\t.then(\n\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\tp.fulfill();\n\t\t\t\t\t\t},\n\t\t\t\t\t\t(response) => {\n\t\t\t\t\t\t\tp.reject(`Error: ${response.errors[0].message}`);\n\t\t\t\t\t\t},\n\t\t\t\t\t)\n\t\t\t\t;\n\n\t\t\t\treturn p;\n\t\t\t});\n\t\t});\n\t}\n\n\tisEditMode(): boolean\n\t{\n\t\treturn this.getItemsController().isEditMode;\n\t}\n\n\tisCollapsed(): boolean\n\t{\n\t\treturn this.isCollapsedMode;\n\t}\n\n\tshowMessage(bindElement, message, position)\n\t{\n\t\tvar popup = PopupManager.create(\n\t\t\t\"left-menu-message\",\n\t\t\tbindElement,\n\t\t\t{\n\t\t\t\tcontent: '<div class=\"left-menu-message-popup\">' + message + '</div>',\n\t\t\t\tdarkMode: true,\n\t\t\t\toffsetTop: position === \"right\" ? -45 : 2,\n\t\t\t\toffsetLeft: position === \"right\" ? 215 : 0,\n\t\t\t\tangle: position === \"right\" ? {position: \"left\"} : true,\n\t\t\t\tcacheable: false,\n\t\t\t\tautoHide: true,\n\t\t\t\tevents: {\n\t\t\t\t\tonDestroy: function () {\n\t\t\t\t\t\tpopup = null;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t})\n\t\t;\n\n\t\tpopup.show();\n\n\t\tsetTimeout(function ()\n\t\t{\n\t\t\tif (popup)\n\t\t\t{\n\t\t\t\tpopup.close();\n\t\t\t\tpopup = null;\n\t\t\t}\n\t\t}, 3000);\n\t}\n\n\tshowError(bindElement)\n\t{\n\t\tthis.showMessage(bindElement, Loc.getMessage('edit_error'));\n\t}\n\n\tshowGlobalPreset()\n\t{\n\t\tBannerDispatcher.high.toQueue((onDone) => {\n\t\t\tconst presetController = this.getDefaultPresetController();\n\t\t\tpresetController.show('global');\n\t\t\tpresetController.getPopup().subscribe('onAfterClose', (event) => {\n\t\t\t\tonDone();\n\t\t\t});\n\t\t});\n\t}\n\n\thandleShowHiddenClick()\n\t{\n\t\tthis.getItemsController().toggleHiddenContainer(true);\n\t}\n\n\tonHiddenBlockIsVisible()\n\t{\n\t\tDom.addClass(this.menuMoreButton, 'menu-favorites-more-btn-open');\n\t\tthis.menuMoreButton.querySelector(\"#menu-more-btn-text\").innerHTML = Loc.getMessage(\"more_items_hide\");\n\t}\n\n\tonHiddenBlockIsHidden()\n\t{\n\t\tDom.removeClass(this.menuMoreButton, 'menu-favorites-more-btn-open');\n\t\tthis.menuMoreButton.querySelector(\"#menu-more-btn-text\").innerHTML = Loc.getMessage(\"more_items_show\");\n\t}\n\n\tonHiddenBlockIsEmpty()\n\t{\n\t\tDom.addClass(this.menuMoreButton, 'menu-favorites-more-btn-hidden');\n\t}\n\n\tonHiddenBlockIsNotEmpty()\n\t{\n\t\tDom.removeClass(this.menuMoreButton, 'menu-favorites-more-btn-hidden');\n\t}\n\n\tsetDefaultMenu()\n\t{\n\t\tMessageBox.show({\n\t\t\tmessage: Loc.getMessage('MENU_SET_DEFAULT_CONFIRM'),\n\t\t\tonYes: (messageBox, button) => {\n\t\t\t\tbutton.setWaiting();\n\t\t\t\tBackend\n\t\t\t\t\t.setDefaultPreset()\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tbutton.setWaiting(false);\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\tdocument.location.reload();\n\t\t\t\t\t})\n\t\t\t\t;\n\t\t\t},\n\t\t\tbuttons: MessageBoxButtons.YES_CANCEL\n\t\t});\n\t}\n\n\tclearCompositeCache()\n\t{\n\t\tajax.runAction('intranet.leftmenu.clearCache', {data: {}});\n\t}\n\n\t#getLeftMenuItemByTopMenuItem({DATA_ID, NODE}): ?Item\n\t{\n\t\tlet item = this.getItemsController().items.get(DATA_ID);\n\t\tif (!item)\n\t\t{\n\t\t\tconst topMenuId = NODE.getAttribute('data-top-menu-id');\n\t\t\tif (NODE === NODE.parentNode.querySelector('[data-top-menu-id]'))\n\t\t\t{\n\t\t\t\tconst leftMenuNode = this.menuItemsBlock.querySelector(`[data-top-menu-id=\"${topMenuId}\"]`);\n\t\t\t\tif (leftMenuNode)\n\t\t\t\t{\n\t\t\t\t\titem = this.getItemsController().items.get(leftMenuNode.getAttribute('data-id'));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn item ?? null;\n\t}\n\t// region Events servicing functions\n\tonGettingSettingMenuItems()\n\t{\n\t\tconst topPoint = ItemUserFavorites.getActiveTopMenuItem();\n\t\tlet menuItemWithAddingToFavorites = null;\n\t\tif (topPoint)\n\t\t{\n\t\t\tconst node = this.menuContainer.querySelector(`.menu-item-block[data-link=\"${topPoint['URL']}\"]`);\n\t\t\tif (!node)\n\t\t\t{\n\t\t\t\tmenuItemWithAddingToFavorites = {\n\t\t\t\t\ttext: Loc.getMessage(\"MENU_ADD_TO_LEFT_MENU\"),\n\t\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\t\tthis.getItemDirector()\n\t\t\t\t\t\t\t.saveStandardPage(topPoint)\n\t\t\t\t\t\t;\n\t\t\t\t\t\titem.getMenuWindow().destroy();\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t\telse if (node.getAttribute('data-type') === ItemUserFavorites.code)\n\t\t\t{\n\t\t\t\tmenuItemWithAddingToFavorites = {\n\t\t\t\t\ttext: Loc.getMessage(\"MENU_DELETE_FROM_LEFT_MENU\"),\n\t\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\t\tthis.getItemDirector()\n\t\t\t\t\t\t\t.deleteStandardPage(topPoint)\n\t\t\t\t\t\t;\n\t\t\t\t\t\titem.getMenuWindow().destroy();\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tmenuItemWithAddingToFavorites = {\n\t\t\t\t\ttext: Loc.getMessage('MENU_DELETE_PAGE_FROM_LEFT_MENU'),\n\t\t\t\t\tclassName: 'menu-popup-disable-text',\n\t\t\t\t\tonclick: () => { }\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tconst leftMenuSettingItems = [\n\t\t\t{\n\t\t\t\ttext: Loc.getMessage('SORT_ITEMS'),\n\t\t\t\tonclick: () => { this.getItemsController().switchToEditMode();}\n\t\t\t},\n\t\t\t{\n\t\t\t\ttext: this.isCollapsed() ? Loc.getMessage('MENU_EXPAND') : Loc.getMessage('MENU_COLLAPSE'),\n\t\t\t\tonclick: (event, item: MenuItem) => {\n\t\t\t\t\tthis.toggle();\n\t\t\t\t\titem.getMenuWindow().destroy();\n\t\t\t\t},\n\t\t\t},\n\t\t\tmenuItemWithAddingToFavorites,\n\t\t\t{\n\t\t\t\ttext: Loc.getMessage('MENU_ADD_SELF_PAGE'),\n\t\t\t\tonclick: (event, item: MenuItem) => {\n\t\t\t\t\tthis\n\t\t\t\t\t\t.getItemDirector()\n\t\t\t\t\t\t.showAddToSelf(\n\t\t\t\t\t\t\tthis.getSettingsController().getContainer()\n\t\t\t\t\t\t)\n\t\t\t\t\t;\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\n\t\t//custom preset\n\t\tif (Options.isAdmin)\n\t\t{\n\t\t\tlet itemText = Loc.getMessage('MENU_SAVE_CUSTOM_PRESET');\n\n\t\t\tif (Options.isCustomPresetRestricted)\n\t\t\t{\n\t\t\t\titemText+= \"<span class='menu-lock-icon'></span>\";\n\t\t\t}\n\n\t\t\tleftMenuSettingItems.push({\n\t\t\t\thtml: itemText,\n\t\t\t\tclassName: (Options.isCustomPresetRestricted ? ' menu-popup-disable-text' : ''),\n\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\tif (Options.isCustomPresetRestricted)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.UI.InfoHelper.show('limit_office_menu_to_all');\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.getCustomPresetController().show();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (!Options.isExtranet)\n\t\t{\n\t\t\tleftMenuSettingItems.push({\n\t\t\t\ttext: Loc.getMessage('MENU_SET_DEFAULT'),\n\t\t\t\tonclick: this.setDefaultMenu.bind(this)\n\t\t\t})\n\t\t}\n\n\t\tconst Messenger = Reflection.getClass('BX.Messenger.v2.Lib.Messenger');\n\n\t\tconst menuItems = [\n\t\t\t!Options.isAdmin ? null : {\n\t\t\t\ttext: Loc.getMessage('LEFT_MENU_SETTINGS_ITEM_B24_SETTINGS'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tBX.SidePanel.Instance.open(`${Options.settingsPath}?analyticContext=left_menu`, {\n\t\t\t\t\t\tallowChangeHistory: false,\n\t\t\t\t\t\twidth: 1034,\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t},\n\t\t\tMessenger ? {\n\t\t\t\ttext: Loc.getMessage('LEFT_MENU_SETTINGS_ITEM_MESSENGER_SETTINGS'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tMessenger.openSettings();\n\t\t\t\t},\n\t\t\t} : null,\n\t\t\tOptions.isExtranet ? null : {\n\t\t\t\ttext: Loc.getMessage('MENU_SET_DEFAULT2'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.getDefaultPresetController().show('personal');\n\t\t\t\t},\n\t\t\t},\n\t\t\t!Options.inviteDialogLink ? null : {\n\t\t\t\ttext: Loc.getMessage('MENU_INVITE_USERS'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tBX.SidePanel.Instance.open(Options.inviteDialogLink, {cacheable: false, allowChangeHistory: false, width: 1100});\n\t\t\t\t},\n\t\t\t},\n\t\t\t!Options.isAdmin && Options.isExtranet ? null : {\n\t\t\t\tdelimiter: true,\n\t\t\t},\n\t\t\t{\n\t\t\t\ttext: Loc.getMessage('LEFT_MENU_SETTINGS_ITEM_MENU_SETTINGS'),\n\t\t\t\titems: leftMenuSettingItems,\n\t\t\t},\n\t\t\t{\n\t\t\t\tdelimiter: true,\n\t\t\t},\n\t\t\t!Options.showSitemapMenuItem ? null : {\n\t\t\t\ttext: Loc.getMessage('MENU_SITE_MAP'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.handleSiteMapClick();\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\ttext: Loc.getMessage('MENU_HELP'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.handleHelperClick();\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\n\t\treturn menuItems.filter((value) => {return value !== null;})\n\t}\n\n\t// endregion\n\n\thandleSiteMapClick()\n\t{\n\t\tthis.switchToSlidingMode(false);\n\n\t\tBX.SidePanel.Instance.open(\n\t\t\t(Loc.getMessage('SITE_DIR') || '/') + 'sitemap/',\n\t\t\t{\n\t\t\t\tallowChangeHistory: false,\n\t\t\t\tcustomLeftBoundary: 0\n\t\t\t}\n\t\t);\n\t}\n\n\thandleHelperClick()\n\t{\n\t\tthis.switchToSlidingMode(false);\n\t\tBX.Helper.show();\n\t}\n\n\t// region Sliding functions\n\tblockSliding()\n\t{\n\t\tthis.stopSliding()\n\t\tthis.isMenuMouseEnterBlocked = true;\n\t}\n\n\treleaseSliding()\n\t{\n\t\tthis.isMenuMouseEnterBlocked = false;\n\t}\n\n\tstopSliding()\n\t{\n\t\tclearTimeout(this.slidingModeTimeoutId);\n\t\tthis.slidingModeTimeoutId = 0;\n\t}\n\n\tstartSliding()\n\t{\n\t\tthis.stopSliding();\n\t\tif (this.isMenuMouseEnterBlocked === true)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.slidingModeTimeoutId = setTimeout(function() {\n\t\t\tthis.slidingModeTimeoutId = 0;\n\t\t\tthis.switchToSlidingMode(true);\n\t\t}.bind(this), 400);\n\t}\n\n\thandleBurgerClick(open)\n\t{\n\t\tthis.getItemsController().switchToViewMode();\n\n\t\tthis.menuHeaderBurger.classList.add(\"menu-switcher-hover\");\n\n\t\tthis.toggle(open, function() {\n\n\t\t\tthis.blockSliding();\n\n\t\t\tsetTimeout(function() {\n\t\t\t\tthis.menuHeaderBurger.classList.remove(\"menu-switcher-hover\");\n\n\t\t\t\tthis.releaseSliding();\n\n\t\t\t}.bind(this), 100);\n\n\t\t}.bind(this));\n\t}\n\n\thandleMenuMouseEnter(event)\n\t{\n\t\tif (!this.isCollapsed())\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.startSliding();\n\t}\n\n\thandleMenuMouseLeave(event)\n\t{\n\t\tthis.stopSliding();\n\t\tif (this.isMenuMouseLeaveBlocked.length <= 0)\n\t\t{\n\t\t\tthis.switchToSlidingMode(false);\n\t\t}\n\t}\n\n\thandleMenuDoubleClick(event)\n\t{\n\t\tif (event.target === this.menuBody)\n\t\t{\n\t\t\tthis.toggle();\n\t\t}\n\t}\n\n\thandleUpButtonClick()\n\t{\n\t\tthis.blockSliding();\n\n\t\tif (this.isUpButtonReversed())\n\t\t{\n\t\t\twindow.scrollTo(0, this.lastScrollOffset);\n\t\t\tthis.lastScrollOffset = 0;\n\t\t\tthis.unreverseUpButton();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.lastScrollOffset = window.pageYOffset;\n\t\t\twindow.scrollTo(0, 0);\n\t\t\tthis.reverseUpButton();\n\t\t}\n\n\t\tsetTimeout(this.releaseSliding.bind(this), 100);\n\t}\n\n\thandleUpButtonMouseLeave()\n\t{\n\t\tthis.releaseSliding();\n\t}\n\n\thandleDocumentScroll()\n\t{\n\t\tif (window.pageYOffset > document.documentElement.clientHeight)\n\t\t{\n\t\t\tthis.showUpButton();\n\n\t\t\tif (this.isUpButtonReversed())\n\t\t\t{\n\t\t\t\tthis.unreverseUpButton();\n\t\t\t\tthis.lastScrollOffset = 0;\n\t\t\t}\n\t\t}\n\t\telse if (!this.isUpButtonReversed())\n\t\t{\n\t\t\tthis.hideUpButton();\n\t\t}\n\n\t\tif (window.pageXOffset > 0)\n\t\t{\n\t\t\tthis.menuContainer.style.left = -window.pageXOffset + \"px\";\n\t\t\tthis.upButton.style.left = -window.pageXOffset + (this.isCollapsed() ? 0 : 172) + \"px\";\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.menuContainer.style.removeProperty(\"left\");\n\t\t\tthis.upButton.style.removeProperty(\"left\");\n\t\t}\n\t}\n\n\tswitchToSlidingMode(enable, immediately)\n\t{\n\t\tif (enable === false)\n\t\t{\n\t\t\tthis.stopSliding();\n\n\t\t\tif (BX.hasClass(this.mainTable, \"menu-sliding-mode\"))\n\t\t\t{\n\t\t\t\tif (immediately !== true)\n\t\t\t\t{\n\t\t\t\t\tBX.addClass(this.mainTable, \"menu-sliding-closing-mode\");\n\t\t\t\t}\n\n\t\t\t\tBX.removeClass(this.mainTable, \"menu-sliding-mode menu-sliding-opening-mode\");\n\t\t\t\tDom.removeClass(this.menuContainer, '--ui-context-edge-dark');\n\t\t\t}\n\t\t}\n\t\telse if (this.isCollapsedMode && !BX.hasClass(this.mainTable, \"menu-sliding-mode\"))\n\t\t{\n\t\t\tBX.removeClass(this.mainTable, \"menu-sliding-closing-mode\");\n\t\t\tDom.removeClass(this.menuContainer, '--ui-context-edge-dark');\n\n\t\t\tif (immediately !== true)\n\t\t\t{\n\t\t\t\tBX.addClass(this.mainTable, \"menu-sliding-opening-mode\");\n\t\t\t}\n\n\t\t\tBX.addClass(this.mainTable, \"menu-sliding-mode\");\n\t\t\tDom.addClass(this.menuContainer, '--ui-context-edge-dark');\n\t\t}\n\t}\n\n\thandleSlidingTransitionEnd(event)\n\t{\n\t\tif (event.target === this.menuContainer)\n\t\t{\n\t\t\tBX.removeClass(this.mainTable, \"menu-sliding-opening-mode menu-sliding-closing-mode\");\n\t\t}\n\t}\n\n\tswitchToScrollMode(enable)\n\t{\n\t\tif (enable === false)\n\t\t{\n\t\t\tDom.removeClass(this.mainTable, 'menu-scroll-mode');\n\t\t}\n\t\telse if (!Dom.hasClass(this.mainTable, 'menu-scroll-mode'))\n\t\t{\n\t\t\tDom.addClass(this.mainTable, 'menu-scroll-mode');\n\t\t}\n\t}\n\n\ttoggle(flag, fn)\n\t{\n\t\tlet leftColumn = document.querySelector(\".js-app\");\n\t\tif (!leftColumn)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst isOpen = !this.mainTable.classList.contains('menu-collapsed-mode');\n\n\t\tif (flag === isOpen || this.mainTable.classList.contains('menu-animation-mode'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.onCustomEvent(\"BX.Bitrix24.LeftMenuClass:onMenuToggle\", [flag, this]);\n\n\t\tthis.blockSliding();\n\t\tthis.switchToSlidingMode(false, true);\n\n\t\t// leftColumn.style.overflow = \"hidden\";\n\t\tthis.mainTable.classList.add(\"menu-animation-mode\", (isOpen ? \"menu-animation-closing-mode\" : \"menu-animation-opening-mode\"));\n\n\t\tvar menuLinks = [].slice.call(leftColumn.querySelectorAll('.menu-item-link'));\n\t\tvar menuMoreBtn = leftColumn.querySelector('.menu-collapsed-more-btn');\n\t\tvar menuMoreBtnDefault = leftColumn.querySelector('.menu-default-more-btn');\n\n\t\tvar menuSitemapIcon = leftColumn.querySelector('.menu-sitemap-icon-box');\n\t\tvar menuSitemapText = leftColumn.querySelector('.menu-sitemap-btn-text');\n\n\t\tvar menuEmployeesText = leftColumn.querySelector('.menu-invite-employees-text');\n\t\tvar menuEmployeesIcon = leftColumn.querySelector('.menu-invite-icon-box');\n\n\t\tvar licenseContainer = leftColumn.querySelector('.menu-license-all-container');\n\t\tvar licenseBtn = leftColumn.querySelector('.menu-license-all-default');\n\t\tvar licenseHeight = licenseBtn ? licenseBtn.offsetHeight : 0;\n\t\tvar licenseCollapsedBtn = leftColumn.querySelector('.menu-license-all-collapsed');\n\n\t\tconst settingsIconBox = this.menuContainer.querySelector(\".menu-settings-icon-box\");\n\t\tconst settingsBtnText = this.menuContainer.querySelector(\".menu-settings-btn-text\");\n\n\t\tconst helpIconBox = this.menuContainer.querySelector(\".menu-help-icon-box\");\n\t\tconst helpBtnText = this.menuContainer.querySelector(\".menu-help-btn-text\");\n\n\t\tvar menuTextDivider = leftColumn.querySelector('.menu-item-separator');\n\t\tvar menuMoreCounter = leftColumn.querySelector('.menu-item-index-more');\n\n\t\tvar pageHeader = this.mainTable.querySelector(\".air-header\");\n\t\tvar imBar = document.getElementById(\"bx-im-bar\");\n\t\tvar imBarWidth = imBar ? imBar.offsetWidth : 0;\n\n\t\tconst expandedMenuWidth = parseInt(getComputedStyle(this.menuContainer).getPropertyValue('--menu-width-expanded'), 10);\n\t\tconst collapsedMenuWidth = parseInt(getComputedStyle(this.menuContainer).getPropertyValue('--menu-width-collapsed'), 10);\n\n\t\t(new BX.easing({\n\t\t\tduration: 300,\n\t\t\tstart: {\n\t\t\t\tsidebarWidth: isOpen ? expandedMenuWidth : collapsedMenuWidth, /* these values are duplicated in style.css as well */\n\t\t\t\t// opacity: isOpen ? 100 : 0,\n\t\t\t\t// opacityRevert: isOpen ? 0 : 100\n\t\t\t},\n\t\t\tfinish: {\n\t\t\t\tsidebarWidth: isOpen ? collapsedMenuWidth : expandedMenuWidth,\n\t\t\t\t// opacity: isOpen ? 0 : 100,\n\t\t\t\t// opacityRevert: isOpen ? 100 : 0\n\t\t\t},\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: function (state)\n\t\t\t{\n\t\t\t\t// leftColumn.style.width = state.sidebarWidth + \"px\";\n\t\t\t\tthis.menuContainer.style.width = state.sidebarWidth + \"px\";\n\t\t\t\tthis.menuHeaderBurger.style.width = state.burgerMenuWidth + \"px\";\n\t\t\t\t// this.headerBurger.style.width = state.burgerMenuWidth + \"px\";\n\n\t\t\t\t//Change this formula in template_style.css as well\n\t\t\t\tif (pageHeader)\n\t\t\t\t{\n\t\t\t\t\tpageHeader.style.maxWidth = \"calc(100vw - \" + state.sidebarWidth + \"px - \" + imBarWidth + \"px)\";\n\t\t\t\t}\n\n\t\t\t\tif (isOpen)\n\t\t\t\t{\n\t\t\t\t\t//Closing Mode\n\t\t\t\t\tif (menuSitemapIcon)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuSitemapIcon.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\tmenuSitemapIcon.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (menuSitemapText)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuSitemapText.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t\tmenuSitemapText.style.opacity = state.opacity / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (menuEmployeesIcon)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuEmployeesIcon.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\tmenuEmployeesIcon.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (menuEmployeesText)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuEmployeesText.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t\tmenuEmployeesText.style.opacity = state.opacity / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (settingsIconBox)\n\t\t\t\t\t{\n\t\t\t\t\t\tsettingsIconBox.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\tsettingsIconBox.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (settingsBtnText)\n\t\t\t\t\t{\n\t\t\t\t\t\tsettingsBtnText.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t\tsettingsBtnText.style.opacity = state.opacity / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (helpIconBox)\n\t\t\t\t\t{\n\t\t\t\t\t\thelpIconBox.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\thelpIconBox.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (helpBtnText)\n\t\t\t\t\t{\n\t\t\t\t\t\thelpBtnText.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t\thelpBtnText.style.opacity = state.opacity / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (menuMoreBtn)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuMoreBtn.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\tmenuMoreBtn.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (menuMoreBtnDefault)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuMoreBtnDefault.style.transform = \"translateX(\" + state.translateMoreBtn + \"px)\";\n\t\t\t\t\t\tmenuMoreBtnDefault.style.opacity = state.opacity / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (menuMoreCounter)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuMoreCounter.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\tmenuMoreCounter.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (licenseContainer)\n\t\t\t\t\t{\n\t\t\t\t\t\tlicenseBtn.style.transform = \"translateX(\" + state.translateLicenseBtn + \"px)\";\n\t\t\t\t\t\tlicenseBtn.style.opacity = state.opacity / 100;\n\t\t\t\t\t\tlicenseBtn.style.height = state.heightLicenseBtn + \"px\";\n\n\t\t\t\t\t\tlicenseCollapsedBtn.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\tlicenseCollapsedBtn.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tmenuLinks.forEach(function(item) {\n\t\t\t\t\t\tvar menuIcon = item.querySelector(\".menu-item-icon-box\");\n\t\t\t\t\t\tvar menuLinkText = item.querySelector(\".menu-item-link-text\");\n\t\t\t\t\t\tvar menuCounter = item.querySelector(\".menu-item-index\");\n\t\t\t\t\t\tvar menuArrow = item.querySelector('.menu-item-link-arrow');\n\n\t\t\t\t\t\tmenuLinkText.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t\tmenuLinkText.style.opacity = state.opacity / 100;\n\n\t\t\t\t\t\tmenuIcon.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\tmenuIcon.style.opacity = state.opacityRevert / 100;\n\n\t\t\t\t\t\tif (menuArrow)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmenuArrow.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t\t\tmenuArrow.style.opacity = state.opacity / 100;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (menuCounter)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmenuCounter.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\t\tmenuCounter.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t//Opening Mode\n\t\t\t\t\tmenuTextDivider.style.opacity = 0;\n\n\t\t\t\t\tif (menuSitemapIcon)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuSitemapIcon.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\tmenuSitemapIcon.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (menuSitemapText)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuSitemapText.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t\tmenuSitemapText.style.opacity = state.opacity / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (menuEmployeesIcon)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuEmployeesIcon.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\tmenuEmployeesIcon.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (menuEmployeesText)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuEmployeesText.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t\tmenuEmployeesText.style.opacity = state.opacity / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (settingsIconBox)\n\t\t\t\t\t{\n\t\t\t\t\t\tsettingsIconBox.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\tsettingsIconBox.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (settingsBtnText)\n\t\t\t\t\t{\n\t\t\t\t\t\tsettingsBtnText.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t\tsettingsBtnText.style.opacity = state.opacity / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (helpIconBox)\n\t\t\t\t\t{\n\t\t\t\t\t\thelpIconBox.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\thelpIconBox.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (helpBtnText)\n\t\t\t\t\t{\n\t\t\t\t\t\thelpBtnText.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t\thelpBtnText.style.opacity = state.opacity / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (menuMoreBtn)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuMoreBtn.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\tmenuMoreBtn.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (menuMoreBtnDefault)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuMoreBtnDefault.style.transform = \"translateX(\" + state.translateMoreBtn + \"px)\";\n\t\t\t\t\t\tmenuMoreBtnDefault.style.opacity = state.opacity / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (menuMoreCounter)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuMoreCounter.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t}\n\n\t\t\t\t\tif (licenseContainer)\n\t\t\t\t\t{\n\t\t\t\t\t\tlicenseBtn.style.transform = \"translateX(\" + state.translateLicenseBtn + \"px)\";\n\t\t\t\t\t\tlicenseBtn.style.opacity = state.opacity / 100;\n\t\t\t\t\t\tlicenseBtn.style.height = state.heightLicenseBtn + \"px\";\n\n\t\t\t\t\t\tlicenseCollapsedBtn.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\tlicenseCollapsedBtn.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t}\n\n\t\t\t\t\tmenuLinks.forEach(function(item) {\n\t\t\t\t\t\tvar menuIcon = item.querySelector(\".menu-item-icon-box\");\n\t\t\t\t\t\tvar menuLinkText = item.querySelector(\".menu-item-link-text\");\n\t\t\t\t\t\tvar menuCounter = item.querySelector(\".menu-item-index\");\n\t\t\t\t\t\tvar menuArrow = item.querySelector('.menu-item-link-arrow');\n\n\t\t\t\t\t\tmenuLinkText.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t\tmenuLinkText.style.opacity = state.opacity / 100;\n\t\t\t\t\t\tmenuLinkText.style.display = \"inline-block\";\n\n\t\t\t\t\t\tmenuIcon.style.transform = \"translateX(\" + state.translateIcon + \"px)\";\n\t\t\t\t\t\tmenuIcon.style.opacity = state.opacityRevert / 100;\n\n\t\t\t\t\t\tif (menuArrow)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmenuArrow.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t\t\t// menuArrow.style.opacity = state.opacityRevert / 100;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (menuCounter)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmenuCounter.style.transform = \"translateX(\" + state.translateText + \"px)\";\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tvar event = document.createEvent(\"Event\");\n\t\t\t\tevent.initEvent(\"resize\", true, true);\n\t\t\t\twindow.dispatchEvent(event);\n\n\t\t\t}.bind(this),\n\t\t\tcomplete: function ()\n\t\t\t{\n\t\t\t\tif (isOpen)\n\t\t\t\t{\n\t\t\t\t\tthis.isCollapsedMode = true;\n\t\t\t\t\tBX.addClass(this.mainTable, \"menu-collapsed-mode\");\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.isCollapsedMode = false;\n\t\t\t\t\tBX.removeClass(this.mainTable, \"menu-collapsed-mode\");\n\t\t\t\t}\n\n\t\t\t\tBX.removeClass(\n\t\t\t\t\tthis.mainTable,\n\t\t\t\t\t\"menu-animation-mode menu-animation-opening-mode menu-animation-closing-mode\"\n\t\t\t\t);\n\n\t\t\t\tvar containers = [\n\t\t\t\t\tleftColumn,\n\t\t\t\t\tmenuTextDivider,\n\t\t\t\t\tthis.menuHeaderBurger,\n\t\t\t\t\tthis.headerBurger,\n\t\t\t\t\tsettingsIconBox,\n\t\t\t\t\tsettingsBtnText,\n\t\t\t\t\thelpIconBox,\n\t\t\t\t\thelpBtnText,\n\t\t\t\t\tmenuMoreBtnDefault,\n\t\t\t\t\tmenuMoreBtn,\n\t\t\t\t\tmenuSitemapIcon,\n\t\t\t\t\tmenuSitemapText,\n\t\t\t\t\tmenuEmployeesIcon,\n\t\t\t\t\tmenuEmployeesText,\n\t\t\t\t\tmenuMoreCounter,\n\t\t\t\t\tlicenseBtn,\n\t\t\t\t\tlicenseCollapsedBtn,\n\t\t\t\t\tthis.menuContainer,\n\t\t\t\t\tpageHeader,\n\t\t\t\t];\n\n\t\t\t\tcontainers.forEach(function(container) {\n\t\t\t\t\tif (container)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontainer.style.cssText = \"\";\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tmenuLinks.forEach(function(item) {\n\t\t\t\t\tvar menuIcon = item.querySelector(\".menu-item-icon-box\");\n\t\t\t\t\tvar menuLinkText = item.querySelector(\".menu-item-link-text\");\n\t\t\t\t\tvar menuCounter = item.querySelector(\".menu-item-index\");\n\t\t\t\t\tvar menuArrow = item.querySelector('.menu-item-link-arrow');\n\n\t\t\t\t\titem.style.cssText = \"\";\n\t\t\t\t\tmenuLinkText.style.cssText = \"\";\n\t\t\t\t\tmenuIcon.style.cssText = \"\";\n\n\t\t\t\t\tif (menuArrow)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuArrow.style.cssText = \"\";\n\t\t\t\t\t}\n\n\t\t\t\t\tif (menuCounter)\n\t\t\t\t\t{\n\t\t\t\t\t\tmenuCounter.style.cssText = \"\";\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis.releaseSliding();\n\n\t\t\t\tif (BX.type.isFunction(fn))\n\t\t\t\t{\n\t\t\t\t\tfn();\n\t\t\t\t}\n\n\t\t\t\tBackend.toggleMenu(isOpen);\n\n\t\t\t\tvar event = document.createEvent(\"Event\");\n\t\t\t\tevent.initEvent(\"resize\", true, true);\n\t\t\t\twindow.dispatchEvent(event);\n\n\t\t\t}.bind(this)\n\t\t})).animate();\n\t}\n\t//endregion\n\n\thandleViewMode()\n\t{\n\t\tthis.getItemsController().switchToViewMode();\n\t}\n\n\thandleGroupPanelOpen()\n\t{\n\t\tthis.isMenuMouseLeaveBlocked.push('group');\n\t}\n\n\thandleGroupPanelClose()\n\t{\n\t\tthis.isMenuMouseLeaveBlocked.pop();\n\t}\n\n\tshowUpButton()\n\t{\n\t\tthis.menuContainer.classList.add(\"menu-up-button-active\");\n\t}\n\n\thideUpButton()\n\t{\n\t\tthis.menuContainer.classList.remove(\"menu-up-button-active\");\n\t}\n\n\treverseUpButton()\n\t{\n\t\tthis.menuContainer.classList.add(\"menu-up-button-reverse\");\n\t}\n\n\tunreverseUpButton()\n\t{\n\t\tthis.menuContainer.classList.remove(\"menu-up-button-reverse\");\n\t}\n\n\tisUpButtonReversed()\n\t{\n\t\treturn this.menuContainer.classList.contains(\"menu-up-button-reverse\");\n\t}\n\n\tisDefaultTheme()\n\t{\n\t\treturn document.body.classList.contains(\"bitrix24-default-theme\");\n\t}\n\n\tgetTopPadding()\n\t{\n\t\treturn this.isDefaultTheme() ? 0 : 9;\n\t}\n\n\t// region Public functions\n\tinitPagetitleStar(): boolean\n\t{\n\t\treturn ItemUserFavorites.isCurrentPageStandard(\n\t\t\tItemUserFavorites.getActiveTopMenuItem()\n\t\t);\n\t}\n\n\tgetStructureForHelper()\n\t{\n\t\tconst items = {menu: {}};\n\t\t[\"show\", \"hide\"].forEach((state) => {\n\t\t\tArray.from(this.menuContainer\n\t\t\t\t.querySelectorAll(`[data-status=\"${state}\"][data-type=\"${ItemSystem.code}\"]`)\n\t\t\t)\n\t\t\t.forEach((node) => {\n\t\t\t\titems[state] = items[state] || [];\n\t\t\t\titems[state].push(node.getAttribute(\"data-id\"))\n\t\t\t});\n\t\t});\n\t\treturn items;\n\t}\n\n\tshowItemWarning({itemId, title, events})\n\t{\n\t\tif (this.getItemsController().items.has(itemId))\n\t\t{\n\t\t\tthis.getItemsController().items.get(itemId).showWarning(title, events);\n\t\t}\n\t}\n\n\tremoveItemWarning(itemId)\n\t{\n\t\tif (this.getItemsController().items.has(itemId))\n\t\t{\n\t\t\tthis.getItemsController().items.get(itemId).removeWarning();\n\t\t}\n\t}\n\n\t#specialLiveFeedDecrement = 0;\n\tdecrementCounter(node, iDecrement)\n\t{\n\t\tif (!node || node.id !== 'menu-counter-live-feed')\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.#specialLiveFeedDecrement += parseInt(iDecrement);\n\t\tthis.getItemsController().decrementCounter({\n\t\t\t'live-feed' : parseInt(iDecrement)\n\t\t});\n\t}\n\n\tupdateCounters(counters, send)\n\t{\n\t\tif (!counters)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif (counters['**'] !== undefined)\n\t\t{\n\t\t\tcounters['live-feed'] = counters['**'];\n\t\t\tdelete counters['**'];\n\t\t}\n\n\t\tif (counters['live-feed'])\n\t\t{\n\t\t\tif (counters['live-feed'] <= 0)\n\t\t\t{\n\t\t\t\tthis.#specialLiveFeedDecrement = 0;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcounters['live-feed'] -= this.#specialLiveFeedDecrement;\n\t\t\t}\n\t\t}\n\n\t\tthis.getItemsController().updateCounters(counters, send);\n\t}\n\t//endregion\n}\n"],"names":["Options","eventName","name","Type","isStringFilled","join","version","eventNameSpace","isExtranet","isAdmin","isCustomPresetRestricted","settingsPath","isMainPageEnabled","availablePresetTools","inviteDialogLink","showMarta","showSitemapMenuItem","DefaultController","constructor","container","events","Array","from","Object","keys","forEach","key","EventEmitter","subscribe","getContainer","createPopup","getPopup","show","arguments","emit","hide","close","PresetCustomController","isReady","form","Tag","render","Loc","getMessage","PopupManager","create","overlay","contentColor","contentNoPaddings","lightShadow","draggable","restrict","closeByEsc","titleBar","offsetTop","offsetLeft","cacheable","closeIcon","content","buttons","SaveButton","onclick","button","setWaiting","elements","userScope","value","promise","then","catch","console","log","CancelButton","Utils","getCurPage","document","location","pathname","search","getCurUri","Uri","href","catchError","response","Runtime","loadExtension","notificationCenter","Reflection","getClass","notify","errors","message","position","category","autoHideDelay","refineUrl","originUrl","url","String","trim","test","link","createElement","host","hash","PresetDefaultController","mode","querySelector","cloneNode","toString","onFirstShow","querySelectorAll","node","addEventListener","otherNode","classList","CreateButton","text","isWaiting","currentPreset","getSelectedPreset","showUnavailableToolPopup","presetId","data","hasOwnProperty","reload","getMode","forms","checked","MessageBox","MessageBoxButtons","OK","SettingsController","menuId","menu","Menu","bindElement","targetContainer","items","getItems","angle","getPopupWindow","notHandledMenuItems","isArray","map","item","isPlainObject","html","className","delimiter","undefined","event","isArrayFilled","getMenuWindow","getParentMenuItem","Backend","toggleMenu","collapse","siteDir","context","window","startsWith","ajax","runAction","analyticsLabel","leftmenu","action","saveSelfItemMenu","itemData","id","deleteSelfITem","menuItemId","addFavoritesItemMenu","deleteFavoritesItemMenu","updateFavoritesItemMenu","itemText","itemId","addAdminSharedItemMenu","itemInfo","deleteAdminSharedItemMenu","menu_item_id","saveItemsSort","menuItems","firstItemLink","setFirstPage","firstPageLink","firstPageUrl","setDefaultPreset","setCustomPreset","forNewUsersOnly","itemsSort","customItems","userApply","deleteCustomItem","setSystemPreset","preset","analyticsFirst","postponeSystemPreset","clearCache","expandGroup","collapseGroup","Item","parentContainer","links","isDraggable","storage","init","onDeleteAsFavorites","bind","setTimeout","GLOBAL_TARGET","incrementMaxListeners","destroy","showError","showMessage","getId","dataset","getCode","code","getName","textContent","canDelete","delete","hasAttribute","getAttribute","push","split","makeTextIcons","update","openInNewPage","setAttribute","Text","encode","linkNode","isString","innerHTML","unsubscribe","decrementMaxListeners","getSimilarToUrl","currentUri","result","index","areUrlsEqual","priority","contains","icon","getShortName","getCounterValue","parseInt","counterValue","updateCounter","oldValue","add","remove","warning","BX","style","display","newValue","markAsActive","error","showWarning","title","removeWarning","Event","appendChild","parentNode","removeChild","showMessagePopup","darkMode","onClose","autoHide","TypeError","getDropDownActions","getEditFields","animate","filter","v","detect","createNode","counterId","topMenuId","backendSaveItem","showUpdate","Promise","resolve","reject","showForm","checkForm","length","focus","popup","isEditMode","indexOf","itemInfoToSave","checkedUri","checkedUrlBrief","getPath","replace","currentUrlBrief","getHost","shortName","words","substring","firstWord","secondWord","i","toUpperCase","ItemUserFavorites","onCustomEvent","isActive","contextMenuItems","itemLinkNode","type","ItemAdminShared","getActiveTopMenuItem","Main","interfaceButtonsManager","firstTopMenuInstance","values","getObjects","shift","topMenuItem","getActive","path","ID","NODE","URL","TEXT","DATA_ID","COUNTER_ID","COUNTER","SUB_LINK","isCurrentPageStandard","topMenuPoint","currentFullPath","saveCurrentPage","pageTitle","pageLink","startX","startY","menuNodeCoord","getBoundingClientRect","left","top","isStandardItem","subLink","getElementById","innerText","titleCoord","animateFromPoint","deleteCurrentPage","topPoint","animateToPoint","saveStandardPage","pos","deleteStandardPage","ItemUserSelf","confirm","messageBox","showAdd","resolve1","reject2","deletePerm","codeToConvert","ItemAdminCustom","actions","ItemMainPage","openSettings","SidePanel","Instance","open","ItemSystem","ItemGroup","toggleAndSave","Dom","removeClass","groupContainer","preventDefault","stopPropagation","expand","checkAndCorrect","insertAfter","hideGroupContainer","stop","overflow","addClass","slideParams","height","offsetHeight","easing","duration","start","opacity","finish","transition","makeEaseOut","transitions","quart","step","state","complete","checkAttribute","contentHeight","toNumber","markAsInactive","removeAttribute","ItemGroupSystem","itemMappings","getItem","itemClassName","itemClass","ItemActive","checkAndSet","theMostOfTheLinks","linkUri","changeActiveItem","uri","actualParams","getQueryParams","theMostOfTheLinkServiceData","params","matches","comparedLinkParams","unhighlight","highlight","checkAndUnset","parent","closest","ItemsController","Map","hiddenContainer","registerItem","toggleHiddenContainer","getActiveItem","set","parentItem","deleteItem","convertItem","openItemMenu","target","currentTarget","unregisterItem","has","unsubscribeAll","replaceChild","switchToEditMode","switchToViewMode","isHiddenContainerVisible","setItemAsAMainPage","startTop","dragElement","attrs","insertBeforeElement","nextElementSibling","insertBefore","nextSibling","showItem","oldParent","hideItem","emitEvent","updateCounters","counters","send","countersDynamic","entries","localStorage","hiddenCounterNode","Math","max","Number","BXIM","res","counterNode","visibleValue","DesktopApi","isDesktop","setBrowserIconBadge","itemGroup","decrementCounter","addItem","Element","styleValue","styleDisplay","get","updateItem","export","contextMenuItem","actionItem","call","targetPosition","getPosition","right","width","onShow","scrollHeight","opening","hiddenBlock","maxHeight","linear","hiddenCounterValue","newParent","saveSortItems","currentGroupId","chain","role","groupId","groupItem","pop","group_id","LINK","decode","NEW_PAGE","topMenuNode","body","finishY","paddingLeft","jsDD","Enable","onbxdragstart","onbxdrag","x","y","onbxdraghover","dest","onbxdragstop","registerObject","dnd","itemDomBlank","itemMoveBlank","draggableBlock","registerItems","registerDest","firstNode","unregisterDest","menuItemsBlockHeight","min","groupHolder","prepend","itemPlaceHolder","onHiddenBlockIsEmptyEmitted","e","enableDest","refreshDestArea","ItemDirector","page","topItem","showAddToSelf","Analytics","AnalyticUserRole","ADMIN","NOT_ADMIN","sendSetCustomPreset","sendData","tool","AnalyticTool","AnalyticCategory","MENU","AnalyticEvent","SET","c_section","AnalyticSection","p1","sendSetPreset","isPersonal","CHANGE","SELECT","TOOL","POPUP","c_element","sendClose","SHOW","PRESET","QUALIFICATION","SETTINGS","AnalyticActions","CONFIRM","LATER","CLOSE","SAVE","SKIP","GroupPanel","options","MemoryCache","groupsLink","isBoolean","isExtranetInstalled","remember","getFilterContainer","getItemsContainer","getCounterContainer","saveFilter","Ajax","contentCallback","exports","Layout","createContent","design","section","margin","abort","onrequeststart","xhr","groups","group","classes","extranet","favorite","dom","encodeURI","append","attr","filterElement","currentFilter","newFilter","hasClass","star","toggleClass","flyingStar","offsetWidth","scale","positive","cache","Cache","scrollModeThreshold","lastScrollOffset","slidingModeTimeoutId","isMenuMouseEnterBlocked","isMenuMouseLeaveBlocked","isCollapsedMode","menuContainer","isCustomPresetAvailable","analytics","initAndBindNodes","bindEvents","getItemsController","groupPanel","handleMenuDoubleClick","handleMenuMouseEnter","handleMenuMouseLeave","handleSlidingTransitionEnd","menuHeader","menuBody","menuItemsBlock","mainTable","menuHeaderBurger","handleBurgerClick","menuMoreButton","handleShowHiddenClick","siteMapItem","handleSiteMapClick","settingsSaveBtn","handleViewMode","getSettingsController","EditMode","toggle","ViewMode","onDragModeOn","switchToSlidingMode","onDragModeOff","onHiddenBlockIsVisible","onHiddenBlockIsHidden","onHiddenBlockIsEmpty","onHiddenBlockIsNotEmpty","getItemDirector","onItemHasBeenAdded","onGettingSettingMenuItems","getCustomPresetController","onPresetIsSet","getDefaultPresetController","closeEventWasProcessed","postponeHandler","presetController","onPresetIsPostponed","getCompatData","counter","decrement","command","addCustomEvent","handleGroupPanelOpen","handleGroupPanelClose","isDomNode","leftMenuNode","leftMenuLink","previousElementSibling","contextMenu","dataItem","topMenu","match","addMenuItem","currentPageInMenu","compatData","promises","p","fulfill","isCollapsed","onDestroy","showGlobalPreset","BannerDispatcher","high","toQueue","onDone","setDefaultMenu","onYes","YES_CANCEL","clearCompositeCache","menuItemWithAddingToFavorites","leftMenuSettingItems","UI","InfoHelper","Messenger","allowChangeHistory","handleHelperClick","customLeftBoundary","Helper","blockSliding","stopSliding","releaseSliding","clearTimeout","startSliding","handleUpButtonClick","isUpButtonReversed","scrollTo","unreverseUpButton","pageYOffset","reverseUpButton","handleUpButtonMouseLeave","handleDocumentScroll","documentElement","clientHeight","showUpButton","hideUpButton","pageXOffset","upButton","removeProperty","enable","immediately","switchToScrollMode","flag","fn","leftColumn","isOpen","menuLinks","slice","menuMoreBtn","menuMoreBtnDefault","menuSitemapIcon","menuSitemapText","menuEmployeesText","menuEmployeesIcon","licenseContainer","licenseBtn","licenseHeight","licenseCollapsedBtn","settingsIconBox","settingsBtnText","helpIconBox","helpBtnText","menuTextDivider","menuMoreCounter","pageHeader","imBar","imBarWidth","expandedMenuWidth","getComputedStyle","getPropertyValue","collapsedMenuWidth","sidebarWidth","burgerMenuWidth","maxWidth","transform","translateIcon","opacityRevert","translateText","translateMoreBtn","translateLicenseBtn","heightLicenseBtn","menuIcon","menuLinkText","menuCounter","menuArrow","createEvent","initEvent","dispatchEvent","containers","headerBurger","cssText","isFunction","isDefaultTheme","getTopPadding","initPagetitleStar","getStructureForHelper","showItemWarning","removeItemWarning","iDecrement"],"mappings":"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"}