{"version":3,"file":"invitation-widget.bundle.js","sources":["../src/analytics.js","../src/contents/content.js","../src/contents/invitation.js","../src/contents/structure.js","../src/contents/employees.js","../src/contents/extranet.js","../src/contents/collab.js","../src/contents/user-online.js","../src/popup.js","../src/invitation-widget.js"],"sourcesContent":["import { sendData } from 'ui.analytics';\n\nexport class Analytics\n{\n\tstatic TOOLS = 'headerPopup';\n\tstatic TOOLS_LEGACY = 'Invitation';\n\tstatic CATEGORY_INVITATION = 'invitation';\n\tstatic CATEGORY_INVITATION_LEGACY = 'invitation';\n\tstatic EVENT_NAME_LEGACY = 'drawer_open';\n\tstatic SECTION_POPUP = 'headerPopup';\n\tstatic EVENT_SHOW = 'show';\n\tstatic EVENT_OPEN_SLIDER_INVITATION = 'drawer_open';\n\tstatic EVENT_OPEN_STRUCTURE = 'vis_structure_open';\n\tstatic EVENT_OPEN_USER_LIST = 'company_open';\n\tstatic EVENT_OPEN_SLIDER_EXTRANET_INVITATION = 'extranetinvitation_open';\n\tstatic isAdmin: boolean = false;\n\n\tstatic send(event: string): void\n\t{\n\t\tsendData({\n\t\t\ttool: Analytics.TOOLS,\n\t\t\tcategory: Analytics.CATEGORY_INVITATION,\n\t\t\tevent: event,\n\t\t\tp1: Analytics.isAdmin ? 'isAdmin_Y' : 'isAdmin_N',\n\t\t});\n\t}\n\n\tstatic sendCreateCollab(): void\n\t{\n\t\tsendData({\n\t\t\ttool: 'im',\n\t\t\tcategory: 'collab',\n\t\t\tevent: 'click_create_new',\n\t\t\tc_section: Analytics.SECTION_POPUP,\n\t\t\tp2: 'user_intranet', // widget is available only for intranet users\n\t\t});\n\t}\n}\n","import { BaseEvent, EventEmitter } from 'main.core.events';\nimport { ajax, Cache, Text } from 'main.core';\nimport { ConfigContent } from '../types/content';\nimport { Popup } from 'main.popup';\nimport { Analytics } from '../analytics';\n\nexport class Content extends EventEmitter\n{\n\tcache = new Cache.MemoryCache();\n\n\tconstructor(options: Object)\n\t{\n\t\tsuper();\n\t\tthis.setOptions(options);\n\t\tthis.analytics = new Analytics();\n\t}\n\n\tsetOptions(options: Object): void\n\t{\n\t\tthis.cache.set('options', { ...options });\n\t}\n\n\tgetOptions(): Object\n\t{\n\t\treturn this.cache.get('options', {});\n\t}\n\n\tgetLayout(): HTMLElement\n\t{\n\t\tthrow new Error('Must be implemented in a child class');\n\t}\n\n\tshowInfoHelper(articleCode: string): void\n\t{\n\t\tBX.UI.InfoHelper.show(articleCode);\n\t\tthis.sendAnalytics(articleCode);\n\t}\n\n\tsendAnalytics(code: string): void\n\t{\n\t\tajax.runAction('intranet.invitationwidget.analyticsLabel', {\n\t\t\tdata: {},\n\t\t\tanalyticsLabel: {\n\t\t\t\thelperCode: code,\n\t\t\t\theaderPopup: 'Y'\n\t\t\t}\n\t\t});\n\t}\n\n\tgetHintPopup(text: string, element: HTMLElement, type: string): Popup\n\t{\n\t\treturn this.cache.remember(type, () => {\n\t\t\treturn new Popup(`bx-hint-${Text.getRandom()}`, element, {\n\t\t\t\tcontent: text,\n\t\t\t\tclassName: 'bx-invitation-warning',\n\t\t\t\tzIndex: 15000,\n\t\t\t\tangle: true,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toffsetLeft: 40,\n\t\t\t\tcloseIcon: false,\n\t\t\t\tautoHide: true,\n\t\t\t\tdarkMode: true,\n\t\t\t\toverlay: false,\n\t\t\t\tmaxWidth: 300,\n\t\t\t\tevents: {\n\t\t\t\t\tonShow: (event) => {\n\t\t\t\t\t\tEventEmitter.emit(EventEmitter.GLOBAL_TARGET, 'BX.Intranet.InvitationWidget.HintPopup:show', new BaseEvent({\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\tpopup: event.target,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}));\n\t\t\t\t\t\tconst timeout = setTimeout(() => {\n\t\t\t\t\t\t\tevent.target.close();\n\t\t\t\t\t\t}, 4000)\n\t\t\t\t\t\tEventEmitter.subscribeOnce(EventEmitter.GLOBAL_TARGET, 'BX.Intranet.InvitationWidget.HintPopup:close', () => {\n\t\t\t\t\t\t\tclearTimeout(timeout);\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\tEventEmitter.emit(EventEmitter.GLOBAL_TARGET, 'BX.Intranet.InvitationWidget.HintPopup:close');\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tshowHintPopup(text: string, element: HTMLElement, type: string): void\n\t{\n\t\tthis.getHintPopup(text, element, type).toggle();\n\t}\n\n\tshowInvitationPlace(text: string, element: HTMLElement, type: string): void\n\t{\n\t\tif (this.getOptions().isInvitationAvailable)\n\t\t{\n\t\t\tthis.showInvitationSlider(type);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showHintPopup(text, element, 'hint-' + type);\n\t\t}\n\t}\n\n\tshowInvitationSlider(type: string): void\n\t{\n\t\tlet link = this.getOptions().invitationLink;\n\n\t\tif (type === 'extranet')\n\t\t{\n\t\t\tlink = `${link}&firstInvitationBlock=extranet`;\n\t\t\tAnalytics.send(Analytics.EVENT_OPEN_SLIDER_EXTRANET_INVITATION);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tAnalytics.send(Analytics.EVENT_OPEN_SLIDER_INVITATION);\n\t\t}\n\n\t\tBX.SidePanel.Instance.open(\n\t\t\tlink,\n\t\t\t{ cacheable: false, allowChangeHistory: false, width: 1100 }\n\t\t);\n\t}\n\n\tgetConfig(): ConfigContent\n\t{\n\t\treturn {\n\t\t\thtml: this.getLayout(),\n\t\t}\n\t}\n}\n","import { Content } from \"./content\";\nimport { Tag, Loc } from \"main.core\";\nimport type { InvitationContentOptions } from \"../types/options\";\nimport type { ConfigContent } from \"../types/content\";\n\nexport class InvitationContent extends Content\n{\n\tconstructor(options: InvitationContentOptions) {\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Intranet.InvitationWidget.InvitationContent');\n\t\tthis.setOptions(options);\n\t}\n\n\tgetConfig(): ConfigContent\n\t{\n\t\treturn {\n\t\t\thtml: this.getLayout(),\n\t\t\tbackgroundColor: '#14bfd5',\n\t\t};\n\t}\n\n\tgetLayout(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\tconst showInvitationSlider = (e) => {\n\t\t\t\te.stopPropagation();\n\t\t\t\tthis.showInvitationPlace(\n\t\t\t\t\tLoc.getMessage('INTRANET_INVITATION_WIDGET_DISABLED_TEXT_MSGVER_1'),\n\t\t\t\t\te.target,\n\t\t\t\t\t'default-invitation'\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tconst showInvitationHelper = () => {\n\t\t\t\tthis.showInfoHelper('limit_why_team_invites');\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div data-id=\"bx-invitation-widget-content-invitation\" class=\"intranet-invitation-widget-invite\">\n\t\t\t\t\t<div class=\"intranet-invitation-widget-invite-main\">\n\t\t\t\t\t\t<div class=\"intranet-invitation-widget-inner\">\n\t\t\t\t\t\t\t<div class=\"intranet-invitation-widget-content\">\n\t\t\t\t\t\t\t\t<div class=\"intranet-invitation-widget-item-icon intranet-invitation-widget-item-icon--invite\"></div>\n\t\t\t\t\t\t\t\t<div class=\"intranet-invitation-widget-item-content\">\n\t\t\t\t\t\t\t\t\t<div class=\"intranet-invitation-widget-item-name\">\n\t\t\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_INVITATION_WIDGET_INVITE_EMPLOYEE')}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"intranet-invitation-widget-item-link\">\n\t\t\t\t\t\t\t\t\t\t<span onclick=\"${showInvitationHelper}\" class=\"intranet-invitation-widget-item-link-text\">\n\t\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_INVITATION_WIDGET_DESC')}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<a onclick=\"${showInvitationSlider}\" class=\"intranet-invitation-widget-item-btn intranet-invitation-widget-item-btn--invite\"> \n\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_INVITATION_WIDGET_INVITE')}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n}\n","import { Content } from './content';\nimport { Counter } from 'ui.cnt';\nimport { Tag, Loc, Type, Dom } from 'main.core';\nimport { Analytics } from '../analytics';\nimport type { StructureContentOptions } from '../types/options';\nimport type { ConfigContent } from '../types/content';\nimport { EventEmitter } from 'main.core.events';\n\nexport class StructureContent extends Content\n{\n\tconstructor(options: StructureContentOptions) {\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Intranet.InvitationWidget.StructureContent');\n\t}\n\n\tgetConfig(): ConfigContent\n\t{\n\t\tthis.#showCounter();\n\n\t\tif (this.getOptions().shouldShowStructureCounter)\n\t\t{\n\t\t\tEventEmitter.subscribeOnce('HR.company-structure:first-popup-showed', this.#onFirstWatchNewStructure.bind(this));\n\t\t}\n\n\t\treturn {\n\t\t\thtml: this.getLayout(),\n\t\t\tflex: 3,\n\t\t};\n\t}\n\n\tgetLayout(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\tconst onclick = () => {\n\t\t\t\tAnalytics.send(Analytics.EVENT_OPEN_STRUCTURE);\n\t\t\t};\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div data-id=\"bx-invitation-widget-content-structure\" class=\"intranet-invitation-widget-item intranet-invitation-widget-item--company intranet-invitation-widget-item--active\">\n\t\t\t\t\t<div class=\"intranet-invitation-widget-item-logo\"></div>\n\t\t\t\t\t<div class=\"intranet-invitation-widget-item-content\">\n\t\t\t\t\t\t<div class=\"intranet-invitation-widget-item-name\">\n\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_INVITATION_WIDGET_STRUCTURE')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<a onclick=\"${onclick}\" href=\"${this.getOptions().structureLink}\" class=\"intranet-invitation-widget-item-btn\"> \n\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_INVITATION_WIDGET_EDIT')}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getCounterWrapper(): HTMLElement\n\t{\n\t\treturn this.cache.remember('counter-wrapper', () => {\n\t\t\treturn this.getLayout().querySelector('.intranet-invitation-widget-item-name');\n\t\t});\n\t}\n\n\t#showCounter(): void\n\t{\n\t\tif (this.#getCounterValue() > 0)\n\t\t{\n\t\t\tDom.addClass(this.#getCounter().getContainer(), 'invitation-structure-counter');\n\t\t\tthis.#getCounter().renderTo(this.#getCounterWrapper());\n\t\t}\n\t}\n\n\t#getCounter(): Counter\n\t{\n\t\treturn this.cache.remember('counter', () => {\n\t\t\treturn new Counter({\n\t\t\t\tvalue: this.#getCounterValue(),\n\t\t\t\tcolor: Counter.Color.DANGER,\n\t\t\t});\n\t\t});\n\t}\n\n\t#getCounterValue(): number\n\t{\n\t\treturn (this.getOptions().shouldShowStructureCounter) ? 1 : 0;\n\t}\n\n\t#onFirstWatchNewStructure(): void\n\t{\n\t\tconst value = this.#getCounter().value;\n\t\tif (!Type.isNumber(value))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.getOptions().shouldShowStructureCounter)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.getOptions().shouldShowStructureCounter = false;\n\t\tthis.#getCounter().destroy();\n\t\tthis.cache.delete('counter');\n\t}\n}\n","import { Counter } from 'ui.cnt';\nimport { Content } from \"./content\";\nimport { Analytics } from '../analytics';\nimport { Tag, Loc, ajax, Text, Type } from 'main.core';\nimport type { EmployeesContentOptions } from \"../types/options\";\nimport type { ConfigContent } from \"../types/content\";\nimport { Menu } from \"main.popup\";\nimport { EventEmitter, BaseEvent } from 'main.core.events';\n\nexport class EmployeesContent extends Content\n{\n\t#rightType: string;\n\n\tconstructor(options: EmployeesContentOptions) {\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Intranet.InvitationWidget.EmployeesContent');\n\t\tthis.#showCounter();\n\t}\n\n\tgetConfig(): ConfigContent\n\t{\n\t\treturn {\n\t\t\thtml: this.getLayout(),\n\t\t\tflex: 5,\n\t\t\tsizeLoader: 55,\n\t\t};\n\t}\n\n\tgetLayout(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div data-id=\"bx-invitation-widget-content-employees\" class=\"intranet-invitation-widget-item intranet-invitation-widget-item--emp ${this.getOptions().isLimit ? 'intranet-invitation-widget-item--emp-alert' : null}\">\n\t\t\t\t\t<div class=\"intranet-invitation-widget-inner\">\n\t\t\t\t\t\t<div class=\"intranet-invitation-widget-content\">\n\t\t\t\t\t\t\t<div class=\"intranet-invitation-widget-item-content\">\n\t\t\t\t\t\t\t\t<div onclick=\"${this.showUserList()}\" class=\"intranet-invitation-widget-item-progress ${this.getOptions().isLimit ? 'intranet-invitation-widget-item-progress--crit' : 'intranet-invitation-widget-item-progress--full'}\"/>\n\t\t\t\t\t\t\t\t<div class=\"intranet-invitation-widget-employees\">\n\t\t\t\t\t\t\t\t\t<div onclick=\"${this.showUserList()}\" class=\"intranet-invitation-widget-item-name\">\n\t\t\t\t\t\t\t\t\t\t<span style=\"margin-right: 2px;\">\n\t\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_INVITATION_WIDGET_EMPLOYEES')}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div onclick=\"${this.showUserList()}\" class=\"intranet-invitation-widget-item-num\">\n\t\t\t\t\t\t\t\t\t\t${this.getOptions().users.currentUserCountMessage}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t${this.getDetail()}\n\t\t\t\t\t\t\t${this.getOptions().isAdmin ? this.getSelectorRights() : null}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#showCounter(): void\n\t{\n\t\tif (this.getOptions().invitationCounter > 0)\n\t\t{\n\t\t\tthis.#getCounter().renderTo(this.#getCounterWrapper());\n\t\t}\n\n\t\tBX.addCustomEvent('onPullEvent-main', this.#onReceiveCounterValue.bind(this));\n\t}\n\n\t#onReceiveCounterValue(command, params): void\n\t{\n\t\tif (command === 'user_counter' && params[BX.message('SITE_ID')])\n\t\t{\n\t\t\tconst counters = BX.clone(params[BX.message('SITE_ID')]);\n\t\t\tconst value = counters[this.getOptions().counterId];\n\n\t\t\tif (!Type.isNumber(value))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.#getCounter().update(value);\n\t\t\tthis.getOptions().invitationCounter = value;\n\n\t\t\tif (value > 0)\n\t\t\t{\n\t\t\t\tthis.#getCounter().renderTo(this.#getCounterWrapper());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#getCounter().destroy();\n\t\t\t\tthis.cache.delete('counter');\n\t\t\t}\n\t\t}\n\t}\n\n\t#getCounter(): Counter\n\t{\n\t\treturn this.cache.remember('counter', () => {\n\t\t\treturn new Counter({\n\t\t\t\tvalue: Number(this.getOptions().invitationCounter),\n\t\t\t\tcolor: Counter.Color.DANGER,\n\t\t\t});\n\t\t});\n\t}\n\n\t#getCounterWrapper(): HTMLElement\n\t{\n\t\treturn this.cache.remember('counter-wrapper', () => {\n\t\t\treturn this.getLayout().querySelector('.intranet-invitation-widget-item-name');\n\t\t});\n\t}\n\n\tgetDetail(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('detail', () => {\n\t\t\tlet content = '';\n\n\t\t\tif (Number(this.getOptions().users.maxUserCount) === 0)\n\t\t\t{\n\t\t\t\tcontent = Loc.getMessage('INTRANET_INVITATION_WIDGET_EMPLOYEES_NO_LIMIT');\n\t\t\t}\n\t\t\telse if (this.getOptions().isLimit)\n\t\t\t{\n\t\t\t\tcontent = Loc.getMessage('INTRANET_INVITATION_WIDGET_EMPLOYEES_LIMIT');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcontent = this.getOptions().users.leftCountMessage;\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div onclick=\"${this.showUserList()}\" class=\"intranet-invitation-widget-item-detail\">\n\t\t\t\t\t<span class=\"intranet-invitation-widget-item-link-text\">\n\t\t\t\t\t\t${content}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tshowUserList(): Function\n\t{\n\t\treturn this.cache.remember('showUserList', () => {\n\t\t\treturn () => {\n\t\t\t\tAnalytics.send(Analytics.EVENT_OPEN_USER_LIST);\n\t\t\t\tdocument.location.href = '/company/';\n\t\t\t};\n\t\t});\n\t}\n\n\tgetSelectorRights(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('selector-rights', () => {\n\t\t\tconst showMenu = (e) => {\n\t\t\t\te.stopPropagation();\n\t\t\t\tthis.getRightsMenu(e.target).toggle();\n\t\t\t}\n\n\t\t\tconst button = Tag.render`\n\t\t\t\t<div onclick=\"${showMenu}\" class=\"intranet-invitation-widget-item-menu\"></div>\n\t\t\t`;\n\n\t\t\tthis.subscribe('right-selected', (event) => {\n\t\t\t\tconst menu = this.getRightsMenu(button);\n\t\t\t\tmenu.close();\n\t\t\t\tmenu.destroy();\n\t\t\t\tif (event.data.type)\n\t\t\t\t{\n\t\t\t\t\tthis.cache.delete('menu-rights');\n\t\t\t\t\tthis.#rightType = event.data.type;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn button;\n\t\t});\n\t}\n\n\tgetRightsMenu(element: HTMLElement): Menu\n\t{\n\t\treturn this.cache.remember('menu-rights', () => {\n\t\t\treturn new Menu(`menu-rights-${Text.getRandom()}`, element, this.getMenuRightsItems(), {\n\t\t\t\tautoHide: true,\n\t\t\t\toffsetLeft: 10,\n\t\t\t\toffsetTop: 0,\n\t\t\t\tangle: true,\n\t\t\t\tclassName: 'license-right-popup-men',\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupShow: (popup) => {\n\t\t\t\t\t\tEventEmitter.emit(\n\t\t\t\t\t\t\tEventEmitter.GLOBAL_TARGET,\n\t\t\t\t\t\t\tthis.getEventNamespace() + ':showRightMenu',\n\t\t\t\t\t\t\tnew BaseEvent({\n\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\tpopup: popup,\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t\tonPopupClose: (popup) => {\n\t\t\t\t\t\tEventEmitter.emit(\n\t\t\t\t\t\t\tEventEmitter.GLOBAL_TARGET,\n\t\t\t\t\t\t\tthis.getEventNamespace() + ':closeRightMenu',\n\t\t\t\t\t\t\tnew BaseEvent({\n\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\tpopup: popup,\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t\tonPopupFirstShow: (popup) => {\n\t\t\t\t\t\tEventEmitter.subscribe(EventEmitter.GLOBAL_TARGET, 'SidePanel.Slider:onOpenStart', () => {\n\t\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tgetMenuRightsItems(): Array\n\t{\n\t\tif (!this.#rightType)\n\t\t{\n\t\t\tthis.#rightType = this.getOptions().users.rightType;\n\t\t}\n\n\t\treturn [\n\t\t\t{\n\t\t\t\ttext: Loc.getMessage('INTRANET_INVITATION_WIDGET_SETTING_ALL_INVITE'),\n\t\t\t\tclassName: this.#rightType === 'all' ? 'menu-popup-item-accept' : '',\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.saveInvitationRightSetting('all').then(() => {\n\t\t\t\t\t\tthis.emit('right-selected', new BaseEvent({\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\ttype: 'all'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}));\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\ttext: Loc.getMessage('INTRANET_INVITATION_WIDGET_SETTING_ADMIN_INVITE'),\n\t\t\t\tclassName: this.#rightType === 'admin' ? 'menu-popup-item-accept' : '',\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.saveInvitationRightSetting('admin').then(() => {\n\t\t\t\t\t\tthis.emit('right-selected', new BaseEvent({\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\ttype: 'admin'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}));\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t}\n\n\tsaveInvitationRightSetting(type): Promise\n\t{\n\t\treturn ajax.runAction(\"intranet.invitationwidget.saveInvitationRight\", {\n\t\t\tdata: {\n\t\t\t\ttype: type\n\t\t\t}\n\t\t});\n\t}\n\n}\n","import { Content } from \"./content\";\nimport { Tag, Loc } from \"main.core\";\nimport type { ConfigContent } from \"../types/content\";\nimport type { ExtranetContentOptions } from \"../types/options\";\n\nexport class ExtranetContent extends Content\n{\n\tarticleCode: string = \"6770709\";\n\n\tconstructor(options: ExtranetContentOptions) {\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Intranet.InvitationWidget.ExtranetContent');\n\t}\n\n\tgetConfig(): ConfigContent\n\t{\n\t\treturn {\n\t\t\thtml: this.getLayout(),\n\t\t\tminHeight: '55px',\n\t\t\tsizeLoader: 37,\n\t\t\tmarginBottom: 24,\n\t\t\tsecondary: true,\n\t\t};\n\t}\n\n\tgetLayout(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\tconst showInvitationSlider = (e) => {\n\t\t\t\te.stopPropagation();\n\t\t\t\tthis.showInvitationPlace(\n\t\t\t\t\tLoc.getMessage('INTRANET_INVITATION_WIDGET_DISABLED_TEXT_MSGVER_1'),\n\t\t\t\t\te.target,\n\t\t\t\t\t'extranet'\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tconst showExtranetHelper = () => {\n\t\t\t\tBX.Helper.show(`redirect=detail&code=${this.articleCode}`);\n\t\t\t\tthis.sendAnalytics(this.articleCode);\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div data-id=\"bx-invitation-widget-content-extranet\" class=\"${this.getWrapperClass()}\">\n\t\t\t\t\t<div class=\"intranet-invitation-widget-content\">\n\t\t\t\t\t\t<div class=\"intranet-invitation-widget-item-icon intranet-invitation-widget-item-icon--ext\"></div>\n\t\t\t\t\t\t<div class=\"intranet-invitation-widget-item-content\">\n\t\t\t\t\t\t\t<div class=\"intranet-invitation-widget-item-name\">\n\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_INVITATION_WIDGET_EXTRANET')}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"intranet-invitation-widget-item-link\">\n\t\t\t\t\t\t\t\t<span onclick=\"${showExtranetHelper}\" class=\"intranet-invitation-widget-item-link-text\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_INVITATION_WIDGET_EXTRANET_DESC')}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t${this.getCountUserMessage()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button onclick=\"${showInvitationSlider}\" class=\"intranet-invitation-widget-item-btn\">\n\t\t\t\t\t\t${Loc.getMessage('INTRANET_INVITATION_WIDGET_INVITE')}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetWrapperClass(): string\n\t{\n\t\treturn this.cache.remember('wrapper-class', () => {\n\t\t\tconst baseClass = 'intranet-invitation-widget-item intranet-invitation-widget-item--wide';\n\n\t\t\tif (this.getOptions().currentExtranetUserCount > 0)\n\t\t\t{\n\t\t\t\treturn baseClass + ' intranet-invitation-widget-item--active';\n\t\t\t}\n\n\t\t\treturn baseClass;\n\t\t});\n\t}\n\n\tgetCountUserMessage(): ?HTMLDivElement\n\t{\n\t\treturn this.cache.remember('count-user-message', () => {\n\t\t\tif (this.getOptions().currentExtranetUserCount > 0)\n\t\t\t{\n\t\t\t\treturn Tag.render`\n\t\t\t\t\t<div class=\"intranet-invitation-widget-item-ext-users\">\n\t\t\t\t\t\t${this.getOptions().currentExtranetUserCountMessage}\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t}\n\n\t\t\treturn null;\n\t\t});\n\t}\n}\n","import { Content } from './content';\nimport { Tag, Loc } from 'main.core';\nimport type { ConfigContent } from '../types/content';\nimport type { CollabContentOptions } from '../types/options';\nimport { Analytics } from '../analytics';\n\nexport class CollabContent extends Content\n{\n\tarticleCode: string = '22706764';\n\t#openChat: ?func;\n\n\tconstructor(options: CollabContentOptions) {\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Intranet.InvitationWidget.CollabContent');\n\t}\n\n\tgetConfig(): ConfigContent\n\t{\n\t\treturn {\n\t\t\thtml: this.getOptions().awaitData.then((response) => {\n\t\t\t\tconst { Messenger, CreatableChat } = response;\n\t\t\t\tthis.#openChat = () => {\n\t\t\t\t\tMessenger.openChatCreation(CreatableChat.collab);\n\t\t\t\t\tAnalytics.sendCreateCollab();\n\t\t\t\t};\n\n\t\t\t\treturn this.getLayout();\n\t\t\t}),\n\t\t\tminHeight: '55px',\n\t\t\tsizeLoader: 37,\n\t\t\tmarginBottom: 24,\n\t\t\tsecondary: true,\n\t\t};\n\t}\n\n\tgetLayout(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\tconst showInvitationSlider = (e) => {\n\t\t\t\tthis.#openChat();\n\t\t\t\te.stopPropagation();\n\t\t\t};\n\n\t\t\tconst showCollabHelper = () => {\n\t\t\t\tBX.Helper.show(`redirect=detail&code=${this.articleCode}`);\n\t\t\t\tthis.sendAnalytics(this.articleCode);\n\t\t\t};\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div data-id=\"bx-invitation-widget-content-collab\" class=\"${this.getWrapperClass()}\">\n\t\t\t\t\t<div class=\"intranet-invitation-widget-content\">\n\t\t\t\t\t\t<div class=\"intranet-invitation-widget-item-icon intranet-invitation-widget-item-icon--collab\">\n\t\t\t\t\t\t\t<div class=\"ui-icon-set --collab\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"intranet-invitation-widget-item-content\">\n\t\t\t\t\t\t\t<div class=\"intranet-invitation-widget-item-name\">\n\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_INVITATION_WIDGET_COLLAB')}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"intranet-invitation-widget-item-link\">\n\t\t\t\t\t\t\t\t<span onclick=\"${showCollabHelper}\" class=\"intranet-invitation-widget-item-link-text\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_INVITATION_WIDGET_COLLAB_DESC')}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button onclick=\"${showInvitationSlider}\" class=\"intranet-invitation-widget-item-btn intranet-invitation-widget-item-btn--collab\">\n\t\t\t\t\t\t${Loc.getMessage('INTRANET_INVITATION_WIDGET_COLLAB_CREATE')}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetWrapperClass(): string\n\t{\n\t\treturn this.cache.remember('wrapper-class', () => {\n\t\t\treturn 'intranet-invitation-widget-item intranet-invitation-widget-item--wide intranet-invitation-widget-item--collab';\n\t\t});\n\t}\n}\n","import { Content } from \"./content\";\nimport { Tag, ajax, Runtime, Dom } from \"main.core\";\nimport { Loader } from \"main.loader\";\n\nexport class UserOnlineContent extends Content\n{\n\tgetLoader(): Loader\n\t{\n\t\treturn this.cache.remember('loader', () => {\n\t\t\treturn new Loader({\n\t\t\t\tsize: 45,\n\t\t\t});\n\t\t})\n\t}\n\n\tgetComponentContent(): HTMLElement {\n\t\treturn this.cache.remember('component-content', () => {\n\t\t\tconst contentContainer = Tag.render`\n\t\t\t\t<div data-role=\"invitation-widget-ustat-online\" class=\"invitation-widget-ustat-online\"/>\n\t\t\t`;\n\n\t\t\tthis.getLoader().show(contentContainer);\n\n\t\t\tajax.runAction(\"intranet.invitationwidget.getUserOnlineComponent\").then((response) => {\n\t\t\t\tthis.getLoader().hide();\n\t\t\t\tconst assets = response.data.assets;\n\t\t\t\tBX.load([...assets['css'], ...assets['js']], () => {\n\t\t\t\t\tRuntime.html(null, [...assets['string']].join('\\n'), {useAdjacentHTML: true})\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tRuntime.html(contentContainer, response.data.html).then(() => {\n\t\t\t\t\t\t\t\tthis.getLoader().destroy();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t})\n\t\t\t\t\t;\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn contentContainer;\n\t\t});\n\t}\n\n\tgetLayout(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"intranet-invitation-widget-item intranet-invitation-widget-item--wide intranet-invitation-widget-item--no-padding\">\n\t\t\t\t\t${this.getComponentContent()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n}\n","import { EventEmitter } from 'main.core.events';\nimport { Cache, ajax, Event, Runtime } from 'main.core';\nimport { PopupComponentsMaker } from 'ui.popupcomponentsmaker';\nimport type { ConfigContent } from './types/content';\nimport type { InvitationPopupOptions } from './types/options';\nimport { InvitationContent } from './contents/invitation';\nimport { StructureContent } from './contents/structure';\nimport { EmployeesContent } from './contents/employees';\nimport { ExtranetContent } from './contents/extranet';\nimport { CollabContent } from './contents/collab';\nimport { UserOnlineContent } from './contents/user-online';\n\nexport class InvitationPopup extends EventEmitter\n{\n\t#cache = new Cache.MemoryCache();\n\n\tconstructor(options: InvitationPopupOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Intranet.InvitationWidget.Popup');\n\t\tthis.setOptions(options)\n\t\tthis.#setEventHandler();\n\t}\n\n\tsetOptions(options: InvitationPopupOptions): void\n\t{\n\t\tthis.#cache.set('options', options);\n\t}\n\n\tgetOptions(): InvitationPopupOptions\n\t{\n\t\treturn this.#cache.get('options', {});\n\t}\n\n\tshow(): void\n\t{\n\t\tthis.getPopup().show();\n\t}\n\n\tclose(): void\n\t{\n\t\tthis.getPopup().close();\n\t}\n\n\t#getAwaitData(): Promise\n\t{\n\t\treturn this.#cache.remember('await-data', () => {\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tajax.runAction(\"intranet.invitationwidget.getData\", {\n\t\t\t\t\tdata: {},\n\t\t\t\t\tanalyticsLabel: {\n\t\t\t\t\t\theaderPopup: \"Y\"\n\t\t\t\t\t}\n\t\t\t\t}).then(resolve).catch(reject);\n\t\t\t});\n\t\t});\n\t}\n\n\tgetPopup(): PopupComponentsMaker\n\t{\n\t\treturn this.#cache.remember('popup', () => {\n\t\t\treturn new PopupComponentsMaker({\n\t\t\t\tid: 'invitation-popup',\n\t\t\t\ttarget: this.getOptions().target,\n\t\t\t\twidth: 350,\n\t\t\t\tcontent: this.#getContent(),\n\t\t\t\tpopupLoader: this.getOptions().loader,\n\t\t\t});\n\t\t});\n\t}\n\n\t//This is the method for popup content configuration\n\t#getContent(): Array<ConfigContent>\n\t{\n\t\treturn this.#cache.remember('content', () => {\n\t\t\treturn [\n\t\t\t\tthis.#getInvitationContent().getConfig(),\n\t\t\t\t{\n\t\t\t\t\thtml: [\n\t\t\t\t\t\tthis.#getStructureContent().getConfig(),\n\t\t\t\t\t\tthis.#getEmployeesContent().getConfig(),\n\t\t\t\t\t],\n\t\t\t\t\tmarginBottom: 24,\n\t\t\t\t},\n\t\t\t\tthis.getOptions().isExtranetAvailable ? this.#getExtranetContent().getConfig() : null,\n\t\t\t\tthis.getOptions().isCollabAvailable ? this.#getCollabContent().getConfig() : null,\n\t\t\t\tthis.#getUserOnlineContent().getConfig(),\n\t\t\t];\n\t\t});\n\t}\n\n\t//region Get Content\n\t#getInvitationContent(): InvitationContent\n\t{\n\t\treturn this.#cache.remember('invitation-content', () => {\n\t\t\treturn new InvitationContent({\n\t\t\t\t...this.getOptions(),\n\t\t\t});\n\t\t});\n\t}\n\n\t#getStructureContent(): StructureContent\n\t{\n\t\treturn this.#cache.remember('structure-content', () => {\n\t\t\treturn new StructureContent({\n\t\t\t\t...this.getOptions(),\n\t\t\t});\n\t\t});\n\t}\n\n\t#getEmployeesContent(): EmployeesContent\n\t{\n\t\treturn this.#cache.remember('employees-content', () => {\n\t\t\treturn new EmployeesContent({\n\t\t\t\t...this.getOptions(),\n\t\t\t});\n\t\t});\n\t}\n\n\t#getExtranetContent(): ExtranetContent\n\t{\n\t\treturn this.#cache.remember('extranet-content', () => {\n\t\t\treturn new ExtranetContent({\n\t\t\t\t...this.getOptions(),\n\t\t\t});\n\t\t});\n\t}\n\n\t#getCollabContent(): CollabContent\n\t{\n\t\treturn this.#cache.remember('collab-content', () => {\n\t\t\treturn new CollabContent({\n\t\t\t\t...this.getOptions(),\n\t\t\t\tawaitData: Runtime.loadExtension('im.public', 'im.v2.component.content.chat-forms.forms'),\n\t\t\t});\n\t\t});\n\t}\n\n\t#getUserOnlineContent(): UserOnlineContent\n\t{\n\t\treturn this.#cache.remember('user-online-content', () => {\n\t\t\treturn new UserOnlineContent();\n\t\t});\n\t}\n\t//endregion\n\n\t#getPopupContainer(): HTMLElement\n\t{\n\t\treturn this.#cache.remember('popup-container', () => {\n\t\t\treturn this.getPopup().getPopup().getPopupContainer();\n\t\t});\n\t}\n\n\t#setEventHandler()\n\t{\n\t\tconst autoHideHandler = (event) => {\n\t\t\tif (event.data.popup)\n\t\t\t{\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tEvent.bind(this.#getPopupContainer(), 'click', () => {\n\t\t\t\t\t\tevent.data.popup.close();\n\t\t\t\t\t});\n\t\t\t\t}, 100);\n\t\t\t}\n\t\t}\n\n\t\tconst close = () => {\n\t\t\tthis.close();\n\t\t}\n\n\t\tEventEmitter.subscribe(EventEmitter.GLOBAL_TARGET, 'BX.Intranet.InvitationWidget.EmployeesContent:showRightMenu', autoHideHandler);\n\t\tEventEmitter.subscribe(EventEmitter.GLOBAL_TARGET, 'BX.Intranet.InvitationWidget.HintPopup:show', autoHideHandler);\n\t\tEventEmitter.subscribe(EventEmitter.GLOBAL_TARGET, 'BX.Intranet.UstatOnline:showPopup', autoHideHandler);\n\t\tEventEmitter.subscribe(EventEmitter.GLOBAL_TARGET, 'SidePanel.Slider:onOpenStart', close);\n\t}\n}","import { EventEmitter } from 'main.core.events';\nimport { Cache, Event } from 'main.core';\nimport { Analytics } from './analytics';\nimport type { InvitationWidgetOptions } from './types/options';\nimport { InvitationPopup } from './popup';\nimport './style.css';\n\nexport class InvitationWidget extends EventEmitter\n{\n\t#cache = new Cache.MemoryCache();\n\tstatic #instance: InvitationWidget;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Intranet.InvitationWidget');\n\t}\n\n\tstatic getInstance(): InvitationWidget\n\t{\n\t\tif (!this.#instance)\n\t\t{\n\t\t\tthis.#instance = new this();\n\t\t}\n\n\t\treturn this.#instance;\n\t}\n\n\tshow(): void\n\t{\n\t\tif (this.#getPopup().getPopup().isShown())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#getPopup().show();\n\t}\n\n\tsetOptions(options: InvitationWidgetOptions): void\n\t{\n\t\tthis.#cache.set('options', options);\n\t\tAnalytics.isAdmin = this.getOptions().isCurrentUserAdmin;\n\t\tEvent.bind(this.getOptions().button, 'click', () => {\n\t\t\tAnalytics.send(Analytics.EVENT_SHOW);\n\t\t\tthis.#getPopup().show();\n\t\t});\n\t\tEventEmitter.subscribe(EventEmitter.GLOBAL_TARGET, 'BX.Bitrix24.NotifyPanel:showInvitationWidget', () => {\n\t\t\tthis.#getPopup().show();\n\t\t});\n\n\t\treturn this;\n\t}\n\n\tgetOptions(): InvitationWidgetOptions\n\t{\n\t\treturn this.#cache.get('options', {});\n\t}\n\n\t#getPopup(): InvitationPopup\n\t{\n\t\treturn this.#cache.remember('popup', () => {\n\t\t\treturn new InvitationPopup({\n\t\t\t\t...this.getOptions(),\n\t\t\t});\n\t\t});\n\t}\n}\n"],"names":["Analytics","[object Object]","event","sendData","tool","TOOLS","category","CATEGORY_INVITATION","p1","isAdmin","c_section","SECTION_POPUP","p2","TOOLS_LEGACY","CATEGORY_INVITATION_LEGACY","EVENT_NAME_LEGACY","EVENT_SHOW","EVENT_OPEN_SLIDER_INVITATION","EVENT_OPEN_STRUCTURE","EVENT_OPEN_USER_LIST","EVENT_OPEN_SLIDER_EXTRANET_INVITATION","Content","EventEmitter","constructor","options","super","this","cache","Cache","MemoryCache","setOptions","analytics","set","getOptions","get","getLayout","Error","showInfoHelper","articleCode","BX","UI","InfoHelper","show","sendAnalytics","code","ajax","runAction","data","analyticsLabel","helperCode","headerPopup","getHintPopup","text","element","type","remember","Popup","Text","getRandom","content","className","zIndex","angle","offsetTop","offsetLeft","closeIcon","autoHide","darkMode","overlay","maxWidth","events","onShow","emit","GLOBAL_TARGET","BaseEvent","popup","target","timeout","setTimeout","close","subscribeOnce","clearTimeout","onClose","showHintPopup","toggle","showInvitationPlace","isInvitationAvailable","showInvitationSlider","link","invitationLink","send","SidePanel","Instance","open","cacheable","allowChangeHistory","width","getConfig","html","InvitationContent","setEventNamespace","backgroundColor","Tag","render","Loc","getMessage","e","stopPropagation","StructureContent","Object","value","babelHelpers","shouldShowStructureCounter","bind","flex","structureLink","querySelector","Dom","addClass","getContainer","renderTo","Counter","color","Color","DANGER","Type","isNumber","destroy","delete","EmployeesContent","writable","sizeLoader","isLimit","showUserList","users","currentUserCountMessage","getDetail","getSelectorRights","Number","maxUserCount","leftCountMessage","document","location","href","button","getRightsMenu","subscribe","menu","Menu","getMenuRightsItems","onPopupShow","getEventNamespace","onPopupClose","onPopupFirstShow","rightType","onclick","saveInvitationRightSetting","then","invitationCounter","addCustomEvent","command","params","message","clone","counterId","update","ExtranetContent","minHeight","marginBottom","secondary","getWrapperClass","Helper","getCountUserMessage","baseClass","currentExtranetUserCount","currentExtranetUserCountMessage","CollabContent","awaitData","response","Messenger","CreatableChat","openChatCreation","collab","sendCreateCollab","UserOnlineContent","getLoader","Loader","size","getComponentContent","contentContainer","hide","assets","load","Runtime","join","useAdjacentHTML","InvitationPopup","getPopup","PopupComponentsMaker","id","popupLoader","loader","Promise","resolve","reject","catch","isExtranetAvailable","isCollabAvailable","loadExtension","getPopupContainer","autoHideHandler","Event","InvitationWidget","isShown","isCurrentUserAdmin"],"mappings":"2DAEO,MAAMA,EAeZC,YAAYC,GAEXC,WAAS,CACRC,KAAMJ,EAAUK,MAChBC,SAAUN,EAAUO,oBACpBL,MAAOA,EACPM,GAAIR,EAAUS,QAAU,YAAc,cAIxCR,0BAECE,WAAS,CACRC,KAAM,KACNE,SAAU,SACVJ,MAAO,mBACPQ,UAAWV,EAAUW,cACrBC,GAAI,mBAhCMZ,EAELK,MAAQ,cAFHL,EAGLa,aAAe,aAHVb,EAILO,oBAAsB,aAJjBP,EAKLc,2BAA6B,aALxBd,EAMLe,kBAAoB,cANff,EAOLW,cAAgB,cAPXX,EAQLgB,WAAa,OARRhB,EASLiB,6BAA+B,cAT1BjB,EAULkB,qBAAuB,qBAVlBlB,EAWLmB,qBAAuB,eAXlBnB,EAYLoB,sCAAwC,0BAZnCpB,EAaLS,SAAmB,ECTpB,MAAMY,UAAgBC,eAI5BC,YAAYC,GAEXC,QAAQC,KAJTC,MAAQ,IAAIC,QAAMC,YAKjBH,KAAKI,WAAWN,GAChBE,KAAKK,UAAY,IAAI/B,EAGtB8B,WAAWN,GAEVE,KAAKC,MAAMK,IAAI,UAAW,IAAKR,IAGhCS,aAEC,OAAOP,KAAKC,MAAMO,IAAI,UAAW,IAGlCC,YAEC,MAAM,IAAIC,MAAM,wCAGjBC,eAAeC,GAEdC,GAAGC,GAAGC,WAAWC,KAAKJ,GACtBZ,KAAKiB,cAAcL,GAGpBK,cAAcC,GAEbC,OAAKC,UAAU,2CAA4C,CAC1DC,KAAM,GACNC,eAAgB,CACfC,WAAYL,EACZM,YAAa,OAKhBC,aAAaC,EAAcC,EAAsBC,GAEhD,OAAO5B,KAAKC,MAAM4B,SAASD,EAAM,IACzB,IAAIE,QAAO,WAAUC,OAAKC,YAAeL,EAAS,CACxDM,QAASP,EACTQ,UAAW,wBACXC,OAAQ,KACRC,OAAO,EACPC,UAAW,EACXC,WAAY,GACZC,WAAW,EACXC,UAAU,EACVC,UAAU,EACVC,SAAS,EACTC,SAAU,IACVC,OAAQ,CACPC,OAASrE,IACRoB,eAAakD,KAAKlD,eAAamD,cAAe,8CAA+C,IAAIC,YAAU,CAC1G3B,KAAM,CACL4B,MAAOzE,EAAM0E,WAGf,MAAMC,EAAUC,WAAW,KAC1B5E,EAAM0E,OAAOG,SACX,KACHzD,eAAa0D,cAAc1D,eAAamD,cAAe,+CAAgD,KACtGQ,aAAaJ,MAGfK,QAAS,KACR5D,eAAakD,KAAKlD,eAAamD,cAAe,qDAOnDU,cAAc/B,EAAcC,EAAsBC,GAEjD5B,KAAKyB,aAAaC,EAAMC,EAASC,GAAM8B,SAGxCC,oBAAoBjC,EAAcC,EAAsBC,GAEnD5B,KAAKO,aAAaqD,sBAErB5D,KAAK6D,qBAAqBjC,GAI1B5B,KAAKyD,cAAc/B,EAAMC,EAAS,QAAUC,GAI9CiC,qBAAqBjC,GAEpB,IAAIkC,EAAO9D,KAAKO,aAAawD,eAEhB,aAATnC,GAEHkC,GAAQ,iCACRxF,EAAU0F,KAAK1F,EAAUoB,wCAIzBpB,EAAU0F,KAAK1F,EAAUiB,8BAG1BsB,GAAGoD,UAAUC,SAASC,KACrBL,EACA,CAAEM,WAAW,EAAOC,oBAAoB,EAAOC,MAAO,OAIxDC,YAEC,MAAO,CACNC,KAAMxE,KAAKS,2BCzHP,MAAMgE,UAA0B9E,EAEtCE,YAAYC,GACXC,MAAMD,GACNE,KAAK0E,kBAAkB,kDACvB1E,KAAKI,WAAWN,GAGjByE,YAEC,MAAO,CACNC,KAAMxE,KAAKS,YACXkE,gBAAiB,WAInBlE,YAEC,OAAOT,KAAKC,MAAM4B,SAAS,SAAU,IAc7B+C,MAAIC,cAAO;;;;;;;;;aASV;;;;2BAIc;aACd;;;;;qBAKQ;UACX;;;;;MAXKC,MAAIC,WAAW,8CAbI,KAC5B/E,KAAKW,eAAe,2BAiBXmE,MAAIC,WAAW,mCA3BKC,IAC7BA,EAAEC,kBACFjF,KAAK2D,oBACJmB,MAAIC,WAAW,qDACfC,EAAE9B,OACF,uBA4BK4B,MAAIC,WAAW,qDCnDuB,kTAEzC,MAAMG,UAAyBvF,EAErCE,YAAYC,GACXC,MAAMD,GAASqF,8BAAAC,UAAAD,8BAAAC,UAAAD,8BAAAC,UAAAD,8BAAAC,UAAAD,8BAAAC,UACfpF,KAAK0E,kBAAkB,iDAGxBH,YASC,OAPAc,qDAEIrF,KAAKO,aAAa+E,4BAErB1F,eAAa0D,cAAc,0CAA2C+B,mDAA+BE,KAAKvF,OAGpG,CACNwE,KAAMxE,KAAKS,YACX+E,KAAM,GAIR/E,YAEC,OAAOT,KAAKC,MAAM4B,SAAS,SAAU,IAK7B+C,MAAIC,cAAO;;;;;;UAMb;;;oBAGU,YAAkB;SAC7B;;;;MAJGC,MAAIC,WAAW,wCAVN,KACfzG,EAAU0F,KAAK1F,EAAUkB,uBAYSQ,KAAKO,aAAakF,cAC/CX,MAAIC,WAAW,sCAwDvB,aA9CC,OAAO/E,KAAKC,MAAM4B,SAAS,kBAAmB,IACtC7B,KAAKS,YAAYiF,cAAc,0CAEvC,aAIIL,qDAA0B,IAE7BM,MAAIC,SAASP,qDAAmBQ,eAAgB,gCAChDR,qDAAmBS,iDAAS9F,eAE7B,aAIA,OAAOA,KAAKC,MAAM4B,SAAS,UAAW,IAC9B,IAAIkE,UAAQ,CAClBX,8CAAOpF,aACPgG,MAAOD,UAAQE,MAAMC,UAGvB,aAIA,OAAQlG,KAAKO,aAAa+E,2BAA8B,EAAI,EAC5D,aAIA,MAAMF,EAAQC,qDAAmBD,MAC5Be,OAAKC,SAAShB,IAKdpF,KAAKO,aAAa+E,6BAKvBtF,KAAKO,aAAa+E,4BAA6B,EAC/CD,qDAAmBgB,UACnBrG,KAAKC,MAAMqG,OAAO,6BC9FuC,ySAEpD,MAAMC,UAAyB5G,EAIrCE,YAAYC,GACXC,MAAMD,GAASqF,8BAAAC,UAAAD,8BAAAC,UAAAD,8BAAAC,UAAAD,8BAAAC,UAAAD,8BAAAqB,YAAApB,eACfpF,KAAK0E,kBAAkB,iDACvBW,qDAGDd,YAEC,MAAO,CACNC,KAAMxE,KAAKS,YACX+E,KAAM,EACNiB,WAAY,IAIdhG,YAEC,OAAOT,KAAKC,MAAM4B,SAAS,SAAU,IAC7B+C,MAAIC,cAAO;wIACiH;;;;wBAIhH,sDAAwE;;yBAEvE;;aAEZ;;;yBAGY;YACb;;;;SAIH;SACA;;;;MAjBiI7E,KAAKO,aAAamG,QAAU,6CAA+C,KAI3L1G,KAAK2G,eAAmE3G,KAAKO,aAAamG,QAAU,iDAAmD,iDAEtJ1G,KAAK2G,eAEjB7B,MAAIC,WAAW,wCAGH/E,KAAK2G,eAClB3G,KAAKO,aAAaqG,MAAMC,wBAI3B7G,KAAK8G,YACL9G,KAAKO,aAAaxB,QAAUiB,KAAK+G,oBAAsB,OA8D/DD,YAEC,OAAO9G,KAAKC,MAAM4B,SAAS,SAAU,KACpC,IAAII,EAAU,GAed,OAXCA,EAFoD,IAAjD+E,OAAOhH,KAAKO,aAAaqG,MAAMK,cAExBnC,MAAIC,WAAW,iDAEjB/E,KAAKO,aAAamG,QAEhB5B,MAAIC,WAAW,8CAIf/E,KAAKO,aAAaqG,MAAMM,iBAG5BtC,MAAIC,cAAO;oBACH;;QAEZ;;;MAFc7E,KAAK2G,eAEjB1E,KAOP0E,eAEC,OAAO3G,KAAKC,MAAM4B,SAAS,eAAgB,IACnC,KACNvD,EAAU0F,KAAK1F,EAAUmB,sBACzB0H,SAASC,SAASC,KAAO,cAK5BN,oBAEC,OAAO/G,KAAKC,MAAM4B,SAAS,kBAAmB,KAC7C,MAKMyF,EAAS1C,MAAIC,cAAO;oBACX;MANGG,IACjBA,EAAEC,kBACFjF,KAAKuH,cAAcvC,EAAE9B,QAAQQ,WAkB9B,OAXA1D,KAAKwH,UAAU,iBAAmBhJ,IACjC,MAAMiJ,EAAOzH,KAAKuH,cAAcD,GAChCG,EAAKpE,QACLoE,EAAKpB,UACD7H,EAAM6C,KAAKO,OAEd5B,KAAKC,MAAMqG,OAAO,eAClBjB,mDAAkB7G,EAAM6C,KAAKO,QAIxB0F,IAITC,cAAc5F,GAEb,OAAO3B,KAAKC,MAAM4B,SAAS,cAAe,IAClC,IAAI6F,OAAM,eAAc3F,OAAKC,YAAeL,EAAS3B,KAAK2H,qBAAsB,CACtFnF,UAAU,EACVF,WAAY,GACZD,UAAW,EACXD,OAAO,EACPF,UAAW,0BACXU,OAAQ,CACPgF,YAAc3E,IACbrD,eAAakD,KACZlD,eAAamD,cACb/C,KAAK6H,oBAAsB,iBAC3B,IAAI7E,YAAU,CACb3B,KAAM,CACL4B,MAAOA,OAKX6E,aAAe7E,IACdrD,eAAakD,KACZlD,eAAamD,cACb/C,KAAK6H,oBAAsB,kBAC3B,IAAI7E,YAAU,CACb3B,KAAM,CACL4B,MAAOA,OAKX8E,iBAAmB9E,IAClBrD,eAAa4H,UAAU5H,eAAamD,cAAe,+BAAgC,KAClFE,EAAMI,eAQZsE,qBAOC,+CALK3H,aAEJqF,mDAAkBrF,KAAKO,aAAaqG,MAAMoB,WAGpC,CACN,CACCtG,KAAMoD,MAAIC,WAAW,iDACrB7C,UAA+B,QAApBmD,mDAA4B,yBAA2B,GAClE4C,QAAS,KACRjI,KAAKkI,2BAA2B,OAAOC,KAAK,KAC3CnI,KAAK8C,KAAK,iBAAkB,IAAIE,YAAU,CACzC3B,KAAM,CACLO,KAAM,cAMX,CACCF,KAAMoD,MAAIC,WAAW,mDACrB7C,UAA+B,UAApBmD,mDAA8B,yBAA2B,GACpE4C,QAAS,KACRjI,KAAKkI,2BAA2B,SAASC,KAAK,KAC7CnI,KAAK8C,KAAK,iBAAkB,IAAIE,YAAU,CACzC3B,KAAM,CACLO,KAAM,iBASbsG,2BAA2BtG,GAE1B,OAAOT,OAAKC,UAAU,gDAAiD,CACtEC,KAAM,CACLO,KAAMA,MAKT,aA7MK5B,KAAKO,aAAa6H,kBAAoB,GAEzC/C,qDAAmBS,iDAAS9F,cAG7Ba,GAAGwH,eAAe,mBAAoBhD,mDAA4BE,KAAKvF,OACvE,WAEsBsI,EAASC,GAE/B,GAAgB,iBAAZD,GAA8BC,EAAO1H,GAAG2H,QAAQ,YACpD,CACC,MACMpD,EADWvE,GAAG4H,MAAMF,EAAO1H,GAAG2H,QAAQ,aACrBxI,KAAKO,aAAamI,WAEzC,IAAKvC,OAAKC,SAAShB,GAElB,OAGDC,qDAAmBsD,OAAOvD,GAC1BpF,KAAKO,aAAa6H,kBAAoBhD,EAElCA,EAAQ,EAEXC,qDAAmBS,iDAAS9F,eAI5BqF,qDAAmBgB,UACnBrG,KAAKC,MAAMqG,OAAO,aAGpB,aAIA,OAAOtG,KAAKC,MAAM4B,SAAS,UAAW,IAC9B,IAAIkE,UAAQ,CAClBX,MAAO4B,OAAOhH,KAAKO,aAAa6H,mBAChCpC,MAAOD,UAAQE,MAAMC,UAGvB,aAIA,OAAOlG,KAAKC,MAAM4B,SAAS,kBAAmB,IACtC7B,KAAKS,YAAYiF,cAAc,yDCtGlC,MAAMkD,UAAwBjJ,EAIpCE,YAAYC,GACXC,MAAMD,GAASE,KAHhBY,YAAsB,UAIrBZ,KAAK0E,kBAAkB,gDAGxBH,YAEC,MAAO,CACNC,KAAMxE,KAAKS,YACXoI,UAAW,OACXpC,WAAY,GACZqC,aAAc,GACdC,WAAW,GAIbtI,YAEC,OAAOT,KAAKC,MAAM4B,SAAS,SAAU,IAe7B+C,MAAIC,cAAO;kEAC2C;;;;;;WAMvD;;;;yBAIc;WACd;;;SAGF;;;wBAGe;QAChB;;;MAlB4D7E,KAAKgJ,kBAM5DlE,MAAIC,WAAW,uCAZI,KAC1BlE,GAAGoI,OAAOjI,KAAM,wBAAuBhB,KAAKY,aAC5CZ,KAAKiB,cAAcjB,KAAKY,cAejBkE,MAAIC,WAAW,4CAGjB/E,KAAKkJ,sBA7BmBlE,IAC7BA,EAAEC,kBACFjF,KAAK2D,oBACJmB,MAAIC,WAAW,qDACfC,EAAE9B,OACF,aA4BG4B,MAAIC,WAAW,uCAOtBiE,kBAEC,OAAOhJ,KAAKC,MAAM4B,SAAS,gBAAiB,KAC3C,MAAMsH,EAAY,wEAElB,OAAInJ,KAAKO,aAAa6I,yBAA2B,EAEzCD,EAAY,2CAGbA,IAITD,sBAEC,OAAOlJ,KAAKC,MAAM4B,SAAS,qBAAsB,IAC5C7B,KAAKO,aAAa6I,yBAA2B,EAEzCxE,MAAIC,cAAO;;QAEhB;;OAAE7E,KAAKO,aAAa8I,iCAKhB,oBC1F+B,yDAElC,MAAMC,UAAsB3J,EAKlCE,YAAYC,GACXC,MAAMD,GAASE,KAJhBY,YAAsB,WAAUuE,8BAAAqB,YAAApB,eAK/BpF,KAAK0E,kBAAkB,8CAGxBH,YAEC,MAAO,CACNC,KAAMxE,KAAKO,aAAagJ,UAAUpB,KAAMqB,IACvC,MAAMC,UAAEA,EAASC,cAAEA,GAAkBF,EAMrC,OALAnE,mDAAiB,KAChBoE,EAAUE,iBAAiBD,EAAcE,QACzCtL,EAAUuL,oBAGJ7J,KAAKS,cAEboI,UAAW,OACXpC,WAAY,GACZqC,aAAc,GACdC,WAAW,GAIbtI,YAEC,OAAOT,KAAKC,MAAM4B,SAAS,SAAU,IAW7B+C,MAAIC,cAAO;gEACyC;;;;;;;;WAQrD;;;;yBAIc;WACd;;;;;wBAKa;QAChB;;;MAnB0D7E,KAAKgJ,kBAQ1DlE,MAAIC,WAAW,qCAdE,KACxBlE,GAAGoI,OAAOjI,KAAM,wBAAuBhB,KAAKY,aAC5CZ,KAAKiB,cAAcjB,KAAKY,cAiBjBkE,MAAIC,WAAW,0CAxBOC,IAC7BK,qDACAL,EAAEC,mBA4BEH,MAAIC,WAAW,8CAOtBiE,kBAEC,OAAOhJ,KAAKC,MAAM4B,SAAS,gBAAiB,IACpC,iIC1EH,MAAMiI,UAA0BnK,EAEtCoK,YAEC,OAAO/J,KAAKC,MAAM4B,SAAS,SAAU,IAC7B,IAAImI,SAAO,CACjBC,KAAM,MAKTC,sBACC,OAAOlK,KAAKC,MAAM4B,SAAS,oBAAqB,KAC/C,MAAMsI,EAAmBvF,MAAIC,cAAO;;OAoBpC,OAhBA7E,KAAK+J,YAAY/I,KAAKmJ,GAEtBhJ,OAAKC,UAAU,oDAAoD+G,KAAMqB,IACxExJ,KAAK+J,YAAYK,OACjB,MAAMC,EAASb,EAASnI,KAAKgJ,OAC7BxJ,GAAGyJ,KAAK,IAAID,EAAY,OAAMA,EAAW,IAAI,KAC5CE,UAAQ/F,KAAK,KAAM,IAAI6F,EAAe,QAAGG,KAAK,MAAO,CAACC,iBAAiB,IACrEtC,KAAK,KACLoC,UAAQ/F,KAAK2F,EAAkBX,EAASnI,KAAKmD,MAAM2D,KAAK,KACvDnI,KAAK+J,YAAY1D,kBAOf8D,IAIT1J,YAEC,OAAOT,KAAKC,MAAM4B,SAAS,SAAU,IAC7B+C,MAAIC,cAAO;;OAEhB;;MAAE7E,KAAKkK,gsBClCL,MAAMQ,WAAwB9K,eAIpCC,YAAYC,GAEXC,QAAQoF,+BAAAC,WAAAD,+BAAAC,WAAAD,+BAAAC,WAAAD,+BAAAC,WAAAD,+BAAAC,WAAAD,+BAAAC,WAAAD,+BAAAC,WAAAD,+BAAAC,WAAAD,+BAAAC,WAAAD,8BAAAC,WAAAD,8BAAAqB,YAAApB,MAJA,IAAIlF,QAAMC,cAKlBH,KAAK0E,kBAAkB,sCACvB1E,KAAKI,WAAWN,GAChBuF,uDAGDjF,WAAWN,GAEVuF,mDAAY/E,IAAI,UAAWR,GAG5BS,aAEC,OAAO8E,mDAAY7E,IAAI,UAAW,IAGnCQ,OAEChB,KAAK2K,WAAW3J,OAGjBqC,QAECrD,KAAK2K,WAAWtH,QAiBjBsH,WAEC,OAAOtF,mDAAYxD,SAAS,QAAS,IAC7B,IAAI+I,uBAAqB,CAC/BC,GAAI,mBACJ3H,OAAQlD,KAAKO,aAAa2C,OAC1BoB,MAAO,IACPrC,gDAASjC,eACT8K,YAAa9K,KAAKO,aAAawK,WA6GlC,cAjIC,OAAO1F,mDAAYxD,SAAS,aAAc,IAClC,IAAImJ,QAAQ,CAACC,EAASC,KAC5B/J,OAAKC,UAAU,oCAAqC,CACnDC,KAAM,GACNC,eAAgB,CACfE,YAAa,OAEZ2G,KAAK8C,GAASE,MAAMD,MAGzB,cAkBA,OAAO7F,mDAAYxD,SAAS,UAAW,IAC/B,CACNwD,uDAA6Bd,YAC7B,CACCC,KAAM,CACLa,uDAA4Bd,YAC5Bc,uDAA4Bd,aAE7BuE,aAAc,IAEf9I,KAAKO,aAAa6K,oBAAsB/F,uDAA2Bd,YAAc,KACjFvE,KAAKO,aAAa8K,kBAAoBhG,uDAAyBd,YAAc,KAC7Ec,uDAA6Bd,cAG/B,cAKA,OAAOc,mDAAYxD,SAAS,qBAAsB,IAC1C,IAAI4C,EAAkB,IACzBzE,KAAKO,gBAGV,cAIA,OAAO8E,mDAAYxD,SAAS,oBAAqB,IACzC,IAAIqD,EAAiB,IACxBlF,KAAKO,gBAGV,cAIA,OAAO8E,mDAAYxD,SAAS,oBAAqB,IACzC,IAAI0E,EAAiB,IACxBvG,KAAKO,gBAGV,cAIA,OAAO8E,mDAAYxD,SAAS,mBAAoB,IACxC,IAAI+G,EAAgB,IACvB5I,KAAKO,gBAGV,cAIA,OAAO8E,mDAAYxD,SAAS,iBAAkB,IACtC,IAAIyH,EAAc,IACrBtJ,KAAKO,aACRgJ,UAAWgB,UAAQe,cAAc,YAAa,+CAGhD,cAIA,OAAOjG,mDAAYxD,SAAS,sBAAuB,IAC3C,IAAIiI,GAEZ,cAKA,OAAOzE,mDAAYxD,SAAS,kBAAmB,IACvC7B,KAAK2K,WAAWA,WAAWY,qBAEnC,cAIA,MAAMC,EAAmBhN,IACpBA,EAAM6C,KAAK4B,OAEdG,WAAW,KACVqI,QAAMlG,6CAAKvF,eAA2B,QAAS,KAC9CxB,EAAM6C,KAAK4B,MAAMI,WAEhB,MAQLzD,eAAa4H,UAAU5H,eAAamD,cAAe,8DAA+DyI,GAClH5L,eAAa4H,UAAU5H,eAAamD,cAAe,8CAA+CyI,GAClG5L,eAAa4H,UAAU5H,eAAamD,cAAe,oCAAqCyI,GACxF5L,eAAa4H,UAAU5H,eAAamD,cAAe,+BAPrC,KACb/C,KAAKqD,6KChKD,MAAMqI,WAAyB9L,eAKrCC,cAECE,QAAQoF,+BAAAC,WAAAD,+BAAAqB,YAAApB,MALA,IAAIlF,QAAMC,cAMlBH,KAAK0E,kBAAkB,gCAGxBnG,qBAOC,+CALKyB,eAEJqF,qDAAiB,IAAIrF,8CAGfA,aAGRgB,OAEKqE,uDAAiBsF,WAAWgB,WAKhCtG,uDAAiBrE,OAGlBZ,WAAWN,GAYV,OAVAuF,qDAAY/E,IAAI,UAAWR,GAC3BxB,EAAUS,QAAUiB,KAAKO,aAAaqL,mBACtCH,QAAMlG,KAAKvF,KAAKO,aAAa+G,OAAQ,QAAS,KAC7ChJ,EAAU0F,KAAK1F,EAAUgB,YACzB+F,uDAAiBrE,SAElBpB,eAAa4H,UAAU5H,eAAamD,cAAe,+CAAgD,KAClGsC,uDAAiBrE,SAGXhB,KAGRO,aAEC,OAAO8E,qDAAY7E,IAAI,UAAW,KAWnC,cANC,OAAO6E,qDAAYxD,SAAS,QAAS,IAC7B,IAAI6I,GAAgB,IACvB1K,KAAKO,gBAGV4E,sBA1DWuG,OAAgBlF,YAAApB"}