this.BX=this.BX||{},function(e,t,s,a,i,l,r){"use strict";let o,n,c,p,b,d=e=>e;var u=babelHelpers.classPrivateFieldLooseKey("cache"),v=babelHelpers.classPrivateFieldLooseKey("setOptions"),h=babelHelpers.classPrivateFieldLooseKey("getOptions"),P=babelHelpers.classPrivateFieldLooseKey("getMoreMenu"),L=babelHelpers.classPrivateFieldLooseKey("getAvatar"),m=babelHelpers.classPrivateFieldLooseKey("getHost"),H=babelHelpers.classPrivateFieldLooseKey("getStatus"),F=babelHelpers.classPrivateFieldLooseKey("getEmail");class B{constructor(e){Object.defineProperty(this,F,{value:O}),Object.defineProperty(this,H,{value:E}),Object.defineProperty(this,m,{value:_}),Object.defineProperty(this,L,{value:k}),Object.defineProperty(this,P,{value:f}),Object.defineProperty(this,h,{value:y}),Object.defineProperty(this,v,{value:g}),Object.defineProperty(this,u,{writable:!0,value:new r.Cache.MemoryCache}),babelHelpers.classPrivateFieldLooseBase(this,v)[v](e)}getContainer(){return babelHelpers.classPrivateFieldLooseBase(this,u)[u].remember("container",(()=>r.Tag.render(o||(o=d`
				<div class="intranet-desktop-portal-list-item__wrapper">
					<div class="intranet-desktop-portal-list-item__avatar">
						${0}
					</div>
					<div class="intranet-desktop-portal-list-item__info-wrapper">
						${0}
						${0}
					</div>
					${0}
				</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,L)[L]().getContainer(),babelHelpers.classPrivateFieldLooseBase(this,m)[m](),babelHelpers.classPrivateFieldLooseBase(this,F)[F](),babelHelpers.classPrivateFieldLooseBase(this,P)[P]())))}}function g(e){return babelHelpers.classPrivateFieldLooseBase(this,u)[u].set("options",e),this}function y(){return babelHelpers.classPrivateFieldLooseBase(this,u)[u].get("options",{})}function f(){return babelHelpers.classPrivateFieldLooseBase(this,u)[u].remember("moreMenuElement",(()=>{const e=r.Tag.render(n||(n=d`
				<i class="ui-icon-set --more-l intranet-desktop-portal-list-item__more"/>
			`)),t=new a.Menu({bindElement:e,items:[babelHelpers.classPrivateFieldLooseBase(this,h)[h]().account.connected?{text:"\u0412\u044b\u0439\u0442\u0438",onclick:()=>{i.DesktopApi.disconnectAccount(babelHelpers.classPrivateFieldLooseBase(this,h)[h]().account.host),t.close(),l.EventEmitter.emit("BX.Intranet.DesktopPortalList.Item:change")}}:{text:"\u041f\u0435\u0440\u0435\u0439\u0442\u0438",onclick:()=>{i.DesktopApi.connectAccount(babelHelpers.classPrivateFieldLooseBase(this,h)[h]().account.host,babelHelpers.classPrivateFieldLooseBase(this,h)[h]().account.login,babelHelpers.classPrivateFieldLooseBase(this,h)[h]().account.protocol,navigator.language),t.close(),l.EventEmitter.emit("BX.Intranet.DesktopPortalList.Item:change")}},{text:"\u0423\u0431\u0440\u0430\u0442\u044c \u0438\u0437 \u0441\u043f\u0438\u0441\u043a\u0430",onclick:()=>{i.DesktopApi.deleteAccount(babelHelpers.classPrivateFieldLooseBase(this,h)[h]().account.host,babelHelpers.classPrivateFieldLooseBase(this,h)[h]().account.login),t.close(),l.EventEmitter.emit("BX.Intranet.DesktopPortalList.Item:change")}}]});return r.Event.bind(e,"click",(e=>{e.preventDefault(),e.stopPropagation(),t.toggle()})),e}))}function k(){const e={size:36,userpicPath:encodeURI(babelHelpers.classPrivateFieldLooseBase(this,h)[h]().account.avatar)};return new s.AvatarRound(e)}function _(){return r.Tag.render(c||(c=d`
			<div class="intranet-desktop-portal-list-item__title-wrapper">
				<span class="intranet-desktop-portal-list-item__title${0}">${0}</span>
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,h)[h]().isCurrent?" --current":"",babelHelpers.classPrivateFieldLooseBase(this,h)[h]().account.host,babelHelpers.classPrivateFieldLooseBase(this,H)[H]())}function E(){return babelHelpers.classPrivateFieldLooseBase(this,h)[h]().isCurrent?babelHelpers.classPrivateFieldLooseBase(this,u)[u].remember("statusElement",(()=>r.Tag.render(p||(p=d`
				<span class="intranet-desktop-portal-list-item__status">${0}</span>
			`),r.Loc.getMessage("INTRANET_DESKTOP_PORTAL_LIST_CURREN_STATUS")))):null}function O(){return r.Tag.render(b||(b=d`
			<span class="intranet-desktop-portal-list-item__description">${0}</span>
		`),babelHelpers.classPrivateFieldLooseBase(this,h)[h]().account.email)}let C,w,A=e=>e;var K=babelHelpers.classPrivateFieldLooseKey("cache"),j=babelHelpers.classPrivateFieldLooseKey("getCurrentPortal"),I=babelHelpers.classPrivateFieldLooseKey("getPanel"),D=babelHelpers.classPrivateFieldLooseKey("getPortalList");class X{constructor(){Object.defineProperty(this,D,{value:$}),Object.defineProperty(this,I,{value:M}),Object.defineProperty(this,j,{value:T}),Object.defineProperty(this,K,{writable:!0,value:new r.Cache.MemoryCache})}getAccounts(){return babelHelpers.classPrivateFieldLooseBase(this,K)[K].remember("accounts",(()=>"undefined"==typeof BXDesktopSystem?[]:i.DesktopApi.getAccountList()))}getCurrentAccount(){return babelHelpers.classPrivateFieldLooseBase(this,K)[K].remember("currentAccount",(()=>{const e=r.Loc.getMessage("USER_ID"),t=this.getAccounts(),s=location.host;return t.find((t=>t.id===e&&s===t.host))}))}getContent(){return[babelHelpers.classPrivateFieldLooseBase(this,j)[j](),babelHelpers.classPrivateFieldLooseBase(this,I)[I](),babelHelpers.classPrivateFieldLooseBase(this,D)[D]()]}}function T(){return babelHelpers.classPrivateFieldLooseBase(this,K)[K].remember("currentPortal",(()=>{if(!this.getCurrentAccount())return null;return{html:new B({account:this.getCurrentAccount(),isCurrent:!0}).getContainer()}}))}function M(){return babelHelpers.classPrivateFieldLooseBase(this,K)[K].remember("panel",(()=>({html:r.Tag.render(C||(C=A`
					<div onclick="${0}" class="intranet-desktop-portal-list-item-list-header__wrapper">
						<span class="intranet-desktop-portal-list-item-list-header__title">Подключенные Битрикс24</span>
						<div class="intranet-desktop-portal-list-item-list-header__connect-wrapper">
							<i class="ui-icon-set --plus-s intranet-desktop-portal-list-item-list-header__connect-icon"></i>
							<span class="intranet-desktop-portal-list-item-list-header__connect-title">Подключить</span>
						</div>
					</div>
				`),(()=>{i.DesktopApi.openAddAccountTab(),l.EventEmitter.emit("BX.Intranet.DesktopPortalList:openConnector")})),withoutBackground:!0})))}function $(){return babelHelpers.classPrivateFieldLooseBase(this,K)[K].remember("portalList",(()=>{const e=r.Tag.render(w||(w=A`
				<div class="intranet-desktop-portal-list-item-list__wrapper"></div>
			`));return this.getAccounts().forEach((t=>{if(t!==this.getCurrentAccount()){const s=new B({account:t,isCurrent:!1});r.Dom.append(s.getContainer(),e)}})),{html:e}}))}var S=babelHelpers.classPrivateFieldLooseKey("cache"),R=babelHelpers.classPrivateFieldLooseKey("setOptions"),U=babelHelpers.classPrivateFieldLooseKey("getOptions"),x=babelHelpers.classPrivateFieldLooseKey("getBasePopup"),N=babelHelpers.classPrivateFieldLooseKey("getContent"),z=babelHelpers.classPrivateFieldLooseKey("cleanCache");class q extends l.EventEmitter{constructor(e){super(),Object.defineProperty(this,z,{value:W}),Object.defineProperty(this,N,{value:V}),Object.defineProperty(this,x,{value:Q}),Object.defineProperty(this,U,{value:J}),Object.defineProperty(this,R,{value:G}),Object.defineProperty(this,S,{writable:!0,value:new r.Cache.MemoryCache}),babelHelpers.classPrivateFieldLooseBase(this,R)[R](e),this.setEventNamespace("BX.Intranet.DesktopPortalList.Popup"),l.EventEmitter.subscribe("BX.Intranet.DesktopPortalList.Item:change",(()=>{babelHelpers.classPrivateFieldLooseBase(this,x)[x]().close(),babelHelpers.classPrivateFieldLooseBase(this,z)[z]()})),l.EventEmitter.subscribe("BX.Intranet.DesktopPortalList:openConnector",(()=>{babelHelpers.classPrivateFieldLooseBase(this,x)[x]().close(),babelHelpers.classPrivateFieldLooseBase(this,z)[z]()}))}show(){babelHelpers.classPrivateFieldLooseBase(this,x)[x]().isShown()||babelHelpers.classPrivateFieldLooseBase(this,x)[x]().show()}}function G(e){return babelHelpers.classPrivateFieldLooseBase(this,S)[S].set("options",e),this}function J(){return babelHelpers.classPrivateFieldLooseBase(this,S)[S].get("options",{})}function Q(){return babelHelpers.classPrivateFieldLooseBase(this,S)[S].remember("popup",(()=>new t.PopupComponentsMaker({target:babelHelpers.classPrivateFieldLooseBase(this,U)[U]().bindElement,width:450,content:babelHelpers.classPrivateFieldLooseBase(this,N)[N]()})))}function V(){return babelHelpers.classPrivateFieldLooseBase(this,S)[S].remember("content",(()=>(new X).getContent()))}function W(){babelHelpers.classPrivateFieldLooseBase(this,S)[S].delete("popup"),babelHelpers.classPrivateFieldLooseBase(this,S)[S].delete("content")}var Y=babelHelpers.classPrivateFieldLooseKey("cache"),Z=babelHelpers.classPrivateFieldLooseKey("setOptions"),ee=babelHelpers.classPrivateFieldLooseKey("getOptions"),te=babelHelpers.classPrivateFieldLooseKey("getPopup");class se extends l.EventEmitter{constructor(e){super(),Object.defineProperty(this,te,{value:le}),Object.defineProperty(this,ee,{value:ie}),Object.defineProperty(this,Z,{value:ae}),Object.defineProperty(this,Y,{writable:!0,value:new r.Cache.MemoryCache}),babelHelpers.classPrivateFieldLooseBase(this,Z)[Z](e),this.setEventNamespace("BX.Intranet.DesktopPortalList")}show(){babelHelpers.classPrivateFieldLooseBase(this,te)[te]().show()}}function ae(e){return babelHelpers.classPrivateFieldLooseBase(this,Y)[Y].set("options",e),this}function ie(){return babelHelpers.classPrivateFieldLooseBase(this,Y)[Y].get("options",{})}function le(){return babelHelpers.classPrivateFieldLooseBase(this,Y)[Y].remember("popup",(()=>new q({bindElement:babelHelpers.classPrivateFieldLooseBase(this,ee)[ee]().bindElement})))}e.DesktopPortalList=se}(this.BX.Intranet=this.BX.Intranet||{},BX.UI,BX.UI,BX.Main,BX.Messenger.v2.Lib,BX.Event,BX);
//# sourceMappingURL=desktop-portal-list.bundle.map.js