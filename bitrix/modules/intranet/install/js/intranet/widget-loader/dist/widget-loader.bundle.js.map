{"version":3,"file":"widget-loader.bundle.js","sources":["../src/widget-loader.js"],"sourcesContent":["import './style.css';\nimport { Tag, Cache, Dom, Event } from 'main.core';\nimport { Popup } from 'main.popup';\n\nexport class WidgetLoader\n{\n\t#cache = new Cache.MemoryCache();\n\n\tconstructor(options = {})\n\t{\n\t\tthis.#setOptions(options);\n\t\tEvent.bind(this.#getOptions().bindElement, 'click', () => {\n\t\t\tthis.show();\n\t\t});\n\t}\n\n\tshow(): void\n\t{\n\t\tthis.getPopup().show();\n\t}\n\n\tclearBeforeInsertContent(): void\n\t{\n\t\tconst popupContainer = this.getPopup().getPopupContainer();\n\t\tDom.removeClass(popupContainer, 'intranet-widget-skeleton__wrap');\n\t\tpopupContainer.querySelectorAll('.intranet-widget-skeleton__row').forEach(\n\t\t\t(row) => Dom.remove(row),\n\t\t);\n\t\tpopupContainer.querySelectorAll('.intranet-widget-skeleton__header').forEach(\n\t\t\t(row) => Dom.remove(row),\n\t\t);\n\t\tpopupContainer.querySelectorAll('.intranet-widget-skeleton__footer').forEach(\n\t\t\t(row) => Dom.remove(row),\n\t\t);\n\t\tDom.prepend(this.#cache.get('popup-content'), popupContainer);\n\t}\n\n\tgetPopup(): Popup\n\t{\n\t\treturn this.#cache.remember('popup', () => {\n\t\t\tconst offsetLeft = (-(this.#getOptions().width / 2)\n\t\t\t\t+ (this.#getOptions().bindElement ? this.#getOptions().bindElement.offsetWidth / 2 : 0)\n\t\t\t\t+ 40);\n\t\t\tconst popup = new Popup({\n\t\t\t\tautoHide: true,\n\t\t\t\tid: this.#getOptions().id ?? null,\n\t\t\t\tbindElement: this.#getOptions().bindElement,\n\t\t\t\twidth: this.#getOptions().width,\n\t\t\t\toffsetLeft: this.#getOptions().offsetLeft ?? offsetLeft,\n\t\t\t\tuseAngle: this.#getOptions().useAngle ?? true,\n\t\t\t\tangle: this.#getOptions().useAngle ?? {\n\t\t\t\t\toffset: (this.#getOptions().width / 2) - 16,\n\t\t\t\t},\n\t\t\t\toffsetTop: this.#getOptions().offsetTop ?? 3,\n\t\t\t\tanimation: 'fading-slide',\n\t\t\t\tcloseByEsc: true,\n\t\t\t});\n\t\t\tconst container = popup.getPopupContainer();\n\t\t\tthis.#cache.set('popup-content', container.querySelector('.popup-window-content'));\n\t\t\tDom.remove(container.querySelector('.popup-window-content'));\n\t\t\tDom.addClass(container, 'intranet-widget-skeleton__wrap');\n\n\t\t\treturn popup;\n\t\t});\n\t}\n\n\t#setOptions(options): WidgetLoader\n\t{\n\t\tthis.#cache.set('options', options);\n\n\t\treturn this;\n\t}\n\n\t#getOptions(): Object\n\t{\n\t\treturn this.#cache.get('options', {});\n\t}\n\n\tcreateSkeletonFromConfig(config = {}): WidgetLoader\n\t{\n\t\tif (config.header)\n\t\t{\n\t\t\tthis.addHeaderSkeleton();\n\t\t}\n\n\t\tif (Array.isArray(config.items))\n\t\t{\n\t\t\tconfig.items.forEach((item) => {\n\t\t\t\tif (item.type === 'item')\n\t\t\t\t{\n\t\t\t\t\tthis.addItemSkeleton(item.height);\n\t\t\t\t}\n\t\t\t\telse if (item.type === 'split')\n\t\t\t\t{\n\t\t\t\t\tthis.addSplitItemSkeleton(item.height);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (config.footer)\n\t\t{\n\t\t\tthis.addFooterSkeleton();\n\t\t}\n\n\t\treturn this;\n\t}\n\n\taddItemSkeleton(height: number): WidgetLoader\n\t{\n\t\tDom.append(this.#createItemSkeleton(height), this.getPopup().getPopupContainer());\n\n\t\treturn this;\n\t}\n\n\taddSplitItemSkeleton(height: number): WidgetLoader\n\t{\n\t\tDom.append(this.#createSplitItemSkeleton(height), this.getPopup().getPopupContainer());\n\n\t\treturn this;\n\t}\n\n\taddHeaderSkeleton(): WidgetLoader\n\t{\n\t\tDom.prepend(this.#createHeaderSkeleton(), this.getPopup().getPopupContainer());\n\n\t\treturn this;\n\t}\n\n\taddFooterSkeleton(): WidgetLoader\n\t{\n\t\tDom.append(this.#createFooterSkeleton(), this.getPopup().getPopupContainer());\n\n\t\treturn this;\n\t}\n\n\t#createHeaderSkeleton(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"intranet-widget-skeleton__header\">\n\t\t\t\t<div style=\"max-width: 95px; height: 8px;\" class=\"intranet-widget-skeleton__line\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#createItemSkeleton(height: number): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"intranet-widget-skeleton__row\">\n\t\t\t\t<div style=\"height: ${height}px\" class=\"intranet-widget-skeleton__item\">\n\t\t\t\t\t<div class=\"intranet-widget-skeleton__circle\"></div>\n\t\t\t\t\t<div style=\"max-width: 130px;\" class=\"intranet-widget-skeleton__line\"></div>\n\t\t\t\t\t<div style=\"width: 12px; height: 12px; margin-left: auto;\" class=\"intranet-widget-skeleton__circle\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#createSplitItemSkeleton(height: number): HTMLElement\n\t{\n\t\treturn  Tag.render`\n\t\t\t<div class=\"intranet-widget-skeleton__row\">\n\t\t\t\t<div style=\"height: ${height}px\" class=\"intranet-widget-skeleton__item\">\n\t\t\t\t\t<div class=\"intranet-widget-skeleton__circle\"></div>\n\t\t\t\t\t<div style=\"max-width: 75px;\" class=\"intranet-widget-skeleton__line\"></div>\n\t\t\t\t\t<div style=\"width: 12px; height: 12px; margin-left: auto;\" class=\"intranet-widget-skeleton__circle\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div style=\"height: ${height}px\" class=\"intranet-widget-skeleton__item\">\n\t\t\t\t\t<div class=\"intranet-widget-skeleton__circle\"></div>\n\t\t\t\t\t<div style=\"max-width: 75px;\" class=\"intranet-widget-skeleton__line\"></div>\n\t\t\t\t\t<div style=\"width: 12px; height: 12px; margin-left: auto;\" class=\"intranet-widget-skeleton__circle\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#createFooterSkeleton(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"intranet-widget-skeleton__footer\">\n\t\t\t\t<div style=\"max-width: 40px;\" class=\"intranet-widget-skeleton__line\"></div>\n\t\t\t\t<div style=\"max-width: 40px;\" class=\"intranet-widget-skeleton__line\"></div>\n\t\t\t\t<div style=\"max-width: 40px;\" class=\"intranet-widget-skeleton__line\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n}\n"],"names":["options","babelHelpers","set","this","get","Tag","render","height","constructor","Object","value","writable","Cache","MemoryCache","Event","bind","bindElement","show","getPopup","clearBeforeInsertContent","popupContainer","getPopupContainer","Dom","removeClass","querySelectorAll","forEach","row","remove","prepend","remember","offsetLeft","width","offsetWidth","popup","Popup","autoHide","id","useAngle","angle","offset","offsetTop","animation","closeByEsc","container","querySelector","addClass","createSkeletonFromConfig","config","header","addHeaderSkeleton","Array","isArray","items","item","type","addItemSkeleton","addSplitItemSkeleton","footer","addFooterSkeleton","append"],"mappings":"oEAEmC,yaAuLlC,WAvHYA,GAIX,OAFAC,mDAAYC,IAAI,UAAWF,GAEpBG,KACP,aAIA,OAAOF,mDAAYG,IAAI,UAAW,IAClC,aA6DA,OAAOC,MAAIC,cAAO;;;;MAKlB,WAEmBC,GAEnB,OAAOF,MAAIC,cAAO;;0BAEI;;;;;;KAAEC,GAOxB,WAEwBA,GAExB,OAAQF,MAAIC,cAAO;;0BAEG;;;;;0BAKA;;;;;;KALEC,EAKAA,GAOxB,aAIA,OAAOF,MAAIC,cAAO;;;;;;qBA7Kb,MAINE,YAAYR,EAAU,IACtBS,8BAAAC,UAAAD,8BAAAC,UAAAD,8BAAAC,UAAAD,8BAAAC,UAAAD,8BAAAC,UAAAD,8BAAAC,UAAAD,8BAAAE,YAAAD,MAHS,IAAIE,QAAMC,cAIlBZ,mDAAiBD,GACjBc,QAAMC,KAAKd,qDAAmBe,YAAa,QAAS,KACnDb,KAAKc,SAIPA,OAECd,KAAKe,WAAWD,OAGjBE,2BAEC,MAAMC,EAAiBjB,KAAKe,WAAWG,oBACvCC,MAAIC,YAAYH,EAAgB,kCAChCA,EAAeI,iBAAiB,kCAAkCC,QAChEC,GAAQJ,MAAIK,OAAOD,IAErBN,EAAeI,iBAAiB,qCAAqCC,QACnEC,GAAQJ,MAAIK,OAAOD,IAErBN,EAAeI,iBAAiB,qCAAqCC,QACnEC,GAAQJ,MAAIK,OAAOD,IAErBJ,MAAIM,QAAQ3B,mDAAYG,IAAI,iBAAkBgB,GAG/CF,WAEC,OAAOjB,mDAAY4B,SAAS,QAAS,KAAM,cAC1C,MAAMC,GAAgB7B,qDAAmB8B,MAAQ,GAC7C9B,qDAAmBe,YAAcf,qDAAmBe,YAAYgB,YAAc,EAAI,GACnF,GACGC,EAAQ,IAAIC,QAAM,CACvBC,UAAU,EACVC,YAAInC,qDAAmBmC,MAAM,KAC7BpB,YAAaf,qDAAmBe,YAChCe,MAAO9B,qDAAmB8B,MAC1BD,oBAAY7B,qDAAmB6B,cAAcA,EAC7CO,kBAAUpC,qDAAmBoC,aAC7BC,eAAOrC,qDAAmBoC,YAAY,CACrCE,OAAStC,qDAAmB8B,MAAQ,EAAK,IAE1CS,mBAAWvC,qDAAmBuC,aAAa,EAC3CC,UAAW,eACXC,YAAY,IAEPC,EAAYV,EAAMZ,oBAKxB,OAJApB,mDAAYC,IAAI,gBAAiByC,EAAUC,cAAc,0BACzDtB,MAAIK,OAAOgB,EAAUC,cAAc,0BACnCtB,MAAIuB,SAASF,EAAW,kCAEjBV,IAgBTa,yBAAyBC,EAAS,IA0BjC,OAxBIA,EAAOC,QAEV7C,KAAK8C,oBAGFC,MAAMC,QAAQJ,EAAOK,QAExBL,EAAOK,MAAM3B,QAAS4B,IACH,SAAdA,EAAKC,KAERnD,KAAKoD,gBAAgBF,EAAK9C,QAEJ,UAAd8C,EAAKC,MAEbnD,KAAKqD,qBAAqBH,EAAK9C,UAK9BwC,EAAOU,QAEVtD,KAAKuD,oBAGCvD,KAGRoD,gBAAgBhD,GAIf,OAFAe,MAAIqC,+CAAOxD,WAAyBI,GAASJ,KAAKe,WAAWG,qBAEtDlB,KAGRqD,qBAAqBjD,GAIpB,OAFAe,MAAIqC,+CAAOxD,WAA8BI,GAASJ,KAAKe,WAAWG,qBAE3DlB,KAGR8C,oBAIC,OAFA3B,MAAIM,gDAAQzB,aAA8BA,KAAKe,WAAWG,qBAEnDlB,KAGRuD,oBAIC,OAFApC,MAAIqC,+CAAOxD,aAA8BA,KAAKe,WAAWG,qBAElDlB"}