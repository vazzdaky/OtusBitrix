{"version":3,"file":"user-mini-profile.bundle.js","sources":["../src/classes/backend.js","../src/classes/initial-param-service.js","../src/components/divider/divider.js","../src/components/error-state/const.js","../src/components/error-state/error-state.js","../src/components/loader/loader.js","../src/components/loader-transition/loader-transition.js","../src/mixins/button-mixin.js","../src/mixins/icon-set-mixin.js","../src/mixins/loc-mixin.js","../src/components/structure-view/components/connector/department-connector.js","../src/classes/open-action-service.js","../src/components/structure-view/components/department-block/department-block.js","../src/components/structure-view/components/department-block/locked-department-block.js","../src/components/structure-view/components/department-spacer.js","../src/components/structure-view/const.js","../src/components/structure-view/structure-view.js","../src/components/structure-view-list/structure-view-list.js","../src/components/transition-collapse/transition-collapse.js","../src/classes/chat-service.js","../src/components/user-base-info/components/user-role/const.js","../src/components/user-base-info/components/user-role/user-role.js","../src/components/user-base-info/components/user-status-icon/const.js","../src/components/user-base-info/components/user-status-icon/user-status-icon.js","../src/components/user-base-info/components/user-status-description/const.js","../src/type.js","../src/components/user-base-info/components/user-status-description/user-status-description.js","../src/components/user-base-info/components/user-time/user-time.js","../src/components/user-base-info/const.js","../src/components/user-base-info/user-base-info.js","../src/components/user-detailed-info/components/user-detailed-info-contact-item-value/user-detailed-info-contact-item-value.js","../src/components/user-detailed-info/components/user-detailed-info-item/user-detailed-info-item.js","../src/components/user-detailed-info/components/entity-menu-item/entity-menu-item.js","../src/components/user-detailed-info/components/user-detailed-info-entity-list-value/user-detailed-info-entity-list-value.js","../src/components/user-detailed-info/user-detailed-info.js","../src/components/app.js","../src/utils/tracking.js","../src/user-mini-profile.js","../src/user-mini-profile-manager.js"],"sourcesContent":["import { ajax } from 'main.core';\nimport type { UserMiniProfileData } from '../type';\n\nexport class Backend\n{\n\tstatic load(userId: number): Promise<UserMiniProfileData>\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runAction('intranet.user.miniProfile.load', {\n\t\t\t\tdata: {\n\t\t\t\t\tuserId,\n\t\t\t\t},\n\t\t\t})\n\t\t\t\t.then((result) => {\n\t\t\t\t\tresolve(result.data);\n\t\t\t\t})\n\t\t\t\t.catch((result) => {\n\t\t\t\t\treject(result.errors[0]?.code ?? null);\n\t\t\t\t})\n\t\t\t;\n\t\t});\n\t}\n}\n","type InitialParamType = 'right-side-expand';\n\nexport const InitialParamDict: Record<string, InitialParamType> = {\n\tRightSideExpand: 'right-side-expand',\n};\n\nconst prefix = 'intranet-user-mini-profile';\n\nexport class InitialParamService\n{\n\t// eslint-disable-next-line flowtype/require-return-type\n\tstatic getValue(type: InitialParamType): string\n\t{\n\t\tconst key = this.#getKeyByType(type);\n\n\t\treturn localStorage.getItem(key);\n\t}\n\n\tstatic save(type: InitialParamType, value: string): void\n\t{\n\t\tconst key = this.#getKeyByType(type);\n\t\tif (!Object.values(InitialParamDict).includes(type))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlocalStorage.setItem(key, value);\n\t}\n\n\tstatic #getKeyByType(type: InitialParamType): string\n\t{\n\t\treturn prefix + type;\n\t}\n}\n","import './style.css';\n\n// @vue/component\nexport const Divider = {\n\tname: 'UserMiniProfileDivider',\n\tprops: {\n\t\tisVertical: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"intranet-user-mini-profile__divider\"\n\t\t\t:class=\"isVertical ? '--vertical' : '--horizontal'\"\n\t\t>\n\t\t\t<div class=\"intranet-user-mini-profile__divider-inner\"></div>\n\t\t</div>\n\t`,\n};\n","import { Loc } from 'main.core';\nimport type { ErrorStateType, ErrorStateSetting } from './type';\n\nexport const ErrorStateSettingByType: Record<ErrorStateType, ErrorStateSetting> = {\n\tdefault: {\n\t\tclass: '--default',\n\t\ttitle: Loc.getMessage('INTRANET_USER_MINI_ERROR_STATE_TITLE'),\n\t\tdescription: Loc.getMessage('INTRANET_USER_MINI_ERROR_STATE_DESCRIPTION'),\n\t},\n\t'access-denied': {\n\t\tclass: '--access-denied',\n\t\ttitle: Loc.getMessage('INTRANET_USER_MINI_ERROR_STATE_ACCESS_DENIED_TITLE'),\n\t\tdescription: Loc.getMessage('INTRANET_USER_MINI_ERROR_STATE_ACCESS_DENIED_DESCRIPTION'),\n\t},\n};\n\nexport const ErrorStateDict: Record<string, ErrorStateType> = Object.freeze({\n\tAccessDenied: 'access-denied',\n\tDefault: 'default',\n});\n","import { ErrorStateDict, ErrorStateSettingByType } from './const';\n\n// eslint-disable-next-line no-unused-vars\nimport type { ErrorStateType, ErrorStateSetting } from './type';\n\nimport './style.css';\n\n// @vue/component\nexport const ErrorState = {\n\tname: 'ErrorState',\n\tprops: {\n\t\ttype: {\n\t\t\t/** @type ErrorStateType */\n\t\t\ttype: String,\n\t\t\tdefault: ErrorStateDict.Default,\n\t\t\tvalidator: (value) => {\n\t\t\t\treturn Object.values(ErrorStateDict).includes(value);\n\t\t\t},\n\t\t},\n\t},\n\tcomputed: {\n\t\tsetting(): ?ErrorStateSetting\n\t\t{\n\t\t\treturn ErrorStateSettingByType[this.type] ?? null;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"intranet-user-mini-profile__error-state\"\n\t\t\t:class=\"setting?.class\"\n\t\t>\n\t\t\t<div class=\"intranet-user-mini-profile__error-state-content\">\n\t\t\t\t<div class=\"intranet-user-mini-profile__error-state__icon\"></div>\n\t\t\t\t<div class=\"intranet-user-mini-profile__error-state__title\">\n\t\t\t\t\t{{ setting?.title }}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"intranet-user-mini-profile__error-state__description\">\n\t\t\t\t\t{{ setting?.description }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import './style.css';\n\n// @vue/component\nexport const UserMiniProfileLoader = {\n\tname: 'UserMiniProfileLoader',\n\tprops: {\n\t\tisShort: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"intranet-user-mini-profile-loader\" :class=\"{ '--short': isShort }\"></div>\n\t`,\n};\n","import { Dom } from 'main.core';\nimport { UserMiniProfileLoader } from '../loader/loader';\n\nimport './style.css';\n\n// @vue/component\nexport const LoaderTransition = {\n\tname: 'LoaderTransition',\n\tcomponents: {\n\t\tUserMiniProfileLoader,\n\t},\n\tprops: {\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\tisShowContent: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\tisLoaderShort: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: ['end'],\n\tmethods: {\n\t\tresetSize(): void\n\t\t{\n\t\t\tDom.style(this.$el, {\n\t\t\t\twidth: '',\n\t\t\t\theight: '',\n\t\t\t});\n\t\t},\n\t\tonEnd(): void\n\t\t{\n\t\t\tthis.resetSize();\n\t\t\tthis.$emit('end');\n\t\t},\n\t\tonEnter(el: HTMLElement): void\n\t\t{\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tDom.style(this.$el, {\n\t\t\t\t\twidth: `${el.offsetWidth}px`,\n\t\t\t\t\theight: `${el.offsetHeight}px`,\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tonBeforeLeave(el: HTMLElement): void\n\t\t{\n\t\t\tDom.style(this.$el, {\n\t\t\t\twidth: `${el.offsetWidth}px`,\n\t\t\t\theight: `${el.offsetHeight}px`,\n\t\t\t});\n\t\t},\n\t\tonAfterLeave(): void\n\t\t{\n\t\t\tthis.onEnd();\n\t\t},\n\n\t\tonAfterEnter(): void\n\t\t{\n\t\t\tthis.onEnd();\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<TransitionGroup \n\t\t\tname=\"intranet-user-mini-profile-fade\"\n\t\t\ttag=\"div\"\n\t\t\tclass=\"intranet-user-mini-profile__loader-transition-wrapper\"\n\t\t\t@enter=\"onEnter\"\n\t\t\t@beforeLeave=\"onBeforeLeave\"\n\t\t\t@afterLeave=\"onAfterLeave\"\n\t\t\t@afterEnter=\"onAfterEnter\"\n\t\t>\n\t\t\t<div v-if=\"isLoading\"\n                 class=\"intranet-user-mini-profile__loader-transition-wrapper__loader\"\n\t\t\t\t key=\"loader\"\n\t\t\t>\n\t\t\t\t<UserMiniProfileLoader\n\t\t\t\t   :isShort=\"isLoaderShort\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<slot v-else-if=\"isShowContent\"></slot>\n\t\t</TransitionGroup>\n\t`,\n};\n","import { AirButtonStyle, Button, ButtonIcon, ButtonSize } from 'ui.vue3.components.button';\nimport { BitrixVueComponentProps } from 'ui.vue3';\n\nexport const ButtonMixin: BitrixVueComponentProps = {\n\tcomponents: {\n\t\tButton,\n\t},\n\tcomputed: {\n\t\tbuttonSize: () => ButtonSize,\n\t\tbuttonStyle: () => AirButtonStyle,\n\t\tbuttonIcon: () => ButtonIcon,\n\t},\n};\n","import { Set, Outline } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.outline';\n\n// @vue/mixin\nexport const IconSetMixin = {\n\tcomputed: {\n\t\tset: () => Set,\n\t\toutlineSet: () => Outline,\n\t},\n};\n","import { Loc } from 'main.core';\n\n// @vue/mixin\nexport const LocMixin = {\n\tmethods: {\n\t\tloc(code: string, replacements: ? {[key: string]: string} = null): ?string\n\t\t{\n\t\t\treturn Loc.getMessage(code, replacements);\n\t\t},\n\t\tlocPlural(code: string, value: number, replacements: ? {[key: string]: string} = null): ?string\n\t\t{\n\t\t\treturn Loc.getMessagePlural(code, value, replacements);\n\t\t},\n\t},\n};\n","import './style.css';\n\n// @vue/component\nexport const DepartmentConnector = {\n\tname: 'DepartmentConnector',\n\tprops: {\n\t\ttopBindElement: {\n\t\t\ttype: HTMLElement,\n\t\t\trequired: true,\n\t\t},\n\t\tbottomBindElement: {\n\t\t\ttype: HTMLElement,\n\t\t\trequired: true,\n\t\t},\n\t\toffsetLeft: {\n\t\t\ttype: Number,\n\t\t\tdefault: 11,\n\t\t},\n\t},\n\tcomputed: {\n\t\ttop(): string\n\t\t{\n\t\t\tconst { height } = this.topBindElement.getBoundingClientRect();\n\t\t\tconst value = this.topBindElement.offsetTop + height;\n\n\t\t\treturn `${value}px`;\n\t\t},\n\t\tleft(): string\n\t\t{\n\t\t\tconst value = this.topBindElement.offsetLeft + this.offsetLeft;\n\n\t\t\treturn `${value}px`;\n\t\t},\n\t\theight(): number\n\t\t{\n\t\t\tconst topElementBottom = this.topBindElement.offsetTop + this.topBindElement.offsetHeight;\n\t\t\tconst bottomElementCenter = this.bottomBindElement.offsetTop + this.bottomBindElement.offsetHeight / 2;\n\n\t\t\treturn Math.round(bottomElementCenter - topElementBottom);\n\t\t},\n\t\tpathD(): string\n\t\t{\n\t\t\tconst height = this.height;\n\n\t\t\tconst d = [\n\t\t\t\t'M 1 0',\n\t\t\t\t`V ${height - 5}`,\n\t\t\t\t`C 1 ${height - 3}.2091 2.7909 ${height - 1} 5 ${height - 1}`,\n\t\t\t\t'H 9',\n\t\t\t];\n\n\t\t\treturn d.join('');\n\t\t},\n\t\tviewBox(): string\n\t\t{\n\t\t\treturn `0 0 9 ${this.height}`;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"intranet-user-mini-profile__structure-view-connector\" \n\t\t\t :style=\"{ 'top': top, 'left': left }\"\n\t\t>\n\t\t\t<svg width=\"9\" :height=\"height\" :viewBox=\"viewBox\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t<path :d=\"pathD\" stroke=\"#F0F0F0\"/>\n\t\t\t</svg>\n\t\t</div>\n\t`,\n};\n","import { Type } from 'main.core';\nimport { Structure } from 'humanresources.company-structure.public';\n\nexport class OpenActionService\n{\n\tstatic openStructureNodeId(nodeId: number): void\n\t{\n\t\tStructure?.open({\n\t\t\tfocusNodeId: nodeId,\n\t\t});\n\t}\n\n\tstatic openUserProfile(url: ?string): void\n\t{\n\t\tif (!Type.isStringFilled(url))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.SidePanel.Instance.open(url);\n\t}\n}\n","import { BIcon } from 'ui.icon-set.api.vue';\nimport { Avatar } from 'ui.vue3.components.avatar';\n\nimport { OpenActionService } from '../../../../classes/open-action-service';\nimport { IconSetMixin } from '../../../../mixins/icon-set-mixin';\nimport { LocMixin } from '../../../../mixins/loc-mixin';\n\nimport type { UserData } from '../../../../type';\n\nimport './style.css';\n\n// @vue/component\nexport const DepartmentBlock = {\n\tname: 'DepartmentBlock',\n\tcomponents: {\n\t\tBIcon,\n\t\tAvatar,\n\t},\n\tmixins: [LocMixin, IconSetMixin],\n\tprops: {\n\t\tnodeId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\thighlighted: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\temployeeCount: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tuser: {\n\t\t\t/** @type UserData | null */\n\t\t\ttype: [Object, null],\n\t\t\tdefault: () => {},\n\t\t},\n\t\thead: {\n\t\t\t/** @type UserData | null */\n\t\t\ttype: [Object, null],\n\t\t\tdefault: () => {},\n\t\t},\n\t},\n\tcomputed: {\n\t\temployeeCountTitle(): string\n\t\t{\n\t\t\tconst { employeeCount } = this;\n\n\t\t\treturn this.locPlural('INTRANET_USER_MINI_PROFILE_EMPLOYEES_COUNT', employeeCount, { '#COUNT#': employeeCount });\n\t\t},\n\t\tisShowHead(): boolean\n\t\t{\n\t\t\tconst { head, user } = this;\n\n\t\t\treturn head && head.id !== user?.id;\n\t\t},\n\t},\n\tmethods: {\n\t\tonTitleClick(): void\n\t\t{\n\t\t\tOpenActionService.openStructureNodeId(this.nodeId);\n\t\t},\n\t\tonUserClick(user: UserData): void\n\t\t{\n\t\t\tOpenActionService.openUserProfile(user.url);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"intranet-user-mini-profile__structure-view-department-block\"\n\t\t\t:class=\"{'--highlighted': highlighted }\"\n\t\t>\n\t\t\t<div class=\"intranet-user-mini-profile__structure-view-department-block__title\"\n\t\t\t\t :title=\"title\"\n\t\t\t\t @click=\"onTitleClick\"\n\t\t\t>\n\t\t\t\t<span>{{ title }}</span>\n\t\t\t\t<div class=\"intranet-user-mini-profile__structure-view-department-block__title-chevron\">\n\t\t\t\t\t<div class=\"intranet-user-mini-profile__structure-view-department-block__title-chevron-icon\">\n\t\t\t\t\t\t<BIcon\n\t\t\t\t\t\t\t:name=\"outlineSet.CHEVRON_RIGHT_S\"\n\t\t\t\t\t\t\t:size=\"20\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"intranet-user-mini-profile__structure-view-department-block__employee-count\">\n\t\t\t\t{{ employeeCountTitle }}\n\t\t\t</div>\n\t\t\t<div v-if=\"user\"\n\t\t\t\tclass=\"intranet-user-mini-profile__structure-view-department-block__user\"\n\t\t\t\t@click=\"onUserClick(user)\"\n\t\t\t>\n\t\t\t\t<div class=\"intranet-user-mini-profile__structure-view-department-block__user-avatar\">\n\t\t\t\t\t<Avatar :options=\"{ picPath: user.avatar, size: 28, title: user.name }\"/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"intranet-user-mini-profile__structure-view-department-block__user-info\">\n\t\t\t\t\t<div \n\t\t\t\t\t\tclass=\"intranet-user-mini-profile__structure-view-department-block__user-info__name\"\n\t\t\t\t\t\t:title=\"user.name\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ user.name }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if=\"user.workPosition\"\n\t\t\t\t\t\tclass=\"intranet-user-mini-profile__structure-view-department-block__user-info__position\"\n\t\t\t\t\t\t:title=\"user.workPosition\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ user.workPosition }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-if=\"isShowHead\" \n\t\t\t\tclass=\"intranet-user-mini-profile__structure-view-department-block__head\"\n\t\t\t>\n\t\t\t\t<div class=\"intranet-user-mini-profile__structure-view-department-block__head-title\">\n\t\t\t\t\t{{ loc('INTRANET_USER_MINI_DETAILED_INFO_HEAD') }}\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"intranet-user-mini-profile__structure-view-department-block__head-info\"\n\t\t\t\t\t@click=\"onUserClick(head)\"\n\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"intranet-user-mini-profile__structure-view-department-block__head-info__avatar\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Avatar :options=\"{ picPath: head.avatar, size: 20, title: head.name }\"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"intranet-user-mini-profile__structure-view-department-block__head-info__name\"\n\t\t\t\t\t\t:title=\"head.name\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ head.name }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BIcon } from 'ui.icon-set.api.vue';\n\nimport { IconSetMixin } from '../../../../mixins/icon-set-mixin';\n\nimport './style.css';\n\n// @vue/component\nexport const LockedDepartmentBlock = {\n\tname: 'LockedDepartmentBlock',\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tmixins: [IconSetMixin],\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"intranet-user-mini-profile__structure-view-department-block --locked\"\n\t\t>\n\t\t\t<div class=\"intranet-user-mini-profile__structure-view-department-block-lock\">\n\t\t\t\t<BIcon \n\t\t\t\t\t:size=\"30\" \n\t\t\t\t\t:name=\"outlineSet.LOCK_L\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","export const DepartmentSpacer = {\n\tname: 'DepartmentSpacer',\n\tprops: {\n\t\tvalue: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tisVertical: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\tstyle(): Object\n\t\t{\n\t\t\tconst value = `${this.value}px`;\n\n\t\t\tif (!this.isVertical)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\twidth: value,\n\t\t\t\t\tminWidth: value,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\theight: value,\n\t\t\t\tminHeight: value,\n\t\t\t};\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div :style=\"style\"/>\n\t`,\n};\n","export const LockedDepartment = 'locked-department';\n","import { BIcon } from 'ui.icon-set.api.vue';\n\nimport { IconSetMixin } from '../../mixins/icon-set-mixin';\nimport { LocMixin } from '../../mixins/loc-mixin';\nimport { DepartmentConnector } from './components/connector/department-connector';\nimport { DepartmentBlock } from './components/department-block/department-block';\nimport { LockedDepartmentBlock } from './components/department-block/locked-department-block';\nimport { DepartmentSpacer } from './components/department-spacer';\nimport { LockedDepartment } from './const';\n\n// eslint-disable-next-line no-unused-vars\nimport type { BranchProp, StructureViewListDataType } from './type';\nimport type { DepartmentType, UserData } from '../../type';\n\nimport './style.css';\n\n// @vue/component\nexport const StructureView = {\n\tname: 'StructureView',\n\tcomponents: {\n\t\tBIcon,\n\t\tDepartmentBlock,\n\t\tLockedDepartmentBlock,\n\t\tDepartmentConnector,\n\t\tDepartmentSpacer,\n\t},\n\tmixins: [LocMixin, IconSetMixin],\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tbranch: {\n\t\t\t/** @type BranchProp */\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\theadDictionary: {\n\t\t\t/** @type HeadDictionary */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tuserDepartmentId: {\n\t\t\ttype: Number,\n\t\t\tdefault: null,\n\t\t},\n\t\tuser: {\n\t\t\t/** @type UserData | null */\n\t\t\ttype: Object,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\tdata(): StructureViewListDataType\n\t{\n\t\treturn {\n\t\t\tblocks: [],\n\t\t\tconnectorBindElementPairs: [],\n\t\t};\n\t},\n\tcomputed: {\n\t\tLockedDepartment: () => LockedDepartment,\n\t},\n\tmounted(): void\n\t{\n\t\tthis.$nextTick((): void => {\n\t\t\tthis.makeConnectors();\n\t\t});\n\t},\n\tmethods: {\n\t\tmakeConnectors(): void\n\t\t{\n\t\t\tthis.connectorBindElementPairs = [];\n\n\t\t\tconst connectorCount = this.blocks.length - 2;\n\n\t\t\tfor (let i = 0; i <= connectorCount; ++i)\n\t\t\t{\n\t\t\t\tconst topBlock = this.blocks[i].$el;\n\t\t\t\tconst bottomBlock = this.blocks[i + 1].$el;\n\n\t\t\t\tthis.connectorBindElementPairs.push([topBlock, bottomBlock]);\n\t\t\t}\n\t\t},\n\t\tgetHeadForDepartment(department: DepartmentType): UserData | null\n\t\t{\n\t\t\tconst { id: departmentId } = department;\n\t\t\tif (departmentId !== this.userDepartmentId)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst { headIds } = department;\n\t\t\tconst userIsHead = headIds.includes(this.user.id);\n\t\t\tif (userIsHead)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst firstHeadId = headIds[0];\n\t\t\tif (!firstHeadId)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.headDictionary[firstHeadId] ?? null;\n\t\t},\n\t\tgetUserForDepartment(department: DepartmentType): UserData | null\n\t\t{\n\t\t\tconst { id: departmentId } = department;\n\t\t\tif (departmentId === this.userDepartmentId)\n\t\t\t{\n\t\t\t\treturn this.user;\n\t\t\t}\n\n\t\t\tconst { headIds } = department;\n\n\t\t\tconst firstHeadId = headIds[0];\n\t\t\tif (!firstHeadId)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.headDictionary[firstHeadId] ?? null;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"intranet-user-mini-profile__structure-view\">\n\t\t\t<div class=\"intranet-user-mini-profile__structure-view__title\">\n\t\t\t\t<div class=\"intranet-user-mini-profile__structure-view__title-icon\">\n\t\t\t\t\t<BIcon :name=\"outlineSet.COMPANY\" :size=\"18\"/>\n\t\t\t\t</div>\n\t\t\t\t<span>{{ title }}</span>\n\t\t\t</div>\n\t\t\t<div class=\"intranet-user-mini-profile__structure-view__preview\" v-if=\"branch.length\">\n\t\t\t\t<div v-for=\"(department, index) in branch\"\n\t\t\t\t\t class=\"intranet-user-mini-profile__structure-view__preview-row\"\n\t\t\t\t>\n\t\t\t\t\t<DepartmentSpacer :value=\"index * 20\"/>\n\t\t\t\t\t<template v-if=\"department === LockedDepartment\">\n\t\t\t\t\t\t<LockedDepartmentBlock\n\t\t\t\t\t\t\t:ref=\"el => { blocks[index] = el}\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<DepartmentBlock\n\t\t\t\t\t\t\t:ref=\"el => { blocks[index] = el}\"\n\t\t\t\t\t\t\t:key=\"'department-' + department.id\"\n\t\t\t\t\t\t\t:title=\"department.title\"\n\t\t\t\t\t\t\t:nodeId=\"department.id\"\n\t\t\t\t\t\t\t:employee-count=\"department.employeeCount\"\n\t\t\t\t\t\t\t:user=\"getUserForDepartment(department)\"\n\t\t\t\t\t\t\t:head=\"getHeadForDepartment(department)\"\n\t\t\t\t\t\t\t:highlighted=\"department.id === userDepartmentId\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\t\t\t\t<template\n\t\t\t\t\tv-for=\"elementPair in connectorBindElementPairs\"\n\t\t\t\t>\n\t\t\t\t\t<DepartmentConnector\n\t\t\t\t\t\t:topBindElement=\"elementPair[0]\"\n\t\t\t\t\t\t:bottomBindElement=\"elementPair[1]\"\n\t\t\t\t\t\t:offsetLeft=\"11\"\n\t\t\t\t\t/>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BIcon } from 'ui.icon-set.api.vue';\n\nimport { ButtonMixin } from '../../mixins/button-mixin';\nimport { IconSetMixin } from '../../mixins/icon-set-mixin';\nimport { StructureView } from '../structure-view/structure-view';\nimport { LockedDepartment } from '../structure-view/const';\n\nimport type { LockedDepartmentType } from '../structure-view/type';\nimport type { StructureViewListDataType } from './type';\nimport type { DepartmentType } from '../../type';\n\nimport './style.css';\n\nconst StructureViewListAnimation = Object.freeze({\n\tnext: 'intranet-user-mini-profile-structure-view-carousel-next',\n\tprev: 'intranet-user-mini-profile-structure-view-carousel-prev',\n});\n\nconst maxElementsInBranch = 3;\n\n// @vue/component\nexport const StructureViewList = {\n\tname: 'StructureViewList',\n\tcomponents: {\n\t\tStructureView,\n\t\tBIcon,\n\t},\n\tmixins: [IconSetMixin, ButtonMixin],\n\tprops: {\n\t\tstructure: {\n\t\t\t/** @type StructureType */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tuser: {\n\t\t\t/** @type UserData */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): StructureViewListDataType\n\t{\n\t\treturn {\n\t\t\tindex: 0,\n\t\t\tanimationName: '',\n\t\t\tisTransitionInProgress: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tisPrevDisabled(): boolean\n\t\t{\n\t\t\treturn this.isTransitionInProgress || this.index === 0;\n\t\t},\n\t\tisNextDisabled(): boolean\n\t\t{\n\t\t\treturn this.isTransitionInProgress || this.index >= this.structure.userDepartmentIds.length - 1;\n\t\t},\n\t\thasManyUserDepartments(): boolean\n\t\t{\n\t\t\treturn this.structure.userDepartmentIds.length > 1;\n\t\t},\n\t\tmaxBranchHeight(): number\n\t\t{\n\t\t\tlet result = 0;\n\n\t\t\tfor (const departmentId of this.structure.userDepartmentIds)\n\t\t\t{\n\t\t\t\tconst departmentBranchHeight = this.makeDepartmentBranch(departmentId).length;\n\t\t\t\tif (departmentBranchHeight === maxElementsInBranch)\n\t\t\t\t{\n\t\t\t\t\treturn maxElementsInBranch;\n\t\t\t\t}\n\n\t\t\t\tresult = Math.max(result, departmentBranchHeight);\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\tmissingMaxDepartmentCount(): number\n\t\t{\n\t\t\treturn maxElementsInBranch - this.maxBranchHeight;\n\t\t},\n\t},\n\tmethods: {\n\t\tmakeDepartmentBranch(departmentId: number): Array<DepartmentType | LockedDepartmentType>\n\t\t{\n\t\t\tconst { departmentDictionary } = this.structure;\n\t\t\tconst department = departmentDictionary[departmentId];\n\t\t\tif (!department)\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tconst branch = [];\n\n\t\t\tlet node = department;\n\t\t\twhile (node && branch.length < maxElementsInBranch)\n\t\t\t{\n\t\t\t\tbranch.push(node);\n\n\t\t\t\tif (node.parentId === null)\n\t\t\t\t{\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tnode = departmentDictionary[node.parentId];\n\t\t\t}\n\n\t\t\tif (branch.length < maxElementsInBranch && branch[branch.length - 1].parentId !== 0)\n\t\t\t{\n\t\t\t\tbranch.push(LockedDepartment);\n\t\t\t}\n\n\t\t\treturn branch.reverse();\n\t\t},\n\t\tnext(): void\n\t\t{\n\t\t\tif (this.isNextDisabled)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.animationName = StructureViewListAnimation.next;\n\n\t\t\tthis.index += 1;\n\t\t},\n\t\tprev(): void\n\t\t{\n\t\t\tif (this.isPrevDisabled)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.animationName = StructureViewListAnimation.prev;\n\n\t\t\tthis.index -= 1;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"intranet-user-mini-profile__structure-view-list\">\n\t\t\t<div\n\t\t\t\tclass=\"intranet-user-mini-profile__structure-view-list__preview-zone\"\n\t\t\t\t:class=\"{ '--one-branch': !hasManyUserDepartments }\"\n\t\t\t\t:style=\"{ '--missing-max-department-count': missingMaxDepartmentCount }\"\n\t\t\t>\n\t\t\t\t<TransitionGroup \n\t\t\t\t\ttype=\"transition\" \n\t\t\t\t\t:name=\"animationName\"\n\t\t\t\t\t@beforeEnter=\"isTransitionInProgress = true\"\n\t\t\t\t\t@afterLeave=\"isTransitionInProgress = false\"\n\t\t\t\t>\n\t\t\t\t\t<template v-for=\"(departmentId, index) in structure.userDepartmentIds\">\n\t\t\t\t\t\t<StructureView\n\t\t\t\t\t\t\tstyle=\"height: 100%;\"\n\t\t\t\t\t\t\tv-if=\"index === this.index\"\n\t\t\t\t\t\t\t:title=\"structure.title\"\n\t\t\t\t\t\t\t:branch=\"makeDepartmentBranch(departmentId)\"\n\t\t\t\t\t\t\t:key=\"departmentId\"\n\t\t\t\t\t\t\t:userDepartmentId=\"departmentId\"\n\t\t\t\t\t\t\t:headDictionary=\"structure.headDictionary\"\n\t\t\t\t\t\t\t:user=\"user\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</template>\n\t\t\t\t</TransitionGroup>\n\t\t\t</div>\n\t\t\t<div v-if=\"hasManyUserDepartments\"\n\t\t\t\tclass=\"intranet-user-mini-profile__structure-view-control\"\n\t\t\t>\n\t\t\t\t<Button \n\t\t\t\t\t:leftIcon=\"buttonIcon.CHEVRON_LEFT_S\"\n\t\t\t\t\t:style=\"buttonStyle.PLAIN_NO_ACCENT\"\n\t\t\t\t\t:size=\"buttonSize.EXTRA_SMALL\"\n\t\t\t\t\t:removeRightCorners=\"true\"\n\t\t\t\t\t:disabled=\"isPrevDisabled\"\n\t\t\t\t\t@click=\"prev\"\n\t\t\t\t/>\n\t\t\t\t<Button \n\t\t\t\t\t:leftIcon=\"buttonIcon.CHEVRON_RIGHT_S\"\n\t\t\t\t\t:style=\"buttonStyle.PLAIN_NO_ACCENT\"\n\t\t\t\t\t:size=\"buttonSize.EXTRA_SMALL\"\n\t\t\t\t\t:removeLeftCorners=\"true\"\n\t\t\t\t\t:disabled=\"isNextDisabled\"\n\t\t\t\t\t@click=\"next\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Dom } from 'main.core';\n\nimport './style.css';\n\n// @vue/component\nexport const CollapseTransition = {\n\tname: 'CollapseTransition',\n\tprops: {\n\t\tinitialHeight: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t},\n\t},\n\temits: ['start', 'end'],\n\tcreated(): void\n\t{\n\t\tif (!this.$slots.default)\n\t\t{\n\t\t\tthrow new Error('Slot is required');\n\t\t}\n\t},\n\tmethods: {\n\t\tonEnter(el: HTMLElement): void\n\t\t{\n\t\t\tthis.targetWidth = el.offsetWidth;\n\t\t\tthis.targetHeight = Math.max(el.offsetHeight, this.initialHeight);\n\n\t\t\tconst fromHeight = Math.min(el.offsetHeight, this.initialHeight);\n\n\t\t\tDom.style(el, {\n\t\t\t\twidth: 0,\n\t\t\t\theight: `${fromHeight}px`,\n\t\t\t});\n\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tDom.style(el, {\n\t\t\t\t\twidth: `${this.targetWidth}px`,\n\t\t\t\t\theight: `${this.targetHeight}px`,\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tonBeforeLeave(el: HTMLElement): void\n\t\t{\n\t\t\tconst minHeight = Math.min(this.initialHeight, el.offsetHeight);\n\n\t\t\tDom.style(el, {\n\t\t\t\twidth: `${el.offsetWidth}px`,\n\t\t\t\theight: `${el.offsetHeight}px`,\n\t\t\t});\n\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tDom.style(el, {\n\t\t\t\t\twidth: 0,\n\t\t\t\t\theight: `${minHeight}px`,\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tthis.$emit('start');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Transition\n\t\t\tname=\"intranet-user-mini-profile-collapse\"\n\t\t\t@enter=\"onEnter\"\n\t\t\t@beforeLeave=\"onBeforeLeave\"\n\t\t\t@afterEnter=\"this.$emit('end')\"\n\t\t\t@afterLeave=\"this.$emit('end')\"\n\t\t\t@beforeEnter=\"this.$emit('start')\"\n\t\t>\n\t\t\t<slot></slot>\n\t\t</Transition>\n\t`,\n};\n","import { Messenger } from 'im.public';\n\nexport class ChatService\n{\n\tstatic openMessenger(userId: number): void\n\t{\n\t\tMessenger?.openChat(String(userId));\n\t}\n\n\tstatic call(userId: number, withVideo: boolean): void\n\t{\n\t\tMessenger?.startVideoCall(String(userId), withVideo);\n\t}\n}\n","import { Loc } from 'main.core';\nimport type { UserRole } from '../../../../type';\n\nexport const UserRoleTitleByCode: Record<UserRole, string> = {\n\tshop: Loc.getMessage('INTRANET_USER_MINI_PROFILE_ROLE_SHOP'),\n\temail: Loc.getMessage('INTRANET_USER_MINI_PROFILE_ROLE_EMAIL'),\n\tintegrator: Loc.getMessage('INTRANET_USER_MINI_PROFILE_ROLE_INTEGRATOR'),\n\tvisitor: Loc.getMessage('INTRANET_USER_MINI_PROFILE_ROLE_VISITOR'),\n};\n","import { LocMixin } from '../../../../mixins/loc-mixin';\nimport { UserRoleTitleByCode } from './const';\n\nimport './style.css';\n\n// @vue/component\nexport const UserRole = {\n\tname: 'UserRole',\n\tmixins: [LocMixin],\n\tprops: {\n\t\trole: {\n\t\t\ttype: [String, null],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\ttitle(): ?string\n\t\t{\n\t\t\tif (!this.role)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn UserRoleTitleByCode[this.role] ?? null;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-if=\"title\"\n\t\t\tclass=\"intranet-user-mini-profile__role\"\n\t\t>\n\t\t\t<div class=\"intranet-user-mini-profile__role-inner-text\">\n\t\t\t\t{{ title }}\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Outline } from 'ui.icon-set.api.core';\nimport type { UserStatusType } from '../../../../type';\n\nexport const IconSettingByStatus: Record<UserStatusType, UserStatusIconSetting> = {\n\tonline: {\n\t\ticonName: Outline.EARTH_WITH_CHECK,\n\t\tcolorVar: '--ui-color-accent-main-success',\n\t},\n\toffline: {\n\t\ticonName: Outline.EARTH_WITH_CLOCK,\n\t\tcolorVar: '--ui-color-accent-main-warning',\n\t},\n\tdnd: {\n\t\ticonName: Outline.EARTH_WITH_STOP,\n\t\tcolorVar: '--ui-color-accent-main-alert',\n\t},\n\tvacation: {\n\t\ticonName: Outline.EARTH_WITH_TREE,\n\t\tcolorVar: '--ui-color-accent-extra-aqua',\n\t},\n\tfired: {\n\t\ticonName: Outline.EARTH_WITH_CROSS,\n\t\tcolorVar: '--ui-color-gray-50',\n\t},\n};\n\nexport type UserStatusIconSetting = {\n\ticonName: string,\n\tcolorVar: string,\n};\n","import { BIcon } from 'ui.icon-set.api.vue';\n\nimport { IconSetMixin } from '../../../../mixins/icon-set-mixin';\nimport { IconSettingByStatus } from './const';\n\nimport type { UserStatusIconSetting } from './const';\n\nimport './style.css';\n\n// @vue/component\nexport const UserStatusIcon = {\n\tname: 'UserStatusIcon',\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tmixins: [IconSetMixin],\n\tprops: {\n\t\tstatus: {\n\t\t\t/** @type UserStatusCodeType */\n\t\t\ttype: String,\n\t\t\tdefault: 'offline',\n\t\t},\n\t},\n\tcomputed: {\n\t\ticonSetting(): UserStatusIconSetting | null\n\t\t{\n\t\t\treturn IconSettingByStatus[this.status] ?? null;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-if=\"iconSetting\"\n\t\t\tclass=\"intranet-user-mini-profile__user-status\" \n\t\t\t:style=\"{ '--ui-icon-set__icon-color': 'var(' + iconSetting.colorVar + ')' }\"\n\t\t>\n\t\t\t<BIcon\n\t\t\t\t:size=\"24\"\n\t\t\t\t:name=\"iconSetting.iconName\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Loc } from 'main.core';\nimport type { UserStatusCodeType } from '../../../../type';\n\nexport const StaticDescriptionByStatus: Record<UserStatusCodeType, string> = {\n\tonline: Loc.getMessage('INTRANET_USER_MINI_PROFILE_USER_STATUS_ONLINE'),\n\tdnd: Loc.getMessage('INTRANET_USER_MINI_PROFILE_USER_STATUS_DND'),\n\tfired: Loc.getMessage('INTRANET_USER_MINI_PROFILE_USER_STATUS_FIRED'),\n};\n","export type UserMiniProfileOptions = {\n\tuserId: number,\n\tbindElement: HTMLElement,\n};\nexport type UserRole = 'admin' | 'employee' | 'integrator' | 'collaber' | 'extranet' | 'visitor' | 'email' | 'shop' | 'external';\n\nexport type UserMiniProfileData = {\n\taccess: {\n\t\tcanChat: boolean,\n\t},\n\tbaseInfo: UserData & {\n\t\ttime: string,\n\t\tstatus: UserStatusType,\n\t\tutcOffset: number,\n\t\trole: UserRole | null,\n\t\taccess: {\n\t\t\tcanChat: boolean,\n\t\t},\n\t},\n\tdetailInfo?: {\n\t\tpersonalMobile: string;\n\t\tinnerPhone: string;\n\t\temail: string;\n\t} | null,\n\tstructure?: StructureType | null,\n};\n\nexport type UserData = {\n\tname: string;\n\tworkPosition: string,\n\tavatar: string,\n\tid: number,\n\turl: string,\n}\n\nexport type StructureType = {\n\ttitle: string,\n\tdepartmentDictionary: Record<string, DepartmentType>,\n\tuserDepartmentIds: Array<number>,\n\theadDictionary: HeadDictionary,\n\tteams: Array<TeamType>,\n};\n\nexport type HeadDictionary = Record<string, UserData>;\n\nexport type NodeType = {\n\tid: number,\n\ttitle: string,\n}\n\nexport type DepartmentType = NodeType & {\n\temployeeCount: number,\n\theadIds: Array<number>,\n\tparentId: number | null,\n};\n\nexport type TeamType = NodeType;\n\nexport type UserStatusType = {\n\tcode: UserStatusCodeType,\n\tlastSeenTs?: number | null,\n\tvacationTs?: number | null,\n};\n\nexport type UserStatusCodeType = 'online' | 'offline' | 'dnd' | 'vacation' | 'fired';\nexport const UserStatus = Object.freeze({\n\tOnline: 'online',\n\tOffline: 'offline',\n\tDoNotDisturb: 'dnd',\n\tVacation: 'vacation',\n\tFired: 'fired',\n});\n","import { DateTimeFormat } from 'main.date';\nimport { Type } from 'main.core';\n\nimport { LocMixin } from '../../../../mixins/loc-mixin';\nimport { StaticDescriptionByStatus } from './const';\nimport { UserStatus } from '../../../../type';\n\nimport type { UserStatusType } from '../../../../type';\n\nimport './style.css';\n\n// @vue/component\nexport const UserStatusDescription = {\n\tname: 'UserStatusDescription',\n\tmixins: [LocMixin],\n\tprops: {\n\t\tstatus: {\n\t\t\t/** @type UserStatusType */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\ttext(): string\n\t\t{\n\t\t\tconst staticText = StaticDescriptionByStatus[this.status.code] ?? null;\n\t\t\tif (staticText)\n\t\t\t{\n\t\t\t\treturn staticText;\n\t\t\t}\n\n\t\t\tif (this.status.code === UserStatus.Offline)\n\t\t\t{\n\t\t\t\treturn this.formatTextForOfflineStatus(this.status);\n\t\t\t}\n\n\t\t\tif (this.status.code === UserStatus.Vacation)\n\t\t\t{\n\t\t\t\treturn this.formatTextForVacationStatus(this.status);\n\t\t\t}\n\n\t\t\treturn '';\n\t\t},\n\t},\n\tmethods: {\n\t\tformatTextForOfflineStatus(status: UserStatusType): string\n\t\t{\n\t\t\tif (!Type.isNumber(status.lastSeenTs) || status.lastSeenTs === 0)\n\t\t\t{\n\t\t\t\treturn this.loc('INTRANET_USER_MINI_PROFILE_USER_STATUS_OFFLINE');\n\t\t\t}\n\n\t\t\tconst dayMonthFormat = DateTimeFormat.getFormat('DAY_MONTH_FORMAT');\n\t\t\tconst shortTimeFormat = DateTimeFormat.getFormat('SHORT_TIME_FORMAT');\n\n\t\t\treturn this.loc('INTRANET_USER_MINI_PROFILE_USER_STATUS_OFFLINE_LAST_SEEN_TEMPLATE', {\n\t\t\t\t'#DATE#': DateTimeFormat.format(dayMonthFormat, status.lastSeenTs),\n\t\t\t\t'#TIME#': DateTimeFormat.format(shortTimeFormat, status.lastSeenTs),\n\t\t\t});\n\t\t},\n\t\tformatTextForVacationStatus(status: UserStatusType): string\n\t\t{\n\t\t\tif (!Type.isNumber(status.vacationTs))\n\t\t\t{\n\t\t\t\treturn this.loc('INTRANET_USER_MINI_PROFILE_USER_STATUS_VACATION');\n\t\t\t}\n\n\t\t\tconst dayMonthFormat = DateTimeFormat.getFormat('DAY_MONTH_FORMAT');\n\n\t\t\treturn this.loc('INTRANET_USER_MINI_PROFILE_USER_STATUS_VACATION_TEMPLATE', {\n\t\t\t\t'#DATE#': DateTimeFormat.format(dayMonthFormat, status.vacationTs),\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<span v-if=\"text\"\n\t\t\tclass=\"intranet-user-mini-profile__user-status-description\"\n\t\t>\n\t\t\t{{ text }}\n\t\t</span>\n\t`,\n};\n","import { DateTimeFormat } from 'main.date';\n\nimport { LocMixin } from '../../../../mixins/loc-mixin';\n\nimport './style.css';\n\n// @vue/component\nexport const UserTime = {\n\tname: 'UserTime',\n\tmixins: [LocMixin],\n\tprops: {\n\t\tutcOffset: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): { date: Date, tickInterval: number | null }\n\t{\n\t\treturn {\n\t\t\tdate: new Date(),\n\t\t\ttickInterval: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\tformattedTime(): string\n\t\t{\n\t\t\tconst date = this.date;\n\n\t\t\tconst localOffset = date.getTimezoneOffset() * 60 * 1000;\n\t\t\tconst targetOffset = this.utcOffset * 1000;\n\n\t\t\tconst totalOffset = localOffset + targetOffset;\n\n\t\t\tdate.setTime(date.getTime() + totalOffset);\n\n\t\t\tconst sign = this.utcOffset >= 0 ? '+' : '-';\n\n\t\t\tconst absOffset = Math.abs(this.utcOffset);\n\n\t\t\tconst hours = Math.floor(absOffset / 3600);\n\t\t\tconst minutes = Math.floor((absOffset % 3600) / 60);\n\n\t\t\tconst timezoneParts = [\n\t\t\t\tthis.loc('INTRANET_USER_MINI_PROFILE_USER_TZ_TEMPLATE', {\n\t\t\t\t\t'#VALUE#': `${sign}${hours.toString()}`,\n\t\t\t\t}),\n\t\t\t];\n\n\t\t\tif (minutes > 0)\n\t\t\t{\n\t\t\t\ttimezoneParts.push(`:${minutes.toString().padStart(2, 0)}`);\n\t\t\t}\n\n\t\t\treturn `${timezoneParts.join('')} (${this.formatDate(date)})`;\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tthis.tickInterval = setInterval(() => {\n\t\t\tthis.date = new Date();\n\t\t}, 1000);\n\t},\n\tunmounted(): void\n\t{\n\t\tclearInterval(this.tickInterval);\n\t},\n\n\tmethods: {\n\t\tformatDate(date: Date): string\n\t\t{\n\t\t\tconst template = DateTimeFormat.getFormat('SHORT_TIME_FORMAT');\n\n\t\t\treturn DateTimeFormat.format(template, date);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<span class=\"intranet-user-mini-profile__user-time\">\n\t\t\t{{ formattedTime }}\n\t\t</span>\n\t`,\n};\n","import type { AvatarType } from 'ui.vue3.components.avatar';\nimport type { UserRole } from '../../type';\n\nexport const UserAvatarTypeByRole: Record<UserRole, AvatarType> = Object.freeze({\n\tcollaber: 'round-guest',\n\textranet: 'round-extranet',\n\temployee: 'round',\n});\n","import { BIcon } from 'ui.icon-set.api.vue';\nimport { BMenu, type MenuOptions } from 'ui.vue3.components.menu';\nimport { RichMenuPopup } from 'ui.vue3.components.rich-menu';\nimport { Avatar } from 'ui.vue3.components.avatar';\n\nimport { ChatService } from '../../classes/chat-service';\nimport { OpenActionService } from '../../classes/open-action-service';\nimport { IconSetMixin } from '../../mixins/icon-set-mixin';\nimport { LocMixin } from '../../mixins/loc-mixin';\nimport { PopupPrefixId } from '../../user-mini-profile';\nimport { UserRole } from './components/user-role/user-role';\nimport { UserStatusIcon } from './components/user-status-icon/user-status-icon';\nimport { UserStatusDescription } from './components/user-status-description/user-status-description';\nimport { UserTime } from './components/user-time/user-time';\nimport { UserAvatarTypeByRole } from './const';\nimport { UserStatus as UserStatusDict } from '../../type';\n\nimport type { UserBaseInfoDataType } from './type';\n\nimport './style.css';\n\n// @vue/component\nexport const UserBaseInfo = {\n\tname: 'UserBaseInfo',\n\tcomponents: {\n\t\tBIcon,\n\t\tUserRole,\n\t\tUserStatusIcon,\n\t\tUserStatusDescription,\n\t\tRichMenuPopup,\n\t\tUserTime,\n\t\tAvatar,\n\t\tBMenu,\n\t},\n\tmixins: [LocMixin, IconSetMixin],\n\tprops: {\n\t\tisShowExpand: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tisExpanded: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\tuserId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tinfo: {\n\t\t\t/** @type UserMiniProfileData['baseInfo'] */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tcanChat: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: ['expand'],\n\tdata(): UserBaseInfoDataType\n\t{\n\t\treturn {\n\t\t\tisShowCallMenu: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tcallMenuPopupOptions(): MenuOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tid: `${PopupPrefixId}call-menu`,\n\t\t\t\tautoHide: true,\n\t\t\t\tbindElement: this.$refs.callActionMenu,\n\t\t\t\tbindOptions: { forceBindPosition: true },\n\t\t\t\tminWidth: 190,\n\t\t\t\twidth: 190,\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: this.loc('INTRANET_USER_MINI_PROFILE_ACTION_CALL_WITH_VIDEO'),\n\t\t\t\t\t\ticon: this.outlineSet.RECORD_VIDEO,\n\t\t\t\t\t\tonClick: () => this.onCallMenuItemClick(),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: this.loc('INTRANET_USER_MINI_PROFILE_ACTION_CALL'),\n\t\t\t\t\t\ticon: this.outlineSet.HEADSET,\n\t\t\t\t\t\tonClick: () => this.onCallMenuItemClick(false),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t};\n\t\t},\n\t\tshouldShowUserTime(): boolean\n\t\t{\n\t\t\treturn [UserStatusDict.Online, UserStatusDict.DoNotDisturb].includes(this.info.status.code);\n\t\t},\n\t\tavatarType(): string\n\t\t{\n\t\t\treturn UserAvatarTypeByRole[this.info.role] ?? 'round';\n\t\t},\n\t},\n\tmethods: {\n\t\topenChat(): void\n\t\t{\n\t\t\tChatService.openMessenger(this.userId);\n\t\t},\n\t\tcall(withVideo: boolean = true): void\n\t\t{\n\t\t\tChatService.call(this.userId, withVideo);\n\t\t},\n\t\tonCallMenuItemClick(withVideo: boolean = true): void\n\t\t{\n\t\t\tthis.isShowCallMenu = false;\n\t\t\tthis.call(withVideo);\n\t\t},\n\t\topenProfile(): void\n\t\t{\n\t\t\tOpenActionService.openUserProfile(this.info.url);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"intranet-user-mini-profile__base-info\">\n\t\t\t<div class=\"intranet-user-mini-profile__base-info__user\">\n\t\t\t\t<div class=\"intranet-user-mini-profile__base-info__user-avatar-wrapper\">\n\t\t\t\t\t<div \n\t\t\t\t\t\tclass=\"intranet-user-mini-profile__base-info__user-avatar\"\n\t\t\t\t\t\t@click=\"openProfile\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Avatar \n\t\t\t\t\t\t\t:type=\"avatarType\"\n\t\t\t\t\t\t\t:options=\"{ userName: info.name, size: 72, title: info.name, picPath: info.avatar }\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<UserStatusIcon v-if=\"info.status\" \n\t\t\t\t\t\t:status=\"info.status.code\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"intranet-user-mini-profile__base-info__user-data\">\n\t\t\t\t\t<div class=\"intranet-user-mini-profile__base-info__user-data__name\"\n\t\t\t\t\t\t :title=\"info.name\"\n\t\t\t\t\t\t @click=\"openProfile\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ info.name }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"intranet-user-mini-profile__base-info__user-data__position\"\n\t\t\t\t\t\t :title=\"info.workPosition\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ info.workPosition }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"intranet-user-mini-profile__base-info__user-data__status\">\n\t\t\t\t\t\t<UserStatusDescription v-if=\"info.status\"\n\t\t\t\t\t\t\t:status=\"info.status\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<UserTime v-if=\"shouldShowUserTime\" \n\t\t\t\t\t\t\t:utcOffset=\"info.utcOffset\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-if=\"canChat\"\n\t\t\t\tclass=\"intranet-user-mini-profile__base-info__actions\"\n\t\t\t>\n\t\t\t\t<div class=\"intranet-user-mini-profile__base-info__action\">\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"ui-btn ui-btn-sm ui-btn-no-caps --air --wide --style-outline-accent-2\"\n\t\t\t\t\t\t@click=\"openChat\"\n\t\t\t\t\t>\n\t\t\t\t\t<span class=\"ui-btn-text\">\n\t\t\t\t\t\t{{ loc('INTRANET_USER_MINI_PROFILE_ACTION_CHAT') }}\n\t\t\t\t\t</span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"intranet-user-mini-profile__base-info__action\">\n\t\t\t\t\t<div class=\"ui-btn-split --air ui-btn-sm --style-filled ui-btn-no-caps\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"ui-btn-main --air\"\n\t\t\t\t\t\t\t@click=\"call()\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span class=\"ui-btn-text\">\n\t\t\t\t\t\t\t\t{{ loc('INTRANET_USER_MINI_PROFILE_ACTION_CALL_WITH_VIDEO') }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tref=\"callActionMenu\"\n\t\t\t\t\t\t\tclass=\"ui-btn-menu\"\n\t\t\t\t\t\t\t@click=\"isShowCallMenu = !isShowCallMenu\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<BMenu v-if=\"isShowCallMenu\"\n\t\t\t\t\t\t\t\t:options=\"callMenuPopupOptions\"\n\t\t\t\t\t\t\t\t@close=\"isShowCallMenu = false\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-if=\"isShowExpand\"\n\t\t\t\tclass=\"intranet-user-mini-profile__expand\"\n\t\t\t\t@click=\"() => $emit('expand')\"\n\t\t\t>\n\t\t\t\t<BIcon :name=\"!isExpanded ? outlineSet.OPEN_CHAT : outlineSet.CLOSE_CHAT\"/>\n\t\t\t</div>\n\t\t\t<div class=\"intranet-user-mini-profile__base-info__role\">\n\t\t\t\t<UserRole \n\t\t\t\t\t:role=\"info.role\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { UI } from 'ui.notification';\n\nimport './style.css';\n\ntype ContactItemType = 'mail' | 'phone';\nconst ContactItem: Record<string, ContactItemType> = Object.freeze({\n\tMail: 'mail',\n\tPhone: 'phone',\n});\n\n// @vue/component\nexport const UserDetailedInfoContactItemValue = {\n\tname: 'UserDetailedInfoContactItemValue',\n\tprops: {\n\t\ttype: {\n\t\t\t/** @type ContactItemType */\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tvalue: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\thref(): string\n\t\t{\n\t\t\tif (this.type === ContactItem.Mail)\n\t\t\t{\n\t\t\t\treturn `mailto:${this.value}`;\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t},\n\tmethods: {\n\t\tonClick(event: Event): void\n\t\t{\n\t\t\tif (this.type === ContactItem.Phone)\n\t\t\t{\n\t\t\t\tevent.preventDefault();\n\t\t\t\tif (navigator.clipboard)\n\t\t\t\t{\n\t\t\t\t\tnavigator.clipboard.writeText(this.value)\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\t\t\tcontent: this.$Bitrix.Loc.getMessage('INTRANET_USER_MINI_PROFILE_ACTION_CLIPBOARD_COPY_PHONE_SUCCESS'),\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(() => {\n\t\t\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\t\t\tcontent: this.$Bitrix.Loc.getMessage('INTRANET_USER_MINI_PROFILE_ACTION_CLIPBOARD_COPY_PHONE_ERROR'),\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: this.$Bitrix.Loc.getMessage('INTRANET_USER_MINI_PROFILE_ACTION_CLIPBOARD_COPY_PHONE_ERROR'),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<a \n\t\t\tclass=\"intranet-user-mini-profile__detailed-info__contact-item-value\"\n\t\t\t:href=\"href\"\n\t\t\ttarget\n\t\t\t@click=\"onClick\"\n\t\t> \n\t\t\t{{ value }}\n\t\t</a>\n\t`,\n};\n","import './style.css';\n\n// @vue/component\nexport const UserDetailedInfoItem = {\n\tname: 'UserDetailedInfoItem',\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"intranet-user-mini-profile__detailed-info-item\">\n\t\t\t<div class=\"intranet-user-mini-profile__detailed-info-item__title\">\n\t\t\t\t{{ title }}\n\t\t\t</div>\n\t\t\t<div class=\"intranet-user-mini-profile__detailed-info-item__value\">\n\t\t\t\t<slot></slot>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BIcon } from 'ui.icon-set.api.vue';\nimport { Avatar } from 'ui.vue3.components.avatar';\n\nimport { IconSetMixin } from '../../../../mixins/icon-set-mixin';\n\nimport './style.css';\n\n// eslint-disable-next-line no-unused-vars\ntype ImageProp = {\n\ttitle?: string,\n\tbIconName?: string,\n\timageSrc?: string,\n\ticonClass?: string,\n};\n\n// @vue/component\nexport const EntityMenuItem = {\n\tcomponents: {\n\t\tBIcon,\n\t\tAvatar,\n\t},\n\tmixins: [IconSetMixin],\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\timage: {\n\t\t\t/** @type ImageProp */\n\t\t\ttype: Object,\n\t\t\tdefault: () => ({}),\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"intranet-user-mini-profile__entity-menu-item\">\n\t\t\t<div class=\"intranet-user-mini-profile__entity-menu-item-content\">\n\t\t\t\t<div v-if=\"image\"\n\t\t\t\t\tclass=\"intranet-user-mini-profile__entity-menu-item__icon\"\n\t\t\t\t\t:class=\"image.iconClass ?? null\"\n\t\t\t\t>\n\t\t\t\t\t<BIcon v-if=\"image.bIconName\" \n\t\t\t\t\t\t:name=\"image.bIconName\"\n\t\t\t\t\t\t:size=\"18\"\n\t\t\t\t\t/>\n\t\t\t\t\t<Avatar v-else\n\t\t\t\t\t\t:options=\"{ size: 24, title, picPath: image.imageSrc }\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div \n\t\t\t\t\tclass=\"intranet-user-mini-profile__entity-menu-item__title\"\n\t\t\t\t\t:title=\"title\"\n\t\t\t\t>\n\t\t\t\t\t{{ title }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Type } from 'main.core';\nimport { RichMenuPopup } from 'ui.vue3.components.rich-menu';\nimport { type PopupOptions } from 'main.popup';\n\nimport { PopupPrefixId } from '../../../../user-mini-profile';\nimport { EntityMenuItem } from '../entity-menu-item/entity-menu-item';\n\nimport './style.css';\n\n// @vue/component\nexport const UserDetailedInfoEntityListValue = {\n\tname: 'UserDetailedInfoEntityListValue',\n\tcomponents: {\n\t\tRichMenuPopup,\n\t\tEntityMenuItem,\n\t},\n\tprops: {\n\t\titems: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tentityType: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\temits: ['click'],\n\n\tdata(): { isMenuShow: boolean }\n\t{\n\t\treturn {\n\t\t\tisMenuShow: false,\n\t\t};\n\t},\n\n\tcomputed: {\n\t\tpopupOptions(): PopupOptions\n\t\t{\n\t\t\tconst formatPopupId = (type: String) => {\n\t\t\t\treturn Type.isStringFilled(type) ? `${PopupPrefixId}entity-list-${type}` : undefined;\n\t\t\t};\n\n\t\t\treturn {\n\t\t\t\tid: formatPopupId(this.entityType),\n\t\t\t\tbindElement: this.$refs.counter,\n\t\t\t\twidth: 240,\n\t\t\t\tmaxHeight: 270,\n\t\t\t\tautoHide: true,\n\t\t\t};\n\t\t},\n\t\tfirstItem(): { id?: number, title?: string } | null\n\t\t{\n\t\t\treturn this.items[0] ?? null;\n\t\t},\n\t\tisCounterShow(): boolean\n\t\t{\n\t\t\treturn this.items.length > 1;\n\t\t},\n\t\tcounterTitle(): string\n\t\t{\n\t\t\treturn this.items.length - 1;\n\t\t},\n\t},\n\n\tmethods: {\n\t\topenMenu(): void\n\t\t{\n\t\t\tthis.isMenuShow = true;\n\t\t},\n\t\tonElementClick(id: ?number): void\n\t\t{\n\t\t\tthis.$emit('click', id);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"intranet-user-mini-profile__user-detailed-info__list-value\" v-if=\"items.length\">\n\t\t\t<div class=\"intranet-user-mini-profile__user-detailed-info__list-value__element-container\">\n\t\t\t\t\t<div v-if=\"this.$slots.default\"\n\t\t\t\t\t\tclass=\"intranet-user-mini-profile__user-detailed-info__list-value__before-element\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<slot \n\t\t\t\t\t\t\t:item=\"firstItem\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</slot>\n\t\t\t\t\t</div>\n\t\t\t\t<div class=\"intranet-user-mini-profile__user-detailed-info__list-value__element\">\n\t\t\t\t\t<a\n\t\t\t\t\t\tclass=\"intranet-user-mini-profile__user-detailed-info__list-value__element-text\"\n\t\t\t\t\t\t:title=\"firstItem.title\"\n\t\t\t\t\t\t@click=\"onElementClick(firstItem.id)\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ firstItem.title }}\n\t\t\t\t\t</a>\n\t\t\t\t\t<div v-if=\"isCounterShow\"\n\t\t\t\t\t\t class=\"intranet-user-mini-profile__user-detailed-info__list-value__counter ui-counter\"\n\t\t\t\t\t\t ref=\"counter\"\n\t\t\t\t\t\t @click=\"openMenu\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"ui-counter-inner\">\n\t\t\t\t\t\t\t+{{ counterTitle }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<RichMenuPopup v-if=\"isMenuShow\"\n\t\t\t\tclass=\"intranet-user-mini-profile__user-detailed-info__list-value__entity-menu\"\n\t\t\t\t:popup-options=\"popupOptions\"\n\t\t\t\t@close=\"isMenuShow = false\"\n\t\t\t>\n\t\t\t\t<EntityMenuItem v-for=\"item in items\"\n\t\t\t\t\t:title=\"item.title\"\n\t\t\t\t\t:image=\"item.image\"\n\t\t\t\t\t@click=\"onElementClick(item.id)\"\n\t\t\t\t/>\n\t\t\t</RichMenuPopup>\n\t\t</div>\n\t`,\n};\n","import { BIcon } from 'ui.icon-set.api.vue';\n\nimport { OpenActionService } from '../../classes/open-action-service';\nimport { IconSetMixin } from '../../mixins/icon-set-mixin';\nimport { LocMixin } from '../../mixins/loc-mixin';\nimport { UserDetailedInfoContactItemValue } from './components/user-detailed-info-contact-item-value/user-detailed-info-contact-item-value';\nimport { UserDetailedInfoItem } from './components/user-detailed-info-item/user-detailed-info-item';\nimport { UserDetailedInfoEntityListValue } from './components/user-detailed-info-entity-list-value/user-detailed-info-entity-list-value';\n\nimport type { DepartmentType } from '../../type';\n\nimport './style.css';\n\n// @vue/component\nexport const UserDetailedInfo = {\n\tname: 'UserDetailedInfo',\n\tcomponents: {\n\t\tBIcon,\n\t\tUserDetailedInfoItem,\n\t\tUserDetailedInfoContactItemValue,\n\t\tUserDetailedInfoEntityListValue,\n\t},\n\tmixins: [LocMixin, IconSetMixin],\n\tprops: {\n\t\tinfo: {\n\t\t\t/** @type UserMiniProfileData['detailInfo'] */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\theads: {\n\t\t\t/** @type Array<UserInfo> */\n\t\t\ttype: Array,\n\t\t\tdefault: () => [],\n\t\t},\n\t\tuserDepartments: {\n\t\t\t/** @type Array<DepartmentType> */\n\t\t\ttype: Array,\n\t\t\tdefault: () => [],\n\t\t},\n\t\tdepartments: {\n\t\t\t/** @type Array<DepartmentType> */\n\t\t\ttype: Array,\n\t\t\tdefault: () => [],\n\t\t},\n\t\tteams: {\n\t\t\t/** @type Array<TeamType> */\n\t\t\ttype: Array,\n\t\t\tdefault: () => [],\n\t\t},\n\t},\n\tcomputed: {\n\t\tdepartmentItems(): Array<{ id: number, title: string }>\n\t\t{\n\t\t\treturn this.userDepartments.map((department) => ({\n\t\t\t\tid: department.id,\n\t\t\t\ttitle: department.title,\n\t\t\t\tparentId: department.parentId,\n\t\t\t\timage: {\n\t\t\t\t\tbIconName: this.outlineSet.GROUP,\n\t\t\t\t\ticonClass: '--department',\n\t\t\t\t},\n\t\t\t}));\n\t\t},\n\t\theadItems(): Array<{ id: number, title: string }>\n\t\t{\n\t\t\treturn this.heads.map((head) => ({\n\t\t\t\tid: head.id,\n\t\t\t\ttitle: head.name,\n\t\t\t\timage: {\n\t\t\t\t\timageSrc: head.avatar,\n\t\t\t\t},\n\t\t\t\thref: head.url,\n\t\t\t}));\n\t\t},\n\t\tteamItems(): Array<{ id: number, title: string }>\n\t\t{\n\t\t\treturn this.teams.map((team) => ({\n\t\t\t\tid: team.id,\n\t\t\t\ttitle: team.title,\n\t\t\t\timage: {\n\t\t\t\t\tbIconName: this.outlineSet.MY_PLAN,\n\t\t\t\t\ticonClass: '--team',\n\t\t\t\t},\n\t\t\t}));\n\t\t},\n\t\theadTitle(): string\n\t\t{\n\t\t\treturn this.headItems.length < 2\n\t\t\t\t? this.loc('INTRANET_USER_MINI_DETAILED_INFO_HEAD')\n\t\t\t\t: this.loc('INTRANET_USER_MINI_DETAILED_INFO_HEAD_MULTIPLE')\n\t\t\t;\n\t\t},\n\t\tteamTitle(): string\n\t\t{\n\t\t\treturn this.teamItems.length < 2\n\t\t\t\t? this.loc('INTRANET_USER_MINI_DETAILED_INFO_FC_SINGLE')\n\t\t\t\t: this.loc('INTRANET_USER_MINI_DETAILED_INFO_FC')\n\t\t\t;\n\t\t},\n\t\tdepartmentTitle(): string\n\t\t{\n\t\t\treturn this.departmentItems.length < 2\n\t\t\t\t? this.loc('INTRANET_USER_MINI_DETAILED_INFO_DEPARTMENT')\n\t\t\t\t: this.loc('INTRANET_USER_MINI_DETAILED_INFO_DEPARTMENT_MULTIPLE')\n\t\t\t;\n\t\t},\n\t},\n\tmethods: {\n\t\tonHeadClicked(id: number): void\n\t\t{\n\t\t\tconst head = this.heads.find((item) => item.id === id);\n\t\t\tif (head?.url)\n\t\t\t{\n\t\t\t\tOpenActionService.openUserProfile(head.url);\n\t\t\t}\n\t\t},\n\t\tonStructureNodeClicked(id: number): void\n\t\t{\n\t\t\tOpenActionService.openStructureNodeId(id);\n\t\t},\n\t\tgetParentDepartmentById(id: number): ?DepartmentType\n\t\t{\n\t\t\treturn this.departments.find((item) => item.id === id);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"intranet-user-mini-profile__detailed-info\">\n\t\t\t<UserDetailedInfoItem v-if=\"info.personalMobile\"\n\t\t\t\t:title=\"loc('INTRANET_USER_MINI_DETAILED_INFO_PERSONAL_MOBILE')\"\n\t\t\t>\n\t\t\t\t<UserDetailedInfoContactItemValue :value=\"info.personalMobile\" type=\"phone\"/>\n\t\t\t</UserDetailedInfoItem>\n\t\t\t<UserDetailedInfoItem v-if=\"info.innerPhone\"\n\t\t\t\t:title=\"loc('INTRANET_USER_MINI_DETAILED_INFO_PHONE_INNER')\"\n\t\t\t>\n\t\t\t\t{{ info.innerPhone }}\n\t\t\t</UserDetailedInfoItem>\n\t\t\t<UserDetailedInfoItem v-if=\"info.email\"\n\t\t\t\t:title=\"loc('INTRANET_USER_MINI_DETAILED_INFO_EMAIL')\"\n\t\t\t>\n\t\t\t\t<UserDetailedInfoContactItemValue :value=\"info.email\" type=\"mail\"/>\n\t\t\t</UserDetailedInfoItem>\n\t\t\t<UserDetailedInfoItem v-if=\"headItems.length\"\n\t\t\t\t:title=\"headTitle\"\n\t\t\t>\n\t\t\t\t<UserDetailedInfoEntityListValue\n\t\t\t\t\tentityType=\"user\"\n\t\t\t\t\t:items=\"headItems\"\n\t\t\t\t\t@click=\"(id) => onHeadClicked(id)\"\n\t\t\t\t/>\n\t\t\t</UserDetailedInfoItem>\n\t\t\t<UserDetailedInfoItem v-if=\"departmentItems.length\"\n\t\t\t\t:title=\"departmentTitle\"\n\t\t\t>\n\t\t\t\t<UserDetailedInfoEntityListValue \n\t\t\t\t\t:items=\"departmentItems\"\n\t\t\t\t\tentityType=\"department\"\n\t\t\t\t\t@click=\"(id) => onStructureNodeClicked(id)\"\n\t\t\t\t\tv-slot=\"{ item }\"\n\t\t\t\t>\n\t\t\t\t\t<template v-if=\"getParentDepartmentById(item.parentId)\">\n\t\t\t\t\t\t<div class=\"intranet-user-mini-profile__detailed-info-item__parent-department\">\n\t\t\t\t\t\t\t<div class=\"intranet-user-mini-profile__detailed-info-item__parent-department-text\"\n\t\t\t\t\t\t\t\t :title=\"getParentDepartmentById(item.parentId)?.title\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{{ getParentDepartmentById(item.parentId)?.title }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"intranet-user-mini-profile__detailed-info-item__parent-department-arrow\">\n\t\t\t\t\t\t\t\t<div class=\"intranet-user-mini-profile__detailed-info-item__parent-department-arrow-icon\">\n\t\t\t\t\t\t\t\t\t<BIcon :name=\"outlineSet.CHEVRON_RIGHT_L\" :size=\"16\"/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t</UserDetailedInfoEntityListValue>\n\t\t\t</UserDetailedInfoItem>\n\t\t\t<UserDetailedInfoItem v-if=\"teamItems.length\"\n\t\t\t\t:title=\"teamTitle\"\n\t\t\t>\n\t\t\t\t<UserDetailedInfoEntityListValue \n\t\t\t\t\t:items=\"teamItems\"\n\t\t\t\t\tentityType=\"team\"\n\t\t\t\t\t@click=\"(id) => onStructureNodeClicked(id)\"\n\t\t\t\t/>\n\t\t\t</UserDetailedInfoItem>\n\t\t</div>\n\t`,\n};\n","import { Backend } from '../classes/backend';\nimport { InitialParamDict, InitialParamService } from '../classes/initial-param-service';\n\nimport type { DepartmentType, UserData } from '../type';\nimport { Divider } from './divider/divider';\nimport { ErrorState } from './error-state/error-state';\nimport { ErrorStateDict } from './error-state/const';\nimport { LoaderTransition } from './loader-transition/loader-transition';\nimport { UserMiniProfileLoader } from './loader/loader';\nimport { StructureViewList } from './structure-view-list/structure-view-list';\nimport { CollapseTransition } from './transition-collapse/transition-collapse';\nimport type { UserMiniProfileDataType } from './type';\nimport { UserBaseInfo } from './user-base-info/user-base-info';\nimport { UserDetailedInfo } from './user-detailed-info/user-detailed-info';\n\n// @vue/component\nexport const UserMiniProfileComponent = {\n\tname: 'UserMiniProfile',\n\tcomponents: {\n\t\tUserMiniProfileLoader,\n\t\tUserBaseInfo,\n\t\tUserDetailedInfo,\n\t\tDivider,\n\t\tStructureViewList,\n\t\tCollapseTransition,\n\t\tErrorState,\n\t\tLoaderTransition,\n\t},\n\tprops: {\n\t\tpopup: {\n\t\t\t/** @type Popup */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tuserId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): UserMiniProfileDataType\n\t{\n\t\treturn {\n\t\t\tisError: false,\n\t\t\terrorType: ErrorStateDict.Default,\n\t\t\tisLoaded: false,\n\t\t\tisLoading: false,\n\t\t\tisExpanded: true,\n\t\t\tisExpandBlocked: false,\n\t\t\tbackendData: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\tuserDepartments(): Array<DepartmentType>\n\t\t{\n\t\t\tconst userDepartmentIds = this.backendData.structure?.userDepartmentIds ?? [];\n\t\t\tconst departmentDictionary = this.backendData.structure?.departmentDictionary ?? [];\n\t\t\tconst userDepartments = [];\n\t\t\tuserDepartmentIds.forEach((id: number) => {\n\t\t\t\tconst department = departmentDictionary[id];\n\t\t\t\tif (!department)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tuserDepartments.push(department);\n\t\t\t});\n\n\t\t\treturn userDepartments;\n\t\t},\n\t\tdepartments(): Array<DepartmentType>\n\t\t{\n\t\t\treturn Object.values(this.backendData.structure?.departmentDictionary ?? {});\n\t\t},\n\t\theads(): Array<UserData>\n\t\t{\n\t\t\tconst userDepartmentIds = this.backendData.structure?.userDepartmentIds ?? [];\n\t\t\tconst departmentDictionary = this.backendData.structure?.departmentDictionary ?? [];\n\n\t\t\tconst headDictionary = this.backendData.structure?.headDictionary ?? [];\n\n\t\t\tconst headList = [];\n\t\t\tconst headIds: Set<number> = new Set();\n\n\t\t\tuserDepartmentIds.forEach((departmentId: number) => {\n\t\t\t\t/** @type DepartmentType | null */\n\t\t\t\tconst department = departmentDictionary[departmentId];\n\t\t\t\tif (!department)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst { headIds: departmentHeadIds } = department;\n\t\t\t\tif (departmentHeadIds.includes(this.userId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tdepartmentHeadIds.forEach((headId) => {\n\t\t\t\t\tif (!headIds.has(headId) && headDictionary[headId])\n\t\t\t\t\t{\n\t\t\t\t\t\theadList.push(headDictionary[headId]);\n\t\t\t\t\t\theadIds.add(headId);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn headList.filter((head) => head.id !== this.userId);\n\t\t},\n\t\tcanShowDepartments(): boolean\n\t\t{\n\t\t\treturn this.userDepartments.length > 0;\n\t\t},\n\t\tisShouldBeExpandedByInitial(): boolean\n\t\t{\n\t\t\treturn InitialParamService.getValue(InitialParamDict.RightSideExpand) === 'Y';\n\t\t},\n\t\tcanChat(): boolean\n\t\t{\n\t\t\treturn this.backendData?.access.canChat ?? false;\n\t\t},\n\t\tisShowStructure(): boolean\n\t\t{\n\t\t\treturn this.canShowDepartments && this.isExpanded;\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tif (!this.isLoaded)\n\t\t{\n\t\t\tthis.isLoading = true;\n\t\t\tvoid Backend.load(this.userId)\n\t\t\t\t.then((data) => {\n\t\t\t\t\tthis.backendData = data;\n\t\t\t\t\tthis.isLoaded = true;\n\t\t\t\t})\n\t\t\t\t.catch((errorCode) => {\n\t\t\t\t\tif (errorCode === 'ACCESS_DENIED')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.errorType = ErrorStateDict.AccessDenied;\n\t\t\t\t\t}\n\t\t\t\t\tthis.isError = true;\n\t\t\t\t})\n\t\t\t\t.finally(() => {\n\t\t\t\t\tthis.isLoading = false;\n\t\t\t\t\tthis.adjustPopup();\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\n\t\tthis.isExpanded = this.isShouldBeExpandedByInitial;\n\t},\n\tmounted(): void\n\t{\n\t\tthis.adjustPopup();\n\t},\n\tmethods: {\n\t\tonExpand(): void\n\t\t{\n\t\t\tif (this.isExpandBlocked)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isExpanded = !this.isExpanded;\n\t\t\tInitialParamService.save(InitialParamDict.RightSideExpand, this.isExpanded ? 'Y' : 'N');\n\t\t},\n\t\tadjustPopup(): void\n\t\t{\n\t\t\tthis.popup?.adjustPosition();\n\t\t},\n\n\t\tonCollapseStart(): void\n\t\t{\n\t\t\tthis.isExpandBlocked = true;\n\t\t\tthis.adjustPopup();\n\t\t},\n\t\tonCollapseEnd(): void\n\t\t{\n\t\t\tthis.isExpandBlocked = false;\n\t\t\tthis.adjustPopup();\n\t\t},\n\t\tgetUserData(): UserData\n\t\t{\n\t\t\tconst { avatar, name, workPosition, url } = this.backendData.baseInfo;\n\n\t\t\treturn {\n\t\t\t\tid: this.userId,\n\t\t\t\tavatar,\n\t\t\t\tname,\n\t\t\t\tworkPosition,\n\t\t\t\turl,\n\t\t\t};\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"intranet-user-mini-profile-wrapper\">\n\t\t\t<template v-if=\"!isError\">\n\t\t\t\t<LoaderTransition \n\t\t\t\t\t:isLoading=\"isLoading\" \n\t\t\t\t\t:isShowContent=\"!!backendData\"\n\t\t\t\t\t:isLoaderShort=\"!isShouldBeExpandedByInitial\"\n\t\t\t\t\t@end=\"() => this.adjustPopup()\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"intranet-user-mini-profile-wrapper__content\">\n\t\t\t\t\t\t<div class=\"intranet-user-mini-profile-wrapper__column --left\"\n\t\t\t\t\t\t\t ref=\"leftColumn\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<UserBaseInfo\n\t\t\t\t\t\t\t\t:userId=\"userId\"\n\t\t\t\t\t\t\t\t:info=\"backendData.baseInfo\"\n\t\t\t\t\t\t\t\t:isShowExpand=\"canShowDepartments\"\n\t\t\t\t\t\t\t\t:isExpanded=\"isExpanded\"\n\t\t\t\t\t\t\t\t:canChat=\"canChat\"\n\t\t\t\t\t\t\t\t@expand=\"onExpand\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<template v-if=\"backendData.detailInfo\">\n\t\t\t\t\t\t\t\t<Divider style=\"margin-top: 18px; margin-bottom: 14px\"/>\n\t\t\t\t\t\t\t\t<UserDetailedInfo\n\t\t\t\t\t\t\t\t  :info=\"backendData.detailInfo\"\n\t\t\t\t\t\t\t\t  :userDepartments=\"userDepartments\"\n\t\t\t\t\t\t\t\t  :departments=\"departments\"\n\t\t\t\t\t\t\t\t  :heads=\"heads\"\n\t\t\t\t\t\t\t\t  :teams=\"backendData.structure.teams\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<CollapseTransition\n\t\t\t\t\t\t\t@start=\"onCollapseStart\"\n\t\t\t\t\t\t\t@end=\"onCollapseEnd\"\n\t\t\t\t\t\t\t:initialHeight=\"$refs.leftColumn?.offsetHeight\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div v-if=\"isShowStructure\" \n\t\t\t\t\t\t\t\tclass=\"intranet-user-mini-profile-wrapper__content__right-wrapper\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Divider isVertical style=\"margin: 0 18px\"/>\n\t\t\t\t\t\t\t\t<div class=\"intranet-user-mini-profile-wrapper__column --right\">\n\t\t\t\t\t\t\t\t\t<StructureViewList\n\t\t\t\t\t\t\t\t\t\t:structure=\"backendData.structure\"\n\t\t\t\t\t\t\t\t\t\t:user=\"getUserData()\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</CollapseTransition>\n\t\t\t\t\t</div>\n\t\t\t\t</LoaderTransition>\n\t\t\t</template>\n\t\t\t<ErrorState v-if=\"isError\"\n\t\t\t\t:type=\"errorType\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { EventEmitter } from 'main.core.events';\nimport { Event } from 'main.core';\nimport { Popup, PopupManager } from 'main.popup';\nimport { PopupPrefixId } from '../user-mini-profile';\n\nconst ShowDelayMs = 1000;\nconst CloseDelayMs = 500;\n\nexport class Tracking extends EventEmitter\n{\n\t#popup: Popup;\n\t#bindElement: ?HTMLElement = null;\n\n\t#showOrCloseTimeout: ?number = null;\n\t#haveToCloseCheckInterval: ?number = null;\n\n\t#handler: {\n\t\tonMouseEnter: (event) => void,\n\t\tonMouseLeave: (event) => void,\n\t\tonBindElementClick: (event) => void,\n\t} = null;\n\n\tconstructor(trackingOptions: { popup: Popup, bindElement: ?HTMLElement })\n\t{\n\t\tsuper();\n\t\tthis.#popup = trackingOptions.popup;\n\t\tthis.#bindElement = trackingOptions.bindElement;\n\n\t\tthis.#handler = {\n\t\t\tonMouseEnter: (event) => this.#onMouseEnter(event),\n\t\t\tonMouseLeave: (event) => this.#onMouseLeave(event),\n\t\t\tonBindElementClick: (event) => this.#onBindElementClick(event),\n\t\t};\n\n\t\tthis.setEventNamespace('Intranet.User.MiniProfile.Tracking');\n\t}\n\n\tsetBindElement(element: ?HTMLElement): void\n\t{\n\t\tif (this.#bindElement === element)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.unbindTracking();\n\t\tthis.#bindElement = element;\n\t\tif (this.#bindElement)\n\t\t{\n\t\t\tthis.setupTracking();\n\t\t}\n\t}\n\n\tsetupTracking(): void\n\t{\n\t\tconst { onMouseEnter, onMouseLeave, onBindElementClick } = this.#handler;\n\n\t\tEvent.bind(this.#bindElement, 'click', onBindElementClick);\n\t\tthis.#getTrackingElements().forEach((element) => {\n\t\t\tEvent.bind(element, 'mouseenter', onMouseEnter);\n\t\t\tEvent.bind(element, 'mouseleave', onMouseLeave);\n\t\t});\n\t}\n\n\tunbindTracking(): void\n\t{\n\t\tconst { onMouseEnter, onMouseLeave, onBindElementClick } = this.#handler;\n\n\t\tEvent.unbind(this.#bindElement, 'click', onBindElementClick);\n\t\tthis.#getTrackingElements().forEach((element) => {\n\t\t\tEvent.unbind(element, 'mouseenter', onMouseEnter);\n\t\t\tEvent.unbind(element, 'mouseleave', onMouseLeave);\n\t\t});\n\t\tclearInterval(this.#showOrCloseTimeout);\n\t\tclearInterval(this.#haveToCloseCheckInterval);\n\t}\n\n\t#onBindElementClick(): void\n\t{\n\t\tclearInterval(this.#haveToCloseCheckInterval);\n\t\tclearTimeout(this.#showOrCloseTimeout);\n\t\tthis.emit('close');\n\t}\n\n\t#onMouseEnter(event): void\n\t{\n\t\tclearInterval(this.#haveToCloseCheckInterval);\n\t\tthis.#scheduleShow();\n\t}\n\n\t#onMouseLeave(event): void\n\t{\n\t\tclearTimeout(this.#showOrCloseTimeout);\n\t\tif (this.#haveToClose())\n\t\t{\n\t\t\tthis.#scheduleClose();\n\t\t}\n\t\telse if (!this.#isPopupOnTop())\n\t\t{\n\t\t\tthis.#haveToCloseCheckInterval = setInterval(() => {\n\t\t\t\tif (!this.#haveToClose())\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.emit('close');\n\t\t\t\tclearInterval(this.#haveToCloseCheckInterval);\n\t\t\t}, CloseDelayMs * 2);\n\t\t}\n\t}\n\n\t#haveToClose(): boolean\n\t{\n\t\tif (this.#popup.isShown() && this.#isPopupOnTop())\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t#isPopupOnTop(): boolean\n\t{\n\t\tconst popupStack = PopupManager.getPopups();\n\n\t\tfor (let i = popupStack.length - 1; i >= 0; --i)\n\t\t{\n\t\t\tconst popup = popupStack[i];\n\t\t\tif (popup.getId() === this.#popup.getId())\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (popup.isShown() && popup.getId().includes(PopupPrefixId))\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t#scheduleClose(): void\n\t{\n\t\tclearTimeout(this.#showOrCloseTimeout);\n\t\tthis.#showOrCloseTimeout = setTimeout(() => {\n\t\t\tthis.emit('close');\n\t\t}, CloseDelayMs);\n\t}\n\n\t#scheduleShow(): void\n\t{\n\t\tclearTimeout(this.#showOrCloseTimeout);\n\t\tthis.#showOrCloseTimeout = setTimeout(() => {\n\t\t\tthis.emit('show');\n\t\t}, ShowDelayMs);\n\t}\n\n\t#getTrackingElements(): Array<HTMLElement>\n\t{\n\t\treturn [this.#bindElement, this.#popup.getPopupContainer()];\n\t}\n}\n","import { Tag } from 'main.core';\nimport { BaseCache, MemoryCache } from 'main.core.cache';\nimport { EventEmitter } from 'main.core.events';\nimport { Popup, PopupManager } from 'main.popup';\nimport { BitrixVue, VueCreateAppResult } from 'ui.vue3';\n\nimport { UserMiniProfileComponent } from './components/app';\nimport type { UserMiniProfileOptions } from './type';\nimport { Tracking } from './utils/tracking';\n\nimport 'ui.design-tokens';\nimport './style.css';\n\nexport const PopupPrefixId = 'intranet-user-mini-profile-';\n\nexport class UserMiniProfile\n{\n\t#options: UserMiniProfileOptions;\n\n\t#cache: BaseCache = new MemoryCache();\n\t#tracking: Tracking;\n\n\t#app: VueCreateAppResult | null = null;\n\n\t#closeHandler: () => void = null;\n\n\tconstructor(options: UserMiniProfileOptions)\n\t{\n\t\tthis.#options = options;\n\n\t\tthis.#tracking = new Tracking({\n\t\t\tpopup: this.#getPopup(),\n\t\t\tbindElement: options.bindElement,\n\t\t});\n\t\tthis.#closeHandler = () => this.close();\n\n\t\tthis.#bindEvents();\n\t}\n\n\tdestroy(): void\n\t{\n\t\tthis.#tracking.unbindTracking();\n\t\tthis.#getPopup().destroy();\n\t\tthis.#app?.unmount();\n\n\t\tEventEmitter.unsubscribe('SidePanel.Slider:onOpen', this.#closeHandler);\n\t\tEventEmitter.unsubscribe('Intranet.User.MiniProfile:close', this.#closeHandler);\n\t}\n\n\tshow(): void\n\t{\n\t\tthis.#createAppIfNeed();\n\t\tthis.#getPopup().show();\n\t}\n\n\tclose(): void\n\t{\n\t\tthis.#getPopup().close();\n\n\t\tPopupManager.getPopups()\n\t\t\t.filter((popup) => popup.isShown() && popup.getId().includes(PopupPrefixId))\n\t\t\t.forEach((popup) => {\n\t\t\t\tpopup.close();\n\t\t\t})\n\t\t;\n\t}\n\n\tsetBindElement(element: ?HTMLElement): void\n\t{\n\t\tif (this.#options.bindElement === element)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst popup = this.#getPopup();\n\t\tpopup.close();\n\t\tpopup.setBindElement(element);\n\t\tthis.#tracking.setBindElement(element);\n\n\t\tthis.#options.bindElement = element;\n\t}\n\n\tgetBindElement(): ?HTMLElement\n\t{\n\t\treturn this.#options.bindElement;\n\t}\n\n\t#getPopup(): Popup\n\t{\n\t\treturn this.#cache.remember('popup', () => {\n\t\t\treturn new Popup({\n\t\t\t\tclassName: 'intranet-user-mini-profile-popup',\n\t\t\t\tcontent: this.#getContainer(),\n\t\t\t\tbindElement: this.#options.bindElement,\n\t\t\t\tmaxWidth: 643,\n\t\t\t\tmaxHeight: 497,\n\t\t\t\tpadding: 0,\n\t\t\t\tcontentNoPaddings: true,\n\t\t\t\tangle: {\n\t\t\t\t\toffset: this.#options.bindElement.offsetWidth / 2,\n\t\t\t\t},\n\t\t\t\tanimation: 'fading',\n\t\t\t\tbindOptions: {\n\t\t\t\t\tforceBindPosition: true,\n\t\t\t\t\tforceTop: true,\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\t#getContainer(): HTMLElement\n\t{\n\t\treturn this.#cache.remember('container', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"intranet-user-mini-profile --ui-context-content-light\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#createAppIfNeed(): void\n\t{\n\t\tif (this.#app)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst { userId } = this.#options;\n\t\tconst popup = this.#getPopup();\n\n\t\tthis.#app = BitrixVue.createApp(UserMiniProfileComponent, {\n\t\t\tuserId,\n\t\t\tpopup,\n\t\t});\n\n\t\tthis.#app.mount(this.#getContainer());\n\t}\n\n\t#bindEvents(): void\n\t{\n\t\tthis.#tracking.setupTracking();\n\t\tthis.#tracking.subscribe('close', () => this.close());\n\t\tthis.#tracking.subscribe('show', () => this.show());\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onOpen', this.#closeHandler);\n\t\tEventEmitter.subscribe('Intranet.User.MiniProfile:close', this.#closeHandler);\n\t}\n}\n","import { UserMiniProfile } from './user-mini-profile';\nimport type { UserMiniProfileOptions } from './type';\n\nexport class UserMiniProfileManager\n{\n\tstatic #instanceByIdMap: Map<string, UserMiniProfile> = new Map();\n\tstatic #instanceByBindElementMap: Map<HTMLElement, UserMiniProfile> = new Map();\n\n\tstatic getById(id: string): ?UserMiniProfile\n\t{\n\t\treturn this.#instanceByIdMap.get(id);\n\t}\n\n\tstatic create(options: UserMiniProfileOptions & { id: string }): UserMiniProfile\n\t{\n\t\tconst { id, bindElement } = options;\n\n\t\t// If other widget was already binded to element, we need to unbind it\n\t\tif (this.#instanceByBindElementMap.has(bindElement))\n\t\t{\n\t\t\tconst instanceByElement = this.#instanceByBindElementMap.get(bindElement);\n\t\t\tconst instanceById = this.#instanceByIdMap.get(id);\n\t\t\tif (instanceById !== instanceByElement)\n\t\t\t{\n\t\t\t\tinstanceByElement.setBindElement(null);\n\t\t\t\tthis.#instanceByBindElementMap.delete(bindElement);\n\t\t\t}\n\t\t}\n\n\t\tif (this.#instanceByIdMap.has(id))\n\t\t{\n\t\t\tconst instance = this.#instanceByIdMap.get(id);\n\n\t\t\tconst previousBindElement = instance.getBindElement();\n\t\t\tif (previousBindElement !== bindElement)\n\t\t\t{\n\t\t\t\tthis.#instanceByBindElementMap.delete(previousBindElement);\n\t\t\t\tinstance.setBindElement(bindElement);\n\t\t\t}\n\n\t\t\tthis.#instanceByBindElementMap.set(bindElement, instance);\n\n\t\t\treturn instance;\n\t\t}\n\n\t\tconst instance = new UserMiniProfile(options);\n\t\tthis.#instanceByIdMap.set(id, instance);\n\t\tthis.#instanceByBindElementMap.set(bindElement, instance);\n\n\t\treturn instance;\n\t}\n}\n"],"names":["Backend","load","userId","Promise","resolve","reject","ajax","runAction","data","then","result","catch","errors","code","InitialParamDict","RightSideExpand","prefix","InitialParamService","getValue","type","key","localStorage","getItem","save","value","Object","values","includes","setItem","Divider","name","props","isVertical","Boolean","default","template","ErrorStateSettingByType","class","title","Loc","getMessage","description","ErrorStateDict","freeze","AccessDenied","Default","ErrorState","String","validator","computed","setting","UserMiniProfileLoader","isShort","LoaderTransition","components","isLoading","required","isShowContent","isLoaderShort","emits","methods","resetSize","Dom","style","$el","width","height","onEnd","$emit","onEnter","el","requestAnimationFrame","offsetWidth","offsetHeight","onBeforeLeave","onAfterLeave","onAfterEnter","ButtonMixin","Button","buttonSize","ButtonSize","buttonStyle","AirButtonStyle","buttonIcon","ButtonIcon","IconSetMixin","set","Set","outlineSet","Outline","LocMixin","loc","replacements","locPlural","getMessagePlural","DepartmentConnector","topBindElement","HTMLElement","bottomBindElement","offsetLeft","Number","top","getBoundingClientRect","offsetTop","left","topElementBottom","bottomElementCenter","Math","round","pathD","d","join","viewBox","OpenActionService","openStructureNodeId","nodeId","Structure","open","focusNodeId","openUserProfile","url","Type","isStringFilled","BX","SidePanel","Instance","DepartmentBlock","BIcon","Avatar","mixins","highlighted","employeeCount","user","head","employeeCountTitle","isShowHead","id","onTitleClick","onUserClick","LockedDepartmentBlock","DepartmentSpacer","minWidth","minHeight","LockedDepartment","StructureView","branch","Array","headDictionary","userDepartmentId","blocks","connectorBindElementPairs","mounted","$nextTick","makeConnectors","connectorCount","length","i","topBlock","bottomBlock","push","getHeadForDepartment","department","departmentId","headIds","userIsHead","firstHeadId","getUserForDepartment","StructureViewListAnimation","next","prev","maxElementsInBranch","StructureViewList","structure","index","animationName","isTransitionInProgress","isPrevDisabled","isNextDisabled","userDepartmentIds","hasManyUserDepartments","maxBranchHeight","departmentBranchHeight","makeDepartmentBranch","max","missingMaxDepartmentCount","departmentDictionary","node","parentId","reverse","CollapseTransition","initialHeight","created","$slots","Error","targetWidth","targetHeight","fromHeight","min","ChatService","openMessenger","Messenger","openChat","call","withVideo","startVideoCall","UserRoleTitleByCode","shop","email","integrator","visitor","UserRole","role","IconSettingByStatus","online","iconName","EARTH_WITH_CHECK","colorVar","offline","EARTH_WITH_CLOCK","dnd","EARTH_WITH_STOP","vacation","EARTH_WITH_TREE","fired","EARTH_WITH_CROSS","UserStatusIcon","status","iconSetting","StaticDescriptionByStatus","UserStatus","Online","Offline","DoNotDisturb","Vacation","Fired","UserStatusDescription","text","staticText","formatTextForOfflineStatus","formatTextForVacationStatus","isNumber","lastSeenTs","dayMonthFormat","DateTimeFormat","getFormat","shortTimeFormat","format","vacationTs","UserTime","utcOffset","date","Date","tickInterval","formattedTime","localOffset","getTimezoneOffset","targetOffset","totalOffset","setTime","getTime","sign","absOffset","abs","hours","floor","minutes","timezoneParts","toString","padStart","formatDate","setInterval","unmounted","clearInterval","UserAvatarTypeByRole","collaber","extranet","employee","UserBaseInfo","RichMenuPopup","BMenu","isShowExpand","isExpanded","info","canChat","isShowCallMenu","callMenuPopupOptions","PopupPrefixId","autoHide","bindElement","$refs","callActionMenu","bindOptions","forceBindPosition","items","icon","RECORD_VIDEO","onClick","onCallMenuItemClick","HEADSET","shouldShowUserTime","UserStatusDict","avatarType","openProfile","ContactItem","Mail","Phone","UserDetailedInfoContactItemValue","href","event","preventDefault","navigator","clipboard","writeText","UI","Notification","Center","notify","content","$Bitrix","UserDetailedInfoItem","EntityMenuItem","image","UserDetailedInfoEntityListValue","entityType","isMenuShow","popupOptions","formatPopupId","undefined","counter","maxHeight","firstItem","isCounterShow","counterTitle","openMenu","onElementClick","UserDetailedInfo","heads","userDepartments","departments","teams","departmentItems","map","bIconName","GROUP","iconClass","headItems","imageSrc","avatar","teamItems","team","MY_PLAN","headTitle","teamTitle","departmentTitle","onHeadClicked","find","item","onStructureNodeClicked","getParentDepartmentById","UserMiniProfileComponent","popup","isError","errorType","isLoaded","isExpandBlocked","backendData","forEach","headList","departmentHeadIds","headId","has","add","filter","canShowDepartments","isShouldBeExpandedByInitial","access","isShowStructure","errorCode","finally","adjustPopup","onExpand","adjustPosition","onCollapseStart","onCollapseEnd","getUserData","workPosition","baseInfo","ShowDelayMs","CloseDelayMs","Tracking","EventEmitter","constructor","trackingOptions","onMouseEnter","onMouseLeave","onBindElementClick","setEventNamespace","setBindElement","element","unbindTracking","setupTracking","Event","bind","unbind","clearTimeout","emit","isShown","popupStack","PopupManager","getPopups","getId","setTimeout","getPopupContainer","UserMiniProfile","options","MemoryCache","close","destroy","unmount","unsubscribe","show","getBindElement","remember","Popup","className","maxWidth","padding","contentNoPaddings","angle","offset","animation","forceTop","Tag","render","BitrixVue","createApp","mount","subscribe","UserMiniProfileManager","getById","get","create","instanceByElement","instanceById","delete","instance","previousBindElement","Map"],"mappings":"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"}