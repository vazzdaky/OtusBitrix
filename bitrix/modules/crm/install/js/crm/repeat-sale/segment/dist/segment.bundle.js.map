{"version":3,"file":"segment.bundle.js","sources":["../src/components/common/additional-info-component.js","../src/components/common/ai-switcher-component.js","../src/components/common/text-editor-wrapper-component.js","../src/components/navigation/button.js","../src/components/selector/call-assessment-selector.js","../src/components/common/dialog-wrapper-component.js","../src/components/common/tag-selector-wrapper-component.js","../src/components/selector/category-selector.js","../src/components/selector/stage-selector.js","../src/components/selector/user-selector.js","../src/components/segment.js","../src/segment.js"],"sourcesContent":["import { Event, Extension, Loc } from 'main.core';\nimport { PromoVideoPopup } from 'ui.promo-video-popup';\n\nexport const AdditionalInfoComponent = {\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tmounted()\n\t{\n\t\tthis.popup = null;\n\t\tthis.region = Extension.getSettings('crm.repeat-sale.segment').get('region');\n\n\t\tEvent.EventEmitter.subscribe('UI.PromoVideoPopup:accept', (event) => {\n\t\t\tthis.popup?.hide();\n\t\t});\n\t},\n\n\tmethods: {\n\t\tonClick(): void\n\t\t{\n\t\t\tif (this.popup === null)\n\t\t\t{\n\t\t\t\tthis.popup = new PromoVideoPopup({\n\t\t\t\t\tangleOptions: null,\n\t\t\t\t\ttargetOptions: '1',\n\t\t\t\t\tuseOverlay: true,\n\t\t\t\t\tvideoSrc: this.videoSrc,\n\t\t\t\t\tvideoContainerMinHeight: 255,\n\t\t\t\t\ttitle: Loc.getMessage('CRM_REPEAT_SALE_SEGMENT_HOW_IT_WORK_TITLE'),\n\t\t\t\t\tcolors: {\n\t\t\t\t\t\ttitle: 'var(--ui-color-palette-black-base)',\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.popup.show();\n\t\t},\n\t},\n\n\tcomputed: {\n\t\tvideoSrc(): string\n\t\t{\n\t\t\tlet name = 'how-it-work-en';\n\t\t\tif (['kz', 'ru', 'by'].includes(this.region))\n\t\t\t{\n\t\t\t\tname = 'how-it-work-ru';\n\t\t\t}\n\n\t\t\treturn `/bitrix/js/crm/repeat-sale/segment/video/${name}.webm`;\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"crm-repeat-sale__segment-field-info\">\n\t\t\t<span @click=\"onClick\">\n\t\t\t\t{{title}}\n\t\t\t</span>\n\t\t</div>\n\t`,\n};\n","import { Switcher, SwitcherSize } from 'ui.switcher';\nimport { AdditionalInfoComponent } from './additional-info-component';\n\nexport const AiSwitcherComponent = {\n\temits: [\n\t\t'change',\n\t],\n\n\tcomponents: {\n\t\tAdditionalInfoComponent,\n\t},\n\n\tprops: {\n\t\tchecked: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\treadOnly: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\tmounted(): void\n\t{\n\t\tthis.renderSwitcher();\n\t},\n\n\tmethods: {\n\t\trenderSwitcher(): void\n\t\t{\n\t\t\tconst switcher = new Switcher({\n\t\t\t\tchecked: this.checked,\n\t\t\t\tdisabled: this.readOnly,\n\t\t\t\tsize: SwitcherSize.small,\n\t\t\t\tshowStateTitle: false,\n\t\t\t\thandlers: {\n\t\t\t\t\tchecked: (event) => {\n\t\t\t\t\t\tthis.emitChange(false);\n\t\t\t\t\t},\n\t\t\t\t\tunchecked: (event) => {\n\t\t\t\t\t\tthis.emitChange(true);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tswitcher.renderTo(this.$refs.switcher);\n\t\t},\n\t\temitChange(value: boolean): void\n\t\t{\n\t\t\tthis.$emit('change', value);\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"crm-repeat-sale__segment-ai-switcher-wrapper\">\n\t\t\t<div>\n\t\t\t\t{{this.$Bitrix.Loc.getMessage('CRM_REPEAT_SALE_SEGMENT_COPILOT_DESCRIPTION')}}\n\t\t\t</div>\n\t\t\t<div class=\"crm-repeat-sale__segment-ai-switcher\" ref=\"switcher\"></div>\n\t\t</div>\n\t`,\n};\n","import { Event, Runtime, Type } from 'main.core';\nimport { TextEditor, TextEditorComponent } from 'ui.text-editor';\nimport { AiSwitcherComponent } from './ai-switcher-component';\n\nexport const TextEditorWrapperComponent = {\n\tcomponents: {\n\t\tTextEditorComponent,\n\t\tAiSwitcherComponent,\n\t},\n\n\temits: [\n\t\t'change',\n\t],\n\n\tprops: {\n\t\ttextEditor: TextEditor,\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\ttextEditorEvents: {\n\t\t\t\tonChange: this.emitChangeData,\n\t\t\t},\n\t\t};\n\t},\n\n\tmounted(): void\n\t{\n\t\tthis.setTextEditorHeight();\n\t\tthis.windowResizeHandler = this.windowResizeHandler.bind(this);\n\n\t\tEvent.bind(window, 'resize', this.windowResizeHandler);\n\t},\n\n\tunmounted(): void\n\t{\n\t\tEvent.unbind(window, 'resize', this.windowResizeHandler);\n\t},\n\n\tmethods: {\n\t\temitChangeData(): void\n\t\t{\n\t\t\tif (!Type.isFunction(this.onChangeDebounce))\n\t\t\t{\n\t\t\t\tthis.onChangeDebounce = Runtime.debounce(this.onChange, 100, this);\n\t\t\t}\n\n\t\t\tthis.onChangeDebounce();\n\t\t},\n\t\tonChange(): void\n\t\t{\n\t\t\tthis.$emit('change', {\n\t\t\t\tprompt: this.textEditor.getText(),\n\t\t\t});\n\t\t},\n\t\twindowResizeHandler(): void\n\t\t{\n\t\t\tthis.setTextEditorHeight();\n\t\t},\n\t\tsetTextEditorHeight(): void\n\t\t{\n\t\t\tconst editorOffsetTop = this.$el.parentNode.offsetTop;\n\n\t\t\tconst navigationClassName = '.crm-repeat-sale__segment_navigation-container';\n\t\t\tconst navigationOffsetTop = document.querySelector(navigationClassName)?.offsetTop ?? 0;\n\n\t\t\tconst textEditorContainerBottomPadding = 20;\n\t\t\tconst availableHeight = navigationOffsetTop - editorOffsetTop - textEditorContainerBottomPadding;\n\t\t\tconst minHeight = Math.round(availableHeight * 0.5);\n\t\t\tconst maxHeight = Math.round(availableHeight * 0.8);\n\n\t\t\tif (minHeight < 200)\n\t\t\t{\n\t\t\t\tthis.textEditor?.setMinHeight(maxHeight);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.textEditor?.setMinHeight(minHeight);\n\t\t\t}\n\n\t\t\tthis.textEditor?.setMaxHeight(maxHeight);\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<TextEditorComponent\n\t\t\t:events=\"textEditorEvents\"\n\t\t\t:editor-instance=\"textEditor\"\n\t\t/>\n\t`,\n};\n","import { Loc } from 'main.core';\nimport { AirButtonStyle, Button as UiButton } from 'ui.buttons';\n\nexport const ButtonEvents = {\n\tclick: 'crm:repeat-sale:segment:navigation-button-click',\n};\n\nexport const Button = {\n\tprops: {\n\t\tid: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tmounted()\n\t{\n\t\tthis.initButton();\n\t},\n\n\tmethods: {\n\t\tinitButton(): void\n\t\t{\n\t\t\tthis.button = new UiButton({\n\t\t\t\tuseAirDesign: true,\n\t\t\t\ttext: Loc.getMessage(`CRM_REPEAT_SALE_SEGMENT_NAVIGATION_BUTTON_${this.id.toUpperCase()}`),\n\t\t\t\tround: true,\n\t\t\t\tstyle: this.buttonStyle,\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.emitClickEvent();\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tthis.button.setDataSet({\n\t\t\t\tid: `crm-repeat-sale-segment-buttons-${this.id.toLowerCase()}`,\n\t\t\t});\n\n\t\t\tif (this.$refs.button)\n\t\t\t{\n\t\t\t\tthis.button.renderTo(this.$refs.button);\n\t\t\t}\n\t\t},\n\t\temitClickEvent(): void\n\t\t{\n\t\t\tthis.$Bitrix.eventEmitter.emit(ButtonEvents.click, { id: this.id });\n\t\t},\n\t},\n\n\tcomputed: {\n\t\tbuttonStyle(): string\n\t\t{\n\t\t\tif (this.id === 'update')\n\t\t\t{\n\t\t\t\treturn AirButtonStyle.FILLED;\n\t\t\t}\n\n\t\t\treturn AirButtonStyle.OUTLINE;\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div ref=\"button\" class=\"crm-repeat-sale__segment_button\"></div>\n\t`,\n};\n","import { Event } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\nimport { Dialog } from 'ui.entity-selector';\n\nexport const CallAssessmentSelector = {\n\tprops: {\n\t\tcallAssessments: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tcurrentCallAssessmentId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\treadOnly: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\tcreated()\n\t{\n\t\tthis.dialog = null;\n\t\tthis.tabs = [\n\t\t\t{ id: 'call_assessments', title: '' },\n\t\t];\n\n\t\tthis.items = [];\n\t\tthis.callAssessments.forEach((callAssessment, index) => {\n\t\t\tthis.items.push({\n\t\t\t\tid: callAssessment.id,\n\t\t\t\ttitle: callAssessment.name,\n\t\t\t\tentityId: 'call_assessment',\n\t\t\t\ttabs: 'call_assessments',\n\t\t\t\tselected: callAssessment.id === this.currentCallAssessmentId,\n\t\t\t});\n\t\t});\n\t},\n\n\tmethods: {\n\t\ttoggleDialog(): void\n\t\t{\n\t\t\tconst dialog = this.getDialog();\n\n\t\t\tif (dialog.isOpen())\n\t\t\t{\n\t\t\t\tdialog.hide();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdialog.show();\n\t\t\t}\n\t\t},\n\t\tgetDialog(): Dialog\n\t\t{\n\t\t\tif (this.dialog === null)\n\t\t\t{\n\t\t\t\tconst targetNode = this.$refs.dialog;\n\t\t\t\tconst parentPopupContainer = targetNode.closest('body');\n\n\t\t\t\tthis.dialog = new Dialog({\n\t\t\t\t\ttargetNode,\n\t\t\t\t\tcontext: 'CRM_REPEAT_SALE_CALL_ASSESSMENT',\n\t\t\t\t\tmultiple: false,\n\t\t\t\t\tdropdownMode: true,\n\t\t\t\t\tshowAvatars: false,\n\t\t\t\t\tenableSearch: true,\n\t\t\t\t\twidth: 450,\n\t\t\t\t\tzIndex: 2500,\n\t\t\t\t\ttabs: this.tabs,\n\t\t\t\t\titems: this.items,\n\t\t\t\t\tsearchOptions: {\n\t\t\t\t\t\tallowCreateItem: false,\n\t\t\t\t\t},\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t'Item:onSelect': (event: BaseEvent) => {\n\t\t\t\t\t\t\tconst { item: { id } } = event.getData();\n\t\t\t\t\t\t\tthis.emitSelectItem(id);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonShow: (event: BaseEvent) => {\n\t\t\t\t\t\t\tEvent.bindOnce(\n\t\t\t\t\t\t\t\tparentPopupContainer,\n\t\t\t\t\t\t\t\t'click',\n\t\t\t\t\t\t\t\tthis.onPopupContainerClick.bind(this),\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn this.dialog;\n\t\t},\n\t\temitSelectItem(itemId: number): void\n\t\t{\n\t\t\tthis.$emit('onSelectItem', itemId);\n\t\t},\n\t\tonPopupContainerClick(): void\n\t\t{\n\t\t\tthis.getDialog().hide();\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div\n\t\t\tref=\"dialog\"\n\t\t\t@click=\"toggleDialog\"\n\t\t\tclass=\"crm-repeat-sale__segment_call-assessment\"\n\t\t>\n\t\t\t{{ this.$Bitrix.Loc.getMessage('CRM_REPEAT_SALE_SEGMENT_CALL_ASSESSMENT_SELECTOR') }}\n\t\t</div>\n\t`,\n};\n","import { Event } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\nimport { Dialog } from 'ui.entity-selector';\n\ntype ItemId = [\n\tstring,\n\t\tstring | number,\n];\n\nexport const DialogWrapperComponent = {\n\temits: [\n\t\t'change',\n\t\t'onSelectItem',\n\t\t'onDeselectItem',\n\t],\n\n\tprops: {\n\t\titems: {\n\t\t\ttype: Array,\n\t\t\tdefault: [],\n\t\t},\n\t\ttabs: {\n\t\t\ttype: Array,\n\t\t\tdefault: [],\n\t\t},\n\t\tentities: {\n\t\t\ttype: Array,\n\t\t\tdefault: [],\n\t\t},\n\t\tshowAvatars: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tmultiple: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tcontext: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tevents: {\n\t\t\ttype: Object,\n\t\t\tdefault: {},\n\t\t},\n\t\treadOnly: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\tmethods: {\n\t\tgetDialog(): Dialog\n\t\t{\n\t\t\tif (!this.dialog)\n\t\t\t{\n\t\t\t\tconst targetNode = this.$refs.dialog;\n\t\t\t\tconst parentPopupContainer = targetNode.closest('body');\n\n\t\t\t\tthis.dialog = new Dialog({\n\t\t\t\t\ttargetNode,\n\t\t\t\t\tcontext: this.context,\n\t\t\t\t\tmultiple: this.multiple,\n\t\t\t\t\tdropdownMode: true,\n\t\t\t\t\tshowAvatars: this.showAvatars,\n\t\t\t\t\tenableSearch: true,\n\t\t\t\t\twidth: 450,\n\t\t\t\t\tzIndex: 2500,\n\t\t\t\t\titems: this.items,\n\t\t\t\t\tentities: this.entities,\n\t\t\t\t\ttabs: this.tabs,\n\t\t\t\t\tsearchOptions: {\n\t\t\t\t\t\tallowCreateItem: false,\n\t\t\t\t\t},\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t'Item:onSelect': (event: BaseEvent) => {\n\t\t\t\t\t\t\tconst { item: selectedItem } = event.getData();\n\t\t\t\t\t\t\tthis.emitSelectItem(selectedItem);\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'Item:onDeselect': (event: BaseEvent) => {\n\t\t\t\t\t\t\tconst { item: deselectedItem } = event.getData();\n\n\t\t\t\t\t\t\tthis.emitDeselectItem(deselectedItem);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonShow: (event: BaseEvent) => {\n\t\t\t\t\t\t\tEvent.bindOnce(\n\t\t\t\t\t\t\t\tparentPopupContainer,\n\t\t\t\t\t\t\t\t'click',\n\t\t\t\t\t\t\t\tthis.onPopupContainerClick.bind(this),\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn this.dialog;\n\t\t},\n\t\temitSelectItem(selectedItem: Array): void\n\t\t{\n\t\t\tthis.$emit('onSelectItem', selectedItem);\n\t\t},\n\t\temitDeselectItem(deselectedItem: Array): void\n\t\t{\n\t\t\tthis.$emit('onDeselectItem', deselectedItem);\n\t\t},\n\t\tselectItem(itemId: ItemId): void\n\t\t{\n\t\t\tconst item = this.dialog.getItem(itemId);\n\t\t\titem?.select();\n\t\t},\n\t\tonPopupContainerClick(): void\n\t\t{\n\t\t\tthis.getDialog().hide();\n\t\t},\n\t\tshow(): void\n\t\t{\n\t\t\tthis.getDialog().show();\n\t\t},\n\t\ttoggleDialog(): void\n\t\t{\n\t\t\tif (this.readOnly)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst dialog = this.getDialog();\n\n\t\t\tif (dialog.isOpen())\n\t\t\t{\n\t\t\t\tdialog.hide();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdialog.show();\n\t\t\t}\n\t\t},\n\t\tdestroy(): void\n\t\t{\n\t\t\tthis.dialog?.destroy();\n\t\t\tthis.dialog = null;\n\t\t},\n\t},\n\n\tcomputed: {\n\t\telementTitle(): string\n\t\t{\n\t\t\treturn this.items.find((item) => item.selected)?.title ?? '';\n\t\t},\n\t\tcustomData(): ?Object\n\t\t{\n\t\t\treturn this.items.find((item) => item.selected)?.customData ?? '';\n\t\t},\n\t\tcontrolClassList(): Array\n\t\t{\n\t\t\treturn [\n\t\t\t\t'ui-ctl',\n\t\t\t\t'ui-ctl-after-icon',\n\t\t\t\t{ 'ui-ctl-dropdown': !this.readOnly },\n\t\t\t];\n\t\t},\n\t\ticonClassList(): Array\n\t\t{\n\t\t\treturn [\n\t\t\t\t'crm-repeat-sale__segment-dialog-field-icon',\n\t\t\t\t{ '--color': Boolean(this.customData?.color) },\n\t\t\t];\n\t\t},\n\t\ticonStyleList(): Object\n\t\t{\n\t\t\tif (this.customData?.color === null)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tbackgroundColor: this.customData.color,\n\t\t\t};\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div\n\t\t\t:class=\"controlClassList\"\n\t\t\tref=\"dialog\"\n\t\t\t@click=\"toggleDialog\"\n\t\t>\n    \t\t<div \n\t\t\t\tv-if=\"!readOnly\"\n\t\t\t\tclass=\"ui-ctl-after ui-ctl-icon-angle\"\n\t\t\t></div>\n\t\t\t<div class=\"ui-ctl-element\">\n\t\t\t\t<span class=\"crm-repeat-sale__segment-dialog-field\">\n\t\t\t\t\t<span \n\t\t\t\t\t\t:class=\"iconClassList\"\n\t\t\t\t\t\t:style=\"iconStyleList\"\n\t\t\t\t\t></span>\n\t\t\t\t\t<span class=\"crm-repeat-sale__segment-dialog-field-value\">\n\t\t\t\t\t\t{{elementTitle}}\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Dom } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\nimport { TagSelector } from 'ui.entity-selector';\n\ntype ItemId = [\n\tstring,\n\tstring | number,\n];\n\nexport const TagSelectorWrapperComponent = {\n\temits: [\n\t\t'change',\n\t\t'onSelectItem',\n\t\t'onDeselectItem',\n\t],\n\n\tprops: {\n\t\titems: {\n\t\t\ttype: Array,\n\t\t\tdefault: [],\n\t\t},\n\t\tpreselectedItems: {\n\t\t\ttype: Array,\n\t\t\tdefault: [],\n\t\t},\n\t\ttabs: {\n\t\t\ttype: Array,\n\t\t\tdefault: [],\n\t\t},\n\t\tentities: {\n\t\t\ttype: Array,\n\t\t\tdefault: [],\n\t\t},\n\t\tshowAvatars: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tmultiple: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tcontext: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tevents: {\n\t\t\ttype: Object,\n\t\t\tdefault: {},\n\t\t},\n\t\treadOnly: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\tmounted() {\n\t\tthis.initDialog();\n\t},\n\n\twatch: {\n\t\titems(items: Array): void\n\t\t{\n\t\t\tthis.tagSelector.getDialog().destroy();\n\t\t\tDom.clean(this.$refs.dialog);\n\n\t\t\tthis.initDialog();\n\t\t},\n\t},\n\n\tmethods: {\n\t\tinitDialog(): void\n\t\t{\n\t\t\tconst targetNode = this.$refs.dialog;\n\t\t\tconst parentPopupContainer = targetNode.closest('body');\n\n\t\t\tthis.tagSelector = new TagSelector({\n\t\t\t\tmultiple: this.multiple,\n\t\t\t\treadonly: this.readOnly,\n\t\t\t\thideOnSelect: false,\n\t\t\t\tdialogOptions: {\n\t\t\t\t\ttargetNode,\n\t\t\t\t\tcontext: this.context,\n\t\t\t\t\tmultiple: this.multiple,\n\t\t\t\t\thideOnSelect: false,\n\t\t\t\t\tdropdownMode: true,\n\t\t\t\t\tshowAvatars: this.showAvatars,\n\t\t\t\t\tenableSearch: true,\n\t\t\t\t\twidth: 450,\n\t\t\t\t\tzIndex: 2500,\n\t\t\t\t\titems: this.items,\n\t\t\t\t\tpreselectedItems: this.preselectedItems,\n\t\t\t\t\tentities: this.entities,\n\t\t\t\t\ttabs: this.tabs,\n\t\t\t\t\tsearchOptions: {\n\t\t\t\t\t\tallowCreateItem: false,\n\t\t\t\t\t},\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t'Item:onSelect': (event: BaseEvent) => {\n\t\t\t\t\t\t\tconst { item: selectedItem } = event.getData();\n\t\t\t\t\t\t\tthis.emitSelectItem(selectedItem);\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'Item:onDeselect': (event: BaseEvent) => {\n\t\t\t\t\t\t\tconst { item: deselectedItem } = event.getData();\n\n\t\t\t\t\t\t\tthis.emitDeselectItem(deselectedItem);\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tthis.tagSelector.renderTo(this.$refs.dialog);\n\t\t},\n\t\temitSelectItem(selectedItem: Array): void\n\t\t{\n\t\t\tthis.$emit('onSelectItem', selectedItem);\n\t\t},\n\t\temitDeselectItem(deselectedItem: Array): void\n\t\t{\n\t\t\tthis.$emit('onDeselectItem', deselectedItem);\n\t\t},\n\t\tselectItem(itemId: ItemId): void\n\t\t{\n\t\t\tconst item = this.tagSelector.getDialog().getItem(itemId);\n\t\t\titem?.select();\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div ref=\"dialog\"></div>\n\t`,\n};\n","import { DialogWrapperComponent } from '../common/dialog-wrapper-component';\nimport { TagSelectorWrapperComponent } from '../common/tag-selector-wrapper-component';\n\nexport const CategorySelector = {\n\tcomponents: {\n\t\tTagSelectorWrapperComponent,\n\t\tDialogWrapperComponent,\n\t},\n\n\tprops: {\n\t\tcategories: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tcurrentCategoryId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\treadOnly: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\tdata(): Object\n\t{\n\t\tconst items = [];\n\t\tthis.categories.forEach((category, index) => {\n\t\t\titems.push({\n\t\t\t\tid: category.id,\n\t\t\t\ttitle: category.name,\n\t\t\t\tentityId: 'category',\n\t\t\t\ttabs: 'categories',\n\t\t\t\tselected: category.id === this.currentCategoryId,\n\t\t\t});\n\t\t});\n\n\t\treturn {\n\t\t\titems,\n\t\t};\n\t},\n\n\tcreated()\n\t{\n\t\tthis.tabs = [\n\t\t\t{ id: 'categories', title: '' },\n\t\t];\n\t},\n\n\twatch: {\n\t\tcurrentCategoryId(categoryId: string): void\n\t\t{\n\t\t\tthis.items.forEach((item) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\titem.selected = (item.id === categoryId);\n\t\t\t});\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<DialogWrapperComponent\n\t\t\t:items=\"items\"\n\t\t\t:tabs=\"tabs\"\n\t\t/>\n\t`,\n};\n","import { DialogWrapperComponent } from '../common/dialog-wrapper-component';\n\nexport const StageSelector = {\n\tcomponents: {\n\t\tDialogWrapperComponent,\n\t},\n\n\tprops: {\n\t\tcategory: {\n\t\t\ttype: Object,\n\t\t},\n\t\tcurrentStageId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\treadOnly: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\titems: this.getPreparedItems(),\n\t\t};\n\t},\n\n\tcreated()\n\t{\n\t\tthis.tabs = [\n\t\t\t{ id: 'stages', title: '' },\n\t\t];\n\t},\n\n\tmethods: {\n\t\tdestroy(): void\n\t\t{\n\t\t\tthis.$refs.dialog.destroy();\n\t\t},\n\t\tgetPreparedItems(setSelectedFirst: boolean = false): Array<Object>\n\t\t{\n\t\t\tconst items = [];\n\n\t\t\tif (this.category === null)\n\t\t\t{\n\t\t\t\treturn items;\n\t\t\t}\n\n\t\t\tlet hasSelected = true;\n\n\t\t\tObject.values(this.category.items).forEach((item) => {\n\t\t\t\titems.push({\n\t\t\t\t\tid: item.id,\n\t\t\t\t\ttitle: item.name,\n\t\t\t\t\tentityId: 'stage',\n\t\t\t\t\ttabs: 'stages',\n\t\t\t\t\tselected: (setSelectedFirst ? hasSelected : item.id === this.currentStageId),\n\t\t\t\t\tavatarOptions: {\n\t\t\t\t\t\tbgColor: item.color,\n\t\t\t\t\t\tborderRadius: 6,\n\t\t\t\t\t\tbgSize: 20,\n\t\t\t\t\t\tbgImage: 'none',\n\t\t\t\t\t},\n\t\t\t\t\tcustomData: {\n\t\t\t\t\t\tcolor: item.color,\n\t\t\t\t\t},\n\t\t\t\t});\n\n\t\t\t\thasSelected = false;\n\t\t\t});\n\n\t\t\treturn items;\n\t\t},\n\t},\n\n\twatch: {\n\t\tcategory(category: Object): void\n\t\t{\n\t\t\tthis.items = this.getPreparedItems(true);\n\t\t},\n\t\tcurrentStageId(categoryId: string): void\n\t\t{\n\t\t\tthis.items.forEach((item) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\titem.selected = (item.id === categoryId);\n\t\t\t});\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<DialogWrapperComponent\n\t\t\tref=\"dialog\"\n\t\t\t:items=\"items\"\n\t\t\t:tabs=\"tabs\"\n\t\t\t:showAvatars=\"true\"\n\t\t/>\n\t`,\n};\n","import { TagSelectorWrapperComponent } from '../common/tag-selector-wrapper-component';\n\nexport const UserSelector = {\n\tcomponents: {\n\t\tTagSelectorWrapperComponent,\n\t},\n\n\tprops: {\n\t\tuserIds: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\treadOnly: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tpreselectedItems: this.userIds.map((userId) => {\n\t\t\t\treturn ['user', userId];\n\t\t\t}),\n\t\t};\n\t},\n\n\tcreated()\n\t{\n\t\tthis.entities = [\n\t\t\t{\n\t\t\t\tid: 'user',\n\t\t\t\toptions: {\n\t\t\t\t\tinviteEmployeeLink: false,\n\t\t\t\t\temailUsers: false,\n\t\t\t\t\tinviteGuestLink: false,\n\t\t\t\t\tintranetUsersOnly: true,\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'structure-node',\n\t\t\t\toptions: {\n\t\t\t\t\tselectMode: 'usersOnly',\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<TagSelectorWrapperComponent \n\t\t\t:entities=\"entities\"\n\t\t\t:preselected-items=\"preselectedItems\"\n\t\t\t:show-avatars=\"true\"\n\t\t\t:multiple=\"true\"\n\t\t\t:read-only=\"readOnly\"\n\t\t/>\n\t`,\n};\n","import { ajax as Ajax, Loc, Text, Type } from 'main.core';\nimport { BBCodeParser } from 'ui.bbcode.parser';\nimport { UI } from 'ui.notification';\nimport { TextEditor } from 'ui.text-editor';\nimport { hint } from 'ui.vue3.directives.hint';\nimport { AdditionalInfoComponent } from './common/additional-info-component';\nimport { AiSwitcherComponent } from './common/ai-switcher-component';\nimport { TextEditorWrapperComponent } from './common/text-editor-wrapper-component';\nimport { Button, ButtonEvents } from './navigation/button';\nimport { CallAssessmentSelector } from './selector/call-assessment-selector';\nimport { CategorySelector } from './selector/category-selector';\nimport { StageSelector } from './selector/stage-selector';\nimport { UserSelector } from './selector/user-selector';\n\nconst ARTICLE_CODE = '23240682';\n\nexport const Segment = {\n\tcomponents: {\n\t\tButton,\n\t\tAdditionalInfoComponent,\n\t\tAiSwitcherComponent,\n\t\tTextEditorWrapperComponent,\n\t\tCallAssessmentSelector,\n\t\tCategorySelector,\n\t\tStageSelector,\n\t\tUserSelector,\n\t},\n\n\tdirectives: {\n\t\thint,\n\t},\n\n\tprops: {\n\t\tsettings: {\n\t\t\ttype: Object,\n\t\t\tdefault: {},\n\t\t},\n\t\tsegment: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tcategories: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tcallAssessments: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tevents: {\n\t\t\ttype: Object,\n\t\t\tdefault: {},\n\t\t},\n\t\ttextEditor: TextEditor,\n\t},\n\n\tdata(): Object\n\t{\n\t\tconst { segment, textEditor, categories } = this;\n\t\tconst id = segment?.id ?? null;\n\t\tconst isEnabled = segment?.isEnabled ?? null;\n\n\t\tconst firstCategory = categories[0];\n\n\t\treturn {\n\t\t\tid,\n\t\t\tisEnabled,\n\t\t\ttext: textEditor.getText(),\n\t\t\tparser: new BBCodeParser(),\n\t\t\tisVisibleExpertSettings: false,\n\n\t\t\tcurrentCategoryId: segment.entityCategoryId ?? firstCategory.id,\n\t\t\tcurrentStageId: segment.entityStageId ?? this.getFirstAvailableCategoryStageId(firstCategory),\n\t\t\tassignmentUserIds: new Set(segment.assignmentUserIds ?? []),\n\t\t\tcurrentEntityTitlePattern: segment.entityTitlePattern ?? null,\n\t\t\tcurrentCallAssessmentId: segment.callAssessmentId ?? null,\n\t\t\tcurrentIsAiEnabled: segment.isAiEnabled ?? true,\n\t\t};\n\t},\n\n\tmounted(): void\n\t{\n\t\tthis.$Bitrix.eventEmitter.subscribe(ButtonEvents.click, this.onNavigationButtonClick);\n\t},\n\n\tbeforeUnmount(): void\n\t{\n\t\tthis.$Bitrix.eventEmitter.unsubscribe(ButtonEvents.click, this.onNavigationButtonClick);\n\t},\n\n\tmethods: {\n\t\tonSaveCallback(): void\n\t\t{\n\t\t\tif (Type.isFunction(this.events?.onSave))\n\t\t\t{\n\t\t\t\tthis.events.onSave();\n\t\t\t}\n\t\t},\n\t\tonNavigationButtonClick({ data }): void\n\t\t{\n\t\t\tconst { id } = data;\n\t\t\tif (id === 'cancel' || id === 'close')\n\t\t\t{\n\t\t\t\tthis.closeSlider();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.sendData();\n\t\t},\n\t\tsendData(): void\n\t\t{\n\t\t\tconst data = {\n\t\t\t\tprompt: this.textEditor.getText(),\n\t\t\t\tentityTypeId: 2, // temporary only deal\n\t\t\t\tentityCategoryId: this.currentCategoryId,\n\t\t\t\tentityStageId: this.currentStageId,\n\t\t\t\tassignmentUserIds: [...this.assignmentUserIds.values()],\n\t\t\t\tentityTitlePattern: this.currentEntityTitlePattern,\n\t\t\t\tcallAssessmentId: this.currentCallAssessmentId,\n\t\t\t\tisAiEnabled: this.currentIsAiEnabled,\n\t\t\t};\n\n\t\t\tif (!this.validate(data))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst dataParams = {\n\t\t\t\tid: this.id,\n\t\t\t\tdata,\n\t\t\t};\n\n\t\t\ttop.BX.Event.EventEmitter.emit('crm:repeatSale:segment:beforeSave', dataParams);\n\n\t\t\tAjax\n\t\t\t\t.runAction('crm.repeatsale.segment.save', { json: dataParams })\n\t\t\t\t.then(\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\ttop.BX.Event.EventEmitter.emit('crm:repeatSale.segment:save', {\n\t\t\t\t\t\t\t...dataParams,\n\t\t\t\t\t\t\tstatus: response?.status,\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif (response?.status !== 'success')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\t\t\tcontent: Text.encode(response.errors[0].message),\n\t\t\t\t\t\t\t\tautoHideDelay: 6000,\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.onSaveCallback();\n\t\t\t\t\t\tthis.closeSlider();\n\t\t\t\t\t},\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tconst messageCode = 'CRM_REPEAT_SALE_SEGMENT_SAVE_ERROR';\n\n\t\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\t\tcontent: Loc.getMessage(messageCode),\n\t\t\t\t\t\t\tautoHideDelay: 6000,\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t)\n\t\t\t\t.catch((response) => {\n\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: Text.encode(response.errors[0].message),\n\t\t\t\t\t\tautoHideDelay: 6000,\n\t\t\t\t\t});\n\n\t\t\t\t\tthrow response;\n\t\t\t\t})\n\t\t\t;\n\t\t},\n\t\tvalidate(data: Object): boolean\n\t\t{\n\t\t\tif (!Type.isArrayFilled(data.assignmentUserIds))\n\t\t\t{\n\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\tcontent: Text.encode(Loc.getMessage('CRM_REPEAT_SALE_SEGMENT_VALIDATE_ASSIGNMENT_USERS_ERROR')),\n\t\t\t\t\tautoHideDelay: 6000,\n\t\t\t\t});\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\tcloseSlider(): void\n\t\t{\n\t\t\ttop.BX.SidePanel.Instance.getSliderByWindow(window).close();\n\t\t},\n\t\tgetPlainText(): number\n\t\t{\n\t\t\treturn this.parser.parse(this.textEditor.getText()).toPlainText().trim();\n\t\t},\n\t\ttoggleExpertSettings(): void\n\t\t{\n\t\t\tthis.isVisibleExpertSettings = !this.isVisibleExpertSettings;\n\n\t\t\tif (this.isVisibleExpertSettings)\n\t\t\t{\n\t\t\t\tvoid this.$nextTick(() => {\n\t\t\t\t\tthis.$refs.expertSettings.scrollIntoView(false);\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tshowHelpArticle(): void\n\t\t{\n\t\t\twindow.top.BX?.Helper?.show(`redirect=detail&code=${ARTICLE_CODE}`);\n\t\t},\n\n\t\tonSelectCategory(category: Object): void\n\t\t{\n\t\t\tif (this.currentCategoryId === category.id)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$refs.stageSelector.destroy();\n\t\t\tthis.currentCategoryId = category.id;\n\n\t\t\tvoid this.$nextTick(() => {\n\t\t\t\tconst currentCategory = this.getCategoryById(this.currentCategoryId);\n\t\t\t\tthis.currentStageId = this.getFirstAvailableCategoryStageId(currentCategory);\n\t\t\t});\n\t\t},\n\t\tonSelectStage(stage: Object): void\n\t\t{\n\t\t\tthis.currentStageId = stage.id;\n\t\t},\n\t\tgetCategoryById(id: number): Object\n\t\t{\n\t\t\treturn this.categories.find((category) => category.id === id);\n\t\t},\n\t\tgetFirstAvailableCategoryStageId(category: Object): string\n\t\t{\n\t\t\treturn category.items[0].id;\n\t\t},\n\t\tonSelectAssignmentUser(user: Object): void\n\t\t{\n\t\t\tthis.assignmentUserIds.add(user.id);\n\t\t},\n\t\tonDeselectAssignmentUser(user: Object): void\n\t\t{\n\t\t\tthis.assignmentUserIds.delete(user.id);\n\t\t},\n\t\tsetCurrentCallAssessmentId(id: number): void\n\t\t{\n\t\t\tthis.currentCallAssessmentId = id;\n\t\t},\n\t\tgetMessageByCode(code: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(code);\n\t\t},\n\t\tsetCurrentIsAiEnabled(value: boolean): void\n\t\t{\n\t\t\tthis.currentIsAiEnabled = value;\n\t\t},\n\t},\n\n\tcomputed: {\n\t\treadOnly(): boolean\n\t\t{\n\t\t\treturn this.settings.isReadOnly;\n\t\t},\n\t\taiCallEnabled(): boolean\n\t\t{\n\t\t\treturn this.settings.isAiCallEnabled;\n\t\t},\n\t\tchevronClassList(): Array\n\t\t{\n\t\t\treturn [\n\t\t\t\t'crm-repeat-sale__segment-expert-settings-btn-chevron',\n\t\t\t\t{ '--active': this.isVisibleExpertSettings },\n\t\t\t];\n\t\t},\n\t\trepeatSaleSegmentSection(): Array\n\t\t{\n\t\t\treturn [\n\t\t\t\t'crm-repeat-sale__segment-section',\n\t\t\t\t{ '--active': this.isVisibleExpertSettings },\n\t\t\t];\n\t\t},\n\t\ttitle(): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(\n\t\t\t\t'CRM_REPEAT_SALE_SEGMENT_TITLE',\n\t\t\t\t{\n\t\t\t\t\t'#TITLE#': this.segment.title,\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\t\tcurrentCategory(): ?Object\n\t\t{\n\t\t\treturn this.categories.find((category) => category.id === this.currentCategoryId) ?? null;\n\t\t},\n\t\tmessages(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tmanualTitle: this.getMessageByCode('CRM_REPEAT_SALE_SEGMENT_MANUAL_TITLE'),\n\t\t\t\tmanualDescription: this.getMessageByCode('CRM_REPEAT_SALE_SEGMENT_MANUAL_DESCRIPTION'),\n\t\t\t\ttextAreaTitle: this.getMessageByCode('CRM_REPEAT_SALE_SEGMENT_MANUAL_TEXTAREA_TITLE'),\n\t\t\t\tdealHelp: this.getMessageByCode('CRM_REPEAT_SALE_SEGMENT_DEAL_HELP'),\n\t\t\t\tsectionTitle: this.getMessageByCode('CRM_REPEAT_SALE_SEGMENT_MANUAL_SECTION_TITLE'),\n\t\t\t\tstageTitle: this.getMessageByCode('CRM_REPEAT_SALE_SEGMENT_MANUAL_STAGE_TITLE'),\n\t\t\t\tdealAssignedTitle: this.getMessageByCode('CRM_REPEAT_SALE_SEGMENT_DEAL_ASSIGNED_TITLE'),\n\t\t\t\texpert: this.getMessageByCode('CRM_REPEAT_SALE_SEGMENT_EXPERT'),\n\t\t\t\tdealTitle: this.getMessageByCode('CRM_REPEAT_SALE_SEGMENT_DEAL_TITLE'),\n\t\t\t\tdealDescription: this.getMessageByCode('CRM_REPEAT_SALE_SEGMENT_DEAL_DESCRIPTION'),\n\t\t\t\tdealTitlePattern: this.getMessageByCode('CRM_REPEAT_SALE_SEGMENT_DEAL_NAME_PATTERN_TITLE'),\n\t\t\t\tcopilot: this.getMessageByCode('CRM_REPEAT_SALE_SEGMENT_COPILOT_TITLE'),\n\t\t\t\tassessmentTitle: this.getMessageByCode('CRM_REPEAT_SALE_SEGMENT_CALL_ASSESSMENT_TITLE'),\n\t\t\t\tassessmentDescription: this.getMessageByCode('CRM_REPEAT_SALE_SEGMENT_CALL_ASSESSMENT_DESCRIPTION'),\n\t\t\t};\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"crm-repeat-sale__segment_container\">\n\t\t\t<div class=\"crm-repeat-sale__segment-wrapper\">\n\t\t\t\t<header class=\"crm-repeat-sale__segment-section-header\">\n\t\t\t\t\t<div class=\"crm-repeat-sale__segment-section-header-title\">\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t{{title}}\n\t\t\t\t\t\t\t<span \n\t\t\t\t\t\t\t\tv-if=\"segment.description\"\n\t\t\t\t\t\t\t\tv-hint=\"segment.description\"\n\t\t\t\t\t\t\t\tclass=\"crm-repeat-sale__segment-section-header-help\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</header>\n\t\t\t\t<div class=\"crm-repeat-sale__segment-section-body\">\n\t\t\t\t\t<section class=\"crm-repeat-sale__segment-section --active\">\n\t\t\t\t\t\t<h1 class=\"crm-repeat-sale__segment-section-title\">\n\t\t\t\t\t\t\t{{messages.manualTitle}}\n\t\t\t\t\t\t</h1>\n\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-section-description\">\n\t\t\t\t\t\t\t{{messages.manualDescription}}\n\t\t\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-fields-row\">\n\t\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-field\">\n\t\t\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-field-title\">\n\t\t\t\t\t\t\t\t\t{{messages.textAreaTitle}}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<TextEditorWrapperComponent\n\t\t\t\t\t\t\t\t\t:textEditor=\"textEditor\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<AdditionalInfoComponent \n\t\t\t\t\t\t\t\t\t:title=\"messages.dealHelp\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-fields-row\">\n\t\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-field\">\n\t\t\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-field-title\">\n\t\t\t\t\t\t\t\t\t{{messages.sectionTitle}}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<CategorySelector \n\t\t\t\t\t\t\t\t\t:current-category-id=\"currentCategoryId\"\n\t\t\t\t\t\t\t\t\t:categories=\"categories\"\n\t\t\t\t\t\t\t\t\t@onSelectItem=\"onSelectCategory\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-field\">\n\t\t\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-field-title\">\n\t\t\t\t\t\t\t\t\t{{messages.stageTitle}}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<StageSelector \n\t\t\t\t\t\t\t\t\tref=\"stageSelector\"\n\t\t\t\t\t\t\t\t\t:current-stage-id=\"currentStageId\"\n\t\t\t\t\t\t\t\t\t:category=\"currentCategory\"\n\t\t\t\t\t\t\t\t\t@onSelectItem=\"onSelectStage\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-fields-row\">\n\t\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-field\">\n\t\t\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-field-title\">\n\t\t\t\t\t\t\t\t\t{{messages.dealAssignedTitle}}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<UserSelector\n\t\t\t\t\t\t\t\t\t:user-ids=\"[...assignmentUserIds.values()]\"\n\t\t\t\t\t\t\t\t\t:read-only=\"readOnly\"\n\t\t\t\t\t\t\t\t\t@onSelectItem=\"onSelectAssignmentUser\"\n\t\t\t\t\t\t\t\t\t@onDeselectItem=\"onDeselectAssignmentUser\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</section>\n\t\t\t\n\t\t\t\t\t<div class=\"crm-repeat-sale__segment-expert-settings-btn-wrapper\">\n\t\t\t\t\t\t<span \n\t\t\t\t\t\t\tclass=\"crm-repeat-sale__segment-expert-settings-btn\"\n\t\t\t\t\t\t\t@click=\"toggleExpertSettings\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{messages.expert}}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span \n\t\t\t\t\t\t\t:class=\"chevronClassList\"\n\t\t\t\t\t\t\t@click=\"toggleExpertSettings\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\n\t\t\t\t\t<section :class=\"repeatSaleSegmentSection\" ref=\"expertSettings\">\n\t\t\t\t\t\t<h1 class=\"crm-repeat-sale__segment-section-title --level2\">\n\t\t\t\t\t\t\t{{messages.dealTitle}}\n\t\t\t\t\t\t</h1>\n\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-section-description\">\n\t\t\t\t\t\t\t{{messages.dealDescription}}\n\t\t\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-fields-row\">\n\t\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-field\">\n\t\t\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-field-title\">\n\t\t\t\t\t\t\t\t\t{{messages.dealTitlePattern}}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<input \n\t\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\tv-model=\"currentEntityTitlePattern\"\n\t\t\t\t\t\t\t\t\t:readonly=\"readOnly\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-fields-row\">\n\t\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-field\">\n\t\t\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-field-title\">\n\t\t\t\t\t\t\t\t\t{{messages.copilot}}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<AiSwitcherComponent\n\t\t\t\t\t\t\t\t\t:checked=\"currentIsAiEnabled\"\n\t\t\t\t\t\t\t\t\t:read-only=\"readOnly\"\n\t\t\t\t\t\t\t\t\t@change=\"setCurrentIsAiEnabled\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</section>\n\t\t\t\n\t\t\t\t\t<section \n\t\t\t\t\t\t:class=\"repeatSaleSegmentSection\"\n\t\t\t\t\t\tv-if=\"aiCallEnabled && false\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<h1 class=\"crm-repeat-sale__segment-section-title --level2\">\n\t\t\t\t\t\t\t{{messages.assessmentTitle}}\n\t\t\t\t\t\t</h1>\n\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-section-description\">\n\t\t\t\t\t\t\t{{messages.assessmentDescription}}\n\t\t\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-field\">\n\t\t\t\t\t\t\t<CallAssessmentSelector \n\t\t\t\t\t\t\t\t:call-assessments=\"callAssessments\"\n\t\t\t\t\t\t\t\t:current-call-assessment-id=\"currentCallAssessmentId\"\n\t\t\t\t\t\t\t\t:read-only=\"readOnly\"\n\t\t\t\t\t\t\t\t@onSelectItem=\"setCurrentCallAssessmentId\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{{currentCallAssessmentId}}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</section>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"crm-repeat-sale__segment_navigation-container\">\n\t\t\t\t<div class=\"crm-repeat-sale__segment_navigation-buttons-wrapper\">\n\t\t\t\t\t<Button v-if=\"!readOnly\" id=\"update\" />\n\t\t\t\t\t<Button v-if=\"!readOnly\" id=\"cancel\" />\n\t\t\t\t\t<Button v-if=\"readOnly\" id=\"close\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Loc, Type } from 'main.core';\nimport { BasicEditor } from 'ui.text-editor';\nimport { BitrixVue, VueCreateAppResult } from 'ui.vue3';\nimport { Segment as SegmentComponent } from './components/segment';\nimport 'ui.design-tokens';\nimport 'ui.design-tokens.air';\nimport './segment.css';\n\ntype RepeatSaleSegmentParams = {\n\tdata: Object,\n\tconfig?: Object,\n\tevents?: Object,\n}\n\nexport class Segment\n{\n\t#container: HTMLElement;\n\t#app: ?VueCreateAppResult = null;\n\n\t#textEditor: BasicEditor = null;\n\t#isReadOnly: boolean = true;\n\n\tconstructor(containerId: string, params: RepeatSaleSegmentParams = {})\n\t{\n\t\tthis.#container = document.getElementById(containerId);\n\n\t\tif (!Type.isDomNode(this.#container))\n\t\t{\n\t\t\tthrow new Error('container not found');\n\t\t}\n\n\t\tthis.#isReadOnly = params.config?.readOnly ?? true;\n\n\t\tthis.#app = BitrixVue.createApp(SegmentComponent, {\n\t\t\ttextEditor: this.#getTextEditor(params.data.segment, params.config ?? {}),\n\t\t\ttitle: params.config?.title ?? '',\n\t\t\tsettings: {\n\t\t\t\tisReadOnly: this.#isReadOnly,\n\t\t\t\tisCopy: params.config?.isCopy ?? false,\n\t\t\t\tisAiCallEnabled: params.data.isAiCallEnabled,\n\t\t\t},\n\t\t\tsegment: params.data.segment,\n\t\t\tcategories: params.data.categories,\n\t\t\tcallAssessments: params.data.callAssessments,\n\t\t\tevents: params.events,\n\t\t});\n\n\t\tthis.#app.mount(this.#container);\n\t}\n\n\t#getTextEditor({ prompt: content }, { copilotSettings }): BasicEditor\n\t{\n\t\tif (this.#textEditor !== null)\n\t\t{\n\t\t\treturn this.#textEditor;\n\t\t}\n\n\t\tconst floatingToolbar = (\n\t\t\tthis.#isReadOnly\n\t\t\t\t? []\n\t\t\t\t: [\n\t\t\t\t\t'bold', 'italic', 'underline', 'strikethrough',\n\t\t\t\t\t'|',\n\t\t\t\t\t'numbered-list', 'bulleted-list',\n\t\t\t\t\t'copilot',\n\t\t\t\t]\n\t\t);\n\n\t\tthis.#textEditor = new BasicEditor({\n\t\t\teditable: !this.#isReadOnly,\n\t\t\tremovePlugins: ['BlockToolbar'],\n\t\t\tminHeight: 250,\n\t\t\tmaxHeight: 400,\n\t\t\tcontent,\n\t\t\tplaceholder: Loc.getMessage('CRM_REPEAT_SALE_SEGMENT_PLACEHOLDER'),\n\t\t\tparagraphPlaceholder: Loc.getMessage(\n\t\t\t\tType.isPlainObject(copilotSettings)\n\t\t\t\t\t? 'CRM_REPEAT_SALE_SEGMENT_PLACEHOLDER_WITH_COPILOT'\n\t\t\t\t\t: null,\n\t\t\t),\n\t\t\ttoolbar: [],\n\t\t\tfloatingToolbar,\n\t\t\tcollapsingMode: false,\n\t\t\tcopilot: {\n\t\t\t\tcopilotOptions: Type.isPlainObject(copilotSettings) ? copilotSettings : null,\n\t\t\t\ttriggerBySpace: true,\n\t\t\t},\n\t\t});\n\n\t\treturn this.#textEditor;\n\t}\n}\n"],"names":["AdditionalInfoComponent","props","title","type","String","required","mounted","popup","region","Extension","getSettings","get","Event","EventEmitter","subscribe","event","hide","methods","onClick","PromoVideoPopup","angleOptions","targetOptions","useOverlay","videoSrc","videoContainerMinHeight","Loc","getMessage","colors","show","computed","name","includes","template","AiSwitcherComponent","emits","components","checked","Boolean","readOnly","default","renderSwitcher","switcher","Switcher","disabled","size","SwitcherSize","small","showStateTitle","handlers","emitChange","unchecked","renderTo","$refs","value","$emit","TextEditorWrapperComponent","TextEditorComponent","textEditor","TextEditor","data","textEditorEvents","onChange","emitChangeData","setTextEditorHeight","windowResizeHandler","bind","window","unmounted","unbind","Type","isFunction","onChangeDebounce","Runtime","debounce","prompt","getText","editorOffsetTop","$el","parentNode","offsetTop","navigationClassName","navigationOffsetTop","document","querySelector","textEditorContainerBottomPadding","availableHeight","minHeight","Math","round","maxHeight","setMinHeight","setMaxHeight","ButtonEvents","click","Button","id","initButton","button","UiButton","useAirDesign","text","toUpperCase","style","buttonStyle","onclick","emitClickEvent","setDataSet","toLowerCase","$Bitrix","eventEmitter","emit","AirButtonStyle","FILLED","OUTLINE","CallAssessmentSelector","callAssessments","Object","currentCallAssessmentId","Number","created","dialog","tabs","items","forEach","callAssessment","index","push","entityId","selected","toggleDialog","getDialog","isOpen","targetNode","parentPopupContainer","closest","Dialog","context","multiple","dropdownMode","showAvatars","enableSearch","width","zIndex","searchOptions","allowCreateItem","events","item","getData","emitSelectItem","onShow","bindOnce","onPopupContainerClick","itemId","DialogWrapperComponent","Array","entities","selectedItem","deselectedItem","emitDeselectItem","selectItem","getItem","select","destroy","elementTitle","find","customData","controlClassList","iconClassList","color","iconStyleList","backgroundColor","TagSelectorWrapperComponent","preselectedItems","initDialog","watch","tagSelector","Dom","clean","TagSelector","readonly","hideOnSelect","dialogOptions","CategorySelector","categories","currentCategoryId","category","categoryId","StageSelector","currentStageId","getPreparedItems","setSelectedFirst","hasSelected","values","avatarOptions","bgColor","borderRadius","bgSize","bgImage","UserSelector","userIds","map","userId","options","inviteEmployeeLink","emailUsers","inviteGuestLink","intranetUsersOnly","selectMode","ARTICLE_CODE","Segment","directives","hint","settings","segment","isEnabled","firstCategory","parser","BBCodeParser","isVisibleExpertSettings","entityCategoryId","entityStageId","getFirstAvailableCategoryStageId","assignmentUserIds","Set","currentEntityTitlePattern","entityTitlePattern","callAssessmentId","currentIsAiEnabled","isAiEnabled","onNavigationButtonClick","beforeUnmount","unsubscribe","onSaveCallback","onSave","closeSlider","sendData","entityTypeId","validate","dataParams","top","BX","Ajax","runAction","json","then","response","status","UI","Notification","Center","notify","content","Text","encode","errors","message","autoHideDelay","messageCode","catch","isArrayFilled","SidePanel","Instance","getSliderByWindow","close","getPlainText","parse","toPlainText","trim","toggleExpertSettings","$nextTick","expertSettings","scrollIntoView","showHelpArticle","Helper","onSelectCategory","stageSelector","currentCategory","getCategoryById","onSelectStage","stage","onSelectAssignmentUser","user","add","onDeselectAssignmentUser","delete","setCurrentCallAssessmentId","getMessageByCode","code","setCurrentIsAiEnabled","isReadOnly","aiCallEnabled","isAiCallEnabled","chevronClassList","repeatSaleSegmentSection","messages","manualTitle","manualDescription","textAreaTitle","dealHelp","sectionTitle","stageTitle","dealAssignedTitle","expert","dealTitle","dealDescription","dealTitlePattern","copilot","assessmentTitle","assessmentDescription","constructor","containerId","params","getElementById","isDomNode","Error","config","BitrixVue","createApp","SegmentComponent","isCopy","mount","copilotSettings","floatingToolbar","BasicEditor","editable","removePlugins","placeholder","paragraphPlaceholder","isPlainObject","toolbar","collapsingMode","copilotOptions","triggerBySpace"],"mappings":"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"}