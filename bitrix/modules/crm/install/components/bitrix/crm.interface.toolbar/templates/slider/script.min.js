if(typeof BX.InterfaceToolBar==="undefined"){BX.InterfaceToolBar=function(){this._id="";this._settings=null;this._container=null;this._menuButton=null;this._menuPopup=null;this._isMenuOpened=false};BX.InterfaceToolBar.prototype={initialize:function(e,t){this._id=e;this._settings=t?t:BX.CrmParamBag.create(null);var n=this._container=BX(this.getSetting("containerId",""));if(n){var i=this.getSetting("menuButtonClassName");if(!BX.type.isNotEmptyString(i)){i=this.getSetting("moreButtonClassName","crmsettingbtn")}if(BX.type.isNotEmptyString(i)){this._menuButton=BX.findChild(n,{className:i},true,false);if(this._menuButton){BX.bind(this._menuButton,"click",BX.delegate(this.onMenuButtonClick,this))}}}},getId:function(){return this._id},getSetting:function(e,t){return this._settings.getParam(e,t)},prepareMenuItem:function(e){var t=/return\s+false(\s*;)?\s*$/;var n=/;\s*$/;var i=typeof e["SEPARATOR"]!=="undefined"?e["SEPARATOR"]:false;if(i){return{delimiter:true}}var o=typeof e["LINK"]!=="undefined"?e["LINK"]:"";var u=typeof e["ONCLICK"]!=="undefined"?e["ONCLICK"]:"";if(o!==""){var s='window.top.location.href = "'+o+'";';u=u!==""?s+" "+u:s}if(u!==""){if(!t.test(u)){if(!n.test(u)){u+=";"}u+=" return false;"}}var r={text:typeof e["TEXT"]!=="undefined"?e["TEXT"]:"",className:"menupopupitemnone"};if(u!==""){r["onclick"]=u}if(BX.type.isArray(e["MENU"])){var p=[];for(var a=0,f=e["MENU"].length;a<f;a++){p.push(this.prepareMenuItem(e["MENU"][a]))}r["items"]=p}return r},openMenu:function(e){if(this._isMenuOpened){this.closeMenu();return}var t=this.getSetting("items",null);if(!BX.type.isArray(t)){return}var n=[];for(var i=0;i<t.length;i++){n.push(this.prepareMenuItem(t[i]))}BX.onCustomEvent(window,"Crm.InterfaceToolbar.MenuBuild",[this,{items:n}]);this._menuId=this._id.toLowerCase()+"_menu";BX.PopupMenu.show(this._menuId,this._menuButton,n,{autoHide:true,closeByEsc:true,offsetTop:0,offsetLeft:0,events:{onPopupShow:BX.delegate(this.onPopupShow,this),onPopupClose:BX.delegate(this.onPopupClose,this),onPopupDestroy:BX.delegate(this.onPopupDestroy,this)}});this._menuPopup=BX.PopupMenu.currentItem},closeMenu:function(){if(this._menuPopup){if(this._menuPopup.popupWindow){this._menuPopup.popupWindow.destroy()}}},onMenuButtonClick:function(e){this.openMenu()},onPopupShow:function(){this._isMenuOpened=true},onPopupClose:function(){this.closeMenu()},onPopupDestroy:function(){this._isMenuOpened=false;this._menuPopup=null;if(typeof BX.PopupMenu.Data[this._menuId]!=="undefined"){delete BX.PopupMenu.Data[this._menuId]}},onEditorConfigReset:function(){var e=BX.Crm.EntityEditor.getDefault();if(e){e.resetConfig()}}};BX.InterfaceToolBar.create=function(e,t){var n=new BX.InterfaceToolBar;n.initialize(e,t);return n}}
//# sourceMappingURL=script.map.js