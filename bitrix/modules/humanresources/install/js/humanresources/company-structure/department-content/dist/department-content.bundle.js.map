{"version":3,"file":"department-content.bundle.js","sources":["../src/components/users/consts.js","../src/components/users/empty-tab-add-button.js","../src/api.js","../src/actions.js","../src/components/users/item/move-user-action-popup.js","../src/components/users/item/action-button.js","../src/components/users/item/item.js","../src/components/base-components/empty-state/empty-state.js","../src/components/base-components/list/empty-list-item.js","../src/components/base-components/list/list-action-button.js","../src/components/base-components/list/list.js","../src/components/base-components/search/search-input.js","../src/components/users/tab.js","../src/components/chats/consts.js","../src/components/chats/empty-tab-add-buttons.js","../src/components/chats/list-item.js","../src/components/chats/tab.js","../src/components/department-content.js"],"sourcesContent":["export const HeadListDataTestIds = Object.freeze({\n\tcontainerDataTestId: 'hr-department-content_users-tab__head-list-container',\n\tlistActionButtonDataTestId: 'hr-department-content_users-tab__head-list-action-button',\n\tlistActonMenuDataTestId: 'hr-department-content_users-tab__head-list-action-menu-container',\n\tlistCounterDataTestId: 'hr-department-content_users-tab__head-list-counter',\n});\n\nexport const EmployeeListDataTestIds = Object.freeze({\n\tcontainerDataTestId: 'hr-department-content_users-tab__employee-list-container',\n\tlistActionButtonDataTestId: 'hr-department-content_users-tab__employee-list-action-button',\n\tlistActonMenuDataTestId: 'hr-department-content_users-tab__employee-list-action-menu-container',\n\tlistCounterDataTestId: 'hr-department-content_users-tab__employee-list-counter',\n});","import { AnalyticsSourceType } from 'humanresources.company-structure.api';\nimport { EmptyUsersTabActionMenu } from 'humanresources.company-structure.org-chart';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { EntityTypes } from 'humanresources.company-structure.utils';\nimport { mapState } from 'ui.vue3.pinia';\nimport { RouteActionMenu } from 'humanresources.company-structure.structure-components';\n\nimport 'ui.icon-set.crm';\nimport 'ui.icon-set.main';\nimport './styles/empty-tab-add-buttons.css';\n\nexport const EmptyTabAddButton = {\n\tname: 'emptyStateContainer',\n\n\tcomponents: { RouteActionMenu },\n\n\tprops: {\n\t\tdepartmentId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tentityType: {\n\t\t\ttype: String,\n\t\t\tdefault: EntityTypes.department,\n\t\t},\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tmenuVisible: false,\n\t\t};\n\t},\n\n\tcomputed: {\n\t\tmenu(): EmptyUsersTabActionMenu\n\t\t{\n\t\t\treturn new EmptyUsersTabActionMenu(this.departmentId, AnalyticsSourceType.DETAIL, null, this.entityType);\n\t\t},\n\t\t...mapState(useChartStore, ['focusedNode']),\n\t},\n\n\tmethods:\n\t{\n\t\tloc(phraseCode: string, replacements: {[p: string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tonClick(): void\n\t\t{\n\t\t\tif ((this.entityType === EntityTypes.team) && (this.menu.items.length === 1))\n\t\t\t{\n\t\t\t\t// for teams for now there can be only one item, so we invoke action right away\n\t\t\t\tthis.onActionMenuItemClick(this.menu.items[0].id);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.menuVisible = true;\n\t\t\t}\n\t\t},\n\t\tonActionMenuItemClick(actionId: string): void\n\t\t{\n\t\t\tthis.menu.onActionMenuItemClick(actionId);\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"hr-department-detail-content__users-empty-tab-add_buttons-container\">\n\t\t\t<button\n\t\t\t\tclass=\"hr-add-employee-empty-tab-entity-btn ui-btn ui-btn ui-btn-sm ui-btn-primary ui-btn-round\"\n\t\t\t\tref=\"actionMenuButton\"\n\t\t\t\t@click.stop=\"onClick\"\n\t\t\t\tdata-id=\"hr-department-detail-content__user-empty-tab_add-user-button\"\n\t\t\t>\n\t\t\t\t<span class=\"hr-add-employee-empty-tab-entity-btn-text\">{{loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPTY_EMPLOYEES_ADD_USER_ADD_BUTTON')}}</span>\n\t\t\t</button>\n\t\t\t<RouteActionMenu\n\t\t\t\tv-if=\"menuVisible\"\n\t\t\t\t:id=\"'empty-state-department-detail-add-menu-' + focusedNode\"\n\t\t\t\t:items=\"menu.items\"\n\t\t\t\t:width=\"302\"\n\t\t\t\t:bindElement=\"$refs['actionMenuButton']\"\n\t\t\t\t@action=\"onActionMenuItemClick\"\n\t\t\t\t@close=\"menuVisible = false\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { getData, postData } from 'humanresources.company-structure.api';\n\nexport const DepartmentAPI = {\n\tgetPagedEmployees: (id: Number, page: Number, countPerPage: Number) => {\n\t\treturn getData('humanresources.api.Structure.Node.Member.Employee.list', { nodeId: id, page, countPerPage });\n\t},\n\tremoveUserFromDepartment: (nodeId: number, userId: number): Promise<void> => {\n\t\treturn postData('humanresources.api.Structure.Node.Member.deleteUser', {\n\t\t\tnodeId,\n\t\t\tuserId,\n\t\t});\n\t},\n\tmoveUserToDepartment: (nodeId: number, userId: number, targetNodeId: number): Promise<void> => {\n\t\treturn postData('humanresources.api.Structure.Node.Member.moveUser', {\n\t\t\tnodeId,\n\t\t\tuserId,\n\t\t\ttargetNodeId,\n\t\t});\n\t},\n\tisUserInMultipleDepartments: (userId: number): Promise<void> => {\n\t\treturn getData('humanresources.api.User.isUserInMultipleDepartments', {\n\t\t\tuserId,\n\t\t});\n\t},\n\tgetUserInfo: (nodeId: number, userId: number): Promise<void> => {\n\t\treturn getData('humanresources.api.User.getInfoByUserMember', {\n\t\t\tnodeId,\n\t\t\tuserId,\n\t\t});\n\t},\n\tfireUser: (userId: number): Promise<void> => {\n\t\treturn postData('intranet.user.fire', {\n\t\t\tuserId,\n\t\t});\n\t},\n\tfindMemberByQuery: (nodeId: number, query: string): Promise<void> => {\n\t\treturn getData('humanresources.api.Structure.Node.Member.find', {\n\t\t\tnodeId,\n\t\t\tquery,\n\t\t});\n\t},\n\tgetChatsAndChannels: (nodeId: number) => {\n\t\treturn getData('humanresources.api.Structure.Node.Member.Chat.getList', {\n\t\t\tnodeId,\n\t\t});\n\t},\n\tsaveChats: (\n\t\tnodeId: number,\n\t\tids: number[],\n\t): Promise<Array> => {\n\t\treturn postData('humanresources.api.Structure.Node.Member.Chat.saveChatList', {\n\t\t\tnodeId,\n\t\t\tids,\n\t\t});\n\t},\n};\n","import { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { getMemberRoles } from 'humanresources.company-structure.api';\nimport { Type } from 'main.core';\n\nexport const DepartmentContentActions = {\n\tmoveUserToDepartment: (departmentId, userId, targetDepartmentId, role): void => {\n\t\tconst store = useChartStore();\n\t\tconst department = store.departments.get(departmentId);\n\t\tconst targetDepartment = store.departments.get(targetDepartmentId);\n\n\t\tif (!department || !targetDepartment)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst oldMemberRoles = getMemberRoles(department.entityType);\n\t\tconst targetMemberRoles = getMemberRoles(targetDepartment.entityType);\n\t\tconst user = role === oldMemberRoles.employee\n\t\t\t? department.employees?.find((employee) => employee.id === userId)\n\t\t\t: department.heads.find((head) => head.id === userId)\n\t\t;\n\t\tif (!user)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tdepartment.userCount -= 1;\n\t\tif (role === oldMemberRoles.employee)\n\t\t{\n\t\t\tdepartment.employees = department.employees.filter((employee) => employee.id !== userId);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdepartment.heads = department.heads.filter((head) => head.id !== userId);\n\t\t}\n\n\t\ttargetDepartment.userCount += 1;\n\t\tif (userId === store.userId)\n\t\t{\n\t\t\tstore.changeCurrentDepartment(departmentId, targetDepartmentId);\n\t\t}\n\n\t\tuser.role = targetMemberRoles.employee;\n\t\tif (!targetDepartment.employees)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\ttargetDepartment.employees.push(user);\n\t},\n\tremoveUserFromDepartment: (departmentId, userId, role): void => {\n\t\tconst store = useChartStore();\n\t\tconst department = store.departments.get(departmentId);\n\t\tconst oldMemberRoles = getMemberRoles(department.entityType);\n\t\tif (!department)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (userId === store.userId)\n\t\t{\n\t\t\tstore.changeCurrentDepartment(departmentId);\n\t\t}\n\n\t\tdepartment.userCount -= 1;\n\t\tif (role === oldMemberRoles.employee)\n\t\t{\n\t\t\tdepartment.employees = department.employees.filter((employee) => employee.id !== userId);\n\n\t\t\treturn;\n\t\t}\n\n\t\tdepartment.heads = department.heads.filter((head) => head.id !== userId);\n\t},\n\tupdateEmployees: (departmentId: number, employees: Array): void => {\n\t\tconst { departments } = useChartStore();\n\t\tconst department = departments.get(departmentId);\n\n\t\tif (!department)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tdepartments.set(departmentId, { ...department, employees });\n\t},\n\tupdateEmployeeListOptions: (\n\t\tdepartmentId: number,\n\t\toptions: { page?: number, shouldUpdateList?: boolean, isListUpdated?: boolean },\n\t): void => {\n\t\tconst { departments } = useChartStore();\n\t\tconst department = departments.get(departmentId);\n\n\t\tif (!department)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tdepartment.employeeListOptions = {\n\t\t\t...department.employeeListOptions,\n\t\t\t...options,\n\t\t};\n\n\t\tdepartments.set(departmentId, department);\n\t},\n\tsetChatsAndChannels: (\n\t\tnodeId: number,\n\t\tchats: Array,\n\t\tchannels: Array,\n\t): void => {\n\t\tconst store = useChartStore();\n\t\tconst department = store.departments.get(nodeId);\n\t\tif (!department)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tdepartment.channels = channels;\n\t\tdepartment.chats = chats;\n\t\tdepartment.chatAndChannelsCount = (chats.length + channels.length);\n\t},\n\tremoveUserFromAllDepartments: async (userId): Promise<void> => {\n\t\tconst store = useChartStore();\n\t\tconst departments = store.departments;\n\t\tconst departmentsToUpdate = [];\n\n\t\tfor (const [key, department] of departments)\n\t\t{\n\t\t\tif (\n\t\t\t\t(\n\t\t\t\t\t'heads' in department\n\t\t\t\t\t&& Type.isArray(department.heads)\n\t\t\t\t\t&& department.heads.some((employee) => employee.id === userId)\n\t\t\t\t)\n\t\t\t\t|| (\n\t\t\t\t\t'employees' in department\n\t\t\t\t\t&& Type.isArray(department.employees)\n\t\t\t\t\t&& department.employees.some((employee) => employee.id === userId)\n\t\t\t\t)\n\t\t\t)\n\t\t\t{\n\t\t\t\tdepartmentsToUpdate.push(key);\n\t\t\t}\n\t\t}\n\n\t\treturn store.refreshDepartments(departmentsToUpdate);\n\t},\n};\n","import { getMemberRoles, type MemberRolesType } from 'humanresources.company-structure.api';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { PermissionActions, PermissionChecker } from 'humanresources.company-structure.permission-checker';\nimport { ConfirmationPopup } from 'humanresources.company-structure.structure-components';\nimport { EntityTypes } from 'humanresources.company-structure.utils';\nimport { Text } from 'main.core';\nimport { type BaseEvent } from 'main.core.events';\nimport { TagSelector } from 'ui.entity-selector';\nimport { UI } from 'ui.notification';\nimport { mapState } from 'ui.vue3.pinia';\nimport { DepartmentContentActions } from '../../../actions';\nimport { DepartmentAPI } from '../../../api';\n\nimport './styles/move-user-action-popup.css';\n\n// @vue/component\nexport const MoveUserActionPopup = {\n\tname: 'MoveUserActionPopup',\n\tcomponents: { ConfirmationPopup },\n\temits: ['close', 'action'],\n\n\tprops: {\n\t\tparentId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tuser: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tentityType: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.permissionChecker = PermissionChecker.getInstance();\n\n\t\tif (!this.permissionChecker)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.action = this.isTeamEntity\n\t\t\t? PermissionActions.teamAddMember\n\t\t\t: PermissionActions.employeeAddToDepartment\n\t\t;\n\t\tthis.selectedDepartmentId = 0;\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tshowMoveUserActionLoader: false,\n\t\t\tlockMoveUserActionButton: false,\n\t\t\tshowUserAlreadyBelongsToDepartmentPopup: false,\n\t\t\taccessDenied: false,\n\t\t};\n\t},\n\n\tmounted(): void\n\t{\n\t\tconst departmentContainer = this.$refs['department-selector'];\n\t\tthis.departmentSelector = this.createTagSelector();\n\t\tthis.departmentSelector.renderTo(departmentContainer);\n\t},\n\n\tcomputed: {\n\t\t...mapState(useChartStore, ['departments', 'focusedNode']),\n\t\tincludedNodeEntityTypesInDialog(): string[]\n\t\t{\n\t\t\treturn this.isTeamEntity ? ['team'] : ['department'];\n\t\t},\n\t\tgetMoveUserActionPhrase(): string\n\t\t{\n\t\t\tconst departmentName = Text.encode(this.departments.get(this.focusedNode).name ?? '');\n\t\t\tconst userName = Text.encode(this.user.name ?? '');\n\n\t\t\tlet phraseCode = '';\n\t\t\tif (this.isTeamEntity)\n\t\t\t{\n\t\t\t\tphraseCode = 'HUMANRESOURCES_DEPARTMENT_CONTENT_TAB_USER_ACTION_MENU_MOVE_TO_ANOTHER_TEAM_REMOVE_USER_DESCRIPTION';\n\t\t\t\tphraseCode += this.user.gender === 'F' ? '_F' : '_M';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tphraseCode = 'HUMANRESOURCES_DEPARTMENT_CONTENT_TAB_USER_ACTION_MENU_MOVE_TO_ANOTHER_DEPARTMENT_ALREADY_BELONGS_TO_DEPARTMENT_DESCRIPTION_MSGVER_1';\n\t\t\t}\n\n\t\t\treturn this.loc(\n\t\t\t\tphraseCode,\n\t\t\t\t{\n\t\t\t\t\t'#USER_NAME#': userName,\n\t\t\t\t\t'#DEPARTMENT_NAME#': departmentName,\n\t\t\t\t},\n\t\t\t)\n\t\t\t\t.replace(\n\t\t\t\t\t'[link]',\n\t\t\t\t\t`<a class=\"hr-department-detail-content__move-user-department-user-link\" href=\"${this.user.url}\">`,\n\t\t\t\t)\n\t\t\t\t.replace('[/link]', '</a>')\n\t\t\t;\n\t\t},\n\t\tgetUserAlreadyBelongsToDepartmentPopupPhrase(): string\n\t\t{\n\t\t\tconst departmentName = Text.encode(this.departments.get(this.selectedParentDepartment ?? 0).name ?? '');\n\t\t\tconst userName = Text.encode(this.user.name ?? '');\n\n\t\t\tlet phraseCode = '';\n\t\t\tif (this.isTeamEntity)\n\t\t\t{\n\t\t\t\tphraseCode = 'HUMANRESOURCES_DEPARTMENT_CONTENT_TAB_USER_ACTION_MENU_MOVE_TO_ANOTHER_TEAM_ALREADY_BELONGS_TO_TEAM_DESCRIPTION';\n\t\t\t\tphraseCode += this.user.gender === 'F' ? '_F' : '_M';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tphraseCode = 'HUMANRESOURCES_DEPARTMENT_CONTENT_TAB_USER_ACTION_MENU_MOVE_TO_ANOTHER_DEPARTMENT_ALREADY_BELONGS_TO_DEPARTMENT_DESCRIPTION_MSGVER_1';\n\t\t\t}\n\n\t\t\tlet phrase = this.loc(\n\t\t\t\tphraseCode,\n\t\t\t\t{\n\t\t\t\t\t'#USER_NAME#': userName,\n\t\t\t\t\t'#DEPARTMENT_NAME#': departmentName,\n\t\t\t\t},\n\t\t\t);\n\t\t\tphrase = phrase.replace('[link]', `<a class=\"hr-department-detail-content__move-user-department-user-link\" href=\"${this.user.url}\">`);\n\t\t\tphrase = phrase.replace('[/link]', '</a>');\n\n\t\t\treturn phrase;\n\t\t},\n\t\tmemberRoles(): MemberRolesType\n\t\t{\n\t\t\treturn getMemberRoles(this.entityType);\n\t\t},\n\t\tisTeamEntity(): boolean\n\t\t{\n\t\t\treturn this.entityType === EntityTypes.team;\n\t\t},\n\t\tconfirmTitle(): string\n\t\t{\n\t\t\treturn this.isTeamEntity\n\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_MOVE_TO_ANOTHER_TEAM_POPUP_CONFIRM_TITLE')\n\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_MOVE_TO_ANOTHER_DEPARTMENT_POPUP_CONFIRM_TITLE')\n\t\t\t;\n\t\t},\n\t\tconfirmDescription(): string\n\t\t{\n\t\t\treturn this.isTeamEntity\n\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_USER_ACTION_MENU_MOVE_TO_ANOTHER_TEAM_POPUP_ACTION_SELECT_TEAM_DESCRIPTION')\n\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_USER_ACTION_MENU_MOVE_TO_ANOTHER_DEPARTMENT_POPUP_ACTION_SELECT_DEPARTMENT_DESCRIPTION')\n\t\t\t;\n\t\t},\n\t},\n\n\tmethods: {\n\t\tcreateTagSelector(): TagSelector\n\t\t{\n\t\t\treturn new TagSelector({\n\t\t\t\tevents: {\n\t\t\t\t\tonTagAdd: (event: BaseEvent) => {\n\t\t\t\t\t\tthis.accessDenied = false;\n\t\t\t\t\t\tconst { tag } = event.data;\n\t\t\t\t\t\tthis.selectedParentDepartment = tag.id;\n\t\t\t\t\t\tif (PermissionChecker.hasPermission(this.action, tag.id))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.lockMoveUserActionButton = false;\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.accessDenied = true;\n\t\t\t\t\t\tthis.lockMoveUserActionButton = true;\n\t\t\t\t\t},\n\t\t\t\t\tonTagRemove: () => {\n\t\t\t\t\t\tthis.lockMoveUserActionButton = true;\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tmultiple: false,\n\t\t\t\tdialogOptions: {\n\t\t\t\t\twidth: 425,\n\t\t\t\t\theight: 350,\n\t\t\t\t\tdropdownMode: true,\n\t\t\t\t\thideOnDeselect: true,\n\t\t\t\t\tentities: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: 'structure-node',\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\tselectMode: 'departmentsOnly',\n\t\t\t\t\t\t\t\trestricted: 'addMember',\n\t\t\t\t\t\t\t\tincludedNodeEntityTypes: this.includedNodeEntityTypesInDialog,\n\t\t\t\t\t\t\t\tuseMultipleTabs: true,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\tpreselectedItems: [['structure-node', this.parentId]],\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\tloc(phraseCode: string, replacements: {[p: string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tasync confirmMoveUser(): Promise<void>\n\t\t{\n\t\t\tthis.showMoveUserActionLoader = true;\n\t\t\tconst departmentId = this.focusedNode;\n\t\t\tconst userId = this.user.id;\n\t\t\tconst targetNodeId = this.selectedParentDepartment;\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\tawait DepartmentAPI.moveUserToDepartment(\n\t\t\t\t\tdepartmentId,\n\t\t\t\t\tuserId,\n\t\t\t\t\ttargetNodeId,\n\t\t\t\t);\n\t\t\t}\n\t\t\tcatch (error)\n\t\t\t{\n\t\t\t\tthis.showMoveUserActionLoader = false;\n\n\t\t\t\tconst code = error.code ?? 0;\n\n\t\t\t\tif (code === 'MEMBER_ALREADY_BELONGS_TO_NODE')\n\t\t\t\t{\n\t\t\t\t\tthis.showUserAlreadyBelongsToDepartmentPopup = true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst phraseCode = this.isTeamEntity\n\t\t\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_USER_ACTION_MENU_MOVE_TO_ANOTHER_TEAM_ERROR')\n\t\t\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_USER_ACTION_MENU_MOVE_TO_ANOTHER_DEPARTMENT_ERROR')\n\t\t\t\t\t;\n\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: phraseCode,\n\t\t\t\t\t\tautoHideDelay: 2000,\n\t\t\t\t\t});\n\t\t\t\t\tthis.$emit('close');\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst departmentName = Text.encode(this.departments.get(targetNodeId)?.name ?? '');\n\t\t\tconst phraseCode = this.isTeamEntity\n\t\t\t\t? 'HUMANRESOURCES_DEPARTMENT_CONTENT_TAB_USER_ACTION_MENU_MOVE_TO_ANOTHER_TEAM_SUCCESS_MESSAGE'\n\t\t\t\t: 'HUMANRESOURCES_DEPARTMENT_CONTENT_TAB_USER_ACTION_MENU_MOVE_TO_ANOTHER_DEPARTMENT_SUCCESS_MESSAGE'\n\t\t\t;\n\t\t\tUI.Notification.Center.notify({\n\t\t\t\tcontent: this.loc(\n\t\t\t\t\tphraseCode,\n\t\t\t\t\t{\n\t\t\t\t\t\t'#DEPARTMENT_NAME#': departmentName,\n\t\t\t\t\t},\n\t\t\t\t),\n\t\t\t\tautoHideDelay: 2000,\n\t\t\t});\n\n\t\t\tDepartmentContentActions.moveUserToDepartment(\n\t\t\t\tdepartmentId,\n\t\t\t\tuserId,\n\t\t\t\ttargetNodeId,\n\t\t\t\tthis.user.role ?? this.memberRoles.employee,\n\t\t\t);\n\n\t\t\tthis.$emit('action');\n\t\t\tthis.showMoveUserActionLoader = false;\n\t\t},\n\t\tcloseAction(): void\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t\tcloseUserAlreadyBelongsToDepartmentPopup(): void\n\t\t{\n\t\t\tthis.showUserAlreadyBelongsToDepartmentPopup = false;\n\t\t\tthis.closeAction();\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<ConfirmationPopup\n\t\t\t@action=\"confirmMoveUser\"\n\t\t\t@close=\"closeAction\"\n\t\t\t:showActionButtonLoader=\"showMoveUserActionLoader\"\n\t\t\t:lockActionButton=\"lockMoveUserActionButton\"\n\t\t\t:title=\"confirmTitle\"\n\t\t\t:confirmBtnText = \"loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_MOVE_TO_ANOTHER_DEPARTMENT_POPUP_CONFIRM_BUTTON')\"\n\t\t\t:width=\"364\"\n\t\t>\n\t\t\t<template v-slot:content>\n\t\t\t\t<div class=\"hr-department-detail-content__user-action-text-container\">\n\t\t\t\t\t<div v-html=\"getMoveUserActionPhrase\"/>\n\t\t\t\t\t<span>\n\t\t\t\t\t\t{{confirmDescription}}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"hr-department-detail-content__move-user-department-selector\"\n\t\t\t\t\tref=\"department-selector\"\n\t\t\t\t\t:class=\"{ 'ui-ctl-warning': accessDenied }\"\n\t\t\t\t/>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"accessDenied\"\n\t\t\t\t\tclass=\"hr-department-detail-content__move-user-department_item-error\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"ui-icon-set --warning\"></div>\n\t\t\t\t\t<span\n\t\t\t\t\t\tclass=\"hr-department-detail-content__move-user-department_item-error-message\"\n\t\t\t\t\t>\n\t\t\t\t\t\t\t{{loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_USER_ACTION_MENU_MOVE_TO_ANOTHER_DEPARTMENT_PERMISSION_ERROR')}}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</ConfirmationPopup>\n\t\t<ConfirmationPopup\n\t\t\t@action=\"closeUserAlreadyBelongsToDepartmentPopup\"\n\t\t\t@close=\"closeUserAlreadyBelongsToDepartmentPopup\"\n\t\t\tv-if=\"showUserAlreadyBelongsToDepartmentPopup\"\n\t\t\t:withoutTitleBar = true\n\t\t\t:onlyConfirmButtonMode = true\n\t\t\t:confirmBtnText = \"loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_USER_ACTION_MENU_MOVE_TO_ANOTHER_DEPARTMENT_ALREADY_BELONGS_TO_DEPARTMENT_CLOSE_BUTTON')\"\n\t\t\t:width=\"300\"\n\t\t>\n\t\t\t<template v-slot:content>\n\t\t\t\t<div class=\"hr-department-detail-content__user-action-text-container\">\n\t\t\t\t\t<div \n\t\t\t\t\t\tclass=\"hr-department-detail-content__user-belongs-to-department-text-container\"\n\t\t\t\t\t\tv-html=\"getUserAlreadyBelongsToDepartmentPopupPhrase\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"hr-department-detail-content__move-user-department-selector\" ref=\"department-selector\"></div>\n\t\t\t</template>\n\t\t</ConfirmationPopup>\n\t`,\n};\n","import { RouteActionMenu, ConfirmationPopup } from 'humanresources.company-structure.structure-components';\nimport { Text } from 'main.core';\nimport { UserListActionMenu, MenuActions } from 'humanresources.company-structure.org-chart';\nimport { DepartmentAPI } from '../../../api';\nimport { DepartmentContentActions } from '../../../actions';\nimport { memberRoles } from 'humanresources.company-structure.api';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { mapState } from 'ui.vue3.pinia';\nimport { MoveUserActionPopup } from './move-user-action-popup';\nimport { UI } from 'ui.notification';\nimport { EntityTypes } from 'humanresources.company-structure.utils';\n\nimport './styles/action-button.css';\n\nexport const UserListItemActionButton = {\n\tname: 'userList',\n\n\tprops: {\n\t\tuser: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdepartmentId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tcomponents: {\n\t\tRouteActionMenu,\n\t\tConfirmationPopup,\n\t\tMoveUserActionPopup,\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tmenuVisible: {},\n\t\t\tshowRemoveUserConfirmationPopup: false,\n\t\t\tshowRemoveUserConfirmationActionLoader: false,\n\t\t\tshowMoveUserPopup: false,\n\t\t\tshowFireUserPopup: false,\n\t\t\tfireUserLoad: false,\n\t\t};\n\t},\n\n\tmethods: {\n\t\ttoggleMenu(userId)\n\t\t{\n\t\t\tthis.menuVisible[userId] = !this.menuVisible[userId];\n\t\t},\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tonActionMenuItemClick(actionId: string): void\n\t\t{\n\t\t\tif (actionId === MenuActions.removeUserFromDepartment)\n\t\t\t{\n\t\t\t\tthis.showRemoveUserConfirmationPopup = true;\n\t\t\t}\n\n\t\t\tif (actionId === MenuActions.moveUserToAnotherDepartment)\n\t\t\t{\n\t\t\t\tthis.showMoveUserPopup = true;\n\t\t\t}\n\n\t\t\tif (actionId === MenuActions.fireUserFromCompany)\n\t\t\t{\n\t\t\t\tthis.showFireUserPopup = true;\n\t\t\t}\n\t\t},\n\t\tasync removeUser(): Promise<void>\n\t\t{\n\t\t\tthis.showRemoveUserConfirmationActionLoader = true;\n\t\t\tconst userId = this.user.id;\n\t\t\tconst isUserInMultipleDepartments = await DepartmentAPI.isUserInMultipleDepartments(userId);\n\t\t\tconst departmentId = this.focusedNode;\n\t\t\tthis.showRemoveUserConfirmationActionLoader = false;\n\t\t\tthis.showRemoveUserConfirmationPopup = false;\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\tawait DepartmentAPI.removeUserFromDepartment(departmentId, userId);\n\t\t\t}\n\t\t\tcatch\n\t\t\t{\n\t\t\t\tconst phraseCode = this.isTeamEntity\n\t\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_REMOVE_FROM_TEAM_ERROR')\n\t\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_REMOVE_FROM_DEPARTMENT_ERROR')\n\t\t\t\t;\n\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\tcontent: phraseCode,\n\t\t\t\t\tautoHideDelay: 2000,\n\t\t\t\t});\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst phraseCode = this.isTeamEntity\n\t\t\t\t? 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_REMOVE_FROM_TEAM_SUCCESS'\n\t\t\t\t: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_REMOVE_FROM_DEPARTMENT_SUCCESS';\n\t\t\tconst departmentName = Text.encode(this.departments.get(this.focusedNode).name ?? '');\n\t\t\tUI.Notification.Center.notify({\n\t\t\t\tcontent: this.loc(phraseCode, { '#DEPARTMENT_NAME#': departmentName }),\n\t\t\t\tautoHideDelay: 2000,\n\t\t\t});\n\n\t\t\tconst role = this.user.role;\n\t\t\tif (isUserInMultipleDepartments || this.isTeamEntity)\n\t\t\t{\n\t\t\t\tDepartmentContentActions.removeUserFromDepartment(departmentId, userId, role);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst rootDepartment = [...this.departments.values()].find((department) => department.parentId === 0);\n\t\t\tif (!rootDepartment)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tDepartmentContentActions.moveUserToDepartment(\n\t\t\t\tdepartmentId,\n\t\t\t\tuserId,\n\t\t\t\trootDepartment.id,\n\t\t\t\trole,\n\t\t\t);\n\t\t},\n\t\tcancelRemoveUser(): void\n\t\t{\n\t\t\tthis.showRemoveUserConfirmationPopup = false;\n\t\t},\n\t\tasync fireUser(): void\n\t\t{\n\t\t\tthis.fireUserLoad = true;\n\n\t\t\tconst userId = this.user.id;\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\tawait DepartmentAPI.fireUser(userId);\n\t\t\t}\n\t\t\tcatch (error)\n\t\t\t{\n\t\t\t\tif (error.code !== 'STRUCTURE_ACCESS_DENIED')\n\t\t\t\t{\n\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: this.user.isInvited\n\t\t\t\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_DELETE_ERROR')\n\t\t\t\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_FIRE_ERROR'),\n\t\t\t\t\t\tautoHideDelay: 2000,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tthis.showFireUserPopup = false;\n\t\t\t\tthis.fireUserLoad = false;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tDepartmentContentActions.removeUserFromDepartment(this.focusedNode, userId, this.user.role);\n\t\t\tawait DepartmentContentActions.removeUserFromAllDepartments(userId);\n\t\t\tthis.showFireUserPopup = false;\n\t\t\tthis.fireUserLoad = false;\n\t\t},\n\t\tcancelFireUser(): void\n\t\t{\n\t\t\tthis.showFireUserPopup = false;\n\t\t},\n\t\thandleMoveUserAction(): void\n\t\t{\n\t\t\tthis.showMoveUserPopup = false;\n\t\t},\n\t\thandleMoveUserClose(): void\n\t\t{\n\t\t\tthis.showMoveUserPopup = false;\n\t\t},\n\t\tgetMemberKeyByValue(value: string): string\n\t\t{\n\t\t\treturn Object.keys(memberRoles).find((key) => memberRoles[key] === value) || '';\n\t\t},\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.menu = new UserListActionMenu(this.focusedNode, this.entityType, this.user.isInvited);\n\t},\n\n\tcomputed: {\n\t\t...mapState(useChartStore, ['focusedNode', 'departments']),\n\t\tmemberRoles(): typeof memberRoles\n\t\t{\n\t\t\treturn memberRoles;\n\t\t},\n\t\tgetFirePopupDescription(): string\n\t\t{\n\t\t\tconst userName = Text.encode(this.user.name ?? '');\n\t\t\tconst userUrl = Text.encode(this.user.url ?? '');\n\t\t\tconst genderSuffix = this.user.gender === 'F' ? '_F' : '_M';\n\n\t\t\tconst phrase = this.user.isInvited\n\t\t\t\t? `HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_DELETE_POPUP_DESCRIPTION${genderSuffix}`\n\t\t\t\t: `HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_FIRE_POPUP_DESCRIPTION${genderSuffix}`\n\t\t\t;\n\n\t\t\tconst description = this.loc(phrase, {\n\t\t\t\t'#USER_NAME#': userName,\n\t\t\t});\n\n\t\t\treturn description.replace('[link]', `<a class=\"hr-department-detail-content__fire-user-link\" href=\"${userUrl}\">`)\n\t\t\t\t.replace('[/link]', '</a>')\n\t\t\t;\n\t\t},\n\t\tgetFirePopupTitle(): string\n\t\t{\n\t\t\treturn this.user.isInvited\n\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_DELETE_POPUP_TITLE')\n\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_FIRE_POPUP_TITLE');\n\t\t},\n\t\tgetFirePopupButtonText(): string\n\t\t{\n\t\t\treturn this.user.isInvited\n\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_DELETE_POPUP_CONFIRM_BUTTON')\n\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_FIRE_POPUP_CONFIRM_BUTTON');\n\t\t},\n\t\tgetRemovePopupTitle(): string\n\t\t{\n\t\t\treturn this.isTeamEntity\n\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_REMOVE_FROM_TEAM_POPUP_TITLE')\n\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_REMOVE_FROM_DEPARTMENT_POPUP_TITLE');\n\t\t},\n\t\tgetRemovePopupDescription(): string\n\t\t{\n\t\t\tconst departmentName = Text.encode(this.departments.get(this.focusedNode).name ?? '');\n\t\t\tconst userName = Text.encode(this.user.name ?? '');\n\n\t\t\tif (this.isTeamEntity)\n\t\t\t{\n\t\t\t\tconst phraseCode = 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_REMOVE_FROM_TEAM_POPUP_DESCRIPTION';\n\t\t\t\tconst genderSuffix = this.user.gender === 'F' ? '_F' : '_M';\n\n\t\t\t\treturn this.loc(\n\t\t\t\t\tphraseCode + genderSuffix,\n\t\t\t\t\t{\n\t\t\t\t\t\t'#USER_NAME#': userName,\n\t\t\t\t\t\t'#DEPARTMENT_NAME#': departmentName,\n\t\t\t\t\t},\n\t\t\t\t)\n\t\t\t\t\t.replace(\n\t\t\t\t\t\t'[link]',\n\t\t\t\t\t\t`<a class=\"hr-department-detail-content__move-user-department-user-link\" href=\"${this.user.url}\">`,\n\t\t\t\t\t)\n\t\t\t\t\t.replace('[/link]', '</a>')\n\t\t\t\t;\n\t\t\t}\n\n\t\t\treturn this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_REMOVE_FROM_DEPARTMENT_POPUP_DESCRIPTION');\n\t\t},\n\t\tentityType(): string\n\t\t{\n\t\t\treturn this.departments.get(this.focusedNode)?.entityType;\n\t\t},\n\t\tisTeamEntity(): boolean\n\t\t{\n\t\t\treturn this.entityType === EntityTypes.team;\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<button\n\t\t\tv-if=\"menu.items.length\"\n\t\t\tclass=\"ui-icon-set --more hr-department-detail-content__user-action-btn\"\n\t\t\t:class=\"{ '--focused': menuVisible[user.id] }\"\n\t\t\t@click.stop=\"toggleMenu(user.id)\"\n\t\t\tref=\"actionUserButton\"\n\t\t\t:data-id=\"'hr-department-detail-content__'+ getMemberKeyByValue(user.role) + '-list_user-' + user.id + '-action-btn'\"\n\t\t/>\n\t\t<RouteActionMenu\n\t\t\tv-if=\"menuVisible[user.id]\"\n\t\t\t:id=\"'tree-node-department-menu-' + user.id\"\n\t\t\t:items=\"menu.items\"\n\t\t\t:width=\"302\"\n\t\t\t:bindElement=\"$refs.actionUserButton\"\n\t\t\t@action=\"onActionMenuItemClick\"\n\t\t\t@close=\"menuVisible[user.id] = false\"\n\t\t/>\n\t\t<ConfirmationPopup\n\t\t\tref=\"removeUserConfirmationPopup\"\n\t\t\tv-if=\"showRemoveUserConfirmationPopup\"\n\t\t\t:showActionButtonLoader=\"showRemoveUserConfirmationActionLoader\"\n\t\t\t:title=\"getRemovePopupTitle\"\n\t\t\t:confirmBtnText=\"loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_REMOVE_FROM_DEPARTMENT_POPUP_CONFIRM_BUTTON')\"\n\t\t\t:confirmButtonClass=\"isTeamEntity ? 'ui-btn-danger' : 'ui-btn-primary'\"\n\t\t\t@action=\"removeUser\"\n\t\t\t@close=\"cancelRemoveUser\"\n\t\t\t:width=\"364\"\n\t\t>\n\t\t\t<template v-slot:content>\n\t\t\t\t<div class=\"hr-department-detail-content__user-action-text-container\">\n\t\t\t\t<div\n\t\t\t\t\tv-html=\"getRemovePopupDescription\"\n\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</ConfirmationPopup>\n\t\t<ConfirmationPopup\n\t\t\tref=\"fireUserConfirmationPopup\"\n\t\t\tv-if=\"showFireUserPopup\"\n\t\t\t:showActionButtonLoader=\"fireUserLoad\"\n\t\t\t:title=\"getFirePopupTitle\"\n\t\t\t:confirmBtnText=\"getFirePopupButtonText\"\n\t\t\t:confirmButtonClass=\"'ui-btn-danger'\"\n\t\t\t@action=\"fireUser\"\n\t\t\t@close=\"cancelFireUser\"\n\t\t\t:width=\"364\"\n\t\t>\n\t\t\t<template v-slot:content>\n\t\t\t\t<div class=\"hr-department-detail-content__user-action-text-container\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-html=\"getFirePopupDescription\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</ConfirmationPopup>\n\t\t<MoveUserActionPopup\n\t\t\tv-if=\"showMoveUserPopup\"\n\t\t\t:parentId=\"focusedNode\"\n\t\t\t:user=\"user\"\n\t\t\t:entityType=\"entityType\"\n\t\t\t@action=\"handleMoveUserAction\"\n\t\t\t@close=\"handleMoveUserClose\"\n\t\t/>\n\t`,\n};\n","import { getMemberRoles, type MemberRolesType } from 'humanresources.company-structure.api';\nimport { UserListItemActionButton } from './action-button';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { mapState } from 'ui.vue3.pinia';\n\nimport 'ui.tooltip';\nimport './styles/item.css';\n\nexport const UserListItem = {\n\tname: 'userList',\n\n\tprops: {\n\t\tuser: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tselectedUserId: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t\tentityType: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tcomponents: { UserListItemActionButton },\n\n\tcomputed: {\n\t\tmemberRoles(): MemberRolesType\n\t\t{\n\t\t\treturn getMemberRoles(this.entityType);\n\t\t},\n\t\tdefaultAvatar(): string\n\t\t{\n\t\t\treturn '/bitrix/js/humanresources/company-structure/org-chart/src/images/default-user.svg';\n\t\t},\n\t\t...mapState(useChartStore, ['focusedNode']),\n\t},\n\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\thandleUserClick(item): void\n\t\t{\n\t\t\tBX.SidePanel.Instance.open(item.url, {\n\t\t\t\tcacheable: false,\n\t\t\t});\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div \n\t\t\t:key=\"user.id\"\n\t\t\tclass=\"hr-department-detail-content__user-container\"\n\t\t\t:class=\"{ '--searched': user.id === selectedUserId }\"\n\t\t\t:data-id=\"'hr-department-detail-content__user-' + user.id + '-item'\"\n\t\t>\n\t\t\t<div class=\"hr-department-detail-content__user-avatar-container\" @click=\"handleUserClick(user)\">\n\t\t\t\t<img \n\t\t\t\t\tclass=\"hr-department-detail-content__user-avatar-img\"\n\t\t\t\t\t:src=\"user.avatar ? encodeURI(user.avatar) : defaultAvatar\"\n\t\t\t\t/>\n\t\t\t\t<div v-if=\"user.role === memberRoles.head\" class=\"hr-department-detail-content__user-avatar-overlay\"></div>\n\t\t\t</div>\n\t\t\t<div class=\"hr-department-detail-content-user__text-container\">\n\t\t\t\t<div class=\"hr-department-detail-content__user-title\">\n\t\t\t\t\t<div \n\t\t\t\t\t\tclass=\"hr-department-detail-content__user-name\" \n\t\t\t\t\t\t@click=\"handleUserClick(user)\"\n\t\t\t\t\t\t:bx-tooltip-user-id=\"user.id\"\n\t\t\t\t\t\tbx-tooltip-context=\"b24\"\n\t\t\t\t\t\t:data-id=\"'hr-department-detail-content__user-' + user.id + '-item-name'\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ user.name }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if=\"user.badgeText\" class=\"hr-department-detail-content-user__name-badge\">{{ user.badgeText }}</div>\n\t\t\t\t</div>\n\t\t\t\t<div \n\t\t\t\t\tclass=\"hr-department-detail-content__user-subtitle\" \n\t\t\t\t\t:class=\"{ '--without-work-position': !user.subtitle }\"\n\t\t\t\t>\n\t\t\t\t\t{{ (user.subtitle?.length ?? 0) > 0 ? user.subtitle : this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_LIST_DEFAULT_WORK_POSITION') }}\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"user.isInvited\" class=\"hr-department-detail-content-user__item-badge\">\n\t\t\t\t\t{{ this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_LIST_INVITED_BADGE_TEXT') }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<UserListItemActionButton\n\t\t\t\t:user=\"user\"\n\t\t\t\t:departmentId=\"focusedNode\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import 'ui.icon-set.main';\nimport './empty-state.css';\n\nexport const EmptyState = {\n\tname: 'emptyState',\n\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t\timageClass: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t\tdescription: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t\tlist: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: [],\n\t\t},\n\t},\n\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: {[p: string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"hr-department-detail-content_tab__empty-state-container\">\n\t\t\t<div v-if=\"imageClass\" :class=\"['hr-department-detail-content_tab__empty-state-icon', imageClass]\"/>\n\t\t\t<span v-if=\"title\" class=\"hr-department-detail-content__empty-tab-entity-title\">\n\t\t\t\t{{ title }}\n\t\t\t</span>\n\t\t\t<span v-if=\"description\" class=\"hr-department-detail-content_tab__empty-state-description\">\n\t\t\t\t{{ description }}\n\t\t\t</span>\n\t\t\t<div v-if=\"list.length > 0\" class=\"hr-department-detail-content_tab__empty-state-list\">\n\t\t\t\t<div class=\"hr-department-detail-content_tab__empty-state-list-item\"  v-for=\"item in list\">\n\t\t\t\t\t<div \n\t\t\t\t\t\tclass=\"ui-icon-set --circle-check hr-department-detail-content_tab__empty-state-list-item-check\"\n\t\t\t\t\t\tstyle=\"--ui-icon-set__icon-size: 20px;\"\n\t\t\t\t\t/>\n\t\t\t\t\t<div class=\"hr-department-detail-content_tab__empty-state-list--item-text\">\n\t\t\t\t\t\t{{ item.text }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<slot name=\"content\"/>\n\t\t</div>\n\t`,\n};\n","import './styles/empty-list-item.css';\n\nexport const EmptyListItem = {\n\tname: 'tabEmptyListItem',\n\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\timageClass: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\twithAddPermission: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div :class=\"['hr-department-detail-content__tab-empty-list_item-wrapper', { '--with-add': withAddPermission }]\">\n\t\t\t<div class=\"hr-department-detail-content__tab-empty-list_item-image\" :class=\"imageClass\"/>\n\t\t\t<div class=\"hr-department-detail-content__tab-empty-list_item-content\">\n\t\t\t\t<div class=\"hr-department-detail-content__tab-empty-list_item-title\">\n\t\t\t\t\t{{ title }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};","import { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { mapState } from 'ui.vue3.pinia';\nimport { RouteActionMenu } from 'humanresources.company-structure.structure-components';\nimport './styles/list-action-button.css';\n\nexport const ListActionButton = {\n\tname: 'userListActionButton',\n\temits: ['tabListAction', 'close'],\n\n\tprops:\n\t\t{\n\t\t\tid: {\n\t\t\t\ttype: String,\n\t\t\t\trequired: true,\n\t\t\t},\n\t\t\tmenuItems: {\n\t\t\t\ttype: Array,\n\t\t\t\trequired: true,\n\t\t\t},\n\t\t\tdataTestIds: {\n\t\t\t\ttype: Object,\n\t\t\t\trequired: false,\n\t\t\t\tdefault: {},\n\t\t\t},\n\t\t},\n\n\tcomponents:\n\t{\n\t\tRouteActionMenu,\n\t},\n\n\tcomputed:\n\t{\n\t\t...mapState(useChartStore, ['focusedNode']),\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tmenuVisible: false,\n\t\t};\n\t},\n\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tonActionMenuItemClick(itemId: string): void\n\t\t{\n\t\t\tthis.$emit('tabListAction', itemId);\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<button\n\t\t\tv-if=\"menuItems.length\"\n\t\t\tclass=\"hr-department-detail-content__tab-list_header-button\"\n\t\t\t:class=\"{ '--focused': menuVisible }\"\n\t\t\t:ref=\"id + '-route-action-menu'\"\n\t\t\t@click.stop=\"menuVisible = true\"\n\t\t\t:data-test-id=\"dataTestIds.buttonDataTestId\"\n\t\t>\n\t\t\t{{ loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_LIST_ACTION_BUTTON_TITLE') }}\n\t\t</button>\n\t\t<RouteActionMenu\n\t\t\tv-if=\"menuVisible\"\n\t\t\t:id=\"id + '-route-action-menu'\"\n\t\t\t:items=\"menuItems\"\n\t\t\t:width=\"302\"\n\t\t\t:bindElement=\"$refs[id + '-route-action-menu']\"\n\t\t\t:containerDataTestId=\"dataTestIds.containerDataTestId\"\n\t\t\t@action=\"onActionMenuItemClick\"\n\t\t\t@close=\"menuVisible = false\"\n\t\t/>\n\t`,\n};\n","import { Type } from 'main.core';\nimport { EmptyListItem } from './empty-list-item';\nimport { ListActionButton } from './list-action-button';\n// eslint-disable-next-line no-unused-vars\nimport type { TabListDataTestIds } from './types';\nimport './styles/list.css';\n\nexport const TabList = {\n\tname: 'tabList',\n\tcomponents: { ListActionButton, EmptyListItem },\n\temits: ['tabListAction'],\n\n\tprops: {\n\t\tid: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tcount: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t},\n\t\tmenuItems: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: [],\n\t\t},\n\t\tlistItems: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\temptyItemTitle: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t\temptyItemImageClass: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t\thideEmptyItem: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\twithAddPermission: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t\t/** @var { TabListDataTestIds } dataTestIds */\n\t\tdataTestIds: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: {},\n\t\t},\n\t},\n\n\tcomputed: {\n\t\tneedToShowCount(): boolean\n\t\t{\n\t\t\treturn Type.isNumber(this.count);\n\t\t},\n\t},\n\n\tmethods: {\n\t\tonActionMenuItemClick(actionId: string): void\n\t\t{\n\t\t\tthis.$emit('tabListAction', actionId);\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"hr-department-detail-content__tab-list_container\"\n\t\t\t :data-test-id=\"dataTestIds.containerDataTestId\"\n\t\t>\n\t\t\t<div class=\"hr-department-detail-content__tab-list_header-container\">\n\t\t\t\t<div class=\"hr-department-detail-content__tab-list_list-title\">\n\t\t\t\t\t{{ title}}\n\t\t\t\t\t<span\n\t\t\t\t\t\tv-if=\"needToShowCount\"\n\t\t\t\t\t\tclass=\"hr-department-detail-content__tab-list_header-count\"\n\t\t\t\t\t\t:data-test-id=\"dataTestIds.listCounterDataTestId\"\n\t\t\t\t\t>\n\t\t\t\t\t{{ count }}\n\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<ListActionButton\n\t\t\t\t\t:id=\"id\"\n\t\t\t\t\t:menuItems=\"menuItems\"\n\t\t\t\t\t@tabListAction=\"onActionMenuItemClick\"\n\t\t\t\t\t:dataTestIds=\"{buttonDataTestId: dataTestIds.listActionButtonDataTestId, containerDataTestId: dataTestIds.listActonMenuDataTestId}\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div class=\"hr-department-detail-content__tab_list-container\">\n\t\t\t\t<template v-for=\"(item) in listItems\">\n\t\t\t\t\t<slot :item=\"item\"/>\n\t\t\t\t</template>\n\t\t\t\t<EmptyListItem v-if=\"emptyItemTitle && emptyItemImageClass && !listItems.length && !hideEmptyItem\"\n\t\t\t\t\t:title=\"emptyItemTitle\"\n\t\t\t\t\t:imageClass=\"emptyItemImageClass\"\n\t\t\t\t\t:withAddPermission=\"withAddPermission\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import 'ui.icon-set.main';\nimport './search-input.css';\n\nexport const SearchInput = {\n\tname: 'searchInput',\n\tprops: {\n\t\tvalue: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tplaceholder: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tdataTestId: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t},\n\n\tdata(): {hasFocus: boolean}\n\t{\n\t\treturn {\n\t\t\thasFocus: false,\n\t\t};\n\t},\n\n\tmethods: {\n\t\thandleInput(event: InputEvent): void\n\t\t{\n\t\t\tthis.$emit('inputChange', event.target.value);\n\t\t},\n\t\thandleBlur(): void\n\t\t{\n\t\t\tif (this.value.length === 0)\n\t\t\t{\n\t\t\t\tthis.hasFocus = false;\n\t\t\t}\n\t\t},\n\t\tclearInput(): void\n\t\t{\n\t\t\tthis.hasFocus = false;\n\t\t\tthis.$emit('inputChange', '');\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"hr-department-detail-content__content-search\"\n\t\t\t:class=\"{'--focused': hasFocus}\"\n\t\t>\n\t\t\t<div class=\"hr-department-detail-content__content-search-icon ui-icon-set --search-1\"/>\n\t\t\t<input\n\t\t\t\tclass=\"hr-department-detail-content__content-search-input\"\n\t\t\t\ttype=\"text\"\n\t\t\t\t:placeholder=\"!hasFocus ?  placeholder : ''\"\n\t\t\t\t:data-test-id=\"dataTestId\"\n\t\t\t\t:value=\"value\"\n\t\t\t\t@input=\"handleInput\"\n\t\t\t\t@focus=\"hasFocus = true\"\n\t\t\t\t@blur=\"handleBlur\"\n\t\t\t>\n\t\t\t<div\n\t\t\t\tclass=\"hr-department-detail-content__content-search-close-button ui-icon-set --cross-circle-50\"\n\t\t\t\t:class=\"{'--hide': !hasFocus}\"\n\t\t\t\t@click=\"clearInput\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { EntityTypes } from 'humanresources.company-structure.utils';\nimport { mapState, mapWritableState } from 'ui.vue3.pinia';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { getMemberRoles, MemberRolesType } from 'humanresources.company-structure.api';\nimport { PermissionActions, PermissionChecker } from 'humanresources.company-structure.permission-checker';\nimport { AnalyticsSourceType } from 'humanresources.company-structure.api';\nimport { UsersTabActionMenu } from 'humanresources.company-structure.org-chart';\nimport { HeadListDataTestIds, EmployeeListDataTestIds } from './consts';\nimport { EmptyTabAddButton } from './empty-tab-add-button';\nimport { UserListItem } from './item/item';\nimport { EmptyState } from '../base-components/empty-state/empty-state';\nimport { TabList } from '../base-components/list/list';\nimport { SearchInput } from '../base-components/search/search-input';\nimport { DepartmentAPI } from '../../api';\nimport { DepartmentContentActions } from '../../actions';\nimport type { TabListDataTestIds } from '../base-components/list/types';\n\nimport 'ui.buttons';\nimport './styles/tab.css';\n\ntype DepartmentUsersStatus = {\n\tdepartmentId: number;\n\tloaded: boolean;\n};\n\n// @vue/component\nexport const UsersTab = {\n\tname: 'usersTab',\n\n\tcomponents: {\n\t\tSearchInput,\n\t\tEmptyState,\n\t\tTabList,\n\t\tEmptyTabAddButton,\n\t\tUserListItem,\n\t},\n\n\temits: ['showDetailLoader', 'hideDetailLoader'],\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tsearchQuery: '',\n\t\t\tselectedUserId: null,\n\t\t\tneedToScroll: false,\n\t\t};\n\t},\n\n\tcomputed: {\n\t\tmemberRoles(): MemberRolesType\n\t\t{\n\t\t\treturn getMemberRoles(this.entityType);\n\t\t},\n\t\theads(): Array\n\t\t{\n\t\t\treturn this.departments.get(this.focusedNode).heads ?? [];\n\t\t},\n\t\theadCount(): number\n\t\t{\n\t\t\treturn this.heads.length ?? 0;\n\t\t},\n\t\tdepartmentId(): number\n\t\t{\n\t\t\treturn this.focusedNode;\n\t\t},\n\t\tformattedHeads(): Array\n\t\t{\n\t\t\treturn this.heads.map((head) => ({\n\t\t\t\t...head,\n\t\t\t\tsubtitle: head.workPosition,\n\t\t\t\tbadgeText: this.getBadgeText(head.role),\n\t\t\t})).sort((a, b) => {\n\t\t\t\tconst roleOrder = {\n\t\t\t\t\t[this.memberRoles.head]: 1,\n\t\t\t\t\t[this.memberRoles.deputyHead]: 2,\n\t\t\t\t};\n\n\t\t\t\tconst roleA = roleOrder[a.role] || 3;\n\t\t\t\tconst roleB = roleOrder[b.role] || 3;\n\n\t\t\t\treturn roleA - roleB;\n\t\t\t});\n\t\t},\n\t\tfilteredHeads(): Array\n\t\t{\n\t\t\treturn this.formattedHeads.filter(\n\t\t\t\t(head) => head.name.toLowerCase().includes(this.searchQuery.toLowerCase())\n\t\t\t\t\t|| head.workPosition?.toLowerCase().includes(this.searchQuery.toLowerCase()),\n\t\t\t);\n\t\t},\n\t\temployeeCount(): number\n\t\t{\n\t\t\tconst memberCount = this.departments.get(this.focusedNode).userCount ?? 0;\n\n\t\t\treturn memberCount - (this.headCount ?? 0);\n\t\t},\n\t\tformattedEmployees(): Array\n\t\t{\n\t\t\treturn this.employees.map((employee) => ({\n\t\t\t\t...employee,\n\t\t\t\tsubtitle: employee.workPosition,\n\t\t\t})).reverse();\n\t\t},\n\t\tfilteredEmployees(): Array\n\t\t{\n\t\t\treturn this.formattedEmployees.filter(\n\t\t\t\t(employee) => employee.name.toLowerCase().includes(this.searchQuery.toLowerCase())\n\t\t\t\t\t|| employee.workPosition?.toLowerCase().includes(this.searchQuery.toLowerCase()),\n\t\t\t);\n\t\t},\n\t\tmemberCount(): number\n\t\t{\n\t\t\treturn this.departments.get(this.focusedNode).userCount ?? 0;\n\t\t},\n\t\t...mapState(useChartStore, ['focusedNode', 'departments', 'searchedUserId']),\n\t\t...mapWritableState(useChartStore, ['searchedUserId']),\n\t\temployees(): Array\n\t\t{\n\t\t\treturn this.departments.get(this.focusedNode)?.employees ?? [];\n\t\t},\n\t\tshowSearchBar(): boolean\n\t\t{\n\t\t\treturn this.memberCount > 0;\n\t\t},\n\t\tshowSearchEmptyState(): boolean\n\t\t{\n\t\t\treturn this.filteredHeads.length === 0 && this.filteredEmployees.length === 0;\n\t\t},\n\t\tcanAddUsers(): boolean\n\t\t{\n\t\t\tconst permissionChecker = PermissionChecker.getInstance();\n\t\t\tif (!permissionChecker)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst nodeId = this.focusedNode;\n\t\t\tconst permission = this.isTeamEntity\n\t\t\t\t? PermissionActions.teamAddMember\n\t\t\t\t: PermissionActions.employeeAddToDepartment\n\t\t\t;\n\n\t\t\treturn permissionChecker.hasPermission(permission, nodeId);\n\t\t},\n\t\theadListEmptyStateTitle(): string\n\t\t{\n\t\t\tif (this.canAddUsers)\n\t\t\t{\n\t\t\t\treturn this.isTeamEntity\n\t\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_TEAM_HEAD_EMPTY_LIST_ITEM_TITLE')\n\t\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_HEAD_EMPTY_LIST_ITEM_TITLE');\n\t\t\t}\n\n\t\t\treturn this.isTeamEntity\n\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_TEAM_HEAD_EMPTY_LIST_ITEM_TITLE_WITHOUT_ADD_PERMISSION')\n\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_HEAD_EMPTY_LIST_ITEM_TITLE_WITHOUT_ADD_PERMISSION');\n\t\t},\n\t\temployeesListEmptyStateTitle(): string\n\t\t{\n\t\t\tif (this.canAddUsers)\n\t\t\t{\n\t\t\t\treturn this.isTeamEntity\n\t\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_TEAM_EMPLOYEE_EMPTY_LIST_ITEM_TITLE')\n\t\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_EMPLOYEE_EMPTY_LIST_ITEM_TITLE');\n\t\t\t}\n\n\t\t\treturn this.isTeamEntity\n\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_TEAM_EMPLOYEE_EMPTY_LIST_ITEM_TITLE_WITHOUT_ADD_PERMISSION')\n\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_EMPLOYEE_EMPTY_LIST_ITEM_TITLE_WITHOUT_ADD_PERMISSION');\n\t\t},\n\t\tshouldUpdateList(): boolean\n\t\t{\n\t\t\treturn this.departments.get(this.focusedNode).employeeListOptions?.shouldUpdateList ?? true;\n\t\t},\n\t\tdepartmentUsersStatus(): DepartmentUsersStatus\n\t\t{\n\t\t\tconst department = this.departments.get(this.focusedNode);\n\t\t\tif (department?.heads && department.employees)\n\t\t\t{\n\t\t\t\treturn { departmentId: this.focusedNode, loaded: true };\n\t\t\t}\n\n\t\t\treturn { departmentId: this.focusedNode, loaded: false };\n\t\t},\n\t\theadMenu(): UsersTabActionMenu\n\t\t{\n\t\t\treturn new UsersTabActionMenu(\n\t\t\t\tthis.focusedNode,\n\t\t\t\tAnalyticsSourceType.DETAIL,\n\t\t\t\t'head',\n\t\t\t\tthis.entityType,\n\t\t\t);\n\t\t},\n\t\temployeeMenu(): UsersTabActionMenu\n\t\t{\n\t\t\treturn new UsersTabActionMenu(\n\t\t\t\tthis.focusedNode,\n\t\t\t\tAnalyticsSourceType.DETAIL,\n\t\t\t\t'employee',\n\t\t\t\tthis.entityType,\n\t\t\t);\n\t\t},\n\t\tisEmployeeListOptionsSet(): boolean\n\t\t{\n\t\t\tconst department = this.departments.get(this.focusedNode) || {};\n\n\t\t\treturn department.employeeListOptions && Object.keys(department.employeeListOptions).length > 0;\n\t\t},\n\t\temployeeTitle(): string\n\t\t{\n\t\t\treturn this.isTeamEntity\n\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_TEAM_EMPLOYEE_LIST_TITLE')\n\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_EMPLOYEE_LIST_TITLE');\n\t\t},\n\t\tentityType(): string\n\t\t{\n\t\t\treturn this.departments.get(this.focusedNode)?.entityType;\n\t\t},\n\t\tisTeamEntity(): boolean\n\t\t{\n\t\t\treturn this.entityType === EntityTypes.team;\n\t\t},\n\t\temptyStateTitle(): string\n\t\t{\n\t\t\treturn this.isTeamEntity\n\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPTY_EMPLOYEES_TEAM_ADD_USER_TITLE')\n\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPTY_EMPLOYEES_ADD_USER_TITLE');\n\t\t},\n\t\temptyStateDescription(): string\n\t\t{\n\t\t\tif (this.canAddUsers)\n\t\t\t{\n\t\t\t\treturn this.isTeamEntity\n\t\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPTY_EMPLOYEES_TEAM_ADD_USER_SUBTITLE')\n\t\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPTY_EMPLOYEES_ADD_USER_SUBTITLE');\n\t\t\t}\n\n\t\t\t// text is in progress\n\t\t\treturn this.isTeamEntity\n\t\t\t\t? ''\n\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPTY_EMPLOYEES_ADD_USER_SUBTITLE');\n\t\t},\n\t},\n\n\twatch: {\n\t\tfocusedNode(newId: number): void\n\t\t{\n\t\t\tconst department = this.departments.get(newId) || {};\n\t\t\tif (!this.isEmployeeListOptionsSet)\n\t\t\t{\n\t\t\t\tconst employeeListOptions = {\n\t\t\t\t\tpage: 0,\n\t\t\t\t\tshouldUpdateList: true,\n\t\t\t\t\tisListUpdated: false,\n\t\t\t\t};\n\t\t\t\tDepartmentContentActions.updateEmployeeListOptions(newId, employeeListOptions);\n\t\t\t\tthis.departments.set(newId, department);\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tdepartment.employeeListOptions.page === 0\n\t\t\t\t&& department.employeeListOptions.isListUpdated === false\n\t\t\t\t&& department.employeeListOptions.shouldUpdateList === true\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.loadEmployeesAction();\n\t\t\t}\n\n\t\t\tthis.isDescriptionExpanded = false;\n\t\t\tthis.searchQuery = '';\n\n\t\t\tif (this.searchedUserId)\n\t\t\t{\n\t\t\t\tthis.needToFocusUserId = this.searchedUserId;\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\tthis.scrollToUser();\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tsearchedUserId: {\n\t\t\thandler(userId: number): void\n\t\t\t{\n\t\t\t\tif (!userId)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.needToFocusUserId = userId;\n\t\t\t\tif (this.isListUpdated)\n\t\t\t\t{\n\t\t\t\t\tthis.needToScroll = true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\t\tthis.scrollToUser();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\timmediate: true,\n\t\t},\n\t\tasync searchQuery(newQuery: string): Promise<void>\n\t\t{\n\t\t\tawait this.searchMembers(newQuery);\n\t\t},\n\t\tdepartmentUsersStatus(usersStatus: DepartmentUsersStatus, prevUsersStatus: DepartmentUsersStatus): void\n\t\t{\n\t\t\tconst { departmentId, loaded } = usersStatus;\n\t\t\tconst { departmentId: prevDepartmentId, loaded: prevLoaded } = prevUsersStatus;\n\t\t\tif (departmentId === prevDepartmentId && loaded === prevLoaded)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (loaded)\n\t\t\t{\n\t\t\t\tthis.$emit('hideDetailLoader');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$emit('showDetailLoader');\n\t\t\t\tthis.loadEmployeesAction();\n\t\t\t}\n\t\t},\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.loadEmployeesAction();\n\t\tthis.clearSearchTimeout = null;\n\t},\n\n\tmounted(): void\n\t{\n\t\tthis.tabContainer = this.$refs['tab-container'];\n\t},\n\n\tmethods: {\n\t\tloc(phraseCode, replacements = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tgetBadgeText(role): ?string\n\t\t{\n\t\t\tif (role === this.memberRoles.head)\n\t\t\t{\n\t\t\t\treturn this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPLOYEES_HEAD_BADGE');\n\t\t\t}\n\n\t\t\tif (role === this.memberRoles.deputyHead)\n\t\t\t{\n\t\t\t\treturn this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPLOYEES_DEPUTY_HEAD_BADGE');\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t\tupdateList(event): void\n\t\t{\n\t\t\tconst employeesList = event.target;\n\t\t\tconst scrollPosition = employeesList.scrollTop + employeesList.clientHeight;\n\n\t\t\tif (employeesList.scrollHeight - scrollPosition < 40)\n\t\t\t{\n\t\t\t\tthis.loadEmployeesAction();\n\t\t\t}\n\t\t},\n\t\tasync loadEmployeesAction(): void\n\t\t{\n\t\t\tconst nodeId = this.focusedNode;\n\n\t\t\tif (!this.departments.get(nodeId))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst employeeListOptions = this.departments.get(nodeId).employeeListOptions ?? {};\n\n\t\t\temployeeListOptions.page = employeeListOptions.page ?? 0;\n\t\t\temployeeListOptions.shouldUpdateList = employeeListOptions.shouldUpdateList ?? true;\n\t\t\temployeeListOptions.isListUpdated = employeeListOptions.isListUpdated ?? false;\n\t\t\tDepartmentContentActions.updateEmployeeListOptions(nodeId, employeeListOptions);\n\t\t\tif (employeeListOptions.isListUpdated || !employeeListOptions.shouldUpdateList)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t!employeeListOptions.isListUpdated\n\t\t\t\t&& employeeListOptions.page === 0\n\t\t\t\t&& employeeListOptions.shouldUpdateList === true\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.$emit('showDetailLoader');\n\t\t\t}\n\n\t\t\temployeeListOptions.isListUpdated = true;\n\t\t\temployeeListOptions.page += 1;\n\t\t\tDepartmentContentActions.updateEmployeeListOptions(nodeId, employeeListOptions);\n\n\t\t\tlet loadedEmployees = await DepartmentAPI.getPagedEmployees(nodeId, employeeListOptions.page, 25);\n\n\t\t\tif (!loadedEmployees)\n\t\t\t{\n\t\t\t\temployeeListOptions.shouldUpdateList = false;\n\t\t\t\temployeeListOptions.isListUpdated = false;\n\t\t\t\tDepartmentContentActions.updateEmployeeListOptions(nodeId, employeeListOptions);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tloadedEmployees = loadedEmployees.map((user) => {\n\t\t\t\treturn { ...user, role: this.memberRoles.employee };\n\t\t\t});\n\n\t\t\tconst employees = this.departments.get(nodeId)?.employees ?? [];\n\t\t\tconst employeeIds = new Set(employees.map((employee) => employee.id));\n\n\t\t\tconst newEmployees = loadedEmployees.reverse().filter((employee) => !employeeIds.has(employee.id));\n\t\t\temployees.unshift(...newEmployees);\n\t\t\temployeeListOptions.shouldUpdateList = newEmployees.length === 25;\n\t\t\temployeeListOptions.isListUpdated = false;\n\n\t\t\tDepartmentContentActions.updateEmployeeListOptions(nodeId, employeeListOptions);\n\t\t\tDepartmentContentActions.updateEmployees(nodeId, employees);\n\t\t\tif (this.departmentUsersStatus.loaded)\n\t\t\t{\n\t\t\t\tthis.$emit('hideDetailLoader');\n\t\t\t}\n\n\t\t\tif (this.needToScroll)\n\t\t\t{\n\t\t\t\tthis.scrollToUser();\n\t\t\t}\n\t\t},\n\t\tasync scrollToUser(): void\n\t\t{\n\t\t\tconst userId = this.needToFocusUserId;\n\t\t\tthis.needToFocusUserId = null;\n\t\t\tthis.needToScroll = false;\n\t\t\tconst selectors = `.hr-department-detail-content__user-container[data-id=\"hr-department-detail-content__user-${userId}-item\"]`;\n\t\t\tlet element = this.tabContainer.querySelector(selectors);\n\n\t\t\tif (!element)\n\t\t\t{\n\t\t\t\tlet user = null;\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\tuser = await DepartmentAPI.getUserInfo(this.focusedNode, userId);\n\t\t\t\t}\n\t\t\t\tcatch\n\t\t\t\t{ /* empty */ }\n\n\t\t\t\tconst department = this.departments.get(this.focusedNode);\n\t\t\t\tif (!user || !department)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (user.role === this.memberRoles.head || user.role === this.memberRoles.deputyHead)\n\t\t\t\t{\n\t\t\t\t\tdepartment.heads = department.heads ?? [];\n\t\t\t\t\tif (!department.heads.some((head) => head.id === user.id))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tdepartment.employees = department.employees ?? [];\n\t\t\t\t\tif (!department.employees.some((employee) => employee.id === user.id))\n\t\t\t\t\t{\n\t\t\t\t\t\tdepartment.employees.push(user);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// eslint-disable-next-line vue/valid-next-tick\n\t\t\t\tawait this.$nextTick(() => {\n\t\t\t\t\telement = this.tabContainer.querySelector(selectors);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (!element)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\telement.scrollIntoView({ behavior: 'smooth', block: 'center' });\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.selectedUserId = userId;\n\t\t\t}, 750);\n\n\t\t\tif (this.clearSearchTimeout)\n\t\t\t{\n\t\t\t\tclearTimeout(this.clearSearchTimeout);\n\t\t\t}\n\n\t\t\tthis.clearSearchTimeout = setTimeout(() => {\n\t\t\t\tif (this.searchedUserId === userId)\n\t\t\t\t{\n\t\t\t\t\tthis.selectedUserId = null;\n\t\t\t\t\tthis.searchedUserId = null;\n\t\t\t\t}\n\t\t\t}, 4000);\n\t\t},\n\t\tasync searchMembers(query)\n\t\t{\n\t\t\tif (query.length === 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.findQueryResult = this.findQueryResult || {};\n\t\t\tthis.findQueryResult[this.focusedNode] = this.findQueryResult[this.focusedNode] || {\n\t\t\t\tsuccess: [],\n\t\t\t\tfailure: [],\n\t\t\t};\n\n\t\t\tconst nodeResults = this.findQueryResult[this.focusedNode];\n\n\t\t\tif (nodeResults.failure.some((failedQuery) => query.startsWith(failedQuery)))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (nodeResults.success.includes(query) || nodeResults.failure.includes(query))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst founded = await DepartmentAPI.findMemberByQuery(this.focusedNode, query);\n\n\t\t\tif (founded.length === 0)\n\t\t\t{\n\t\t\t\tnodeResults.failure.push(query);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst department = this.departments.get(this.focusedNode);\n\t\t\tconst newMembers = founded.filter((found) => !department.heads.some((head) => head.id === found.id)\n\t\t\t\t&& !department.employees.some((employee) => employee.id === found.id));\n\n\t\t\tdepartment.employees.push(...newMembers);\n\t\t\tnodeResults.success.push(query);\n\t\t},\n\t\tsearchUser(searchQuery: string): void\n\t\t{\n\t\t\tthis.searchQuery = searchQuery;\n\t\t},\n\t\tonHeadListActionMenuItemClick(actionId: string): void\n\t\t{\n\t\t\tthis.headMenu.onActionMenuItemClick(actionId);\n\t\t},\n\t\tonEmployeeListActionMenuItemClick(actionId: string): void\n\t\t{\n\t\t\tthis.employeeMenu.onActionMenuItemClick(actionId);\n\t\t},\n\t\tgetHeadListDataTestIds(): TabListDataTestIds\n\t\t{\n\t\t\treturn HeadListDataTestIds;\n\t\t},\n\t\tgetEmployeeListDataTestIds(): TabListDataTestIds\n\t\t{\n\t\t\treturn EmployeeListDataTestIds;\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"hr-department-detail-content__tab-container --users\" ref=\"tab-container\">\n\t\t\t<template v-if=\"memberCount > 0\">\n\t\t\t\t<SearchInput\n\t\t\t\t\tv-if=\"showSearchBar\"\n\t\t\t\t\t:placeholder=\"loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_SEARCH_PLACEHOLDER')\"\n\t\t\t\t\t:value=\"searchQuery\"\n\t\t\t\t\t@inputChange=\"searchUser\"\n\t\t\t\t\tdataTestId=\"hr-department-detail-content_users-tab__users-search-input\"\n\t\t\t\t/>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"!showSearchEmptyState\"\n\t\t\t\t\tv-on=\"shouldUpdateList ? { scroll: updateList } : {}\"\n\t\t\t\t\tclass=\"hr-department-detail-content__lists-container\"\n\t\t\t\t>\n\t\t\t\t\t<TabList\n\t\t\t\t\t\tid='hr-department-detail-content_chats-tab__chat-list'\n\t\t\t\t\t\t:title=\"loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_HEAD_LIST_TITLE')\"\n\t\t\t\t\t\t:count=\"headCount\"\n\t\t\t\t\t\t:menuItems=\"headMenu.items\"\n\t\t\t\t\t\t:listItems=\"filteredHeads\"\n\t\t\t\t\t\t:emptyItemTitle=\"headListEmptyStateTitle\"\n\t\t\t\t\t\temptyItemImageClass=\"hr-department-detail-content__empty-user-list-item-image\"\n\t\t\t\t\t\t:hideEmptyItem=\"searchQuery.length > 0\"\n\t\t\t\t\t\t:withAddPermission=\"canAddUsers\"\n\t\t\t\t\t\t@tabListAction=\"onHeadListActionMenuItemClick\"\n\t\t\t\t\t\t:dataTestIds=\"getHeadListDataTestIds()\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<template v-slot=\"{ item }\">\n\t\t\t\t\t\t\t<UserListItem\n\t\t\t\t\t\t\t\t:user=\"item\"\n\t\t\t\t\t\t\t\t:selectedUserId=\"selectedUserId\"\n\t\t\t\t\t\t\t\t:entityType=\"entityType\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</TabList>\n\t\t\t\t\t<TabList\n\t\t\t\t\t\tid='hr-department-detail-content_chats-tab__channel-list'\n\t\t\t\t\t\t:title=\"employeeTitle\"\n\t\t\t\t\t\t:count=\"employeeCount\"\n\t\t\t\t\t\t:menuItems=\"employeeMenu.items\"\n\t\t\t\t\t\t:listItems=\"filteredEmployees\"\n\t\t\t\t\t\t:emptyItemTitle=\"employeesListEmptyStateTitle\"\n\t\t\t\t\t\temptyItemImageClass=\"hr-department-detail-content__empty-user-list-item-image\"\n\t\t\t\t\t\t:hideEmptyItem=\"searchQuery.length > 0\"\n\t\t\t\t\t\t:withAddPermission=\"canAddUsers\"\n\t\t\t\t\t\t@tabListAction=\"onEmployeeListActionMenuItemClick\"\n\t\t\t\t\t\t:dataTestIds=\"getEmployeeListDataTestIds()\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<template v-slot=\"{ item }\">\n\t\t\t\t\t\t\t<UserListItem\n\t\t\t\t\t\t\t\t:user=\"item\"\n\t\t\t\t\t\t\t\t:selectedUserId=\"selectedUserId\"\n\t\t\t\t\t\t\t\t:entityType=\"entityType\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</TabList>\n\t\t\t\t</div>\n\t\t\t\t<EmptyState v-else\n\t\t\t\t\timageClass=\"hr-department-detail-content__empty-tab-user-not-found-icon\"\n\t\t\t\t\t:title=\"loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPTY_SEARCHED_EMPLOYEES_TITLE')\"\n\t\t\t\t\t:description =\"loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPTY_SEARCHED_EMPLOYEES_SUBTITLE')\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t\t<EmptyState v-else\n\t\t\t\t:imageClass=\"canAddUsers \n\t\t\t\t\t? 'hr-department-detail-content__empty-tab-add-user-icon' \n\t\t\t\t\t: 'hr-department-detail-content__empty-tab-cant-add-user-icon'\"\n\t\t\t\t:title=\"emptyStateTitle\"\n\t\t\t\t:description =\"emptyStateDescription\"\n\t\t\t>\n\t\t\t\t<template v-slot:content>\n\t\t\t\t\t<EmptyTabAddButton v-if=\"canAddUsers\" :departmentId=\"departmentId\" :entityType=\"entityType\"/>\n\t\t\t\t</template>\n\t\t\t</EmptyState>\n\t\t</div>\n\t`,\n};\n","import { Main } from 'ui.icon-set.api.core';\nimport { Loc } from 'main.core';\n\nexport const ChatsMenuOption = Object.freeze({\n\taddChat: 'addChat',\n\tlinkChat: 'linkChat',\n\taddChannel: 'addChannel',\n\tlinkChannel: 'linkChannel',\n});\n\nexport const ChatsMenuLinkChat = Object.freeze({\n\tid: ChatsMenuOption.linkChat,\n\ttitle: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHAT_LIST_LINK_BUTTON_TITLE'),\n\tdescription: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHAT_LIST_LINK_BUTTON_DESC'),\n\tbIcon: {\n\t\tname: Main.CHAT_MESSAGE,\n\t\tsize: 20,\n\t\tcolorTokenName: 'paletteBlue50',\n\t},\n\tdataTestId: 'hr-department-content_chats-tab__chat-list-action-link',\n});\n\nexport const ChatsMenuAddChat = Object.freeze({\n\tid: ChatsMenuOption.addChat,\n\ttitle: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHAT_LIST_ADD_BUTTON_TITLE'),\n\tdescription: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHAT_LIST_ADD_BUTTON_DESC'),\n\tbIcon: {\n\t\tname: Main.ADD_CHAT,\n\t\tsize: 20,\n\t\tcolorTokenName: 'paletteBlue50',\n\t},\n\tdataTestId: 'hr-department-content_chats-tab__chat-list-action-add',\n});\n\nexport const ChatsMenuLinkChannel = Object.freeze({\n\tid: ChatsMenuOption.linkChannel,\n\ttitle: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHANNEL_LIST_LINK_BUTTON_TITLE'),\n\tdescription: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHANNEL_LIST_LINK_BUTTON_DESC'),\n\tbIcon: {\n\t\tname: Main.SPEAKER_MOUTHPIECE,\n\t\tsize: 20,\n\t\tcolorTokenName: 'paletteBlue50',\n\t},\n\tdataTestId: 'hr-department-content_chats-tab__channel-list-action-link',\n});\n\nexport const ChatsMenuAddChannel = Object.freeze({\n\tid: ChatsMenuOption.addChannel,\n\ttitle: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHANNEL_LIST_ADD_BUTTON_TITLE'),\n\tdescription: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHANNEL_LIST_ADD_BUTTON_DESC'),\n\tbIcon: {\n\t\tname: Main.SPEAKER_MOUTHPIECE_PLUS,\n\t\tsize: 20,\n\t\tcolorTokenName: 'paletteBlue50',\n\t},\n\tdataTestId: 'hr-department-content_chats-tab__channel-list-action-add',\n});\n\nexport const ChatListDataTestIds = Object.freeze({\n\tcontainerDataTestId: 'hr-department-content_chats-tab__chat-list-container',\n\tlistActionButtonDataTestId: 'hr-department-content_chats-tab__chat-list-action-button',\n\tlistActonMenuDataTestId: 'hr-department-content_chats-tab__chat-list-action-menu-container',\n\tlistCounterDataTestId: 'hr-department-content_chats-tab__chat-list-counter',\n});\n\nexport const ChannelListDataTestIds = Object.freeze({\n\tcontainerDataTestId: 'hr-department-content_chats-tab__channel-list-container',\n\tlistActionButtonDataTestId: 'hr-department-content_chats-tab__channel-list-action-button',\n\tlistActonMenuDataTestId: 'hr-department-content_chats-tab__channel-list-action-menu-container',\n\tlistCounterDataTestId: 'hr-department-content_chats-tab__channel-list-counter',\n});\n\nexport const ChatLinkDialogDataTestIds = Object.freeze({\n\tcontainerDataTestId: 'hr-department-content_chats-tab__link-chat-container',\n\tconfirmButtonDataTestId: 'hr-department-content_chats-tab__link-chat-confirm-button',\n\tcancelButtonDataTestId: 'hr-department-content_chats-tab__link-chat-cancel-button',\n\tcloseButtonDataTestId: 'hr-department-content_chats-tab__link-chat-close-button',\n});\n\nexport const ChannelLinkDialogDataTestIds = Object.freeze({\n\tcontainerDataTestId: 'hr-department-content_chats-tab__link-channel-container',\n\tconfirmButtonDataTestId: 'hr-department-content_chats-tab__link-channel-confirm-button',\n\tcancelButtonDataTestId: 'hr-department-content_chats-tab__link-channel-cancel-button',\n\tcloseButtonDataTestId: 'hr-department-content_chats-tab__link-channel-close-button',\n});\n","import { RouteActionMenu } from 'humanresources.company-structure.structure-components';\nimport './styles/empty-tab-add-buttons.css';\nimport { ChatsMenuOption } from './consts';\nimport 'ui.icon-set.main';\n\nexport const EmptyTabAddButtons = {\n\tname: 'emptyStateButtons',\n\temits: ['emptyStateAddAction'],\n\tcomponents: { RouteActionMenu },\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tchatMenuVisible: false,\n\t\t\tchannelMenuVisible: false,\n\t\t\tchatButtonId: 'hr-empty-tab-chat-add-button',\n\t\t\tchannelButtonId: 'hr-empty-tab-chat-add-button',\n\t\t};\n\t},\n\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tonChatButtonClick(): void\n\t\t{\n\t\t\tthis.$emit('emptyStateAddAction', ChatsMenuOption.linkChat);\n\t\t},\n\t\tonChannelButtonClick(): void\n\t\t{\n\t\t\tthis.$emit('emptyStateAddAction', ChatsMenuOption.linkChannel);\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"hr-department-detail-content__chat-empty-tab-add_buttons-container\">\n\t\t\t<button\n\t\t\t\t:ref=\"chatButtonId\"\n\t\t\t\tclass=\"ui-btn ui-btn-light-border ui-btn-no-caps ui-btn-round ui-btn-sm hr-department-detail-content__chat-empty-tab-add_chat-button\"\n\t\t\t\t@click.stop=\"this.onChatButtonClick()\"\n\t\t\t\tdata-test-id=\"hr-department-detail-content_chats-tab__empty-tab-add_chat-button\"\n\t\t\t>\n\t\t\t\t<div class=\"ui-icon-set --add-chat hr-department-detail-content__chat-empty-tab-add_chat-button-icon\"/>\n\t\t\t\t<span>\n\t\t\t\t\t{{ loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_TAB_ADD_EMPTY_CHAT_BUTTON') }}\n\t\t\t\t</span>\n\t\t\t</button>\n\t\t\t<button\n\t\t\t\t:ref=\"channelButtonId\"\n\t\t\t\tclass=\"ui-btn ui-btn-light-border ui-btn-no-caps ui-btn-round ui-btn-sm hr-department-detail-content__chat-empty-tab-add_channel-button\"\n\t\t\t\t@click.stop=\"onChannelButtonClick()\"\n\t\t\t\tdata-test-id=\"hr-department-detail-content_chats-tab__empty-tab-add_channel-button\"\n\t\t\t>\n\t\t\t\t<div class=\"ui-icon-set --speaker-mouthpiece-plus hr-department-detail-content__chat-empty-tab-add_chat-button-icon\"/>\n\t\t\t\t<span>\n\t\t\t\t\t{{ loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_TAB_ADD_EMPTY_CHANNEL_BUTTON') }}\n\t\t\t\t</span>\n\t\t\t</button>\n\t\t</div>\n\t`,\n};\n","import { AvatarRound, AvatarSquare } from 'ui.avatar';\nimport { Messenger } from 'im.public.iframe';\nimport { getColorCode } from 'humanresources.company-structure.utils';\n\nexport const ChatListItem = {\n\tname: 'chatListItem',\n\n\tprops: {\n\t\tchat: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tavatar: null,\n\t\t};\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.prepareAvatar();\n\t},\n\n\tmethods: {\n\t\tprepareAvatar(): void\n\t\t{\n\t\t\tif (this.chat.avatar)\n\t\t\t{\n\t\t\t\tthis.chat.color = getColorCode('whiteBase');\n\t\t\t}\n\n\t\t\tconst avatarOptions = {\n\t\t\t\tsize: 32,\n\t\t\t\tuserName: this.chat.title,\n\t\t\t\tbaseColor: this.isExtranet() && !this.chat.avatar ? getColorCode('extranetColor') : this.chat.color,\n\t\t\t\tevents: {\n\t\t\t\t\tclick: () => {\n\t\t\t\t\t\tthis.onChatItemClick();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tif (this.chat.avatar)\n\t\t\t{\n\t\t\t\tavatarOptions.userpicPath = this.chat.avatar;\n\t\t\t}\n\n\t\t\tthis.avatar = this.isChat() ? new AvatarRound(avatarOptions) : new AvatarSquare(avatarOptions);\n\t\t},\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tonChatItemClick(): void\n\t\t{\n\t\t\tMessenger.openChat(this.chat.dialogId);\n\t\t},\n\t\tisChat(): boolean\n\t\t{\n\t\t\treturn this.chat.type !== 'CHANNEL';\n\t\t},\n\t\tisExtranet(): boolean\n\t\t{\n\t\t\treturn this.chat.isExtranet;\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t\t:key=\"chat.id\"\n\t\t\tclass=\"hr-department-detail-content__tab-list_item-wrapper --chat\"\n\t\t\t:class=\"{ '--isExtranet': isExtranet() }\"\n\t\t\t:data-test-id=\"'hr-department-content_chats-tab__list_chat-item-' + chat.id\"\n\t\t>\n\t\t\t<div\n\t\t\t\tclass=\"hr-department-detail-content__tab-list_item-avatar-container\"\n\t\t\t\tv-html=\"this.avatar.getContainer().outerHTML\"\n\t\t\t\t@click=\"onChatItemClick\"\n\t\t\t/>\n\t\t\t<div class=\"hr-department-detail-content__tab-list_item-text-container\">\n\t\t\t\t<div class=\"hr-department-detail-content__tab-list_item-title-container\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"hr-department-detail-content__tab-list_item-title\"\n\t\t\t\t\t\t:data-test-id=\"'hr-department-content_chats-tab__list_chat-item-' + chat.id + '-title'\"\n\t\t\t\t\t\t@click=\"onChatItemClick\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ chat.title }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"hr-department-detail-content__tab-list_item-subtitle\">\n\t\t\t\t\t{{ chat.subtitle }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div \n\t\t\t\tclass=\"hr-department-detail-content__tab-list_item-action-btn --chat-item-action-btn ui-icon-set --arrow-right\"\n\t\t\t\t@click=\"onChatItemClick\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { EntityTypes } from 'humanresources.company-structure.utils';\nimport { DepartmentContentActions } from '../../actions';\nimport { DepartmentAPI } from '../../api';\nimport { SearchInput } from '../base-components/search/search-input';\nimport { TabList } from '../base-components/list/list';\nimport { EmptyState } from '../base-components/empty-state/empty-state';\nimport { EmptyTabAddButtons } from './empty-tab-add-buttons';\nimport { ChatListItem } from './list-item';\nimport {\n\tChatsMenuOption,\n\tChatsMenuLinkChat,\n\tChatsMenuLinkChannel,\n\tChatListDataTestIds,\n\tChannelListDataTestIds,\n\tChatLinkDialogDataTestIds,\n\tChannelLinkDialogDataTestIds,\n} from './consts';\nimport {\n\tgetChatDialogEntity,\n\tgetChannelDialogEntity,\n\tChatTypeDict,\n\tgetChatRecentTabOptions,\n\tManagementDialog,\n} from 'humanresources.company-structure.structure-components';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { mapState } from 'ui.vue3.pinia';\nimport { Type } from 'main.core';\nimport type { TabOptions } from 'ui.entity-selector';\n\nimport './styles/tab.css';\n\nexport const ChatsTab = {\n\tname: 'chatsTab',\n\n\tcomponents: {\n\t\tSearchInput,\n\t\tTabList,\n\t\tEmptyState,\n\t\tEmptyTabAddButtons,\n\t\tChatListItem,\n\t\tManagementDialog,\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tchatMenuItems: [],\n\t\t\tchannelMenuItems: [],\n\t\t\tisChatLinkActive: false,\n\t\t\tchatLinkDialogVisible: false,\n\t\t\tisChannelLinkActive: false,\n\t\t\tchannelLinkDialogVisible: false,\n\t\t\tisLoading: false,\n\t\t\tsearchQuery: '',\n\t\t};\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.loadChatAction();\n\t\tthis.chatMenuItems = this.getChatListMenuItems();\n\t\tthis.channelMenuItems = this.getChannelListMenuItems();\n\t},\n\n\tmethods:\n\t{\n\t\tloc(phraseCode: string, replacements: {[p: string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tsearchChatOrChannel(searchQuery: string): void\n\t\t{\n\t\t\tthis.searchQuery = searchQuery;\n\t\t},\n\t\tasync loadChatAction(force: boolean): void\n\t\t{\n\t\t\tconst nodeId = this.focusedNode;\n\t\t\tconst department = this.departments.get(nodeId);\n\t\t\tif (!department)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!force && Type.isArray(department.chats) && Type.isArray(department.channels))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.isLoading)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.isLoading = true;\n\n\t\t\tthis.$emit('showDetailLoader');\n\t\t\tconst loadedChatsAndChannels = await DepartmentAPI.getChatsAndChannels(nodeId);\n\t\t\tDepartmentContentActions.setChatsAndChannels(\n\t\t\t\tnodeId,\n\t\t\t\tloadedChatsAndChannels.chats ?? [],\n\t\t\t\tloadedChatsAndChannels.channels ?? [],\n\t\t\t);\n\t\t\tthis.$emit('hideDetailLoader');\n\t\t\tthis.isLoading = false;\n\t\t},\n\t\tgetChatListMenuItems(): Array\n\t\t{\n\t\t\treturn [\n\t\t\t\tChatsMenuLinkChat,\n\t\t\t];\n\t\t},\n\t\tgetChannelListMenuItems(): Array\n\t\t{\n\t\t\treturn [\n\t\t\t\tChatsMenuLinkChannel,\n\t\t\t];\n\t\t},\n\t\tonActionMenuItemClick(actionId: string): void\n\t\t{\n\t\t\tif (actionId === ChatsMenuOption.linkChat)\n\t\t\t{\n\t\t\t\tthis.chatLinkDialogVisible = true;\n\t\t\t}\n\n\t\t\tif (actionId === ChatsMenuOption.linkChannel)\n\t\t\t{\n\t\t\t\tthis.channelLinkDialogVisible = true;\n\t\t\t}\n\t\t},\n\t\tgetAddEmptyStateList(): { text: string }[]\n\t\t{\n\t\t\tlet stateArray = [];\n\n\t\t\tif (this.isTeamEntity)\n\t\t\t{\n\t\t\t\tstateArray = [\n\t\t\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_TAB_ADD_EMPTY_STATE_TEAM_LIST_ITEM_1'),\n\t\t\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_TAB_ADD_EMPTY_STATE_LIST_ITEM_2'),\n\t\t\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_TAB_ADD_EMPTY_STATE_TEAM_LIST_ITEM_3'),\n\t\t\t\t];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tstateArray = [\n\t\t\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_TAB_ADD_EMPTY_STATE_LIST_ITEM_1'),\n\t\t\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_TAB_ADD_EMPTY_STATE_LIST_ITEM_2'),\n\t\t\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_TAB_ADD_EMPTY_STATE_LIST_ITEM_3'),\n\t\t\t\t];\n\t\t\t}\n\n\t\t\treturn stateArray.map((item) => ({ text: item }));\n\t\t},\n\t\tgetChatListDataTestIds(): Object\n\t\t{\n\t\t\treturn ChatListDataTestIds;\n\t\t},\n\t\tgetChannelListDataTestIds(): Object\n\t\t{\n\t\t\treturn ChannelListDataTestIds;\n\t\t},\n\t\tgetChatLinkDialogEntities(): Array\n\t\t{\n\t\t\tconst entity = getChatDialogEntity();\n\t\t\tentity.options.excludeIds = this.chats.map((item) => item.id);\n\n\t\t\treturn [entity];\n\t\t},\n\t\tgetChannelLinkDialogEntities(): Array\n\t\t{\n\t\t\tconst entity = getChannelDialogEntity();\n\t\t\tentity.options.excludeIds = this.channels.map((item) => item.id);\n\n\t\t\treturn [entity];\n\t\t},\n\t\tgetChatLinkRecentTabOptions(): TabOptions\n\t\t{\n\t\t\treturn getChatRecentTabOptions(this.teamEntity, ChatTypeDict.chat);\n\t\t},\n\t\tgetChannelLinkRecentTabOptions(): TabOptions\n\t\t{\n\t\t\treturn getChatRecentTabOptions(this.teamEntity, ChatTypeDict.channel);\n\t\t},\n\t\tasync linkChats(chatsItems: Array): void\n\t\t{\n\t\t\tthis.isChatLinkActive = true;\n\t\t\tconst chats = (chatsItems).map((chatItem) => Number(chatItem.id.replace('chat', '')));\n\t\t\tconst nodeId = this.focusedNode;\n\t\t\tconst ids = { chat: chats };\n\t\t\ttry\n\t\t\t{\n\t\t\t\tawait DepartmentAPI.saveChats(nodeId, ids);\n\t\t\t}\n\t\t\tcatch\n\t\t\t{ /* empty */ }\n\t\t\tthis.isChatLinkActive = false;\n\t\t\tthis.chatLinkDialogVisible = false;\n\t\t\tthis.loadChatAction(true);\n\t\t},\n\t\tasync linkChannel(chatsItems: Array): void\n\t\t{\n\t\t\tthis.isChannelLinkActive = true;\n\t\t\tconst channels = (chatsItems).map((chatItem) => Number(chatItem.id.replace('chat', '')));\n\t\t\tconst nodeId = this.focusedNode;\n\t\t\tconst ids = { channel: channels };\n\t\t\ttry\n\t\t\t{\n\t\t\t\tawait DepartmentAPI.saveChats(nodeId, ids);\n\t\t\t}\n\t\t\tcatch\n\t\t\t{ /* empty */ }\n\t\t\tthis.isChannelLinkActive = false;\n\t\t\tthis.channelLinkDialogVisible = false;\n\t\t\tthis.loadChatAction(true);\n\t\t},\n\t\tgetChatLinkDialogDataTestIds(): Object\n\t\t{\n\t\t\treturn ChatLinkDialogDataTestIds;\n\t\t},\n\t\tgetChannelLinkDialogDataTestIds(): Object\n\t\t{\n\t\t\treturn ChannelLinkDialogDataTestIds;\n\t\t},\n\t},\n\n\tcomputed:\n\t{\n\t\tchats(): Array\n\t\t{\n\t\t\treturn this.departments.get(this.focusedNode)?.chats ?? [];\n\t\t},\n\t\tchannels(): Array\n\t\t{\n\t\t\treturn this.departments.get(this.focusedNode)?.channels ?? [];\n\t\t},\n\t\tfilteredChats(): Array\n\t\t{\n\t\t\treturn this.chats.filter(\n\t\t\t\t(chat) => chat.title.toLowerCase().includes(this.searchQuery.toLowerCase()),\n\t\t\t);\n\t\t},\n\t\tfilteredChannels(): Array\n\t\t{\n\t\t\treturn this.channels.filter(\n\t\t\t\t(channel) => channel.title.toLowerCase().includes(this.searchQuery.toLowerCase()),\n\t\t\t);\n\t\t},\n\t\tshowAddEmptyState(): boolean\n\t\t{\n\t\t\treturn this.chats.length === 0 && this.channels.length === 0;\n\t\t},\n\t\tshowSearchEmptyState(): boolean\n\t\t{\n\t\t\treturn this.filteredChats.length === 0 && this.filteredChannels.length === 0;\n\t\t},\n\t\tgetLinkedChatIds(): Array\n\t\t{\n\t\t\treturn (this.chats).map((chatItem) => `chat${chatItem.id}`);\n\t\t},\n\t\tgetLinkedChannelIds(): Array\n\t\t{\n\t\t\treturn (this.channels).map((channelItem) => `chat${channelItem.id}`);\n\t\t},\n\t\tisChatsLoaded(): Boolean\n\t\t{\n\t\t\tconst department = this.departments.get(this.focusedNode);\n\n\t\t\treturn Boolean(Type.isArray(department.chats) && Type.isArray(department.channels));\n\t\t},\n\t\tteamEntity(): boolean\n\t\t{\n\t\t\treturn this.departments.get(this.focusedNode)?.entityType;\n\t\t},\n\t\tisTeamEntity(): boolean\n\t\t{\n\t\t\treturn this.teamEntity === EntityTypes.team;\n\t\t},\n\t\tgetAddEmptyStateTitle(): string\n\t\t{\n\t\t\treturn this.isTeamEntity\n\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_TAB_ADD_EMPTY_STATE_TEAM_TITLE')\n\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_TAB_ADD_EMPTY_STATE_TITLE')\n\t\t\t;\n\t\t},\n\t\tgetAddChatDescription(): string\n\t\t{\n\t\t\treturn this.isTeamEntity\n\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHAT_LINK_DIALOG_TEAM_DESC')\n\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHAT_LINK_DIALOG_DESC')\n\t\t\t;\n\t\t},\n\t\tgetAddChannelDescription(): string\n\t\t{\n\t\t\treturn this.isTeamEntity\n\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHANNEL_LINK_DIALOG_TEAM_DESC')\n\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHANNEL_LINK_DIALOG_DESC')\n\t\t\t;\n\t\t},\n\t\t...mapState(useChartStore, ['focusedNode', 'departments']),\n\t},\n\n\twatch: {\n\t\tisChatsLoaded(isChatsLoaded): void {\n\t\t\tif (isChatsLoaded === false)\n\t\t\t{\n\t\t\t\tthis.loadChatAction();\n\t\t\t}\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"hr-department-detail-content__tab-container --chat\">\n\t\t\t<template v-if=\"!showAddEmptyState\">\n\t\t\t\t<SearchInput\n\t\t\t\t\t:placeholder=\"loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHAT_SEARCH_INPUT_PLACEHOLDER')\"\n\t\t\t\t\t:value=\"searchQuery\"\n\t\t\t\t\t@inputChange=\"searchChatOrChannel\"\n\t\t\t\t\tdataTestId=\"hr-department-detail-content_chats-tab__chats-and-channels-search-input\"\n\t\t\t\t/>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"!showSearchEmptyState\"\n\t\t\t\t\tclass=\"hr-department-detail-content__lists-container\"\n\t\t\t\t>\n\t\t\t\t\t<TabList\n\t\t\t\t\t\tid='hr-department-detail-content_chats-tab__chat-list'\n\t\t\t\t\t\t:title=\"loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHAT_LIST_TITLE')\"\n\t\t\t\t\t\t:count=\"chats.length\"\n\t\t\t\t\t\t:menuItems=\"chatMenuItems\"\n\t\t\t\t\t\t:listItems=\"filteredChats\"\n\t\t\t\t\t\t:emptyItemTitle=\"loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_CHAT_LIST_ITEM_TEXT')\"\n\t\t\t\t\t\temptyItemImageClass=\"hr-department-detail-content__chat-empty-tab-list-item_tab-icon\"\n\t\t\t\t\t\t:hideEmptyItem=\"searchQuery.length > 0\"\n\t\t\t\t\t\t@tabListAction=\"onActionMenuItemClick\"\n\t\t\t\t\t\t:dataTestIds=\"getChatListDataTestIds()\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<template v-slot=\"{ item }\">\n\t\t\t\t\t\t\t<ChatListItem :chat=\"item\"/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</TabList>\n\t\t\t\t\t<TabList\n\t\t\t\t\t\tid='hr-department-detail-content_chats-tab__channel-list'\n\t\t\t\t\t\t:title=\"loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHANNEL_LIST_TITLE')\"\n\t\t\t\t\t\t:count=\"channels.length\"\n\t\t\t\t\t\t:menuItems=\"channelMenuItems\"\n\t\t\t\t\t\t:listItems=\"filteredChannels\"\n\t\t\t\t\t\t:emptyItemTitle=\"loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_CHANNEL_LIST_ITEM_TEXT')\"\n\t\t\t\t\t\temptyItemImageClass=\"hr-department-detail-content__chat-empty-tab-list-item_tab-icon\"\n\t\t\t\t\t\t:hideEmptyItem=\"searchQuery.length > 0\"\n\t\t\t\t\t\t@tabListAction=\"onActionMenuItemClick\"\n\t\t\t\t\t\t:dataTestIds=\"getChannelListDataTestIds()\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<template v-slot=\"{ item }\">\n\t\t\t\t\t\t\t<ChatListItem :chat=\"item\"/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</TabList>\n\t\t\t\t</div>\n\t\t\t\t<EmptyState \n\t\t\t\t\tv-else\n\t\t\t\t\timageClass=\"hr-department-detail-content__empty-tab-search_tab-icon\"\n\t\t\t\t\t:title=\"loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPTY_SEARCHED_EMPLOYEES_TITLE')\"\n\t\t\t\t\t:description =\"loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPTY_SEARCHED_EMPLOYEES_SUBTITLE')\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t\t<EmptyState \n\t\t\t\tv-else\n\t\t\t\timageClass=\"hr-department-detail-content__chat-empty-tab-add_tab-icon\"\n\t\t\t\t:title=\"getAddEmptyStateTitle\"\n\t\t\t\t:list=\"getAddEmptyStateList()\"\n\t\t\t>\n\t\t\t\t<template v-slot:content>\n\t\t\t\t\t<EmptyTabAddButtons\n\t\t\t\t\t\t@emptyStateAddAction=\"onActionMenuItemClick\"\n\t\t\t\t\t/>\n\t\t\t\t</template>\n\t\t\t</EmptyState>\n\t\t\t<ManagementDialog\n\t\t\t\tv-if=\"chatLinkDialogVisible\"\n\t\t\t\tid=\"hr-department-detail-content-chats-tab-chat-link-dialog\"\n\t\t\t\t:entities=\"getChatLinkDialogEntities()\"\n\t\t\t\t:recentTabOptions=\"getChatLinkRecentTabOptions()\"\n\t\t\t\t:hiddenItemsIds=\"getLinkedChatIds\"\n\t\t\t\t:title=\"loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHAT_LINK_DIALOG_TITLE')\"\n\t\t\t\t:description=\"getAddChatDescription\"\n\t\t\t\t:isActive=\"isChatLinkActive\"\n\t\t\t\t@managementDialogAction=\"linkChats\"\n\t\t\t\t@close=\"chatLinkDialogVisible = false\"\n\t\t\t\t:dataTestIds=\"getChatLinkDialogDataTestIds()\"\n\t\t\t/>\n\t\t\t<ManagementDialog\n\t\t\t\tv-if=\"channelLinkDialogVisible\"\n\t\t\t\tid=\"hr-department-detail-content-chats-tab-channel-link-dialog\"\n\t\t\t\t:entities=\"getChannelLinkDialogEntities()\"\n\t\t\t\t:recentTabOptions=\"getChannelLinkRecentTabOptions()\"\n\t\t\t\t:hiddenItemsIds=\"getLinkedChannelIds\"\n\t\t\t\t:title=\"loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHANNEL_LINK_DIALOG_TITLE')\"\n\t\t\t\t:description=\"getAddChannelDescription\"\n\t\t\t\t:isActive=\"isChannelLinkActive\"\n\t\t\t\t@managementDialogAction=\"linkChannel\"\n\t\t\t\t@close=\"channelLinkDialogVisible = false\"\n\t\t\t\t:dataTestIds=\"getChannelLinkDialogDataTestIds()\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { EntityTypes } from 'humanresources.company-structure.utils';\nimport { UsersTab } from './users/tab';\nimport { ChatsTab } from './chats/tab';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { mapState } from 'ui.vue3.pinia';\n\nimport '../style.css';\n\n// @vue/component\nexport const DepartmentContent = {\n\tname: 'departmentContent',\n\n\tcomponents: { UsersTab, ChatsTab },\n\n\tprops: {\n\t\tisCollapsed: Boolean,\n\t},\n\n\temits: ['showDetailLoader', 'hideDetailLoader', 'editEmployee'],\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tactiveTab: 'usersTab',\n\t\t\ttabs: [\n\t\t\t\t{ name: 'usersTab', component: 'UsersTab', id: 'users-tab' },\n\t\t\t\t{ name: 'chatsTab', component: 'ChatsTab', id: 'chats-tab' },\n\t\t\t],\n\t\t\tisDescriptionOverflowed: false,\n\t\t\tisDescriptionExpanded: false,\n\t\t};\n\t},\n\n\tcomputed: {\n\t\t...mapState(useChartStore, ['focusedNode', 'departments']),\n\t\tactiveTabComponent(): UsersTab | ChatsTab | null\n\t\t{\n\t\t\tconst activeTab = this.tabs.find((tab) => tab.name === this.activeTab);\n\n\t\t\treturn activeTab ? activeTab.component : null;\n\t\t},\n\t\tusersCount(): Number\n\t\t{\n\t\t\treturn this.departments.get(this.focusedNode)?.userCount ?? 0;\n\t\t},\n\t\tchatAndChannelsCount(): Number\n\t\t{\n\t\t\treturn this.departments.get(this.focusedNode)?.chatAndChannelsCount ?? null;\n\t\t},\n\t\ttabArray(): Array\n\t\t{\n\t\t\treturn this.tabs.map((tab) => {\n\t\t\t\tif (tab.name === 'usersTab')\n\t\t\t\t{\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...tab,\n\t\t\t\t\t\tcount: this.usersCount,\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tif (tab.name === 'chatsTab')\n\t\t\t\t{\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...tab,\n\t\t\t\t\t\tcount: this.chatAndChannelsCount,\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\treturn tab;\n\t\t\t});\n\t\t},\n\t\tdescription(): ?string\n\t\t{\n\t\t\tconst department = this.departments.get(this.focusedNode);\n\t\t\tif (!department.description)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn department.description;\n\t\t},\n\t},\n\n\twatch: {\n\t\tdescription(): void\n\t\t{\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.isDescriptionOverflowed = this.checkDescriptionOverflowed();\n\t\t\t});\n\t\t},\n\t\tfocusedNode(): void\n\t\t{\n\t\t\tthis.isDescriptionExpanded = false;\n\t\t\tthis.selectTab('usersTab');\n\t\t},\n\t\tisCollapsed(): void\n\t\t{\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.isDescriptionOverflowed = this.checkDescriptionOverflowed();\n\t\t\t});\n\t\t},\n\t},\n\n\tmethods:\n\t{\n\t\tloc(phraseCode: string, replacements: {[p: string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tselectTab(tabName): void\n\t\t{\n\t\t\tthis.activeTab = tabName;\n\t\t},\n\t\tgetTabLabel(name: string): string\n\t\t{\n\t\t\tif (name === 'usersTab')\n\t\t\t{\n\t\t\t\treturn this.departments.get(this.focusedNode)?.entityType === EntityTypes.team\n\t\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_TEAM_USERS_TITLE')\n\t\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_TITLE');\n\t\t\t}\n\n\t\t\tif (name === 'chatsTab')\n\t\t\t{\n\t\t\t\treturn this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_TITLE');\n\t\t\t}\n\n\t\t\treturn '';\n\t\t},\n\t\ttoggleDescriptionExpand(): void\n\t\t{\n\t\t\tthis.isDescriptionExpanded = !this.isDescriptionExpanded;\n\t\t},\n\t\tcheckDescriptionOverflowed(): boolean\n\t\t{\n\t\t\tconst descriptionContainer = this.$refs.descriptionContainer ?? null;\n\t\t\tif (descriptionContainer)\n\t\t\t{\n\t\t\t\treturn descriptionContainer.scrollHeight > descriptionContainer.clientHeight;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\thideDetailLoader(): void\n\t\t{\n\t\t\tthis.$emit('hideDetailLoader');\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.isDescriptionOverflowed = this.checkDescriptionOverflowed();\n\t\t\t});\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"hr-department-detail-content hr-department-detail-content__scope\">\n\t\t\t<div\n\t\t\t\tref=\"descriptionContainer\"\n\t\t\t\tv-show=\"description\"\n\t\t\t\t:class=\"[\n\t\t\t\t\t'hr-department-detail-content-description',\n\t\t\t\t\t{ '--expanded': isDescriptionExpanded },\n\t\t\t\t\t{ '--overflowed': isDescriptionOverflowed},\n\t\t\t\t]\"\n\t\t\t\tv-on=\"isDescriptionOverflowed ? { click: toggleDescriptionExpand } : {}\"\n\t\t\t>\n\t\t\t\t{{ description }}\n\t\t\t</div>\n\t\t\t<div class=\"hr-department-detail-content__tab-list\">\n\t\t\t\t<button\n\t\t\t\t\tv-for=\"tab in tabArray\"\n\t\t\t\t\t:key=\"tab.name\"\n\t\t\t\t\tclass=\"hr-department-detail-content__tab-item\"\n\t\t\t\t\t:class=\"[{'--active-tab' : activeTab === tab.name}]\"\n\t\t\t\t\t@click=\"selectTab(tab.name)\"\n\t\t\t\t\t:data-id=\"tab.id ? 'hr-department-detail-content__' + tab.id + '_button' : null\"\n\t\t\t\t>\n\t\t\t\t\t{{ this.getTabLabel(tab.name) }}\n\t\t\t\t\t<span\n\t\t\t\t\t\tclass=\"hr-department-detail-content__tab-count\"\n\t\t\t\t\t\t:data-id=\"tab.id ? 'hr-department-detail-content__' + tab.id + '_counter' : null\"\n\t\t\t\t\t>{{ tab.count }}\n\t\t\t\t\t</span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<component\n\t\t\t\tv-if=\"activeTab === 'usersTab'\"\n\t\t\t\t:is=\"activeTabComponent\"\n\t\t\t\t@showDetailLoader=\"$emit('showDetailLoader')\"\n\t\t\t\t@hideDetailLoader=\"hideDetailLoader\"\n\t\t\t/>\n\t\t\t<component\n\t\t\t\tv-if=\"activeTab === 'chatsTab'\"\n\t\t\t\t:is=\"activeTabComponent\"\n\t\t\t\t@showDetailLoader=\"$emit('showDetailLoader')\"\n\t\t\t\t@hideDetailLoader=\"hideDetailLoader\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n"],"names":["HeadListDataTestIds","Object","freeze","containerDataTestId","listActionButtonDataTestId","listActonMenuDataTestId","listCounterDataTestId","EmployeeListDataTestIds","EmptyTabAddButton","name","components","RouteActionMenu","props","departmentId","type","Number","required","entityType","String","default","EntityTypes","department","data","menuVisible","computed","menu","EmptyUsersTabActionMenu","AnalyticsSourceType","DETAIL","mapState","useChartStore","methods","loc","phraseCode","replacements","$Bitrix","Loc","getMessage","onClick","team","items","length","onActionMenuItemClick","id","actionId","template","DepartmentAPI","getPagedEmployees","page","countPerPage","getData","nodeId","removeUserFromDepartment","userId","postData","moveUserToDepartment","targetNodeId","isUserInMultipleDepartments","getUserInfo","fireUser","findMemberByQuery","query","getChatsAndChannels","saveChats","ids","DepartmentContentActions","targetDepartmentId","role","store","departments","get","targetDepartment","oldMemberRoles","getMemberRoles","targetMemberRoles","user","employee","employees","find","heads","head","userCount","filter","changeCurrentDepartment","push","updateEmployees","set","updateEmployeeListOptions","options","employeeListOptions","setChatsAndChannels","chats","channels","chatAndChannelsCount","removeUserFromAllDepartments","departmentsToUpdate","key","Type","isArray","some","refreshDepartments","MoveUserActionPopup","ConfirmationPopup","emits","parentId","created","permissionChecker","PermissionChecker","getInstance","action","isTeamEntity","PermissionActions","teamAddMember","employeeAddToDepartment","selectedDepartmentId","showMoveUserActionLoader","lockMoveUserActionButton","showUserAlreadyBelongsToDepartmentPopup","accessDenied","mounted","departmentContainer","$refs","departmentSelector","createTagSelector","renderTo","includedNodeEntityTypesInDialog","getMoveUserActionPhrase","departmentName","Text","encode","focusedNode","userName","gender","replace","url","getUserAlreadyBelongsToDepartmentPopupPhrase","selectedParentDepartment","phrase","memberRoles","confirmTitle","confirmDescription","TagSelector","events","onTagAdd","event","tag","hasPermission","onTagRemove","multiple","dialogOptions","width","height","dropdownMode","hideOnDeselect","entities","selectMode","restricted","includedNodeEntityTypes","useMultipleTabs","preselectedItems","confirmMoveUser","error","code","UI","Notification","Center","notify","content","autoHideDelay","$emit","closeAction","closeUserAlreadyBelongsToDepartmentPopup","UserListItemActionButton","showRemoveUserConfirmationPopup","showRemoveUserConfirmationActionLoader","showMoveUserPopup","showFireUserPopup","fireUserLoad","toggleMenu","MenuActions","moveUserToAnotherDepartment","fireUserFromCompany","removeUser","rootDepartment","values","cancelRemoveUser","isInvited","cancelFireUser","handleMoveUserAction","handleMoveUserClose","getMemberKeyByValue","value","keys","UserListActionMenu","getFirePopupDescription","userUrl","genderSuffix","description","getFirePopupTitle","getFirePopupButtonText","getRemovePopupTitle","getRemovePopupDescription","UserListItem","selectedUserId","defaultAvatar","handleUserClick","item","BX","SidePanel","Instance","open","cacheable","EmptyState","title","imageClass","list","Array","EmptyListItem","withAddPermission","Boolean","ListActionButton","menuItems","dataTestIds","itemId","TabList","count","listItems","emptyItemTitle","emptyItemImageClass","hideEmptyItem","needToShowCount","isNumber","SearchInput","placeholder","dataTestId","hasFocus","handleInput","target","handleBlur","clearInput","UsersTab","searchQuery","needToScroll","headCount","formattedHeads","map","subtitle","workPosition","badgeText","getBadgeText","sort","a","b","roleOrder","deputyHead","roleA","roleB","filteredHeads","toLowerCase","includes","employeeCount","memberCount","formattedEmployees","reverse","filteredEmployees","mapWritableState","showSearchBar","showSearchEmptyState","canAddUsers","permission","headListEmptyStateTitle","employeesListEmptyStateTitle","shouldUpdateList","departmentUsersStatus","loaded","headMenu","UsersTabActionMenu","employeeMenu","isEmployeeListOptionsSet","employeeTitle","emptyStateTitle","emptyStateDescription","watch","newId","isListUpdated","loadEmployeesAction","isDescriptionExpanded","searchedUserId","needToFocusUserId","$nextTick","scrollToUser","handler","immediate","newQuery","searchMembers","usersStatus","prevUsersStatus","prevDepartmentId","prevLoaded","clearSearchTimeout","tabContainer","updateList","employeesList","scrollPosition","scrollTop","clientHeight","scrollHeight","loadedEmployees","employeeIds","Set","newEmployees","has","unshift","selectors","element","querySelector","scrollIntoView","behavior","block","setTimeout","clearTimeout","findQueryResult","success","failure","nodeResults","failedQuery","startsWith","founded","newMembers","found","searchUser","onHeadListActionMenuItemClick","onEmployeeListActionMenuItemClick","getHeadListDataTestIds","getEmployeeListDataTestIds","ChatsMenuOption","addChat","linkChat","addChannel","linkChannel","ChatsMenuLinkChat","bIcon","Main","CHAT_MESSAGE","size","colorTokenName","ChatsMenuAddChat","ADD_CHAT","ChatsMenuLinkChannel","SPEAKER_MOUTHPIECE","ChatsMenuAddChannel","SPEAKER_MOUTHPIECE_PLUS","ChatListDataTestIds","ChannelListDataTestIds","ChatLinkDialogDataTestIds","confirmButtonDataTestId","cancelButtonDataTestId","closeButtonDataTestId","ChannelLinkDialogDataTestIds","EmptyTabAddButtons","chatMenuVisible","channelMenuVisible","chatButtonId","channelButtonId","onChatButtonClick","onChannelButtonClick","ChatListItem","chat","avatar","prepareAvatar","color","getColorCode","avatarOptions","baseColor","isExtranet","click","onChatItemClick","userpicPath","isChat","AvatarRound","AvatarSquare","Messenger","openChat","dialogId","ChatsTab","ManagementDialog","chatMenuItems","channelMenuItems","isChatLinkActive","chatLinkDialogVisible","isChannelLinkActive","channelLinkDialogVisible","isLoading","loadChatAction","getChatListMenuItems","getChannelListMenuItems","searchChatOrChannel","force","loadedChatsAndChannels","getAddEmptyStateList","stateArray","text","getChatListDataTestIds","getChannelListDataTestIds","getChatLinkDialogEntities","entity","getChatDialogEntity","excludeIds","getChannelLinkDialogEntities","getChannelDialogEntity","getChatLinkRecentTabOptions","getChatRecentTabOptions","teamEntity","ChatTypeDict","getChannelLinkRecentTabOptions","channel","linkChats","chatsItems","chatItem","getChatLinkDialogDataTestIds","getChannelLinkDialogDataTestIds","filteredChats","filteredChannels","showAddEmptyState","getLinkedChatIds","getLinkedChannelIds","channelItem","isChatsLoaded","getAddEmptyStateTitle","getAddChatDescription","getAddChannelDescription","DepartmentContent","isCollapsed","activeTab","tabs","component","isDescriptionOverflowed","activeTabComponent","tab","usersCount","tabArray","checkDescriptionOverflowed","selectTab","tabName","getTabLabel","toggleDescriptionExpand","descriptionContainer","hideDetailLoader"],"mappings":"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"}