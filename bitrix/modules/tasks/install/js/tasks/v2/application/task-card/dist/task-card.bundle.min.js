this.BX=this.BX||{};this.BX.Tasks=this.BX.Tasks||{};this.BX.Tasks.V2=this.BX.Tasks.V2||{};(function(e,s,a,l,t){"use strict";let i=e=>e,r;var o=babelHelpers.classPrivateFieldLooseKey("layout");class d{constructor(){Object.defineProperty(this,o,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,o)[o]={}}renderCompactCardSkeleton(){babelHelpers.classPrivateFieldLooseBase(this,o)[o].compactCardSkeleton=l.Tag.render(r||(r=i`
			<div class="tasks-task-compact-card-skeleton">
				<div class="tasks-task-compact-card-skeleton-fields">
					<div class="tasks-task-compact-card-skeleton-fields-title">
						${0}
						<div class="tasks-task-card-skeleton-group --icons">
							${0}
							${0}
						</div>
					</div>
					<div class="tasks-task-compact-card-skeleton-fields-description">
						${0}
					</div>
					<div class="tasks-task-compact-card-skeleton-fields-list">
						<div class="tasks-task-compact-card-skeleton-fields-list-row">
							<div class="tasks-task-card-skeleton-group">
								${0}
							</div>
							<div class="tasks-task-card-skeleton-group">
								${0}
								${0}
							</div>
						</div>
						<div class="tasks-task-compact-card-skeleton-fields-list-row">
							<div class="tasks-task-card-skeleton-group">
								${0}
							</div>
							<div class="tasks-task-card-skeleton-group">
								${0}
								${0}
							</div>
						</div>
					</div>
				</div>
				<div class="tasks-task-compact-card-skeleton-chips">
					${0}
				</div>
				<div class="tasks-task-compact-card-skeleton-footer">
					<div class="tasks-task-card-skeleton-group">
						${0}
						${0}
					</div>
					<div style="margin-right: 6px;">
						${0}
					</div>
				</div>
			</div>
		`),new t.Line({width:240,height:18,borderRadius:60}).render(),new t.Circle({size:18}).render(),new t.Circle({size:18}).render(),new t.Line({width:80,height:12,borderRadius:60}).render(),new t.Line({width:100,height:12,borderRadius:60}).render(),new t.Circle({size:22}).render(),new t.Line({width:130,height:12,borderRadius:60}).render(),new t.Line({width:100,height:12,borderRadius:60}).render(),new t.Circle({size:22}).render(),new t.Line({width:130,height:12,borderRadius:60}).render(),new t.Line({height:34,borderRadius:8}).render(),new t.Line({width:84,height:34,borderRadius:8}).render(),new t.Line({width:84,height:34,borderRadius:8}).render(),new t.Line({width:97,height:12,borderRadius:60}).render());return babelHelpers.classPrivateFieldLooseBase(this,o)[o].compactCardSkeleton}removeCompactCardSkeleton(){l.Dom.remove(babelHelpers.classPrivateFieldLooseBase(this,o)[o].compactCardSkeleton)}}let c=e=>e,n,b;var p=babelHelpers.classPrivateFieldLooseKey("params");var v=babelHelpers.classPrivateFieldLooseKey("compactCardPopup");var u=babelHelpers.classPrivateFieldLooseKey("layout");var h=babelHelpers.classPrivateFieldLooseKey("taskCardSkeleton");var P=babelHelpers.classPrivateFieldLooseKey("taskCompactCard");var H=babelHelpers.classPrivateFieldLooseKey("subscribe");var L=babelHelpers.classPrivateFieldLooseKey("unsubscribe");var F=babelHelpers.classPrivateFieldLooseKey("renderPopupContent");var k=babelHelpers.classPrivateFieldLooseKey("renderDragHandle");var B=babelHelpers.classPrivateFieldLooseKey("handlePopupShow");var C=babelHelpers.classPrivateFieldLooseKey("closeCompactCard");var y=babelHelpers.classPrivateFieldLooseKey("openFullCard");var w=babelHelpers.classPrivateFieldLooseKey("adjustPosition");var f=babelHelpers.classPrivateFieldLooseKey("showOverlay");var m=babelHelpers.classPrivateFieldLooseKey("hideOverlay");class g{constructor(e={}){Object.defineProperty(this,k,{value:$});Object.defineProperty(this,F,{value:T});Object.defineProperty(this,L,{value:j});Object.defineProperty(this,H,{value:O});Object.defineProperty(this,p,{writable:true,value:void 0});Object.defineProperty(this,v,{writable:true,value:null});Object.defineProperty(this,u,{writable:true,value:void 0});Object.defineProperty(this,h,{writable:true,value:void 0});Object.defineProperty(this,P,{writable:true,value:null});Object.defineProperty(this,B,{writable:true,value:e=>{var s,a;(a=(s=babelHelpers.classPrivateFieldLooseBase(this,B)[B]).openedPopupsCount)!=null?a:s.openedPopupsCount=0;const t=e.getCompatData()[0];const i=()=>{t.unsubscribe("onClose",i);t.unsubscribe("onDestroy",i);babelHelpers.classPrivateFieldLooseBase(this,B)[B].openedPopupsCount--;if(babelHelpers.classPrivateFieldLooseBase(this,B)[B].openedPopupsCount===0){l.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,u)[u].dragHandle,"--disabled")}};t.subscribe("onClose",i);t.subscribe("onDestroy",i);babelHelpers.classPrivateFieldLooseBase(this,B)[B].openedPopupsCount++;l.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,u)[u].dragHandle,"--disabled")}});Object.defineProperty(this,C,{writable:true,value:()=>{babelHelpers.classPrivateFieldLooseBase(this,v)[v].close()}});Object.defineProperty(this,y,{writable:true,value:async e=>{const{TaskFullCard:s}=await l.Runtime.loadExtension("tasks.v2.application.task-full-card");babelHelpers.classPrivateFieldLooseBase(this,p)[p].taskId=e.getData();await new s(babelHelpers.classPrivateFieldLooseBase(this,p)[p]).showCard();babelHelpers.classPrivateFieldLooseBase(this,C)[C]()}});Object.defineProperty(this,w,{writable:true,value:(e=null)=>{var s;const{innerPopup:a,titleFieldHeight:t,animate:i}=(s=e==null?void 0:e.getData())!=null?s:{};if(!a){babelHelpers.classPrivateFieldLooseBase(this,v)[v].setOffset({offsetTop:0});babelHelpers.classPrivateFieldLooseBase(this,v)[v].adjustPosition({forceBindPosition:true});return}const r=a.getPopupContainer();const o=r.offsetHeight-babelHelpers.classPrivateFieldLooseBase(this,u)[u].popupContainer.offsetHeight;const d=20;const c=t+o/2+d*2;l.Dom.style(babelHelpers.classPrivateFieldLooseBase(this,u)[u].popupContainer,"--overlay-offset-top",`-${c}px`);if(!i){babelHelpers.classPrivateFieldLooseBase(this,v)[v].adjustPosition({forceBindPosition:true});l.Dom.style(babelHelpers.classPrivateFieldLooseBase(this,u)[u].popupContainer,"transition","none");setTimeout((()=>l.Dom.style(babelHelpers.classPrivateFieldLooseBase(this,u)[u].popupContainer,"transition",null)))}}});Object.defineProperty(this,f,{writable:true,value:()=>{babelHelpers.classPrivateFieldLooseBase(this,v)[v].adjustPosition({forceBindPosition:true});l.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,v)[v].getPopupContainer(),"--overlay")}});Object.defineProperty(this,m,{writable:true,value:()=>{l.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,v)[v].getPopupContainer(),"--overlay")}});babelHelpers.classPrivateFieldLooseBase(this,p)[p]=e;babelHelpers.classPrivateFieldLooseBase(this,u)[u]={};babelHelpers.classPrivateFieldLooseBase(this,p)[p].taskId=l.Type.isUndefined(babelHelpers.classPrivateFieldLooseBase(this,p)[p].taskId)?0:babelHelpers.classPrivateFieldLooseBase(this,p)[p].taskId;babelHelpers.classPrivateFieldLooseBase(this,h)[h]=new d}static async init(e={}){const{taskId:s=null,groupId:a=null,deadlineTs:t=null,analytics:i={}}=e;const r=s?"TaskFullCard":"TaskCompactCard";const o={TaskFullCard:"tasks.v2.application.task-full-card",TaskCompactCard:"tasks.v2.application.task-compact-card"};const d=await l.Runtime.loadExtension(["tasks.v2.core",o[r]]);return new d[r]({taskId:s,groupId:a,deadlineTs:t,analytics:i})}showCompactCard(){const e=`tasks-compact-card-${babelHelpers.classPrivateFieldLooseBase(this,p)[p].taskId}`;if(a.PopupManager.getPopupById(e)){return}babelHelpers.classPrivateFieldLooseBase(this,v)[v]=new a.Popup({id:e,cacheable:false,width:580,borderRadius:"16px",angle:false,content:babelHelpers.classPrivateFieldLooseBase(this,F)[F](),closeByEsc:false,autoHide:false,closeIcon:false,noAllPaddings:true,contentBorderRadius:"8px",className:"tasks-compact-card-popup",events:{onPopupAfterClose:async e=>{await babelHelpers.classPrivateFieldLooseBase(this,P)[P].unmountCard();babelHelpers.classPrivateFieldLooseBase(this,L)[L](babelHelpers.classPrivateFieldLooseBase(this,P)[P]);e.destroy()},onAfterPopupShow:async e=>{babelHelpers.classPrivateFieldLooseBase(this,u)[u].popupContainer=e.getPopupContainer();babelHelpers.classPrivateFieldLooseBase(this,P)[P]=await g.init(babelHelpers.classPrivateFieldLooseBase(this,p)[p]);babelHelpers.classPrivateFieldLooseBase(this,h)[h].removeCompactCardSkeleton();await babelHelpers.classPrivateFieldLooseBase(this,P)[P].mountCard(babelHelpers.classPrivateFieldLooseBase(this,u)[u].cardContainer);l.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,k)[k](),babelHelpers.classPrivateFieldLooseBase(this,u)[u].cardContainer);babelHelpers.classPrivateFieldLooseBase(this,H)[H](babelHelpers.classPrivateFieldLooseBase(this,P)[P])}},overlay:true,draggable:{element:babelHelpers.classPrivateFieldLooseBase(this,k)[k](),restrict:true}});babelHelpers.classPrivateFieldLooseBase(this,v)[v].show()}}function O(e){s.EventEmitter.subscribe("BX.Main.Popup:onShow",babelHelpers.classPrivateFieldLooseBase(this,B)[B]);e.subscribe("closeCard",babelHelpers.classPrivateFieldLooseBase(this,C)[C]);e.subscribe("openFullCard",babelHelpers.classPrivateFieldLooseBase(this,y)[y]);e.subscribe("adjustPosition",babelHelpers.classPrivateFieldLooseBase(this,w)[w]);e.subscribe("showOverlay",babelHelpers.classPrivateFieldLooseBase(this,f)[f]);e.subscribe("hideOverlay",babelHelpers.classPrivateFieldLooseBase(this,m)[m])}function j(e){s.EventEmitter.unsubscribe("BX.Main.Popup:onShow",babelHelpers.classPrivateFieldLooseBase(this,B)[B]);e.unsubscribe("closeCard",babelHelpers.classPrivateFieldLooseBase(this,C)[C]);e.unsubscribe("openFullCard",babelHelpers.classPrivateFieldLooseBase(this,y)[y]);e.unsubscribe("adjustPosition",babelHelpers.classPrivateFieldLooseBase(this,w)[w]);e.unsubscribe("showOverlay",babelHelpers.classPrivateFieldLooseBase(this,f)[f]);e.unsubscribe("hideOverlay",babelHelpers.classPrivateFieldLooseBase(this,m)[m])}function T(){babelHelpers.classPrivateFieldLooseBase(this,u)[u].cardContainer=l.Tag.render(n||(n=c`
			<div class="tasks-task-compact-card-popup-content">
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,h)[h].renderCompactCardSkeleton());return babelHelpers.classPrivateFieldLooseBase(this,u)[u].cardContainer}function $(){var e,s;(s=(e=babelHelpers.classPrivateFieldLooseBase(this,u)[u]).dragHandle)!=null?s:e.dragHandle=l.Tag.render(b||(b=c`
			<div class="tasks-compact-card-popup-drag-handle"></div>
		`));return babelHelpers.classPrivateFieldLooseBase(this,u)[u].dragHandle}e.TaskCard=g})(this.BX.Tasks.V2.Application=this.BX.Tasks.V2.Application||{},BX.Event,BX.Main,BX,BX.UI.System);
//# sourceMappingURL=task-card.bundle.map.js