this.BX=this.BX||{};this.BX.Tasks=this.BX.Tasks||{};(function(e,s,a,l,t,i){"use strict";let r=e=>e,o,b;var n=babelHelpers.classPrivateFieldLooseKey("id");var p=babelHelpers.classPrivateFieldLooseKey("name");var d=babelHelpers.classPrivateFieldLooseKey("avatar");var c=babelHelpers.classPrivateFieldLooseKey("workPosition");var v=babelHelpers.classPrivateFieldLooseKey("pathToProfile");var u=babelHelpers.classPrivateFieldLooseKey("renderAvatar");class P{constructor(e){Object.defineProperty(this,u,{value:h});Object.defineProperty(this,n,{writable:true,value:void 0});Object.defineProperty(this,p,{writable:true,value:void 0});Object.defineProperty(this,d,{writable:true,value:void 0});Object.defineProperty(this,c,{writable:true,value:void 0});Object.defineProperty(this,v,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,n)[n]=parseInt(e.id,10);babelHelpers.classPrivateFieldLooseBase(this,p)[p]=e.name;babelHelpers.classPrivateFieldLooseBase(this,d)[d]=e.avatar;babelHelpers.classPrivateFieldLooseBase(this,c)[c]=e.workPosition;babelHelpers.classPrivateFieldLooseBase(this,v)[v]=e.pathToProfile}render(){return i.Tag.render(o||(o=r`
			<div class="tasks-flow__task-queue-member" data-id="tasks-flow-task-queue-member-${0}">
				${0}
			</div>
		`),this.getId(),babelHelpers.classPrivateFieldLooseBase(this,u)[u]())}getId(){return babelHelpers.classPrivateFieldLooseBase(this,n)[n]}getName(){return babelHelpers.classPrivateFieldLooseBase(this,p)[p]}getAvatar(){return babelHelpers.classPrivateFieldLooseBase(this,d)[d]}getPathToProfile(){return babelHelpers.classPrivateFieldLooseBase(this,v)[v]}}function h(){let e="<i></i>";if(this.getAvatar()){e=`<i style="background-image: url('${encodeURI(this.getAvatar())}')"></i>`}return i.Tag.render(b||(b=r`
			<a 
				href="${0}"
				class="tasks-flow__task-queue-member_avatar ui-icon ui-icon-common-user"
			>
				${0}
			</a>
		`),i.Text.encode(this.getPathToProfile()),e)}let L=e=>e,F,H,B;var f=babelHelpers.classPrivateFieldLooseKey("serial");var y=babelHelpers.classPrivateFieldLooseKey("title");var _=babelHelpers.classPrivateFieldLooseKey("url");var w=babelHelpers.classPrivateFieldLooseKey("createdBy");var k=babelHelpers.classPrivateFieldLooseKey("creator");var T=babelHelpers.classPrivateFieldLooseKey("responsibleId");var O=babelHelpers.classPrivateFieldLooseKey("responsible");var g=babelHelpers.classPrivateFieldLooseKey("timeInStatus");var K=babelHelpers.classPrivateFieldLooseKey("canRead");var j=babelHelpers.classPrivateFieldLooseKey("getTitleElement");var m=babelHelpers.classPrivateFieldLooseKey("getSerialElement");var I=babelHelpers.classPrivateFieldLooseKey("getTitleClass");var $=babelHelpers.classPrivateFieldLooseKey("openTask");var C=babelHelpers.classPrivateFieldLooseKey("getSerial");class E{constructor(e){Object.defineProperty(this,C,{value:D});Object.defineProperty(this,$,{value:U});Object.defineProperty(this,I,{value:A});Object.defineProperty(this,m,{value:q});Object.defineProperty(this,j,{value:S});Object.defineProperty(this,f,{writable:true,value:void 0});Object.defineProperty(this,y,{writable:true,value:void 0});Object.defineProperty(this,_,{writable:true,value:void 0});Object.defineProperty(this,w,{writable:true,value:void 0});Object.defineProperty(this,k,{writable:true,value:void 0});Object.defineProperty(this,T,{writable:true,value:void 0});Object.defineProperty(this,O,{writable:true,value:void 0});Object.defineProperty(this,g,{writable:true,value:void 0});Object.defineProperty(this,K,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,f)[f]=parseInt(e.serial,10);babelHelpers.classPrivateFieldLooseBase(this,w)[w]=parseInt(e.createdBy,10);babelHelpers.classPrivateFieldLooseBase(this,k)[k]=new P(e.creator);babelHelpers.classPrivateFieldLooseBase(this,T)[T]=parseInt(e.responsibleId,10);babelHelpers.classPrivateFieldLooseBase(this,O)[O]=new P(e.responsible);babelHelpers.classPrivateFieldLooseBase(this,g)[g]=e.timeInStatus.formatted;babelHelpers.classPrivateFieldLooseBase(this,y)[y]=e.title;babelHelpers.classPrivateFieldLooseBase(this,_)[_]=e.url;babelHelpers.classPrivateFieldLooseBase(this,K)[K]=Boolean(e.canRead)}render(){return i.Tag.render(F||(F=L`
			<div class="tasks-flow__task-queue-line-container">
				<div class="tasks-flow__task-queue-line">
					${0}
					${0}
					<div class="tasks-flow__task-queue-line_time" title="${0}">${0}</div>
				</div>
				
				<div class="tasks-flow__task-queue-line-avatars">
					<div class="tasks-flow__task-queue-line_avatar">${0}</div>
					<div class="ui-icon-set --chevron-right" style="--ui-icon-set__icon-size: 14px; color: #A8ADB4"></div>
					<div class="tasks-flow__task-queue-line_avatar">${0}</div>
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,m)[m](),babelHelpers.classPrivateFieldLooseBase(this,j)[j](),babelHelpers.classPrivateFieldLooseBase(this,g)[g],babelHelpers.classPrivateFieldLooseBase(this,g)[g],babelHelpers.classPrivateFieldLooseBase(this,k)[k].render(),babelHelpers.classPrivateFieldLooseBase(this,O)[O].render())}}function S(){return i.Tag.render(H||(H=L`
			<div class="${0}" onclick="${0}">${0}</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,I)[I](),babelHelpers.classPrivateFieldLooseBase(this,$)[$].bind(this),i.Text.encode(babelHelpers.classPrivateFieldLooseBase(this,y)[y]))}function q(){return i.Tag.render(B||(B=L`
			<div class="tasks-flow__task-queue-line_number">${0}</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,C)[C]())}function A(){return babelHelpers.classPrivateFieldLooseBase(this,K)[K]?"tasks-flow__task-queue-line_title-access":"tasks-flow__task-queue-line_title"}function U(){if(!babelHelpers.classPrivateFieldLooseBase(this,K)[K]){return}t.SidePanel.Instance.open(babelHelpers.classPrivateFieldLooseBase(this,_)[_])}function D(){if(babelHelpers.classPrivateFieldLooseBase(this,f)[f]<10){return`0${babelHelpers.classPrivateFieldLooseBase(this,f)[f]}`}return babelHelpers.classPrivateFieldLooseBase(this,f)[f]}let M=e=>e,X,x,N,W;var Q=babelHelpers.classPrivateFieldLooseKey("params");var R=babelHelpers.classPrivateFieldLooseKey("flowId");var z=babelHelpers.classPrivateFieldLooseKey("type");var G=babelHelpers.classPrivateFieldLooseKey("pageSize");var Y=babelHelpers.classPrivateFieldLooseKey("pageNum");var J=babelHelpers.classPrivateFieldLooseKey("pending");var V=babelHelpers.classPrivateFieldLooseKey("pages");var Z=babelHelpers.classPrivateFieldLooseKey("totalTaskCount");var ee=babelHelpers.classPrivateFieldLooseKey("popup");var se=babelHelpers.classPrivateFieldLooseKey("loader");var ae=babelHelpers.classPrivateFieldLooseKey("layout");var le=babelHelpers.classPrivateFieldLooseKey("getList");var te=babelHelpers.classPrivateFieldLooseKey("renderContent");var ie=babelHelpers.classPrivateFieldLooseKey("renderCounterContainer");var re=babelHelpers.classPrivateFieldLooseKey("renderTotalTaskCounter");var oe=babelHelpers.classPrivateFieldLooseKey("renderLines");var be=babelHelpers.classPrivateFieldLooseKey("showLines");var ne=babelHelpers.classPrivateFieldLooseKey("appendLines");var pe=babelHelpers.classPrivateFieldLooseKey("setTotalTaskCount");var de=babelHelpers.classPrivateFieldLooseKey("showLoader");var ce=babelHelpers.classPrivateFieldLooseKey("destroyLoader");var ve=babelHelpers.classPrivateFieldLooseKey("consoleError");class ue{constructor(e){Object.defineProperty(this,ve,{value:ke});Object.defineProperty(this,ce,{value:we});Object.defineProperty(this,de,{value:_e});Object.defineProperty(this,pe,{value:ye});Object.defineProperty(this,ne,{value:fe});Object.defineProperty(this,be,{value:Be});Object.defineProperty(this,oe,{value:He});Object.defineProperty(this,re,{value:Fe});Object.defineProperty(this,ie,{value:Le});Object.defineProperty(this,te,{value:he});Object.defineProperty(this,le,{value:Pe});Object.defineProperty(this,Q,{writable:true,value:void 0});Object.defineProperty(this,R,{writable:true,value:void 0});Object.defineProperty(this,z,{writable:true,value:void 0});Object.defineProperty(this,G,{writable:true,value:10});Object.defineProperty(this,Y,{writable:true,value:1});Object.defineProperty(this,J,{writable:true,value:false});Object.defineProperty(this,V,{writable:true,value:void 0});Object.defineProperty(this,Z,{writable:true,value:void 0});Object.defineProperty(this,ee,{writable:true,value:void 0});Object.defineProperty(this,se,{writable:true,value:void 0});Object.defineProperty(this,ae,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]=e;babelHelpers.classPrivateFieldLooseBase(this,R)[R]=parseInt(e.flowId,10);if(!(e.type in ue.TYPES)){throw new Error("The specified queue type is incorrect")}babelHelpers.classPrivateFieldLooseBase(this,z)[z]=e.type;babelHelpers.classPrivateFieldLooseBase(this,V)[V]={};babelHelpers.classPrivateFieldLooseBase(this,ae)[ae]={}}static showInstance(e){new this(e).show(e.bindElement)}show(e){babelHelpers.classPrivateFieldLooseBase(this,ee)[ee]=this.getPopup();babelHelpers.classPrivateFieldLooseBase(this,ee)[ee].setContent(babelHelpers.classPrivateFieldLooseBase(this,te)[te]());babelHelpers.classPrivateFieldLooseBase(this,ee)[ee].setBindElement(e);babelHelpers.classPrivateFieldLooseBase(this,ee)[ee].show()}getPopup(){const e=babelHelpers.classPrivateFieldLooseBase(this,Q)[Q].flowId+babelHelpers.classPrivateFieldLooseBase(this,Q)[Q].type;const s=`tasks-flow-task-queue-popup-${e}`;if(a.PopupManager.getPopupById(s)){return a.PopupManager.getPopupById(s)}const t=new a.Popup({id:s,className:"tasks-flow__task-queue-popup",padding:2,autoHide:true,closeByEsc:true,events:{onFirstShow:()=>{babelHelpers.classPrivateFieldLooseBase(this,be)[be]()},onClose:()=>{t.destroy()}}});new l.SidePanelIntegration(t);return t}}function Pe(e){babelHelpers.classPrivateFieldLooseBase(this,J)[J]=true;const s={PENDING:"Pending",AT_WORK:"Progress",COMPLETED:"Completed"};return new Promise((a=>{i.ajax.runAction(`tasks.flow.Task.${s[babelHelpers.classPrivateFieldLooseBase(this,z)[z]]}.list`,{data:{flowData:{id:babelHelpers.classPrivateFieldLooseBase(this,R)[R]},ago:{days:30}},navigation:{page:e,size:babelHelpers.classPrivateFieldLooseBase(this,G)[G]}}).then((e=>{babelHelpers.classPrivateFieldLooseBase(this,J)[J]=false;if(e.data.tasks.length>=babelHelpers.classPrivateFieldLooseBase(this,G)[G]){babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]++}a({lines:e.data.tasks,totalTaskCount:e.data.totalCount})})).catch((e=>{babelHelpers.classPrivateFieldLooseBase(this,ve)[ve]("getList",e)}))}))}function he(){const{popupContainer:e,popupContent:s}=i.Tag.render(X||(X=M`
			<div ref="popupContainer" class="tasks-flow__task-queue-popup_container">
				<div ref="listContainer" class="tasks-flow__task-queue-popup_content">
					<div class="tasks-flow__task-queue-popup_content-box">
						<span class="tasks-flow__task-queue-popup_label">
							<span class="tasks-flow__task-queue-popup_label-text" title="${0}">
								${0}
							</span>
						</span>
						<div class="tasks-flow__task-queue-popup_status-counter-box">
							<span class="tasks-flow__task-queue-popup_status" title="${0}">
								${0}
							</span>
							${0}
						</div>
							<div class="tasks-flow__task-queue-popup_delimiter"></div>
						${0}
					</div>
				</div>
			</div>
		`),i.Loc.getMessage(`TASKS_FLOW_TASK_QUEUE_POPUP_LABEL_${babelHelpers.classPrivateFieldLooseBase(this,z)[z]}`),i.Loc.getMessage(`TASKS_FLOW_TASK_QUEUE_POPUP_LABEL_${babelHelpers.classPrivateFieldLooseBase(this,z)[z]}`),i.Loc.getMessage(`TASKS_FLOW_TASK_QUEUE_POPUP_STATUS_${babelHelpers.classPrivateFieldLooseBase(this,z)[z]}`),i.Loc.getMessage(`TASKS_FLOW_TASK_QUEUE_POPUP_STATUS_${babelHelpers.classPrivateFieldLooseBase(this,z)[z]}`),babelHelpers.classPrivateFieldLooseBase(this,ie)[ie](),babelHelpers.classPrivateFieldLooseBase(this,oe)[oe]());babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].popupContainer=e;babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].popupContent=s;return babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].popupContainer}function Le(){babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].counterContainer=i.Tag.render(x||(x=M`
			<div class="tasks-flow__total-task-counter-container ui-counter">
					${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,re)[re]());i.Dom.style(babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].counterContainer,"display","none");return babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].counterContainer}function Fe(){babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].totalTaskCounter=i.Tag.render(N||(N=M`
			<div class="tasks-flow__total-task-counter ui-counter-inner"></div>
		`));return babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].totalTaskCounter}function He(){babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].popupInner=i.Tag.render(W||(W=M`
			<div class="tasks-flow__task-queue-popup_inner">
				${0}
			</div>
		`),Object.values(babelHelpers.classPrivateFieldLooseBase(this,V)[V]).flat().map((e=>e.render())));i.Event.bind(babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].popupInner,"scroll",(()=>{const e=babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].popupInner.scrollTop;const s=babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].popupInner.scrollHeight-babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].popupInner.offsetHeight;if(Math.abs(e-s)<1&&babelHelpers.classPrivateFieldLooseBase(this,J)[J]===false){babelHelpers.classPrivateFieldLooseBase(this,be)[be]()}}));return babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].popupInner}function Be(){babelHelpers.classPrivateFieldLooseBase(this,de)[de]();babelHelpers.classPrivateFieldLooseBase(this,ne)[ne](babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]).then((()=>{babelHelpers.classPrivateFieldLooseBase(this,ce)[ce]();babelHelpers.classPrivateFieldLooseBase(this,pe)[pe]()}))}function fe(e){if(babelHelpers.classPrivateFieldLooseBase(this,V)[V][e]){return Promise.resolve()}const s=babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].popupInner;return babelHelpers.classPrivateFieldLooseBase(this,le)[le](e).then((({lines:a,totalTaskCount:l})=>{babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]=l;i.Dom.style(babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].counterContainer,"display","inline-flex");babelHelpers.classPrivateFieldLooseBase(this,V)[V][e]=a.map((e=>new E(e)));babelHelpers.classPrivateFieldLooseBase(this,V)[V][e].forEach((e=>i.Dom.append(e.render(),s)))}))}function ye(){if(!i.Type.isNil(babelHelpers.classPrivateFieldLooseBase(this,Z)[Z])){babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].totalTaskCounter.innerText=babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]>99?"99+":babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]}}function _e(){const e=i.Dom.getPosition(babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].popupInner);const a=40;babelHelpers.classPrivateFieldLooseBase(this,se)[se]=new s.Loader({target:babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].popupInner,size:a,mode:"inline",offset:{left:`${e.width/2-a/2}px`}});babelHelpers.classPrivateFieldLooseBase(this,se)[se].show()}function we(){babelHelpers.classPrivateFieldLooseBase(this,se)[se].destroy()}function ke(e,s){console.error(`TaskQueue: ${e} error`,s)}ue.TYPES={PENDING:"PENDING",AT_WORK:"AT_WORK",COMPLETED:"COMPLETED"};e.TaskQueue=ue})(this.BX.Tasks.Flow=this.BX.Tasks.Flow||{},BX,BX.Main,BX.Tasks,BX.SidePanel,BX);
//# sourceMappingURL=task-queue.bundle.map.js