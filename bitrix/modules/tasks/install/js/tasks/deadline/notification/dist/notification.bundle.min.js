this.BX=this.BX||{};this.BX.Tasks=this.BX.Tasks||{};(function(e,s,t,a,i,l,o,r,n,d){"use strict";var c=babelHelpers.classPrivateFieldLooseKey("EVENT_NAMESPACE");var b=babelHelpers.classPrivateFieldLooseKey("calendar");var v=babelHelpers.classPrivateFieldLooseKey("datePicker");var p=babelHelpers.classPrivateFieldLooseKey("input");var u=babelHelpers.classPrivateFieldLooseKey("matchWorkTime");var h=babelHelpers.classPrivateFieldLooseKey("init");var P=babelHelpers.classPrivateFieldLooseKey("getDefaultTime");var L=babelHelpers.classPrivateFieldLooseKey("onSelect");var F=babelHelpers.classPrivateFieldLooseKey("onHide");var f=babelHelpers.classPrivateFieldLooseKey("setInputValue");var B=babelHelpers.classPrivateFieldLooseKey("getDateFormatByDate");class H extends l.EventEmitter{constructor(e){super();Object.defineProperty(this,B,{value:E});Object.defineProperty(this,f,{value:S});Object.defineProperty(this,F,{value:D});Object.defineProperty(this,L,{value:T});Object.defineProperty(this,P,{value:y});Object.defineProperty(this,h,{value:m});Object.defineProperty(this,c,{writable:true,value:"BX.Tasks.Deadline.Notification.Layout.DeadlinePicker"});Object.defineProperty(this,b,{writable:true,value:void 0});Object.defineProperty(this,v,{writable:true,value:void 0});Object.defineProperty(this,p,{writable:true,value:void 0});Object.defineProperty(this,u,{writable:true,value:void 0});this.setEventNamespace(babelHelpers.classPrivateFieldLooseBase(this,c)[c]);this.subscribeFromOptions(e.events);babelHelpers.classPrivateFieldLooseBase(this,h)[h](e)}getSelectedDate(){return babelHelpers.classPrivateFieldLooseBase(this,v)[v].getSelectedDate()}getToday(){return babelHelpers.classPrivateFieldLooseBase(this,v)[v].getToday()}formatDate(e,s){return babelHelpers.classPrivateFieldLooseBase(this,v)[v].formatDate(e,s)}}function m(e){const s=e.calendar;if(s instanceof BX.Tasks.Calendar){babelHelpers.classPrivateFieldLooseBase(this,b)[b]=s}const t=babelHelpers.classPrivateFieldLooseBase(this,P)[P]();const a=e.input;if(a instanceof HTMLInputElement){babelHelpers.classPrivateFieldLooseBase(this,p)[p]=a}const l=e.matchWorkTime;babelHelpers.classPrivateFieldLooseBase(this,u)[u]=n.Type.isBoolean(l)?l:false;const o=e=>`0${e}`.slice(-2);const r={defaultTime:`${o(t.getHours())}:${o(t.getMinutes())}`,targetNode:babelHelpers.classPrivateFieldLooseBase(this,p)[p],enableTime:true,cutZeroTime:false,events:{onSelect:babelHelpers.classPrivateFieldLooseBase(this,L)[L].bind(this),onHide:babelHelpers.classPrivateFieldLooseBase(this,F)[F].bind(this)}};babelHelpers.classPrivateFieldLooseBase(this,v)[v]=new i.DatePicker({...e,...r});n.Event.bind(babelHelpers.classPrivateFieldLooseBase(this,p)[p],"click",babelHelpers.classPrivateFieldLooseBase(this,v)[v].show.bind(babelHelpers.classPrivateFieldLooseBase(this,v)[v]))}function y(){const e=new Date;const s=babelHelpers.classPrivateFieldLooseBase(this,b)[b].getWorkIntervals(e).pop();return new Date(s.endDate.toLocaleString("en-US",{timeZone:"UTC"}))}function T(e){const{date:s}=e.getData();if(!babelHelpers.classPrivateFieldLooseBase(this,u)[u]){babelHelpers.classPrivateFieldLooseBase(this,f)[f](s);this.emit("onSelect");return}const t=babelHelpers.classPrivateFieldLooseBase(this,b)[b].getClosestWorkTime(s,true);if(s.getTime()!==t.getTime()){babelHelpers.classPrivateFieldLooseBase(this,v)[v].selectDate(new Date(t.toLocaleString("en-US",{timeZone:"UTC"})));babelHelpers.classPrivateFieldLooseBase(this,v)[v].hide();this.emit("onMoveDateToWorkTime")}babelHelpers.classPrivateFieldLooseBase(this,f)[f](t);this.emit("onSelect")}function D(){const e=this.getSelectedDate();const s=this.getToday();if(n.Type.isDate(e)&&e<s){this.emit("onLessCurrentDateSelect")}}function S(e){const s=babelHelpers.classPrivateFieldLooseBase(this,B)[B](e);babelHelpers.classPrivateFieldLooseBase(this,p)[p].value=babelHelpers.classPrivateFieldLooseBase(this,v)[v].formatDate(e,s)}function E(e){const s=a.DateTimeFormat.getFormat("SHORT_TIME_FORMAT");const t=new Date;let i=a.DateTimeFormat.getFormat("DAY_OF_WEEK_MONTH_FORMAT");if(n.Type.isDate(e)&&t.getFullYear()!==e.getFullYear()){i=a.DateTimeFormat.getFormat("FULL_DATE_FORMAT")}return`${i}, ${s}`}class g extends o.Popup{constructor(e){const s=`\n\t\t\t<div class="tasks-deadline-notification-form__content_deadline-selector_moved-toolbar">\n\t\t\t\t${n.Loc.getMessage("TASKS_DEADLINE_NOTIFICATION_MOVED_DEADLINE_TOOLTIP")}\n\t\t\t</div>\n\t\t`;const t={id:"deadline-notification-moved-deadline-popup",offsetLeft:30,offsetTop:5,angle:true,autoHide:true,closeByEsc:false,closeIcon:true,content:s};super({...e,...t})}}class O extends o.Popup{constructor(e){const s=`\n\t\t\t<div class="tasks-deadline-notification-form__content_deadline-selector_overdue-toolbar">\n\t\t\t\t${n.Loc.getMessage("TASKS_DEADLINE_NOTIFICATION_OVERDUE_DEADLINE_TOOLTIP")}\n\t\t\t</div>\n\t\t`;const t={id:"deadline-notification-overdue-deadline-popup",offsetLeft:30,offsetTop:5,angle:true,autoHide:true,closeByEsc:false,closeIcon:true,content:s};super({...e,...t})}}let _=e=>e,I,k;const N=7;var K=babelHelpers.classPrivateFieldLooseKey("EVENT_NAMESPACE");var A=babelHelpers.classPrivateFieldLooseKey("calendar");var C=babelHelpers.classPrivateFieldLooseKey("deadlinePicker");var j=babelHelpers.classPrivateFieldLooseKey("input");var w=babelHelpers.classPrivateFieldLooseKey("matchWorkTime");var M=babelHelpers.classPrivateFieldLooseKey("movedDeadlinePopup");var x=babelHelpers.classPrivateFieldLooseKey("overdueDeadlinePopup");var $=babelHelpers.classPrivateFieldLooseKey("init");var X=babelHelpers.classPrivateFieldLooseKey("initMatchWorkTime");var W=babelHelpers.classPrivateFieldLooseKey("initCalendar");var R=babelHelpers.classPrivateFieldLooseKey("initDeadlinePicker");var U=babelHelpers.classPrivateFieldLooseKey("onMoveDateToWorkTime");var V=babelHelpers.classPrivateFieldLooseKey("onLessCurrentDateSelect");var Y=babelHelpers.classPrivateFieldLooseKey("getOverdueDeadlinePopup");var z=babelHelpers.classPrivateFieldLooseKey("getMovedDeadlinePopup");var Z=babelHelpers.classPrivateFieldLooseKey("getPortalSettings");class G extends l.EventEmitter{constructor(e){super();Object.defineProperty(this,Z,{value:le});Object.defineProperty(this,z,{value:ie});Object.defineProperty(this,Y,{value:ae});Object.defineProperty(this,V,{value:te});Object.defineProperty(this,U,{value:se});Object.defineProperty(this,R,{value:ee});Object.defineProperty(this,W,{value:Q});Object.defineProperty(this,X,{value:J});Object.defineProperty(this,$,{value:q});Object.defineProperty(this,K,{writable:true,value:"BX.Tasks.Deadline.Notification.Layout.DeadlineSelector"});Object.defineProperty(this,A,{writable:true,value:void 0});Object.defineProperty(this,C,{writable:true,value:void 0});Object.defineProperty(this,j,{writable:true,value:void 0});Object.defineProperty(this,w,{writable:true,value:void 0});Object.defineProperty(this,M,{writable:true,value:void 0});Object.defineProperty(this,x,{writable:true,value:void 0});this.setEventNamespace(babelHelpers.classPrivateFieldLooseBase(this,K)[K]);this.subscribeFromOptions(e.events);babelHelpers.classPrivateFieldLooseBase(this,$)[$](e)}render(){return n.Tag.render(I||(I=_`
			<div class="tasks-deadline-notification-form__content_deadline-selector">
				<div class="ui-ctl ui-ctl-after-icon ui-ctl-datetime ui-ctl-w75">
					<div class="ui-ctl-after ui-ctl-icon-calendar"></div>
					${0}
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,j)[j])}getInputValue(){return babelHelpers.classPrivateFieldLooseBase(this,j)[j].value}getDeadline(){return babelHelpers.classPrivateFieldLooseBase(this,C)[C].getSelectedDate()}getToday(){return babelHelpers.classPrivateFieldLooseBase(this,C)[C].getToday()}getFormattedDeadline(e){return babelHelpers.classPrivateFieldLooseBase(this,C)[C].formatDate(this.getDeadline(),e)}}function q(e){babelHelpers.classPrivateFieldLooseBase(this,j)[j]=n.Tag.render(k||(k=_`
			<input class="ui-ctl-element" data-id="tasks-deadline-notification-deadline" readonly>
		`));const s=babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]();babelHelpers.classPrivateFieldLooseBase(this,W)[W](s);babelHelpers.classPrivateFieldLooseBase(this,X)[X](e,s);babelHelpers.classPrivateFieldLooseBase(this,R)[R](babelHelpers.classPrivateFieldLooseBase(this,j)[j],babelHelpers.classPrivateFieldLooseBase(this,A)[A],babelHelpers.classPrivateFieldLooseBase(this,w)[w])}function J(e,s){babelHelpers.classPrivateFieldLooseBase(this,w)[w]=e.matchWorkTime;const t=s.WEEKEND;if(!n.Type.isArray(t)){return}const a=t.length;if(a===N){babelHelpers.classPrivateFieldLooseBase(this,w)[w]=false}}function Q(e){const s=BX.Tasks.Calendar.adaptSettings(e);babelHelpers.classPrivateFieldLooseBase(this,A)[A]=new BX.Tasks.Calendar(s)}function ee(e,s,t){babelHelpers.classPrivateFieldLooseBase(this,C)[C]=new H({events:{onMoveDateToWorkTime:babelHelpers.classPrivateFieldLooseBase(this,U)[U].bind(this),onLessCurrentDateSelect:babelHelpers.classPrivateFieldLooseBase(this,V)[V].bind(this),onSelect:()=>this.emit("onSelect")},input:e,calendar:s,matchWorkTime:t})}function se(){const e=babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]();if(e.isShown()){return}const s=babelHelpers.classPrivateFieldLooseBase(this,z)[z]();s.show()}function te(){const e=babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]();e.show()}function ae(){if(!babelHelpers.classPrivateFieldLooseBase(this,x)[x]){babelHelpers.classPrivateFieldLooseBase(this,x)[x]=new O({bindElement:babelHelpers.classPrivateFieldLooseBase(this,j)[j]})}return babelHelpers.classPrivateFieldLooseBase(this,x)[x]}function ie(){if(!babelHelpers.classPrivateFieldLooseBase(this,M)[M]){babelHelpers.classPrivateFieldLooseBase(this,M)[M]=new g({bindElement:babelHelpers.classPrivateFieldLooseBase(this,j)[j]})}return babelHelpers.classPrivateFieldLooseBase(this,M)[M]}function le(){const e=n.Extension.getSettings("tasks.deadline.notification");return e.get("portalSettings")}var oe=babelHelpers.classPrivateFieldLooseKey("EVENT_NAMESPACE");var re=babelHelpers.classPrivateFieldLooseKey("ACCEPTED_ITEM_CLASS");var ne=babelHelpers.classPrivateFieldLooseKey("ITEMS_CLASSES");var de=babelHelpers.classPrivateFieldLooseKey("button");var ce=babelHelpers.classPrivateFieldLooseKey("items");var be=babelHelpers.classPrivateFieldLooseKey("period");var ve=babelHelpers.classPrivateFieldLooseKey("onMenuItemClick");var pe=babelHelpers.classPrivateFieldLooseKey("refreshMenuItemsIcons");var ue=babelHelpers.classPrivateFieldLooseKey("init");class he extends l.EventEmitter{constructor(e={}){super();Object.defineProperty(this,ue,{value:Fe});Object.defineProperty(this,pe,{value:Le});Object.defineProperty(this,ve,{value:Pe});Object.defineProperty(this,oe,{writable:true,value:"BX.Tasks.Deadline.Notification.Layout.SkipButtonMenu"});Object.defineProperty(this,re,{writable:true,value:"menu-popup-item-accept"});Object.defineProperty(this,ne,{writable:true,value:"menu-popup-icon menu-popup-item-none"});Object.defineProperty(this,de,{writable:true,value:void 0});Object.defineProperty(this,ce,{writable:true,value:void 0});Object.defineProperty(this,be,{writable:true,value:void 0});this.setEventNamespace(babelHelpers.classPrivateFieldLooseBase(this,oe)[oe]);this.subscribeFromOptions(e.events);babelHelpers.classPrivateFieldLooseBase(this,ue)[ue]()}getMenu(){return{closeByEsc:true,items:babelHelpers.classPrivateFieldLooseBase(this,ce)[ce],minWidth:180}}getPeriod(){return babelHelpers.classPrivateFieldLooseBase(this,be)[be]}setButton(e){babelHelpers.classPrivateFieldLooseBase(this,de)[de]=e}}function Pe(e,s){var t;const a=(t=babelHelpers.classPrivateFieldLooseBase(this,de)[de])==null?void 0:t.getMenuWindow();if(!a){return}if(babelHelpers.classPrivateFieldLooseBase(this,be)[be]===e){babelHelpers.classPrivateFieldLooseBase(this,be)[be]="";babelHelpers.classPrivateFieldLooseBase(this,pe)[pe](a.getMenuItems(),babelHelpers.classPrivateFieldLooseBase(this,be)[be]);const e=new l.BaseEvent({data:{buttonMenu:a}});this.emit("onMenuItemDeselect",e);return}babelHelpers.classPrivateFieldLooseBase(this,be)[be]=e;babelHelpers.classPrivateFieldLooseBase(this,pe)[pe](a.getMenuItems(),babelHelpers.classPrivateFieldLooseBase(this,be)[be]);const i=new l.BaseEvent({data:{buttonMenu:a,text:s}});this.emit("onMenuItemSelect",i)}function Le(e,s){e.forEach((e=>{const t=e.getLayout().item;if(!t){return}if(e.getId()===s){n.Dom.addClass(t,babelHelpers.classPrivateFieldLooseBase(this,re)[re]);return}n.Dom.removeClass(t,babelHelpers.classPrivateFieldLooseBase(this,re)[re])}))}function Fe(){babelHelpers.classPrivateFieldLooseBase(this,ce)[ce]=[{dataset:{id:"tasks-deadline-notification-skip-day"},id:"day",text:n.Loc.getMessage("TASKS_DEADLINE_NOTIFICATION_DAY"),className:babelHelpers.classPrivateFieldLooseBase(this,ne)[ne]},{dataset:{id:"tasks-deadline-notification-skip-week"},id:"week",text:n.Loc.getMessage("TASKS_DEADLINE_NOTIFICATION_WEEK"),className:babelHelpers.classPrivateFieldLooseBase(this,ne)[ne]},{dataset:{id:"tasks-deadline-notification-skip-month"},id:"month",text:n.Loc.getMessage("TASKS_DEADLINE_NOTIFICATION_MONTH"),className:babelHelpers.classPrivateFieldLooseBase(this,ne)[ne]},{dataset:{id:"tasks-deadline-notification-skip-forever"},id:"forever",text:n.Loc.getMessage("TASKS_DEADLINE_NOTIFICATION_FOREVER"),className:babelHelpers.classPrivateFieldLooseBase(this,ne)[ne]}];babelHelpers.classPrivateFieldLooseBase(this,ce)[ce].forEach((e=>{e.onclick=babelHelpers.classPrivateFieldLooseBase(this,ve)[ve].bind(this,e.id,e.text)}))}let fe=e=>e,Be;var He=babelHelpers.classPrivateFieldLooseKey("EVENT_NAMESPACE");var me=babelHelpers.classPrivateFieldLooseKey("submitButton");var ye=babelHelpers.classPrivateFieldLooseKey("cancelButton");var Te=babelHelpers.classPrivateFieldLooseKey("skipButton");var De=babelHelpers.classPrivateFieldLooseKey("skipButtonMenu");var Se=babelHelpers.classPrivateFieldLooseKey("init");var Ee=babelHelpers.classPrivateFieldLooseKey("onSubmitButtonClick");var ge=babelHelpers.classPrivateFieldLooseKey("onCancelButtonClick");var Oe=babelHelpers.classPrivateFieldLooseKey("onSkipMenuItemSelect");var _e=babelHelpers.classPrivateFieldLooseKey("onSkipMenuItemDeselect");class Ie extends l.EventEmitter{constructor(e={}){super();Object.defineProperty(this,_e,{value:Ce});Object.defineProperty(this,Oe,{value:Ae});Object.defineProperty(this,ge,{value:Ke});Object.defineProperty(this,Ee,{value:Ne});Object.defineProperty(this,Se,{value:ke});Object.defineProperty(this,He,{writable:true,value:"BX.Tasks.Deadline.Notification.Layout.Footer"});Object.defineProperty(this,me,{writable:true,value:void 0});Object.defineProperty(this,ye,{writable:true,value:void 0});Object.defineProperty(this,Te,{writable:true,value:void 0});Object.defineProperty(this,De,{writable:true,value:void 0});this.setEventNamespace(babelHelpers.classPrivateFieldLooseBase(this,He)[He]);this.subscribeFromOptions(e.events);babelHelpers.classPrivateFieldLooseBase(this,Se)[Se]()}render(){return n.Tag.render(Be||(Be=fe`
			<div class="tasks-deadline-notification-form__footer">
				<div class="tasks-deadline-notification-form__footer_buttons-container">
					${0}
					${0}
				</div>
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,me)[me].render(),babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].render(),babelHelpers.classPrivateFieldLooseBase(this,Te)[Te].render())}getSkipPeriod(){return babelHelpers.classPrivateFieldLooseBase(this,De)[De].getPeriod()}updateSkipButtonText(e){const s=n.Loc.getMessage("TASKS_DEADLINE_NOTIFICATION_SKIP_BUTTON");const t=e===""?s:`${s}, ${e}`;babelHelpers.classPrivateFieldLooseBase(this,Te)[Te].setText(t)}enableButtons(){this.enableSubmitButton();this.enableCancelButton();this.enableSkipButton()}disableButtons(){this.disableSubmitButton();this.disableCancelButton();this.disableSkipButton()}enableSubmitButton(){babelHelpers.classPrivateFieldLooseBase(this,me)[me].setDisabled(false);babelHelpers.classPrivateFieldLooseBase(this,me)[me].setColor(r.ButtonColor.PRIMARY)}disableSubmitButton(){babelHelpers.classPrivateFieldLooseBase(this,me)[me].setDisabled();babelHelpers.classPrivateFieldLooseBase(this,me)[me].setColor()}enableCancelButton(){babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].setDisabled(false)}disableCancelButton(){babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].setDisabled()}enableSkipButton(){babelHelpers.classPrivateFieldLooseBase(this,Te)[Te].setDisabled(false)}disableSkipButton(){babelHelpers.classPrivateFieldLooseBase(this,Te)[Te].setDisabled()}}function ke(){babelHelpers.classPrivateFieldLooseBase(this,me)[me]=new r.Button({dataset:{id:"tasks-deadline-notification-submit"},text:n.Loc.getMessage("TASKS_DEADLINE_NOTIFICATION_SAVE_BUTTON"),size:r.ButtonSize.SMALL,state:r.ButtonState.DISABLED,noCaps:true,round:true,onclick:babelHelpers.classPrivateFieldLooseBase(this,Ee)[Ee].bind(this)});babelHelpers.classPrivateFieldLooseBase(this,ye)[ye]=new r.Button({dataset:{id:"tasks-deadline-notification-cancel"},text:n.Loc.getMessage("TASKS_DEADLINE_NOTIFICATION_CANCEL_BUTTON_MSGVER_1"),color:r.ButtonColor.LINK,size:r.ButtonSize.SMALL,state:r.ButtonState.ACTIVE,noCaps:true,round:true,onclick:babelHelpers.classPrivateFieldLooseBase(this,ge)[ge].bind(this)});babelHelpers.classPrivateFieldLooseBase(this,De)[De]=new he({events:{onMenuItemSelect:babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe].bind(this),onMenuItemDeselect:babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].bind(this)}});babelHelpers.classPrivateFieldLooseBase(this,Te)[Te]=new r.Button({dataset:{id:"tasks-deadline-notification-skip"},text:n.Loc.getMessage("TASKS_DEADLINE_NOTIFICATION_SKIP_BUTTON"),className:"tasks-deadline-notification-form__footer_skip-button",color:r.ButtonColor.LINK,noCaps:true,dropdown:true,menu:babelHelpers.classPrivateFieldLooseBase(this,De)[De].getMenu()});babelHelpers.classPrivateFieldLooseBase(this,De)[De].setButton(babelHelpers.classPrivateFieldLooseBase(this,Te)[Te])}function Ne(){if(babelHelpers.classPrivateFieldLooseBase(this,me)[me].isDisabled()){return}this.emit("onSubmitButtonClick")}function Ke(){if(babelHelpers.classPrivateFieldLooseBase(this,ye)[ye].isDisabled()){return}this.emit("onCancelButtonClick")}function Ae(e){const{buttonMenu:s,text:t}=e.getData();s.close();this.updateSkipButtonText(t.toLowerCase());this.emit("onSkipMenuItemSelect",e)}function Ce(e){const{buttonMenu:s}=e.getData();s.close();this.updateSkipButtonText("");this.emit("onSkipMenuItemDeselect",e)}let je=e=>e,we,Me;function xe(e){return e.replaceAll(/\D/g,"")}function $e(e,s,t){let a=Math.max(e,s);a=Math.min(a,t);return a}const Xe=2**32/2-1;const We=60*60*24*31;var Re=babelHelpers.classPrivateFieldLooseKey("intervalSelector");var Ue=babelHelpers.classPrivateFieldLooseKey("input");var Ve=babelHelpers.classPrivateFieldLooseKey("onInput");class Ye{constructor(){Object.defineProperty(this,Ve,{value:ze});Object.defineProperty(this,Re,{writable:true,value:void 0});Object.defineProperty(this,Ue,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,Ue)[Ue]=n.Tag.render(we||(we=je`
			<input class="ui-ctl-element" placeholder="0" data-id="tasks-deadline-notification-default-deadline">
		`));n.Event.bind(babelHelpers.classPrivateFieldLooseBase(this,Ue)[Ue],"input",babelHelpers.classPrivateFieldLooseBase(this,Ve)[Ve].bind(this));babelHelpers.classPrivateFieldLooseBase(this,Re)[Re]=new d.IntervalSelector({showDropdownIcon:true})}render(){return n.Tag.render(Me||(Me=je`
			<div hidden>
				<div class="tasks-deadline-notification-form__content_default-deadline-container">
					<div class="ui-ctl ui-ctl-w25">
						${0}
					</div>
					<div
						class="tasks-deadline-notification-form__content_default-deadline-container_interval-selector"
						data-id="tasks-deadline-notification-interval-selector"
					>
						${0}
					</div>
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,Ue)[Ue],babelHelpers.classPrivateFieldLooseBase(this,Re)[Re].render())}isExactDeadlineTime(){return["minutes","hours"].includes(babelHelpers.classPrivateFieldLooseBase(this,Re)[Re].getInterval())}getDeadlineInSeconds(){return Number(babelHelpers.classPrivateFieldLooseBase(this,Ue)[Ue].value)*babelHelpers.classPrivateFieldLooseBase(this,Re)[Re].getDuration()}focus(){babelHelpers.classPrivateFieldLooseBase(this,Ue)[Ue].focus()}clear(){babelHelpers.classPrivateFieldLooseBase(this,Ue)[Ue].value=""}select(e){babelHelpers.classPrivateFieldLooseBase(this,Ue)[Ue].value=e}}function ze(){let e=xe(babelHelpers.classPrivateFieldLooseBase(this,Ue)[Ue].value);e=parseInt(e,10);const s=1;const t=Math.floor(Xe/We);e=$e(e,s,t);babelHelpers.classPrivateFieldLooseBase(this,Ue)[Ue].value=e||""}let Ze=e=>e,Ge,qe,Je,Qe,es;var ss=babelHelpers.classPrivateFieldLooseKey("EVENT_NAMESPACE");var ts=babelHelpers.classPrivateFieldLooseKey("popup");var as=babelHelpers.classPrivateFieldLooseKey("targetForm");var is=babelHelpers.classPrivateFieldLooseKey("targetInput");var ls=babelHelpers.classPrivateFieldLooseKey("targetButton");var os=babelHelpers.classPrivateFieldLooseKey("matchWorkTime");var rs=babelHelpers.classPrivateFieldLooseKey("layout");var ns=babelHelpers.classPrivateFieldLooseKey("getPopupContent");var ds=babelHelpers.classPrivateFieldLooseKey("getTitleContainer");var cs=babelHelpers.classPrivateFieldLooseKey("getErrorsContainer");var bs=babelHelpers.classPrivateFieldLooseKey("getDeadlineContainer");var vs=babelHelpers.classPrivateFieldLooseKey("getDefaultDeadlineCheckerTitle");var ps=babelHelpers.classPrivateFieldLooseKey("saveTargetButtonStateInForm");var us=babelHelpers.classPrivateFieldLooseKey("onSubmitButtonClick");var hs=babelHelpers.classPrivateFieldLooseKey("onCancelButtonClick");var Ps=babelHelpers.classPrivateFieldLooseKey("onSkipMenuItemSelect");var Ls=babelHelpers.classPrivateFieldLooseKey("onDefaultDeadlineCheckerChange");var Fs=babelHelpers.classPrivateFieldLooseKey("onDeadlineSelect");var fs=babelHelpers.classPrivateFieldLooseKey("onPopupFirstShow");var Bs=babelHelpers.classPrivateFieldLooseKey("onPromiseError");var Hs=babelHelpers.classPrivateFieldLooseKey("setDefaultDeadline");var ms=babelHelpers.classPrivateFieldLooseKey("setSkipNotificationPeriod");var ys=babelHelpers.classPrivateFieldLooseKey("submit");var Ts=babelHelpers.classPrivateFieldLooseKey("setTargetInputValue");var Ds=babelHelpers.classPrivateFieldLooseKey("init");class Ss extends l.EventEmitter{constructor(e){super();Object.defineProperty(this,Ds,{value:Rs});Object.defineProperty(this,Ts,{value:Ws});Object.defineProperty(this,ys,{value:Xs});Object.defineProperty(this,ms,{value:$s});Object.defineProperty(this,Hs,{value:xs});Object.defineProperty(this,Bs,{value:Ms});Object.defineProperty(this,fs,{value:ws});Object.defineProperty(this,Fs,{value:js});Object.defineProperty(this,Ls,{value:Cs});Object.defineProperty(this,Ps,{value:As});Object.defineProperty(this,hs,{value:Ks});Object.defineProperty(this,us,{value:Ns});Object.defineProperty(this,ps,{value:ks});Object.defineProperty(this,vs,{value:Is});Object.defineProperty(this,bs,{value:_s});Object.defineProperty(this,cs,{value:Os});Object.defineProperty(this,ds,{value:gs});Object.defineProperty(this,ns,{value:Es});Object.defineProperty(this,ss,{writable:true,value:"BX.Tasks.Deadline.Notification"});Object.defineProperty(this,ts,{writable:true,value:void 0});Object.defineProperty(this,as,{writable:true,value:void 0});Object.defineProperty(this,is,{writable:true,value:void 0});Object.defineProperty(this,ls,{writable:true,value:void 0});Object.defineProperty(this,os,{writable:true,value:void 0});Object.defineProperty(this,rs,{writable:true,value:void 0});this.setEventNamespace(babelHelpers.classPrivateFieldLooseBase(this,ss)[ss]);babelHelpers.classPrivateFieldLooseBase(this,Ds)[Ds](e)}show(){babelHelpers.classPrivateFieldLooseBase(this,ts)[ts].show()}close(){babelHelpers.classPrivateFieldLooseBase(this,ts)[ts].close()}}function Es(){const e=n.Tag.render(Ge||(Ge=Ze`
			<form class="tasks-deadline__notification-form">
				${0}
				${0}
				${0}
				${0}
			</form>
		`),babelHelpers.classPrivateFieldLooseBase(this,ds)[ds](),babelHelpers.classPrivateFieldLooseBase(this,cs)[cs](),babelHelpers.classPrivateFieldLooseBase(this,bs)[bs](),babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].footer.render());n.Event.bind(e,"submit",(e=>{e.preventDefault()}));return e}function gs(){return n.Tag.render(qe||(qe=Ze`
			<div class="tasks-deadline-notification-form__title">
				<div class="tasks-deadline-notification-form__title_icon"></div>
				<div class="tasks-deadline-notification-form__title_text">
					${0}
				</div>
			</div>
			<div class="tasks-deadline-notification-form__subtitle">
				${0}
			</div>
		`),n.Loc.getMessage("TASKS_DEADLINE_NOTIFICATION_TITLE"),n.Loc.getMessage("TASKS_DEADLINE_NOTIFICATION_DESCRIPTION"))}function Os(){babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].errorContainer=n.Tag.render(Je||(Je=Ze`
			<div class="tasks-deadline-notification-form__errors" hidden>
				<div class="ui-alert ui-alert-danger">
					<span class="ui-alert-message">${0}</span>
				</div>
			</div>
		`),n.Loc.getMessage("TASKS_DEADLINE_NOTIFICATION_ERROR_MESSAGE"));return babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].errorContainer}function _s(){babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].defaultDeadlineChecker=new s.Checker({id:"tasks-deadline-notification-default-deadline-checker",inputName:"defaultDeadlineChecker",checked:false,title:babelHelpers.classPrivateFieldLooseBase(this,vs)[vs](),hideSeparator:true,size:"extra-small"});const e=babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].defaultDeadlineSelector.render();l.EventEmitter.subscribe(babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].defaultDeadlineChecker,"change",babelHelpers.classPrivateFieldLooseBase(this,Ls)[Ls].bind(this,e));return n.Tag.render(Qe||(Qe=Ze`
			<div class="tasks-deadline-notification-form__content">
				<div class="tasks-deadline-notification-form__content_title">
					${0}
				</div>
				${0}
				<div class="tasks-deadline-notification-form__content_default-deadline-checker">
					${0}
				</div>
				${0}
			</div>
		`),n.Loc.getMessage("TASKS_DEADLINE_NOTIFICATION_DEADLINE_TITLE"),babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].deadlineSelector.render(),babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].defaultDeadlineChecker.render(),e)}function Is(){return`\n\t\t\t<div>\n\t\t\t\t${n.Loc.getMessage("TASKS_DEADLINE_NOTIFICATION_DEFAULT_DEADLINE_CHECKER")}\n\t\t\t</div>\n\t\t\t<span\n\t\t\t\tdata-id="defaultDeadlineHint"\n\t\t\t\tclass="ui-hint"\n\t\t\t\tdata-hint="${n.Loc.getMessage("TASKS_DEADLINE_NOTIFICATION_DEFAULT_DEADLINE_HINT")}"\n\t\t\t\tdata-hint-no-icon\n\t\t\t>\n\t\t\t\t<span class="ui-hint-icon">\n\t\t\t\t</span>\n\t\t\t</span>\n\t\t`}function ks(){if(!babelHelpers.classPrivateFieldLooseBase(this,ls)[ls]||!babelHelpers.classPrivateFieldLooseBase(this,ls)[ls].name||!babelHelpers.classPrivateFieldLooseBase(this,ls)[ls].value){return}const e=n.Tag.render(es||(es=Ze`
			<input name="${0}" value="${0}" hidden>
		`),babelHelpers.classPrivateFieldLooseBase(this,ls)[ls].name,babelHelpers.classPrivateFieldLooseBase(this,ls)[ls].value);n.Dom.append(e,babelHelpers.classPrivateFieldLooseBase(this,as)[as])}function Ns(){babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].footer.disableButtons();const e=babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].defaultDeadlineSelector.getDeadlineInSeconds();const s=babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].defaultDeadlineSelector.isExactDeadlineTime();const t=babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].footer.getSkipPeriod();babelHelpers.classPrivateFieldLooseBase(this,Hs)[Hs](e,s).then((()=>babelHelpers.classPrivateFieldLooseBase(this,ms)[ms](t))).then((()=>{babelHelpers.classPrivateFieldLooseBase(this,Ts)[Ts]();babelHelpers.classPrivateFieldLooseBase(this,ys)[ys]()})).catch((()=>babelHelpers.classPrivateFieldLooseBase(this,Bs)[Bs]()))}function Ks(){babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].footer.disableButtons();babelHelpers.classPrivateFieldLooseBase(this,ys)[ys]()}function As(){if(babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].deadlineSelector.getInputValue()){return}babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].footer.disableButtons();const e=babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].footer.getSkipPeriod();babelHelpers.classPrivateFieldLooseBase(this,ms)[ms](e).then((()=>{babelHelpers.classPrivateFieldLooseBase(this,ys)[ys]()})).catch((()=>babelHelpers.classPrivateFieldLooseBase(this,Bs)[Bs]()))}function Cs(e,s){const a=s.getData();if(!a){n.Dom.hide(e);return}n.Dom.show(e);if(!babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].deadlineSelector.getInputValue()){babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].defaultDeadlineSelector.clear();babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].defaultDeadlineSelector.focus();return}const i=babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].deadlineSelector.getToday();const l=babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].deadlineSelector.getDeadline();const o=(l-i)/1e3;const r=t.DateRounder.roundToDays(o);if(r<=0){babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].defaultDeadlineSelector.clear();babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].defaultDeadlineSelector.focus();return}babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].defaultDeadlineSelector.select(r)}function js(){const e=babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].deadlineSelector.getDeadline();if(e===null){babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].footer.disableSubmitButton();return}babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].footer.enableSubmitButton()}function ws(e){BX.UI.Hint.init(e.getTarget().contentContainer)}function Ms(){babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].footer.enableCancelButton();babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].footer.enableSkipButton();const e=babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].deadlineSelector.getDeadline();if(!n.Type.isNull(e)){babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].footer.enableSubmitButton()}n.Dom.show(babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].errorContainer)}function xs(e,s){if(!babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].defaultDeadlineChecker.isChecked()){return new Promise((e=>{e()}))}const t={default:e,isExactTime:s?"Y":"N"};return n.ajax.runAction("tasks.deadline.Deadline.setDefault",{data:{deadlineData:t}})}function $s(e){if(!babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].footer.getSkipPeriod()){return new Promise((e=>{e()}))}const s={skipPeriod:e};return n.ajax.runAction("tasks.deadline.Notification.skip",{data:{notificationData:s}})}function Xs(){this.close();babelHelpers.classPrivateFieldLooseBase(this,ps)[ps]();this.emit("onBeforeSubmit");babelHelpers.classPrivateFieldLooseBase(this,as)[as].submit()}function Ws(){const e=a.DateTimeFormat.getFormat("FORMAT_DATETIME");babelHelpers.classPrivateFieldLooseBase(this,is)[is].value=babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].deadlineSelector.getFormattedDeadline(e)}function Rs(e){babelHelpers.classPrivateFieldLooseBase(this,as)[as]=e.targetForm;babelHelpers.classPrivateFieldLooseBase(this,is)[is]=e.targetInput;babelHelpers.classPrivateFieldLooseBase(this,ls)[ls]=e.targetButton;babelHelpers.classPrivateFieldLooseBase(this,os)[os]=e.matchWorkTime;babelHelpers.classPrivateFieldLooseBase(this,rs)[rs]={};babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].deadlineSelector=new G({matchWorkTime:babelHelpers.classPrivateFieldLooseBase(this,os)[os],events:{onSelect:babelHelpers.classPrivateFieldLooseBase(this,Fs)[Fs].bind(this)}});babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].defaultDeadlineSelector=new Ye;babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].footer=new Ie({events:{onSubmitButtonClick:babelHelpers.classPrivateFieldLooseBase(this,us)[us].bind(this),onCancelButtonClick:babelHelpers.classPrivateFieldLooseBase(this,hs)[hs].bind(this),onSkipMenuItemSelect:babelHelpers.classPrivateFieldLooseBase(this,Ps)[Ps].bind(this)}});babelHelpers.classPrivateFieldLooseBase(this,ts)[ts]=new o.Popup({id:"deadline-notification",content:babelHelpers.classPrivateFieldLooseBase(this,ns)[ns](),className:"tasks__deadline-notification-popup",overlay:{opacity:40},width:600,autoHide:false,closeIcon:false,events:{onFirstShow:babelHelpers.classPrivateFieldLooseBase(this,fs)[fs].bind(this)}})}e.Notification=Ss})(this.BX.Tasks.Deadline=this.BX.Tasks.Deadline||{},BX.UI.FormElements,BX.Tasks,BX.Main,BX.UI.DatePicker,BX.Event,BX.Main,BX.UI,BX,BX.Tasks);
//# sourceMappingURL=notification.bundle.map.js