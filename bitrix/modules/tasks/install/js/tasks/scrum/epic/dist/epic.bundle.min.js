this.BX=this.BX||{};this.BX.Tasks=this.BX.Tasks||{};(function(t,e,i,s,r,n,a){"use strict";function o(t,e){l(t,e);e.add(t)}function c(t,e,i){l(t,e);e.set(t,i)}function l(t,e){if(e.has(t)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function d(t,e,i){if(!e.has(t)){throw new TypeError("attempted to get private field on non-instance")}return i}var u=new WeakMap;var p=new WeakMap;var h=new WeakMap;var f=new WeakMap;var v=new WeakSet;var m=new WeakSet;var g=new WeakSet;var b=new WeakSet;var k=new WeakSet;var T=new WeakSet;var E=new WeakSet;var y=function(){function t(e){babelHelpers.classCallCheck(this,t);o(this,E);o(this,T);o(this,k);o(this,b);o(this,g);o(this,m);o(this,v);c(this,u,{writable:true,value:void 0});c(this,p,{writable:true,value:void 0});c(this,h,{writable:true,value:void 0});c(this,f,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(this,u,e);d(this,v,w).call(this)}babelHelpers.createClass(t,[{key:"destroyPopups",value:function t(){var e,i;babelHelpers.classPrivateFieldGet(this,p).popup.destroy();(e=babelHelpers.classPrivateFieldGet(this,h).getPopupById(babelHelpers.classPrivateFieldGet(this,u).filterId+"_fields_popup"))===null||e===void 0?void 0:e.destroy();(i=babelHelpers.classPrivateFieldGet(this,h).getPopupById(babelHelpers.classPrivateFieldGet(this,u).filterId+"-grid-settings-window"))===null||i===void 0?void 0:i.destroy()}},{key:"release",value:function t(){d(this,E,_).call(this);d(this,g,I).call(this);this.destroyPopups()}}]);return t}();function w(){babelHelpers.classPrivateFieldSet(this,p,BX.Main.filterManager.getById(babelHelpers.classPrivateFieldGet(this,u).filterId));babelHelpers.classPrivateFieldSet(this,h,BX.Main.PopupManager);d(this,m,S).call(this);d(this,b,L).call(this)}function S(){babelHelpers.classPrivateFieldSet(this,f,babelHelpers.classPrivateFieldGet(this,p).getFilterFieldsValues())}function I(){e.EventEmitter.unsubscribe("BX.Main.Filter:apply",d(this,k,C).bind(this));e.EventEmitter.unsubscribe("BX.Main.Filter:onGetStopBlur",d(this,T,P).bind(this))}function L(){e.EventEmitter.subscribe("BX.Main.Filter:apply",d(this,k,C).bind(this));e.EventEmitter.subscribe("BX.Main.Filter:onGetStopBlur",d(this,T,P).bind(this))}function C(){d(this,m,S).call(this)}function P(t){var e=t.getCompatData()[0],i=e.target,s=e.path;var r=s.find((function(t){var e,i;return((e=t.classList)===null||e===void 0?void 0:e.contains("popup-window"))||((i=t.classList)===null||i===void 0?void 0:i.contains("main-ui-square"))}));var n=[babelHelpers.classPrivateFieldGet(this,p).popup.popupContainer,babelHelpers.classPrivateFieldGet(this,p).getFieldsPopup().popupContainer];if(babelHelpers.classPrivateFieldGet(this,p).popup.isShown()&&!n.some((function(t){return t.contains(i)}))&&!r){babelHelpers.classPrivateFieldGet(this,p).closePopup()}}function _(){babelHelpers.classPrivateFieldGet(this,p).resetFilter()}var F=function(){function t(){babelHelpers.classCallCheck(this,t)}babelHelpers.createClass(t,[{key:"sendRequest",value:function t(e,i){var s=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};return new Promise((function(t,r){n.ajax.runAction("bitrix:tasks.scrum."+e+"."+i,{data:s}).then(t,r)}))}},{key:"showErrorAlert",value:function t(e,i){if(n.Type.isUndefined(e.errors)){console.error(e);return}if(e.errors.length){var s=e.errors.shift();if(s){var r=s.code?s.code:"";var o=s.message+" "+r;var c=i?i:n.Loc.getMessage("TSE_ERROR_POPUP_TITLE");a.MessageBox.alert(o,c)}}}}]);return t}();var M,A,D,B,H,x,R,O,N,q;function X(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function U(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?X(Object(i),!0).forEach((function(e){babelHelpers.defineProperty(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):X(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var j=function(t){babelHelpers.inherits(a,t);function a(){var t;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};babelHelpers.classCallCheck(this,a);t=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(a).call(this,e));t.setEventNamespace("BX.Tasks.Scrum.Epic");t.view=n.Type.isString(e.view)?e.view:"";t.groupId=parseInt(e.groupId,10);t.epicId=n.Type.isUndefined(e.epicId)?0:parseInt(e.epicId,10);t.gridId=n.Type.isUndefined(e.gridId)?"":e.gridId;t.pathToTask=n.Type.isString(e.pathToTask)?e.pathToTask:"";t.requestSender=new F;t.sidePanelManager=BX.SidePanel.Instance;t.sidePanel=null;t.id=null;t.form=null;t.formData=null;t.listData=null;t.filterData=null;t.filter=null;t.editorHandler=null;t.colorPickers=new Map;t.defaultColor="#69dafc";t.selectedColor="";return t}babelHelpers.createClass(a,[{key:"show",value:function t(){switch(this.view){case"add":this.showAddForm();break;case"list":this.showList();break;case"view":this.showViewForm();break;case"edit":this.showEditForm();break;case"tasks":this.showTasksList();break;case"completedTasks":this.showTasksList(true);break}}},{key:"showAddForm",value:function t(){var e=this;this.id=n.Text.getRandom();this.sidePanelManager.open("tasks-scrum-epic-add-form-side-panel",{cacheable:false,width:800,contentCallback:function t(){return i.Layout.createContent({extensions:["tasks.scrum.epic"],title:n.Loc.getMessage("TASKS_SCRUM_ADD_EPIC_FORM_TITLE"),content:e.createAddContent.bind(e),design:{section:false},buttons:function t(i){var s=i.cancelButton,r=i.SaveButton;return[new r({onclick:e.onSaveAddForm.bind(e)}),s]}})},events:{onLoad:this.onLoadAddForm.bind(this)}})}},{key:"showList",value:function t(){var e=this;this.id=n.Text.getRandom();this.gridId="EntityEpicsGrid_"+this.groupId;this.filterId=this.gridId;var s="tasks-scrum-epic-list-side-panel";this.subscribeListToEvents(s);this.sidePanelManager.open(s,{cacheable:false,contentCallback:function t(){return i.Layout.createContent({extensions:["tasks.scrum.epic"],title:n.Loc.getMessage("TASKS_SCRUM_SPRINT_ADD_EPIC_LIST_TITLE"),content:e.createContainerContent.bind(e),design:{section:false},buttons:[]})},events:{onLoad:function t(i){e.onLoadFilter(i);e.onLoadList(i)},onClose:function t(){var i;(i=e.filter)===null||i===void 0?void 0:i.release()}}})}},{key:"showTasksList",value:function t(){var e=this;var s=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;this.id=n.Text.getRandom();this.gridId="EpicTasksGrid_"+this.groupId;this.sidePanelManager.open("tasks-scrum-epic-tasks-list-side-panel",{cacheable:false,contentCallback:function t(){return i.Layout.createContent({extensions:["tasks.scrum.epic"],title:s?n.Loc.getMessage("TASKS_SCRUM_SPRINT_ADD_EPIC_COMPLETED_TASKS_LIST_TITLE"):n.Loc.getMessage("TASKS_SCRUM_SPRINT_ADD_EPIC_TASKS_LIST_TITLE"),content:e.createTasksListContent.bind(e,s),design:{section:false},buttons:[]})},events:{onLoad:this.onLoadTasksList.bind(this)}})}},{key:"showViewForm",value:function t(){var s=this;this.id=n.Text.getRandom();this.subscribeViewToEvents();this.sidePanelManager.open("tasks-scrum-epic-view-form-side-panel",{cacheable:false,width:800,contentCallback:function t(){return new Promise((function(t,r){s.getEpic().then((function(r){var a=r.data;t(i.Layout.createContent({extensions:["tasks.scrum.epic"],title:n.Loc.getMessage("TASKS_SCRUM_VIEW_EPIC_FORM_TITLE"),content:s.createViewContent.bind(s,a),design:{section:false},buttons:function t(i){var r=i.cancelButton,o=i.SaveButton;return[new o({text:n.Loc.getMessage("TASKS_SCRUM_EPIC_EDIT_BUTTON"),onclick:function t(){s.sidePanel.close(false,(function(){e.EventEmitter.emit(s.getEventNamespace()+":"+"openEdit",a.id)}))}}),r]}}))}))}))},events:{onLoad:this.onLoadViewForm.bind(this)}})}},{key:"showEditForm",value:function t(){var e=this;this.id=n.Text.getRandom();this.sidePanelManager.open("tasks-scrum-epic-edit-form-side-panel",{cacheable:false,width:800,contentCallback:function t(){return i.Layout.createContent({extensions:["tasks.scrum.epic"],title:n.Loc.getMessage("TASKS_SCRUM_EDIT_EPIC_FORM_TITLE"),content:e.createEditContent.bind(e),design:{section:false},buttons:function t(i){var s=i.cancelButton,r=i.SaveButton;return[new r({onclick:e.onSaveEditForm.bind(e)}),s]}})},events:{onLoad:this.onLoadEditForm.bind(this)}})}},{key:"removeEpic",value:function t(){var i=this;return n.ajax.runAction("bitrix:tasks.scrum.epic.removeEpic",{data:{groupId:this.groupId,epicId:this.epicId}}).then((function(t){e.EventEmitter.emit(i.getEventNamespace()+":"+"afterRemove",t.data);return true}))["catch"]((function(t){i.requestSender.showErrorAlert(t)}))}},{key:"showTask",value:function t(e){if(this.pathToTask){this.sidePanelManager.open(this.pathToTask.replace("#action#","view").replace("#task_id#",parseInt(e,10)))}}},{key:"subscribeListToEvents",value:function t(i){var s=this;e.EventEmitter.subscribe(this.getEventNamespace()+":"+"afterAdd",(function(){return s.reloadGrid()}));e.EventEmitter.subscribe(this.getEventNamespace()+":"+"afterEdit",(function(){return s.reloadGrid()}))}},{key:"subscribeViewToEvents",value:function t(){var i=this;e.EventEmitter.subscribe(this.getEventNamespace()+":"+"openEdit",(function(t){a.showEdit(i.groupId,t.getData())}))}},{key:"reloadSidePanel",value:function t(e){if(n.Type.isUndefined(e)){this.sidePanelManager.reload()}else{var i=this.sidePanelManager.getOpenSliders();if(i.length>0){i.forEach((function(t){if(t.getUrl()===e){t.reload()}}))}}}},{key:"createAddContent",value:function t(){var e=this;return new Promise((function(t,i){n.ajax.runAction("bitrix:tasks.scrum.epic.getDescriptionEditor",{data:{groupId:e.groupId,editorId:e.id}}).then((function(i){e.formData=i.data;t(e.renderAddForm())}))["catch"]((function(t){e.requestSender.showErrorAlert(t)}))}))}},{key:"createListContent",value:function t(){var e=this;return new Promise((function(t,i){n.ajax.runAction("bitrix:tasks.scrum.epic.list",{data:{groupId:e.groupId,gridId:e.gridId}}).then((function(i){e.listData=i.data;t(e.renderList())}))["catch"]((function(t){e.requestSender.showErrorAlert(t)}))}))}},{key:"createFilterContent",value:function t(){var e=this;return new Promise((function(t,i){n.ajax.runAction("bitrix:tasks.scrum.epic.filter.get",{data:{groupId:e.groupId,gridId:e.gridId}}).then((function(i){e.filterData=i.data;t(e.renderFilter())}))["catch"]((function(t){e.requestSender.showErrorAlert(t)}))}))}},{key:"createTasksListContent",value:function t(e){var i=this;return new Promise((function(t,s){n.ajax.runAction("bitrix:tasks.scrum.epic.getTasksList",{data:{groupId:i.groupId,epicId:i.epicId,gridId:i.gridId,completed:e?"Y":"N"}}).then((function(e){i.listData=e.data;t(i.renderTasksList())}))["catch"]((function(t){i.requestSender.showErrorAlert(t)}))}))}},{key:"createViewContent",value:function t(e){var i=this;return new Promise((function(t,s){n.ajax.runAction("bitrix:tasks.scrum.epic.getEpicFiles",{data:{groupId:i.groupId,epicId:e.id}}).then((function(s){i.epicFiles=n.Type.isUndefined(s.data.html)?"":s.data.html;t(i.renderViewForm(e))}))["catch"]((function(t){i.requestSender.showErrorAlert(t)}))}))}},{key:"createEditContent",value:function t(){var e=this;return new Promise((function(t,i){e.getEpic().then((function(i){var s=i.data;n.ajax.runAction("bitrix:tasks.scrum.epic.getDescriptionEditor",{data:{groupId:e.groupId,editorId:e.id,epicId:s.id,text:s.description}}).then((function(i){e.currentEpic=s;e.formData=i.data;t(e.renderEditForm(s))}))["catch"]((function(t){e.requestSender.showErrorAlert(t)}))}))}))}},{key:"createContainerContent",value:function t(){var e=this;return Promise.all([this.createFilterContent(),this.createListContent()]).then((function(t){var i=babelHelpers.slicedToArray(t,2),s=i[0],r=i[1];return e.renderContainer(s,r)}))}},{key:"getEpic",value:function t(){var e=this;return new Promise((function(t,i){n.ajax.runAction("bitrix:tasks.scrum.epic.getEpic",{data:{groupId:e.groupId,epicId:e.epicId}}).then(t,i)}))}},{key:"onLoadAddForm",value:function t(e){this.sidePanel=e.getSlider();this.form=this.sidePanel.getContainer().querySelector(".tasks-scrum-epic-form");var i=this.form.querySelector(".tasks-scrum-epic-form-description");if(n.Type.isUndefined(this.formData.html)){return}this.renderEditor(i)}},{key:"onSaveAddForm",value:function t(){var i=this;n.ajax.runAction("bitrix:tasks.scrum.epic.createEpic",{data:this.getRequestData()}).then((function(t){i.sidePanel.close(false,(function(){e.EventEmitter.emit(i.getEventNamespace()+":"+"afterAdd",t.data);r.UI.Notification.Center.notify({content:n.Loc.getMessage("TASKS_SCRUM_ADD_EPIC_NOTIFY")})}))}))["catch"]((function(t){i.requestSender.showErrorAlert(t)}))}},{key:"onLoadFilter",value:function t(e){var i,s=this;this.sidePanel=e.getSlider();var r=this.sidePanel.getContainer().querySelector(".tasks-scrum-epic-filter");if((i=this.filterData)!==null&&i!==void 0&&i.html){n.Runtime.html(r,this.filterData.html).then((function(){s.filter=new y({filterId:s.filterId})}))}}},{key:"onLoadList",value:function t(i){var s=this;this.sidePanel=i.getSlider();var r=this.sidePanel.getContainer().querySelector(".tasks-scrum-epic-list");if(n.Type.isUndefined(this.listData.html)){n.Dom.append(this.renderListBlank(),r);n.Event.bind(r.querySelector(".tasks-scrum-epics-empty-button"),"click",this.showAddForm.bind(this))}else{n.Runtime.html(r,this.listData.html).then((function(){e.EventEmitter.subscribe("Grid::beforeRequest",s.onBeforeGridRequest.bind(s));s.prepareTagsList(r)}))}}},{key:"onLoadTasksList",value:function t(i){var s=this;this.sidePanel=i.getSlider();var r=this.sidePanel.getContainer().querySelector(".tasks-scrum-epic-tasks-list");if(this.listData){n.Runtime.html(r,this.listData.html).then((function(){e.EventEmitter.subscribe("Grid::beforeRequest",s.onBeforeGridRequest.bind(s))}))}}},{key:"onLoadViewForm",value:function t(e){this.sidePanel=e.getSlider();if(this.epicFiles){var i=this.sidePanel.getContainer().querySelector(".tasks-scrum-epic-form-files");n.Runtime.html(i,this.epicFiles)}}},{key:"onLoadEditForm",value:function t(e){this.sidePanel=e.getSlider();this.form=this.sidePanel.getContainer().querySelector(".tasks-scrum-epic-form");var i=this.form.querySelector(".tasks-scrum-epic-form-description");if(n.Type.isUndefined(this.formData.html)){return}this.renderEditor(i)}},{key:"onSaveEditForm",value:function t(){var i=this;n.ajax.runAction("bitrix:tasks.scrum.epic.editEpic",{data:this.getRequestData()}).then((function(t){i.sidePanel.close(false,(function(){e.EventEmitter.emit(i.getEventNamespace()+":"+"afterEdit",t.data)}))}))["catch"]((function(t){i.requestSender.showErrorAlert(t)}))}},{key:"onBeforeGridRequest",value:function t(e){var i=e.getCompatData(),s=babelHelpers.slicedToArray(i,2),r=s[0],n=s[1];n.sessid=BX.bitrix_sessid();n.method="POST";if(!n.url){n.url=this.getListUrl()}n.data=U(U({},n.data),{},{groupId:this.groupId,gridId:this.gridId,epicId:this.epicId})}},{key:"getListUrl",value:function t(){return"/bitrix/services/main/ajax.php?action=bitrix:tasks.scrum.epic.list"}},{key:"renderAddForm",value:function t(){return n.Tag.render(M||(M=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="tasks-scrum-epic-form">\n\t\t\t\t<div class="tasks-scrum-epic-form-container">\n\t\t\t\t\t',"\n\t\t\t\t\t","\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"])),this.renderNameField(0,"",this.defaultColor),this.renderDescriptionField())}},{key:"renderContainer",value:function t(e,i){return n.Tag.render(A||(A=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="tasks-scrum-epic-container">\n\t\t\t\t<div class="tasks-scrum-epic-toolbar">\n\t\t\t\t\t<button class="ui-btn ui-btn-success" onclick="','">\n\t\t\t\t\t\t<span class="ui-btn-text">',"</span>\n\t\t\t\t\t</button>\n\t\t\t\t\t","\n\t\t\t\t</div>\n\t\t\t\t","\n\t\t\t</div>\n\t\t"])),this.showAddForm.bind(this),n.Loc.getMessage("TASKS_SCRUM_SPRINT_ADD_EPIC_LIST_TOOLBAR_BUTTON"),e,i)}},{key:"renderFilter",value:function t(){return n.Tag.render(D||(D=babelHelpers.taggedTemplateLiteral(['<div class="tasks-scrum-epic-filter"></div>'])))}},{key:"renderList",value:function t(){return n.Tag.render(B||(B=babelHelpers.taggedTemplateLiteral(['<div class="tasks-scrum-epic-list"></div>'])))}},{key:"renderTasksList",value:function t(){return n.Tag.render(H||(H=babelHelpers.taggedTemplateLiteral(['<div class="tasks-scrum-epic-tasks-list"></div>'])))}},{key:"renderViewForm",value:function t(e){return n.Tag.render(x||(x=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="tasks-scrum-epic-form">\n\t\t\t\t<div class="tasks-scrum-epic-form-container">\n\t\t\t\t\t<div class="tasks-scrum-epic-form-header">\n\t\t\t\t\t\t<div class="tasks-scrum-epic-form-header-title">\n\t\t\t\t\t\t\t','\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="tasks-scrum-epic-form-header-separate"></div>\n\t\t\t\t\t\t<div class="tasks-scrum-epic-header-color">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass="tasks-scrum-epic-header-color-current"\n\t\t\t\t\t\t\t\tstyle="background-color: ',';"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="tasks-scrum-epic-form-body">\n\t\t\t\t\t\t<div class="tasks-scrum-epic-form-description">\n\t\t\t\t\t\t\t','\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="tasks-scrum-epic-form-files"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t'])),n.Text.encode(e.name),n.Text.encode(e.color),e.description)}},{key:"renderEditForm",value:function t(e){this.selectedColor=e.color;return n.Tag.render(R||(R=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="tasks-scrum-epic-form">\n\t\t\t\t<div class="tasks-scrum-epic-form-container">\n\t\t\t\t\t',"\n\t\t\t\t\t","\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"])),this.renderNameField(e.id,e.name,this.selectedColor),this.renderDescriptionField())}},{key:"renderNameField",value:function t(e,i,s){var r=this;var a=n.Tag.render(O||(O=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="tasks-scrum-epic-form-header">\n\t\t\t\t<div class="tasks-scrum-epic-form-header-title">\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype="text"\n\t\t\t\t\t\tname="name"\n\t\t\t\t\t\tvalue="','"\n\t\t\t\t\t\tclass="tasks-scrum-epic-form-header-title-control"\n\t\t\t\t\t\tplaceholder="','"\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t\t<div class="tasks-scrum-epic-form-header-separate"></div>\n\t\t\t\t<div class="tasks-scrum-epic-header-color">\n\t\t\t\t\t<div\n\t\t\t\t\t\tdata-epic-id="','"\n\t\t\t\t\t\tclass="tasks-scrum-epic-header-color-current"\n\t\t\t\t\t\tstyle="background-color: ',';"\n\t\t\t\t\t>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="tasks-scrum-epic-header-color-btn-angle"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t'])),n.Text.encode(i),n.Loc.getMessage("TASKS_SCRUM_SPRINT_ADD_EPIC_NAME_PLACEHOLDER"),parseInt(e,10),n.Text.encode(s));var o=a.querySelector(".tasks-scrum-epic-header-color");n.Event.bind(o,"click",(function(){var t=o.querySelector(".tasks-scrum-epic-header-color-current");var e=r.getColorPicker(t);e.open()}));return a}},{key:"renderDescriptionField",value:function t(){return n.Tag.render(N||(N=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="tasks-scrum-epic-form-body">\n\t\t\t\t<div class="tasks-scrum-epic-form-description --editing"></div>\n\t\t\t</div>\n\t\t'])))}},{key:"renderEditor",value:function t(i){var s=this;setTimeout((function(){n.Runtime.html(i,s.formData.html).then((function(){if(window.LHEPostForm){s.editorHandler=window.LHEPostForm.getHandler(s.id);e.EventEmitter.emit(s.editorHandler.eventNode,"OnShowLHE",[true])}s.focusToName()}))}),300)}},{key:"renderListBlank",value:function t(){return n.Tag.render(q||(q=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="tasks-scrum-epics-empty">\n\t\t\t\t<div class="tasks-scrum-epics-empty-first-title">\n\t\t\t\t\t','\n\t\t\t\t</div>\n\t\t\t\t<div class="tasks-scrum-epics-empty-image">\n\t\t\t\t\t<svg width="124px" height="123px" viewBox="0 0 124 123" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n\t\t\t\t\t\t<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" opacity="0.28">\n\t\t\t\t\t\t\t<path d="M83,105 L83,81.4375 L105,81.4375 L105,18 L17,18 L17,81.4375 L39,81.4375 L39,105 L83,105 Z M10.9411765,0 L113.058824,0 C119.101468,0 124,4.85902727 124,10.8529412 L124,112.147059 C124,118.140973 119.101468,123 113.058824,123 L10.9411765,123 C4.89853156,123 0,118.140973 0,112.147059 L0,10.8529412 C0,4.85902727 4.89853156,0 10.9411765,0 Z M44.0142862,47.0500004 L54.2142857,57.4416671 L79.7142857,32 L87,42.75 L54.2142857,75 L36,57.0833333 L44.0142862,47.0500004 Z" fill="#A8ADB4" />\n\t\t\t\t\t\t</g>\n\t\t\t\t\t</svg>\n\t\t\t\t</div>\n\t\t\t\t<div class="tasks-scrum-epics-empty-second-title">\n\t\t\t\t\t','\n\t\t\t\t</div>\n\t\t\t\t<div class="tasks-scrum-epics-empty-button">\n\t\t\t\t\t<button class="ui-btn ui-btn-primary ui-btn-lg">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"])),n.Loc.getMessage("TASKS_SCRUM_EPICS_EMPTY_FIRST_TITLE"),n.Loc.getMessage("TASKS_SCRUM_EPICS_EMPTY_SECOND_TITLE"),n.Loc.getMessage("TASKS_SCRUM_SPRINT_ADD_EPIC_LIST_TOOLBAR_BUTTON"))}},{key:"getGrid",value:function t(){if(BX&&BX.Main&&BX.Main.gridManager){return BX.Main.gridManager.getById(this.gridId)}return null}},{key:"reloadGrid",value:function t(){if(BX&&BX.Main&&BX.Main.gridManager){BX.Main.gridManager.reload(this.gridId)}}},{key:"prepareTagsList",value:function t(e){var i=this;var s=e.querySelectorAll(".tasks-scrum-epic-grid-tags");s.forEach((function(t){var e=i.getTagsFromNode(t);n.Dom.clean(t);e.forEach((function(e){n.Dom.append(i.getTagNode(e),t)}))}))}},{key:"getTagsFromNode",value:function t(e){var i=[];e.childNodes.forEach((function(t){i.push(t.textContent.trim())}));return i}},{key:"getTagNode",value:function t(e){var i=new s.Label({text:e,color:s.Label.Color.TAG_LIGHT,fill:true,size:s.Label.Size.SM,customClass:""});return i.getContainer()}},{key:"getColorPicker",value:function t(e){var i=this;var s=n.Dom.attr(e,"data-epic-id");if(!this.colorPickers.has(s)){var r=new BX.ColorPicker({bindElement:e,defaultColor:this.defaultColor,selectedColor:this.selectedColor?this.selectedColor:this.defaultColor,onColorSelected:function t(s,r){i.selectedColor=s;e.style.backgroundColor=s},popupOptions:{angle:{position:"top",offset:33},className:"tasks-scrum-epic-color-popup"},allowCustomColor:false,colors:[["#aae9fc","#bbecf1","#98e1dc","#e3f299","#ffee95","#ffdd93","#dfd3b6","#e3c6bb"],["#ffad97","#ffbdbb","#ffcbd8","#ffc4e4","#c4baed","#dbdde0","#bfc5cd","#a2a8b0"]]});this.colorPickers.set(s,r)}return this.colorPickers.get(s)}},{key:"focusToName",value:function t(){var e=this;setTimeout((function(){e.form.querySelector(".tasks-scrum-epic-form-header-title-control").focus()}),50)}},{key:"getRequestData",value:function t(){var e={};if(this.currentEpic){e.epicId=this.currentEpic.id}e.groupId=this.groupId;e.name=this.form.querySelector("[name=name]").value.trim();e.description=this.editorHandler.getEditor().GetContent();e.color=this.selectedColor?this.selectedColor:this.defaultColor;e.files=this.getAttachmentsFiles();return e}},{key:"getAttachmentsFiles",value:function t(){var e=this;var i=[];if(!this.editorHandler||!n.Type.isPlainObject(this.editorHandler.arFiles)||!n.Type.isPlainObject(this.editorHandler.controllers)){return i}var s=[];Object.values(this.editorHandler.arFiles).forEach((function(t){if(!s.includes(t)){s.push(t)}}));s.forEach((function(t){if(e.editorHandler.controllers[t]&&n.Type.isPlainObject(e.editorHandler.controllers[t].values)){Object.keys(e.editorHandler.controllers[t].values).forEach((function(t){if(!i.includes(t)){i.push(t)}}))}}));return i}}],[{key:"showView",value:function t(e,i){var s=new a({view:"view",groupId:e,epicId:i});s.show()}},{key:"showEdit",value:function t(e,i){var s=new a({view:"edit",groupId:e,epicId:i});s.show()}},{key:"removeEpic",value:function t(e,i,s){var r=new a({view:"edit",groupId:e,gridId:s,epicId:i});r.removeEpic().then((function(){r.reloadGrid()}))}},{key:"showTasks",value:function t(e,i){var s=new a({view:"tasks",groupId:e,epicId:i});s.show()}},{key:"showCompletedTasks",value:function t(e,i){var s=new a({view:"completedTasks",groupId:e,epicId:i});s.show()}},{key:"showTask",value:function t(e){var i=BX.SidePanel.Instance;i.getOpenSliders().forEach((function(t){var i=t.getWindow();if(!n.Type.isNil(i)&&!n.Type.isNil(i.BX.Tasks.Scrum.EpicInstance)){i.BX.Tasks.Scrum.EpicInstance.showTask(e)}}))}}]);return a}(e.EventEmitter);t.Filter=y;t.Epic=j})(this.BX.Tasks.Scrum=this.BX.Tasks.Scrum||{},BX.Event,BX.UI.SidePanel,BX.UI,BX,BX,BX.UI.Dialogs);
//# sourceMappingURL=epic.bundle.map.js